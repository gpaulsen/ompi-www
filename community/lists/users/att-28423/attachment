<html><head><meta http-equiv="Content-Type" content="text/html charset=utf-8"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class="">Hi All,<div class=""><br class=""></div><div class="">Thanks for the feedback. &nbsp;I guess I'm a little perplexed about how we got here; I'd think if it was linking against the PMI stuff that slurm version wouldn't matter? &nbsp;There aren't versioned PMI libraries:</div><div class=""><div style="margin: 0px; font-size: 11px; line-height: normal; font-family: Menlo;" class="">/usr/lib64/libpmi.so</div><div style="margin: 0px; font-size: 11px; line-height: normal; font-family: Menlo;" class="">/usr/lib64/libpmi.so.0</div><div style="margin: 0px; font-size: 11px; line-height: normal; font-family: Menlo;" class="">/usr/lib64/libpmi.so.0.0.0 (real file)</div><div style="margin: 0px; font-size: 11px; line-height: normal; font-family: Menlo;" class="">/usr/lib64/libpmi2.so</div><div style="margin: 0px; font-size: 11px; line-height: normal; font-family: Menlo;" class="">/usr/lib64/libpmi2.so.0</div><div style="margin: 0px; font-size: 11px; line-height: normal; font-family: Menlo;" class="">/usr/lib64/libpmi2.so.0.0.0 (real file)</div></div><div class=""><br class=""></div><div class="">FWIW slurm has:</div><div class=""><div style="margin: 0px; font-size: 11px; line-height: normal; font-family: Menlo;" class="">/usr/lib64/libslurm.so</div><div style="margin: 0px; font-size: 11px; line-height: normal; font-family: Menlo;" class="">/usr/lib64/libslurm.so.29 (real file)</div></div><div class=""><br class=""></div><div class="">Any easy temporary fix is just to make a symlink from libslurm.so.29 to libslurm.so.28; things just work. &nbsp;Not really a long term strategy but gets folks running again.</div><div class=""><br class=""></div><div class="">Sounds like I should follow up with the slurm list.</div><div class=""><br class=""></div><div class="">Regards,</div><div class=""><br class=""></div><div class="">Will</div><div class=""><br class=""><div><blockquote type="cite" class=""><div class="">On Jan 29, 2016, at 3:59 AM, Gilles Gouaillardet &lt;<a href="mailto:gilles.gouaillardet@gmail.com" class="">gilles.gouaillardet@gmail.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><div class="">on second thought, is there any chance your sysadmin removed the old libslurm.so.x but kept the old libpmix.so.y ?<div class="">in this case, the real issue would be hidden&nbsp;</div><div class="">your sysadmin "broke" the old libpmi, but you want to use the new one indeed.</div><div class=""><br class=""></div><div class="">Cheers,</div><div class=""><br class=""></div><div class="">Gilles<br class=""><br class="">On Friday, January 29, 2016, Gilles Gouaillardet &lt;<a href="mailto:gilles.gouaillardet@gmail.com" class="">gilles.gouaillardet@gmail.com</a>&gt; wrote:<br class=""><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">Is openmpi linked with a static libpmi.a that requires a dynamic libslurm ?<div class="">that can be checked with ldd mca_ess_pmi.so</div><div class=""><br class=""></div><div class="">btw, do&nbsp;slurm folks increase the libpmi.so version each time slurm&nbsp;is upgraded ?</div><div class="">that could be a part of the issue ...</div><div class="">but if they increase lib version because of abi changes, it might be a bad idea to open libxxx.so instead of libxxx.so.y</div><div class="">generally speaking, libxxx.so.y is provided by libxxx package, and libxxx.so is provided by libxxx-devel package, which means it might not be available on compute nodes.</div><div class="">we could also dlopen libxxx instead of linking with it, and have the sysadmin configure openmpi so it finds the right lib (this approach is used by a prominent vendor, and has other pros but also cons)</div><div class=""><br class=""></div><div class="">Cheers,</div><div class=""><br class=""></div><div class="">Gilles<br class=""><br class="">On Friday, January 29, 2016, Ralph Castain &lt;<a href="javascript:_e(%7B%7D,'cvml','rhc@open-mpi.org');" target="_blank" class="">rhc@open-mpi.org</a>&gt; wrote:<br class=""><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div style="word-wrap:break-word" class="">It makes sense - but isn’t it slurm that is linking libpmi against libslurm? I don’t think we are making that connection, so it would be a slurm issue to change it.<div class=""><br class=""></div><div class=""><br class=""><div class=""><blockquote type="cite" class=""><div class="">On Jan 28, 2016, at 10:12 PM, William Law &lt;<a class="">willthelaw@gmail.com</a>&gt; wrote:</div><br class=""><div class=""><div style="word-wrap:break-word" class="">Hi,<div class=""><br class=""></div><div class="">Our group can't find anyway to do this and it'd be helpful.</div><div class=""><br class=""></div><div class="">We use slurm and keep upgrading the slurm environment.&nbsp; OpenMPI bombs out against PMI each time the libslurm stuff changes, which seems to be fairly regularly.&nbsp; Is there a way to compile against slurm but insulate ourselves from the libslurm chaos?&nbsp; Obvious will ask the slurm folks too.</div><div class=""><br class=""></div><div class=""><div style="margin:0px;font-size:11px;line-height:normal;font-family:Menlo" class="">[<span style="color:rgb(52,189,38)" class=""><b class="">wlaw</b></span>@some-node /scratch/users/wlaw/imb/src]$ mpirun -n 2 --mca grpcomm ^pmi ./IMB-MPI1&nbsp;</div><div style="margin:0px;font-size:11px;line-height:normal;font-family:Menlo" class="">[some-node.local:42584] mca: base: component_find: unable to open /share/sw/free/openmpi/1.6.5/intel/13sp1up1/lib/openmpi/mca_ess_pmi: libslurm.so.28: cannot open shared object file: No such file or directory (ignored)</div><div style="margin:0px;font-size:11px;line-height:normal;font-family:Menlo" class="">[some-node.local:42585] mca: base: component_find: unable to open /share/sw/free/openmpi/1.6.5/intel/13sp1up1/lib/openmpi/mca_pubsub_pmi: libslurm.so.28: cannot open shared object file: No such file or directory (ignored)</div><div style="margin:0px;font-size:11px;line-height:normal;font-family:Menlo" class="">[some-node.local:42586] mca: base: component_find: unable to open /share/sw/free/openmpi/1.6.5/intel/13sp1up1/lib/openmpi/mca_pubsub_pmi: libslurm.so.28: cannot open shared object file: No such file or directory (ignored)</div></div><div class=""><br class=""></div><div class="">(sent it via the wrong email so it bounced..... heh)</div><div class=""><br class=""></div><div class="">Upon further investigation it seems like the most appropriate thing would be to point it at compile time to libslurm.so instead of libslurm.so.xx; does that make sense?</div><div class=""><br class=""></div><div class="">Thanks,</div><div class=""><br class=""></div><div class="">Will</div></div>_______________________________________________<br class="">users mailing list<br class=""><a class="">users@open-mpi.org</a><br class="">Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank" class="">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br class="">Link to this post: <a href="http://www.open-mpi.org/community/lists/users/2016/01/28408.php" target="_blank" class="">http://www.open-mpi.org/community/lists/users/2016/01/28408.php</a></div></blockquote></div><br class=""></div></div></blockquote></div>
</blockquote></div>
_______________________________________________<br class="">users mailing list<br class=""><a href="mailto:users@open-mpi.org" class="">users@open-mpi.org</a><br class="">Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/users<br class="">Link to this post: http://www.open-mpi.org/community/lists/users/2016/01/28415.php</div></blockquote></div><br class=""></div></body></html>
