<html><head><meta http-equiv="Content-Type" content="text/html charset=iso-8859-1"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">Hello, Devendra,<div><br></div><div>Sending and receiving messages in MPI are atomic operations - they complete only when the whole message was sent or received. MPI_Test only tells you if the operation has completed - there is no indication like "30% of the message was sent/received, stay tuned for more".</div><div><br></div><div>On the sender side, the message is constructed by taking bytes from various locations in memory, specified by the type map of the MPI datatype used. Then on the receiver side the message is deconstructed back into memory by placing the received bytes according to the type map of the MPI datatype provided. The combination of receive datatype and receive count gives you a certain number of bytes (that is the type size obtainable by MPI_Type_size times "count"). If the message is shorter, that means that some elements of the receive buffer will not be filled, which is OK - you can test exactly how many elements were filled with MPI_Get_count on the status of the receive operation. If the message was longer, however, there won't be enough place to put all the data that the message is carrying and an overflow error would occur.</div><div><br></div><div>This works best by example. Image that in one process you issue:</div><div><br></div><div>MPI_Send(data, 80, MPI_BYTE, ...);</div><div><br></div><div>This will send a message containing 80 elements of type byte. Now on the receiver side you issue:</div><div><br></div><div>MPI_Irecv(data, 160, MPI_BYTE, ..., &amp;request);</div><div><br></div><div>What will happen is that the message will be received in its entirety since 80 times the size of MPI_BYTE is less than or equal to 160 times the size of MPI_BYTE. Calling MPI_Test on "request" will produce true in the completion flag and you will get back a status variable (unless you provided MPI_STATUS_IGNORE) and then you can call:</div><div><br></div><div>MPI_Get_count(&amp;status, MPI_BYTE, &amp;count);</div><div><br></div><div>Now "count" will contain 80 - the actual number of elements received.</div><div><br></div><div>But if the receive operation was instead:</div><div><br></div><div>MPI_Irecv(data, 40, MPI_BYTE, ..., &amp;request);</div><div><br></div><div>since 40 times the size of MPI_BYTE is less than the size of the message, there will be not enough space to receive the entire message and an overflow error would occur. The MPI_Irecv itself only initiates the receive operation and will not return an error. Rather you will obtain the overflow error in the MPI_ERROR field of the status argument, returned by MPI_Test (the test call itself will return MPI_SUCCESS).</div><div><br></div><div>Since MPI operations are atomic, you cannot send a message of 160 element and then receive it with two separate receives of size 80 - this is very important and it is difficult to grasp initially by people, who come to MPI from the traditional Unix network programming.</div><div><br></div><div>I would recommend that you head to <a href="http://www.mpi-forum.org/">http://www.mpi-forum.org/</a> and download from there the PDF of the latest MPI 2.2 standard (or order the printed book). Unlike many other standard documents this one is actually readable by normal people and contains many useful explanations and examples. Read through entire section 3.2 to get a better idea of how messaging works in MPI.</div><div><br></div><div>Hope that helps to clarify things,</div><div><br></div><div>Hristo</div><div><br><div><div>On 21.08.2012, at 10:01, devendra rai &lt;<a href="mailto:rai.devendra@yahoo.co.uk">rai.devendra@yahoo.co.uk</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite">

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<div><div style="background-color: rgb(255, 255, 255); font-family: verdana, helvetica, sans-serif; font-size: 10pt; ">Hello Jeff and Hristo,<br><br>Now I am completely confused:<br><br>So, let's say, the complete reception requires 8192 bytes. And, I have:<br><br><span id="yiv1301008748yui_3_2_0_18_1345454772473352" style="color:rgb(0, 0, 255);">MPI_Irecv(</span><br style="color:rgb(0, 0, 255);"><span style="color:rgb(0, 0,
 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (void*)this-&gt;receivebuffer,/* the receive buffer */</span><br style="color:rgb(0, 0, 255);"><span id="yiv1301008748yui_3_2_0_18_1345454772473355" style="color:rgb(0, 0, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this-&gt;receive_packetsize,&nbsp; /* 80 */</span><br style="color:rgb(0, 0, 255);"><span style="color:rgb(0, 0, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MPI_BYTE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* The data type expected */</span><br style="color:rgb(0, 0, 255);"><span style="color:rgb(0, 0,
 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this-&gt;transmittingnode,&nbsp;&nbsp;&nbsp; /* The node from which to receive */</span><br style="color:rgb(0, 0, 255);"><span style="color:rgb(0, 0, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this-&gt;uniquetag,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* Tag */</span><br style="color:rgb(0, 0, 255);"><span style="color:rgb(0, 0, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MPI_COMM_WORLD,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* Communicator */</span><br style="color:rgb(0, 0, 255);"><span style="color:rgb(0, 0,
 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;Irecv_request&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* request handle */</span><br style="color:rgb(0, 0, 255);"><span style="color:rgb(0, 0, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );</span><br><div><span><br></span></div><div><br></div><div style="font-size: 13.3333px; font-family: verdana, helvetica, sans-serif; background-color: transparent; font-style: normal; ">That means, the the MPI_Test will tell me that the reception is complete when I have received the first 80 bytes. Correct?</div><div style="font-size: 13.3333px; font-family: verdana, helvetica, sans-serif; background-color: transparent; font-style: normal; "><br></div><div style="font-size: 13.3333px; font-family: verdana, helvetica, sans-serif; background-color: transparent; font-style: normal; ">Next, let[s say that I have a receive buffer with a capacity of 160 bytes, then, will overflow error occur here? Even if I have decided to receive a large payload in chunks of 80 bytes?</div><div style="font-size: 13.3333px; font-family: verdana, helvetica, sans-serif; background-color: transparent; font-style: normal; "><br></div><div style="font-size: 13.3333px; font-family: verdana, helvetica, sans-serif; background-color: transparent; font-style: normal; ">I am sorry, the manual and the API reference was too vague for me.</div><div style="font-size: 13.3333px; font-family: verdana, helvetica, sans-serif; background-color: transparent; font-style: normal; "><br></div><div style="font-size: 13.3333px; font-family: verdana, helvetica, sans-serif; background-color: transparent; font-style: normal; ">Thanks a lot</div><div style="font-size: 13.3333px; font-family: verdana, helvetica, sans-serif; background-color: transparent; font-style: normal; "><br></div><div style="font-size: 13.3333px; font-family: verdana, helvetica, sans-serif; background-color: transparent; font-style: normal; ">Devendra<br></div>  <div style="font-family: verdana, helvetica, sans-serif; font-size: 10pt;"> <div style="font-family: times new roman, new york, times, serif; font-size: 12pt;"> <div dir="ltr"> <font face="Arial" size="2"> <hr size="1">  <b><span style="font-weight:bold;">From:</span></b> "Iliev, Hristo" &lt;<a href="mailto:iliev@rz.rwth-aachen.de">iliev@rz.rwth-aachen.de</a>&gt;<br> <b><span style="font-weight: bold;">To:</span></b> Open MPI Users &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt; <br><b><span style="font-weight: bold;">Cc:</span></b> devendra rai &lt;<a href="mailto:rai.devendra@yahoo.co.uk">rai.devendra@yahoo.co.uk</a>&gt; <br> <b><span style="font-weight:
 bold;">Sent:</span></b> Tuesday, 21 August 2012, 9:48<br> <b><span style="font-weight: bold;">Subject:</span></b> Re: [OMPI users] MPI_Irecv: Confusion with &lt;&lt;int count&gt;&gt; inputy parameter<br> </font> </div> <br>Jeff,<br><br>&gt;&gt; Or is it the number of elements that are expected to be received, and hence MPI_Test will tell me that the receive is not complete untill "count" number of elements have not been received?<br>&gt; <br>&gt; Yes.<br><br>Answering "Yes" this question might further the confusion there. The "count" argument specifies the *capacity* of the receive buffer and the receive operation (blocking or not) will complete successfully for any matching message with size up to "count", even for an empty message with 0 elements, and will produce an overflow error if the received message was longer and data truncation has to occur.<br><br>On 20.08.2012, at 16:32, Jeff Squyres &lt;<a ymailto="mailto:jsquyres@cisco.com" href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a>&gt; wrote:<br><br>&gt; On Aug 20, 2012, at 5:51 AM, devendra rai wrote:<br>&gt; <br>&gt;&gt; Is it the number of elements that have been received *thus far* in the buffer?<br>&gt; <br>&gt; No.<br>&gt; <br>&gt;&gt; Or is it the number of elements that are expected to be received, and hence MPI_Test will tell me that the receive is not complete untill "count" number of elements have not been received?<br>&gt; <br>&gt; Yes.<br>&gt; <br>&gt;&gt; Here's the reason why I have a problem (and I think I may be completely stupid here, I'd appreciate your patience):<br>&gt; [snip]<br>&gt;&gt; Does anyone see what could be going wrong?<br>&gt; <br>&gt; Double check that the (sender_rank, tag, communicator) tuple that you issued in the MPI_Irecv matches the (rank, tag, communicator) tuple from the sender (tag and communicator are arguments on the sending side, and rank is the rank of the sender in that
 communicator).<br>&gt; <br>&gt; When receives block like this without completing like this, it usually means a mismatch between the tuples.<br>&gt; <br>&gt; -- <br>&gt; Jeff Squyres<br>&gt; <a ymailto="mailto:jsquyres@cisco.com" href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a><br>&gt; For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>&gt; <br>&gt; <br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt; <a ymailto="mailto:users@open-mpi.org" href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br><br>--<br>Hristo Iliev, Ph.D. -- High Performance Computing,<br>RWTH Aachen University, Center for Computing and Communication<br>Seffenter Weg
 23,&nbsp; D 52074&nbsp; Aachen (Germany)<br>Tel: +49 241 80 24367 -- Fax/UMS: +49 241 80 624367<br><br><br><br><br> </div> </div>  </div></div></blockquote></div><br><div>
<span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; font-size: medium; ">--<br>Hristo Iliev, Ph.D. -- High Performance Computing,<br>RWTH Aachen University, Center for Computing and Communication<br>Seffenter Weg 23, &nbsp;D 52074 &nbsp;Aachen (Germany)<br>Tel: +49 241 80 24367 -- Fax/UMS: +49 241 80 624367<br><br></span>

</div>
<br></div></body></html>
