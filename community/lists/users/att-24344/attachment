<html><head><meta http-equiv="Content-Type" content="text/html charset=iso-8859-1"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><br><div><div>On May 10, 2014, at 12:02 AM, Wijnberg, Tom &lt;<a href="mailto:TWij@metrohm-applikon.com">TWij@metrohm-applikon.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite">Hi Ralph,<br><br>Thank you for your reply. My problem does sound a bit like the bug you are describing however I'm not quite sure yet. I have implemented the exact same setup between 2 virtual machines and in that setup everything runs correctly. I did test if the local firewall was the problem but no luck. I'm uncertain if perhaps the local admin also is limiting traffic within the network through a firewall however I find that unlikely, but I will ask him on Monday. It did occur to me that perhaps the port forwarding is not setup correctly. I have forwarded port 22 from the virtualbox host to the virtual machine but perhaps openmpi requires more than just this port? The need to have your firewall not block TCP connections between pc's does seem to indicate this.<br></blockquote><div><br></div>This is likely to be the problem, then. OMPI requires several ports: (a) one port for the daemons to connect back to mpirun, and (b) at least one port for the TCP BTL. Your best solution is to remove the firewall on the virtual machine completely, but if you must do it with port forwarding, you can open up some specific ports and pass them to OMPI. For example, if you open up port 1234 and ports 6789-6792:</div><div><br></div><div>-mca&nbsp;<span style="font-family: Menlo; font-size: 11px;">oob_tcp_static_ipv4_ports</span>&nbsp;1234-2000 -mca&nbsp;<span style="font-family: Menlo; font-size: 11px;">btl_tcp_port_min_v4 6789 -mca&nbsp;</span><span style="font-family: Menlo; font-size: 11px;">btl_tcp_port_range_v4 3</span></div><div><span style="font-family: Menlo; font-size: 11px;"><br></span></div><div><span style="font-family: Menlo; font-size: 11px;">Note that you don't have to open up all the oob tcp ports as only the daemon needs to connect back thru the firewall. However, once you specify static ports, you have to provide enough entries for all the local procs to connect back to the daemon - we don't currently offer the option of defining static ports only for the daemons while leaving the app procs dynamic.</span></div><div><font face="Menlo"><span style="font-size: 11px;"><br></span></font></div><div><font face="Menlo"><span style="font-size: 11px;">Per ompi_info:</span></font></div><div><font face="Menlo"><span style="font-size: 11px;"><br></span></font></div><div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;MCA oob: parameter "oob_tcp_static_ipv4_ports" (current</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value: "", data source: default, level: 9 dev/all,</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type: string)</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Static ports for daemons and procs (IPv4)</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;"><br></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;MCA btl: parameter "btl_tcp_port_min_v4" (current value:</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "1024", data source: default, level: 2 user/detail,</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type: int)</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The minimum port where the TCP BTL will try to bind</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (default 1024)</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCA btl: parameter "btl_tcp_port_range_v4" (current value:</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "64511", data source: default, level: 2</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; user/detail, type: int)</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The number of ports where the TCP BTL will try to</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bind (default 64511). This parameter together with</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the port min, define a range of ports where Open</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPI will open sockets.</div><div><br></div><blockquote type="cite"><br>As for the PATH and LD_LIBRARY_PATH how can I check if these are set correctly. When I login into the slave pc I'm able to use mpirun locally without the need to set any variables. To me this would seem to indicate that the problem is not related to the PATH or LD_LIBRARY_PATH. However when I try and add the master to the hosts file (so using them the wrong way around) I get the exact same behavior as observed before.<br></blockquote><div><br></div>Check out the FAQ - login executes a different default setup script than remote execution:</div><div><br></div><div><a href="http://www.open-mpi.org/faq/?category=running#adding-ompi-to-path">http://www.open-mpi.org/faq/?category=running#adding-ompi-to-path</a></div><div><br></div><div>You might also be able to add --enable-orterun-prefix-by-default to your configure line if the install location is the same on both machines.</div><div><br></div><div><br><blockquote type="cite"><br>Currently I'm leaning towards a problem with port forwarding however I can't find information of openmpi requires more than just port 22 to work.<br><br>Regards,<br>TWij<br><br>--<br>Metrohm Applikon&nbsp;B.V.<br>De Brauwweg 13<br>3125 AE Schiedam<br>The NetherlandsLIBRARY_PATH<br>Phone: +31 (0)10 298 3555<br>Direct: +31 (0)10 298 3579<br><br>DISCLAIMER:<br>This e-mail and any attachment sent with it are intended exclusively for the addressee(s), and may not be passed on to, or made available for use by any person other than the addressee(s). Any and every liability resulting from any electronic transmission is ruled out.<br>If you are not the intended recipient, please contact the sender by reply email and destroy all copies of the original message.<br><br><br>-----Original Message-----<br>From: users [<a href="mailto:users-bounces@open-mpi.org">mailto:users-bounces@open-mpi.org</a>] On Behalf Of Ralph Castain<br>Sent: vrijdag 9 mei 2014 15:46<br>To: Open MPI Users<br>Subject: Re: [OMPI users] No output when adding host to hostfile<br><br>There is a known bug in the 1.8.1 release whereby daemons failing to start on a remote node will cause a silent failure. This has been fixed for the upcoming 1.8.2 release, but you might want to use one of the nightly 1.8.2 snapshots in the interim.<br><br>Most likely causes:<br><br>* not finding the required libraries on the remote node because the default PATH and LD_LIBRARY_PATH aren't setup correctly<br><br>* firewall preventing TCP connections between the machines<br><br>Ralph<br><br><br>On May 9, 2014, at 5:30 AM, Wijnberg, Tom &lt;<a href="mailto:TWij@metrohm-applikon.com">TWij@metrohm-applikon.com</a>&gt; wrote:<br><br><blockquote type="cite">Hi,<br><br>I have encountered a problem with openmpi I can't seem to be able to <br>diagnose or find precedence in in the mailing-list. I have two pc's <br>with a fresh install of Arch linux and openmpi 1.8.1. One is a <br>dedicated PC and the other is a virtualbox installation. The <br>virtualbox install is the master and I'm able to use mpirun without a <br>problem (compiled a small program that prints to stdout). In and output are as follows:<br><br><blockquote type="cite">$ mpirun -n 4 -hostfile mpiHosts myprogram hello MPI user: from <br>process = 1 on machine=vArch, of NCPU=4 processes hello MPI user: <br>from process = 0 on machine=vArch, of NCPU=4 processes hello MPI <br>user: from process = 2 on machine=vArch, of NCPU=4 processes hello <br>MPI user: from &nbsp;process = 3 on machine=vArch, of NCPU=4<br></blockquote>processes<br><br>Running programs on a single machine is not a problem. Also I'm able <br>to log into both machines using ssh without the need for a password so <br>communication between the machines should be oke. However when I add <br>the second host to the hostfile the I get no more feedback. What I <br>mean with this is that I get the following.<br><br><blockquote type="cite">$ echo "10.5.10.224 slots=4" &gt;&gt; mpiHosts $ mpirun -n 8 -hostfile $ <br>mpirun -n 4 -hostfile mpiHosts myprogram<br><br></blockquote><br>No output is returned. I'm not sure if this is intended behavior but <br>it seems incorrect to me. Can anyone provide me with some insight as <br>to why I'm observing this en how I can diagnose the problem.<br><br>Regards,<br>TWij<br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br>_______________________________________________<br>users mailing list<br>users@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote></div><br></body></html>
