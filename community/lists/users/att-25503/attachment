<html><head><meta http-equiv="Content-Type" content="text/html charset=us-ascii"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><br><div><div>On Oct 15, 2014, at 11:46 AM, Gus Correa &lt;<a href="mailto:gus@ldeo.columbia.edu">gus@ldeo.columbia.edu</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div style="font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Thank you Ralph and Jeff for the help!<br><br>Glad to hear the segmentation fault is reproducible and will be fixed.<br><br>In any case, one can just avoid the old parameter name<br>(rmaps_base_schedule_policy),<br>and use instead the new parameter name<br>(rmaps_base_mapping_policy)<br>without any problem in OMPI 1.8.3.<br><br></div></blockquote><div><br></div>Fix is in the nightly 1.8 tarball - I'll release a 1.8.4 soon to cover the problem.</div><div><br><blockquote type="cite"><div style="font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">**<br><br>Thanks Ralph for sending the new (OMPI 1.8)<br>parameter names for process binding.<br><br>My recollection is that sometime ago somebody (Jeff perhaps?)<br>posted here a link to a presentation (PDF or PPT) explaining the<br>new style of process binding, but I couldn't find it in the<br>list archives.<br>Maybe the link could be part of the FAQ (if not already there)?<br></div></blockquote><div><br></div>I don't think it is, but I'll try to add it over the next day or so.</div><div><br><blockquote type="cite"><div style="font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br>**<br><br>The Open MPI runtime environment is really great.<br>However, to take advantage of it one often has to do parameter guessing,<br>and to do time consuming tests by trial and error,<br>because the main sources of documentation are<br>the terse output of ompi_info, and several sparse<br>references in the FAQ.<br>(Some of them outdated?)<br><br>In addition, the runtime environment has evolved over time,<br>which is certainly a good thing.<br>However, along with this evolution, several runtime parameters<br>changed both name and functionality, new ones were introduced,<br>old ones were deprecated, which can be somewhat confusing,<br>and can lead to an ineffective use of the runtime environment.<br>(In 1.8.3 I was using several deprecated parameters from 1.6.5<br>that seem to be silently ignored at runtime.<br>I only noticed the problem because that segmentation fault happened.)<br><br>I know asking for thorough documentation is foolish,<br></div></blockquote><div><br></div>Not really - it is something we need to get better about :-(</div><div><br><blockquote type="cite"><div style="font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">but I guess a simple table of runtime parameter names and valid values<br>in the FAQ, maybe sorted by their purpose/function, along with a few examples of use, could help a lot.<br>Some of this material is now spread across several FAQ, but not so<br>easy to find/compare.<br>That doesn't need to be a comprehensive table, but commonly used<br>items like selecting the btl, selecting interfaces,<br>dealing with process binding,<br>modifying/enriching the stdout/sterr output<br>(tagging output, increasing verbosity, etc),<br>probably have their place there.<br></div></blockquote><div><br></div>Yeah, we fell down on this one. The changes were announced with each step in the 1.7 series, but if you step from 1.6 directly to 1.8, you'll get caught flat-footed. We honestly didn't think of that case, and so we mentally assumed that "of course people have been following the series - they know what happened".</div><div><br></div><div>You know what they say about those who "assume" :-/</div><div><br></div><div>I'll try to get something into the FAQ about the entire new mapping, ranking, and binding system. It is actually VERY powerful, allowing you to specify pretty much any placement pattern you can imagine and bind it to whatever level you desire. It was developed in response to requests from researchers who wanted to explore application performance versus placement strategies - but we provided some simplified options to support more common usage patterns.</div><div><br></div><div><br><blockquote type="cite"><div style="font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br><br>Many thanks,<br>Gus Correa<br><br><br>On 10/15/2014 11:12 AM, Jeff Squyres (jsquyres) wrote:<br><blockquote type="cite">We talked off-list -- fixed this on master and just filed <a href="https://github.com/open-mpi/ompi-release/pull/33">https://github.com/open-mpi/ompi-release/pull/33</a> to get this into the v1.8 branch.<br><br><br>On Oct 14, 2014, at 7:39 PM, Ralph Castain &lt;<a href="mailto:rhc@open-mpi.org">rhc@open-mpi.org</a>&gt; wrote:<br><br><blockquote type="cite"><br>On Oct 14, 2014, at 5:32 PM, Gus Correa &lt;<a href="mailto:gus@ldeo.columbia.edu">gus@ldeo.columbia.edu</a>&gt; wrote:<br><br><blockquote type="cite">Dear Open MPI fans and experts<br><br>This is just a note in case other people run into the same problem.<br><br>I just built Open MPI 1.8.3.<br>As usual I put my old settings on openmpi-mca-params.conf,<br>with no further thinking.<br>Then I compiled the connectivity_c.c program and tried<br>to run it with mpiexec.<br>That is a routine that never failed before.<br><br>Bummer!<br>I've got a segmentation fault right away.<br></blockquote><br>Strange &nbsp;- it works fine from the cmd line:<br><br>07:27:04 &nbsp;(v1.8) /home/common/openmpi/ompi-release$ mpirun -n 1 -mca rmaps_base_schedule_policy core hostname<br>--------------------------------------------------------------------------<br>A deprecated MCA variable value was specified in the environment or<br>on the command line. &nbsp;Deprecated MCA variables should be avoided;<br>they may disappear in future releases.<br><br>&nbsp;Deprecated variable: rmaps_base_schedule_policy<br>&nbsp;New variable: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rmaps_base_mapping_policy<br>--------------------------------------------------------------------------<br>bend001<br><br>HOWEVER, I can replicate that behavior when it is in the default params file! I don't see the immediate cause of the difference, but will investigate.<br><br><blockquote type="cite"><br>After some head scratching, checking my environment, etc,<br>I thought I might have configured OMPI incorrectly.<br>Hence, I tried to get information from ompi_info.<br>Oh well, ompi_info also segfaulted!<br><br>It took me a while to realize that the runtime parameter<br>configuration file was the culprit.<br><br>When I inserted the runtime parameter settings one by one,<br>the segfault came with this one:<br><br>rmaps_base_schedule_policy = core<br><br>Ompi_info (when I got it to work) told me that the parameter above<br>is now a deprecated synonym of:<br><br>rmaps_base_mapping_policy = core<br><br>In any case, the old synonym doesn't work and makes ompi_info and<br>mpiexec segfault (and I'd guess anything else that requires the OMPI runtime components).<br>Only the new parameter name works.<br></blockquote><br>That's because the segfault is happening in the printing of the deprecation warning.<br><br><blockquote type="cite"><br>***<br><br>I am also missing in the ompi_info output the following<br>(OMPI 1.6.5) parameters (not reported by ompi_info --all --all):<br><br></blockquote><br>1) orte_process_binding &nbsp;===&gt; hwloc_base_binding_policy<br><br>2) orte_report_bindings &nbsp;&nbsp;===&gt; hwloc_base_report_bindings<br><br>3) opal_paffinity_alone &nbsp;===&gt; gone, use hwloc_base_binding_policy=none if you don't want any binding<br><br><blockquote type="cite"><br>Are they gone forever?<br><br>Are there replacements for them, with approximately the same functionality?<br><br>Is there a list comparing the new (1.8) vs. old (1.6)<br>OMPI runtime parameters, and/or any additional documentation<br>about the new style of OMPI 1.8 runtime parameters?<br></blockquote><br>Will try to add this to the web site<br><br><blockquote type="cite"><br>Since there seems to have been a major revamping of the OMPI<br>runtime parameters, that would be a great help.<br><br>Thank you,<br>Gus Correa<br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/users<br>Link to this post: http://www.open-mpi.org/community/lists/users/2014/10/25497.php<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/users<br>Link to this post: http://www.open-mpi.org/community/lists/users/2014/10/25498.php<br></blockquote><br><br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>Subscription:<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>Link to this post:<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/community/lists/users/2014/10/25501.php">http://www.open-mpi.org/community/lists/users/2014/10/25501.php</a></div></blockquote></div><br></body></html>
