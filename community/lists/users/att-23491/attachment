<div dir="ltr">I am running a CFD simulation benchmark cavity3d available within <a href="http://www.palabos.org/images/palabos_releases/palabos-v1.4r1.tgz">http://www.palabos.org/images/palabos_releases/palabos-v1.4r1.tgz</a><div>
<br></div><div>It is a parallel friendly Lattice Botlzmann solver library.</div><div><br></div><div>Palabos provides benchmark results for the cavity3d on several different platforms and variables here: <a href="http://wiki.palabos.org/plb_wiki:benchmark:cavity_n400">http://wiki.palabos.org/plb_wiki:benchmark:cavity_n400</a></div>
<div><br></div><div>The problem that I have is that the benchmark performance on my cluster does not scale even close to a linear scale.</div><div><br></div><div>My cluster configuration:</div><div><br></div><div>Node1: Dual Xeon 5560 48 Gb RAM</div>
<div>Node2: i5-2400 24 Gb RAM</div><div><br></div><div>Gigabit ethernet connection on eth0</div><div><br></div><div>OpenMPI 1.6.5 on Ubuntu 12.04.3</div><div><br></div><div><br></div><div>Hostfile:</div><div><br></div><div>
Node1 -slots=4 -max-slots=4</div><div>Node2 -slots=4 -max-slots=4</div><div><br></div><div>MPI command: mpirun --mca btl_tcp_if_include eth0 --hostfile /home/mpiuser/.mpi_hostfile -np 8 ./cavity3d 400</div><div><br></div>
<div>Problem:</div><div><br></div><div>cavity3d 400</div><div><br></div><div>When I run mpirun -np 4 on Node1 I get 35.7615 Mega site updates per second</div><div>When I run mpirun -np 4 on Node2 I get 30.7972 Mega site updates per second</div>
<div>When I run mpirun --mca btl_tcp_if_include eth0 --hostfile /home/mpiuser/.mpi_hostfile -np 8 ./cavity3d 400 I get  47.3538 Mega site updates per second</div><div><br></div><div>I understand that there are latencies with GbE and that there is MPI overhead, but this performance scaling still seems very poor. Are my expectations of scaling naive, or is there actually something wrong and fixable that will improve the scaling? Optimistically I would like each node to add to the cluster performance, not slow it down. </div>
<div><br></div><div>Things get even worse if I run asymmetric number of mpi jobs in each node. For instance running -np 12 on Node1 is significantly faster than running -np 16 across Node1 and Node2, thus adding Node2 actually slows down the performance.</div>
<div><br></div><div>Thanks,</div><div><br></div><div>Victor</div><div><br></div><div><br></div></div>

