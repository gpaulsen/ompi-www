<html><head><meta http-equiv="Content-Type" content="text/html charset=us-ascii"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">Yeah, we don't support multi-threaded operations very well at this time. I think you'd have better success with the 1.7 series as it is released, but very much doubt the 1.6 series could do this as you describe.<div><br></div><div>One way to solve the immediate problem would be to funnel all MPI operations into a single thread - you can have that thread subsequently parcel out any messages for handling. You'd have better success with it.</div><div><br></div><div><br><div><div>On Oct 3, 2012, at 10:36 PM, Valentin Clement &lt;<a href="mailto:valentin.clement@riken.jp">valentin.clement@riken.jp</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><meta http-equiv="Content-Type" content="text/html charset=us-ascii"><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">Hi everyone,&nbsp;<div><br></div><div>I'm currently implementing communication based on MPI in our parallel language middle-ware POP-C++. It was using TCP/IP socket before but due to a project to port the language on a supercomputer, I have to use OpenMPI for the communication. I successfully change the old communication by MPI communication. Anyway I having the following error sometimes during the execution of my program.&nbsp;</div><div><br></div><div><div>MPI-COMBOX(client): Want to get a connection to 3461939200.0;<a href="tcp://172.19.76.219:52876;tcp://172.19.7.128:52876;tcp://172.16.162.1:52876;tcp://192.168.59.1:52876+3461939202.0;tcp://172.19.76.219:52879;tcp://172.19.7.128:52879;tcp://172.16.162.1:52879;tcp://192.168.59.1:52879:300">tcp://172.19.76.219:52876;tcp://172.19.7.128:52876;tcp://172.16.162.1:52876;tcp://192.168.59.1:52876+3461939202.0;tcp://172.19.76.219:52879;tcp://172.19.7.128:52879;tcp://172.16.162.1:52879;tcp://192.168.59.1:52879:300</a></div><div>[clementon:58465] [[52825,3],0] ORTE_ERROR_LOG: Data unpack would read past end of buffer in file dpm_orte.c at line 315</div><div>[clementon:58465] *** An error occurred in MPI_Comm_accept</div><div>[clementon:58465] *** on communicator MPI_COMM_WORLD</div><div>[clementon:58465] *** MPI_ERR_UNKNOWN: unknown error</div><div>[clementon:58465] *** MPI_ERRORS_ARE_FATAL: your MPI job will now abort</div></div><div><br></div><div><div><span style="font-family: LMSans10; font-size: 11pt; ">Sometimes I have to MPI_Comm_connect that failed :</span></div><div><span style="font-family: LMSans10; font-size: 11pt; "><br></span></div><div><span style="font-family: LMSans10; font-size: 11pt; "><div>MPI-COMBOX(client): Want to get a connection to 1318912000.0;<a href="tcp://192.168.59.176:33956+1318912002.0;tcp://192.168.59.176:54394:300">tcp://192.168.59.176:33956+1318912002.0;tcp://192.168.59.176:54394:300</a></div><div>[ubuntu:19666] [[20125,3],0] ORTE_ERROR_LOG: Data unpack would read past end of buffer in file dpm_orte.c at line 315</div><div>[ubuntu:19666] *** An error occurred in MPI_Comm_accept</div><div>[ubuntu:19666] *** on communicator MPI_COMM_WORLD</div><div>[ubuntu:19666] *** MPI_ERR_UNKNOWN: unknown error</div><div>[ubuntu:19666] *** MPI_ERRORS_ARE_FATAL: your MPI job will now abort</div></span></div></div><div><br></div><div>So basically, I have a process waiting for connection with MPI_Comm_accept (Comm.Accept as I used C++). And another process want to connect to it with the MPI_Comm_connect (MPI::COMM_WORLD.Connect(port_name) ... ). It works fine most of the time. I'm suspecting a problem with multiple threads. The process who receives connection as a second thread to serve request.&nbsp;</div><div><br></div><div>* The process 1 connects to the process 2&nbsp;</div><div>* process 2 thread 1 register the request</div><div>* process 2 thread 1 will wait for a new connection</div><div>* process 2 thread 2 will server the pending request and might send data</div><div>* A another process might start again a connection to the process 2</div><div><br></div><div>I'm running this code on an Ubuntu 12.04 with OpenMPI 1.6.2 configured with --<span style="font-family: LMSans10; font-size: 11pt; ">enable-mpi-thread-multiple. I joined ompi_info -all output.&nbsp;</span></div><div><span style="font-family: LMSans10; font-size: 11pt; ">I'm running also the same code on a Mac OS X 10.8.2 with OpenMPI 1.6.2 also configured with --enable-mpi-thread-multiple.&nbsp;</span></div><div><span style="font-family: LMSans10; font-size: 11pt; "><br></span></div><div><span style="font-family: LMSans10; font-size: 11pt; ">I don't run on multiple node for the moment. Just one node and already experiencing this. As I said I'm suspecting a problem with multiple thread but my configuration should allow multiple thread to use MPI calls.&nbsp;</span></div><div><span style="font-family: LMSans10; font-size: 11pt; "><br></span></div><div><br></div><div><span style="font-family: LMSans10; font-size: 11pt; "><div><br></div><div>Any help much appreciated&nbsp;</div><div><br></div><div><br></div><div><br></div><div><span style="font-size: 11pt; ">Valentin Clement</span></div><div><br></div><div>--</div><div>Valentin Clement</div><div>Student trainee</div><div>Advanced Institute for Computational Science</div><div><span style="font-size: 11pt; ">Programming environnement research team&nbsp;</span></div><div><span style="font-size: 11pt; ">RIKEN Institute</span></div><div><span style="font-size: 11pt; ">Kobe, Japan</span></div></span></div><div><span style="font-family: LMSans10; font-size: 11pt; "><br></span></div>
		
	
	
		<div class="page" title="Page 10">
			<div class="layoutArea">
				<div class="column"><br class="webkit-block-placeholder"></div></div></div></div><span>&lt;ompi-output.tar.bz2&gt;</span><meta http-equiv="Content-Type" content="text/html charset=us-ascii"><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><div class="page" title="Page 10"><div class="layoutArea"><div class="column"><p><span style="font-size: 11.000000pt; font-family: 'LMSans10'">&nbsp;<br></span></p>
				</div>
			</div>
		</div><div><br></div></div>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users</blockquote></div><br></div></body></html>
