<html><head><meta http-equiv="Content-Type" content="text/html charset=utf-8"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><br class=""><div><blockquote type="cite" class=""><div class="">On Jun 6, 2016, at 8:32 AM, Rob Nagler &lt;<a href="mailto:openmpi-wooxi@q33.us" class="">openmpi-wooxi@q33.us</a>&gt; wrote:</div><br class="Apple-interchange-newline"><div class=""><div dir="ltr" class=""><div class="gmail_extra">Thanks, John. I sometimes wonder if I'm the only one out there with this particular problem.</div></div></div></blockquote><div><br class=""></div>FWIW: I haven’t seen it before.</div><div><br class=""><blockquote type="cite" class=""><div class=""><div dir="ltr" class=""><div class="gmail_extra"><br class=""></div><div class="gmail_extra">Ralph, thanks for sticking with me. :) Using a pool of uids doesn't really work due to the way cgroups/containers works. It also would require changing the permissions of all of the user's files, which would create issues for Jupyter/Hub's access to the files, which is used for in situ monitoring.</div></div></div></blockquote><div><br class=""></div>Not sure I understand the issue, but I have no knowledge of Jupyter or why you are using it. From what I can see, it appears that your choice of tools may be complicating your solution - I’d suggest perhaps focusing on solving the problem rather than trying to force-fit your current tools, but that presumes you don’t have some particular attachment to those tools.</div><div><br class=""><blockquote type="cite" class=""><div class=""><div dir="ltr" class=""><div class="gmail_extra"><br class=""></div><div class="gmail_extra">Docker does not yet handle uid mapping at the container level (1.10 added mappings for the daemon). We have <a href="https://github.com/radiasoft/containers/blob/fc63d3c0d2ffe7e8a80ed1e2a8dc44a33c08cb46/bin/build-docker.sh#L110" class="">solved this problem</a> by adding a uid/gid switcher at container startup for our images. The trick is to change the uid/gid of the "container user" with usermod and groupmod. This only works, however, with images we provide. I'd like a solution that allows us to start arbitrary/unsafe images, relying on cgroups to their job.</div></div></div></blockquote><div><br class=""></div>That isn’t the security hole - the issue is that Docker doesn’t prevent the user from taking privileged state, which means the user can become root. Yes, it is within that container - but the network and other 3rd party services can be vulnerable. Cgroups doesn’t really solve that problem as it still thinks the user is the one you originally set for the container, and constrains resources that way - but it doesn’t do authentication protection.</div><div><br class=""><blockquote type="cite" class=""><div class=""><div dir="ltr" class=""><div class="gmail_extra"><br class=""></div><div class="gmail_extra">Gilles, the containers do lock the user down, but the problem is that the file system space has to be dynamically bound to the containers across the cluster. JuptyerHub solves this problem by understanding the concept of a user, and providing a hook to change the directory to be mounted.</div><div class="gmail_extra"><br class=""></div><div class="gmail_extra">Daniel, we've had bad experiences with ZoL. It's allocation algorithm degrades rapidly when the file system gets over 80% full. It still is not integrated into major distros, which leads to dkms nightmares on system upgrades. I don't really see Flocker as helping in this regard, because the problem is the scheduler, not the file system. We know which directory we have to mount from the cluster file system, just need to get the scheduler to allow us to mount that with the container that is running slurmd.</div><div class="gmail_extra"><br class=""></div><div class="gmail_extra">I'll play with Slurm Elastic Compute this week to see how it works.</div><div class="gmail_extra"><br class=""></div><div class="gmail_extra">Rob<br class=""></div><div class="gmail_extra"><br class=""></div></div>
_______________________________________________<br class="">users mailing list<br class=""><a href="mailto:users@open-mpi.org" class="">users@open-mpi.org</a><br class="">Subscription: https://www.open-mpi.org/mailman/listinfo.cgi/users<br class="">Link to this post: http://www.open-mpi.org/community/lists/users/2016/06/29382.php</div></blockquote></div><br class=""></body></html>
