<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta name=Generator content="Microsoft Word 15 (filtered medium)"><style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.msonormal0, li.msonormal0, div.msonormal0
	{mso-style-name:msonormal;
	mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
span.EmailStyle18
	{mso-style-type:personal-reply;
	font-family:"Calibri",sans-serif;
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri",sans-serif;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext="edit" spidmax="1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext="edit">
<o:idmap v:ext="edit" data="1" />
</o:shapelayout></xml><![endif]--></head><body lang=EN-US link=blue vlink=purple><div class=WordSection1><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>Hello Gilles,<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>Sorry my last message was a bit garbled. I edited the original and hit the send button while distracted.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>We actually use one internal port and an external port for the RoCe traffic.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>I thank you.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>--<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>Llolsten<o:p></o:p></span></p><p class=MsoNormal><a name="_MailEndCompose"><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'><o:p>&nbsp;</o:p></span></a></p><span style='mso-bookmark:_MailEndCompose'></span><p class=MsoNormal><b><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>From:</span></b><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'> users [mailto:users-bounces@open-mpi.org] <b>On Behalf Of </b>Gilles Gouaillardet<br><b>Sent:</b> Wednesday, May 11, 2016 11:03 AM<br><b>To:</b> Open MPI Users &lt;users@open-mpi.org&gt;<br><b>Subject:</b> Re: [OMPI users] mpirun command won't run unless the firewalld daemon is disabled<o:p></o:p></span></p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>I am not sure I understand your last message.<o:p></o:p></p><div><p class=MsoNormal><o:p>&nbsp;</o:p></p></div><div><p class=MsoNormal>if MPI only need the internal port, and there is no firewall protecting this port, then simply tell ompi to use it and only it<o:p></o:p></p></div><div><p class=MsoNormal>mpirun --mca oob_tco_if_include ethxx --mca btl_tcp_if_include ethxx ...<o:p></o:p></p></div><div><p class=MsoNormal><o:p>&nbsp;</o:p></p></div><div><p class=MsoNormal>otherwise, it should work, but only after some internal timeout expire (because of dropped packets by the firewall on the external port) and that can take a while<o:p></o:p></p></div><div><p class=MsoNormal><o:p>&nbsp;</o:p></p></div><div><p class=MsoNormal>Cheers,<o:p></o:p></p></div><div><p class=MsoNormal><o:p>&nbsp;</o:p></p></div><div><p class=MsoNormal>Gilles<br><br>On Wednesday, May 11, 2016, Llolsten Kaonga &lt;<a href="mailto:llk@soft-forge.com">llk@soft-forge.com</a>&gt; wrote:<o:p></o:p></p><blockquote style='border:none;border-left:solid #CCCCCC 1.0pt;padding:0in 0in 0in 6.0pt;margin-left:4.8pt;margin-right:0in'><div><div><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>Hello Gilles/Jeff,</span><o:p></o:p></p><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>&nbsp;</span><o:p></o:p></p><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>Thank you for clarifying this.</span><o:p></o:p></p><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>&nbsp;</span><o:p></o:p></p><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>We have three ports but the RoCE traffic is supposed to use one of the internal ports. However, we do allow use of one of the external ports which we assign a static address.</span><o:p></o:p></p><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>&nbsp;</span><o:p></o:p></p><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>I thank you.</span><o:p></o:p></p><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>--</span><o:p></o:p></p><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>Llolsten</span><o:p></o:p></p><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><a name="m_8185540578218992967__MailEndCompose"><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>&nbsp;</span></a><o:p></o:p></p><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><b><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>From:</span></b><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'> users [mailto:<a href="javascript:_e(%7B%7D,'cvml','users-bounces@open-mpi.org');" target="_blank">users-bounces@open-mpi.org</a>] <b>On Behalf Of </b>Gilles Gouaillardet<br><b>Sent:</b> Tuesday, May 10, 2016 5:06 PM<br><b>To:</b> Open MPI Users &lt;<a href="javascript:_e(%7B%7D,'cvml','users@open-mpi.org');" target="_blank">users@open-mpi.org</a>&gt;<br><b>Subject:</b> Re: [OMPI users] mpirun command won't run unless the firewalld daemon is disabled</span><o:p></o:p></p><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>&nbsp;<o:p></o:p></p><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>I was basically suggesting you open a few ports to anyone (e.g. any IP address), and Jeff suggests you open all ports to a few trusted IP addresses.<o:p></o:p></p><div><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>&nbsp;<o:p></o:p></p></div><div><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>btw, how many network ports do you have ?<o:p></o:p></p></div><div><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>if you have two ports (e.g. eth0 for external access and eth1 for private network) and MPI should only use the internal network, then you can allow all traffic on the internal port, and<o:p></o:p></p></div><div><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>mpirun --mca oob_tcp_if_include eth1 --mca btl_tcp_if_include eth1 ...<o:p></o:p></p></div><div><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>&nbsp;<o:p></o:p></p></div><div><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>Cheers,<o:p></o:p></p></div><div><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>&nbsp;<o:p></o:p></p></div><div><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>Gilles<br><br>On Wednesday, May 11, 2016, Llolsten Kaonga &lt;<a href="javascript:_e(%7B%7D,'cvml','llk@soft-forge.com');" target="_blank">llk@soft-forge.com</a>&gt; wrote:<o:p></o:p></p><blockquote style='border:none;border-left:solid #CCCCCC 1.0pt;padding:0in 0in 0in 6.0pt;margin-left:4.8pt;margin-top:5.0pt;margin-right:0in;margin-bottom:5.0pt'><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>Hello Jeff,<br><br>I think what you suggest is likely exactly what we want to see happen. We<br>run the interop tests with at least two servers, sometimes more. We also<br>have other devices (InfiniBand or RoCE switches) between the servers.<br><br>I will have to ask a stupid question here but when you suggest that we open<br>the firewall to trust random TCP connections, how is that different from<br>disabling it? Is there some configuration besides the suggestion by Gilles<br>to specify ports or a range of ports?<br><br>I thank you.<br>--<br>Llolsten<br><br>-----Original Message-----<br>From: users [<a href="mailto:users-bounces@open-mpi.org">mailto:users-bounces@open-mpi.org</a>] On Behalf Of Jeff Squyres<br>(jsquyres)<br>Sent: Tuesday, May 10, 2016 3:47 PM<br>To: Open MPI User's List &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>Subject: Re: [OMPI users] mpirun command won't run unless the firewalld<br>daemon is disabled<br><br>Open MPI generally needs to be able to communicate on random TCP ports<br>between machines in the MPI job (and the machine where mpirun is invoked, if<br>that is a different machine).<br><br>You could also open your firewall to trust random TCP connections just<br>between the servers in your cluster.<br><br><br><br>&gt; On May 10, 2016, at 3:44 PM, Llolsten Kaonga &lt;<a href="mailto:llk@soft-forge.com">llk@soft-forge.com</a>&gt; wrote:<br>&gt;<br>&gt; Hello Orion,<br>&gt;<br>&gt; I actually rather like the new CentOS 7.2 system better and would like<br>&gt; to not remove firewalld. We will try Gilles' suggestion and see what<br>happens.<br>&gt;<br>&gt; I thank you.<br>&gt; --<br>&gt; Llolsten<br>&gt;<br>&gt; -----Original Message-----<br>&gt; From: users [<a href="mailto:users-bounces@open-mpi.org">mailto:users-bounces@open-mpi.org</a>] On Behalf Of Orion<br>&gt; Poplawski<br>&gt; Sent: Tuesday, May 10, 2016 3:31 PM<br>&gt; To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>&gt; Subject: Re: [OMPI users] mpirun command won't run unless the<br>&gt; firewalld daemon is disabled<br>&gt;<br>&gt; On 05/10/2016 09:24 AM, Llolsten Kaonga wrote:<br>&gt;&gt; Hello Durga,<br>&gt;&gt;<br>&gt;&gt; As I mentioned earlier, up to version 1.8.2, we would just disable<br>&gt;&gt; SELinux and the IPv4 firewall and things run smoothly. It was only<br>&gt;&gt; when we installed version 1.10.2 (CentOS 7.2) that we run into these<br>&gt;&gt; troubles. CentOS 7.2 no longer seems to bother with the IPv4<br>&gt;&gt; firewall, so<br>&gt; you can't do:<br>&gt;&gt;<br>&gt;&gt;<br>&gt;&gt;<br>&gt;&gt; # service iptables save<br>&gt;&gt;<br>&gt;&gt; # service iptables stop<br>&gt;&gt;<br>&gt;&gt; # chkconfig iptables off<br>&gt;<br>&gt; I'll just note that you can either embrace the new firewalld config<br>&gt; (and use firewall-cmd to open your needed ports) or you can remove<br>&gt; firewalld and install iptables-services and go back to the old<br>&gt; iptables method of configuring the firewall.&nbsp; If you don't want a<br>&gt; firewall at all, just remove firewalld.<br>&gt;<br>&gt; --<br>&gt; Orion Poplawski<br>&gt; Technical Manager&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;303-415-9701 x222<br>&gt; NWRA, Boulder/CoRA Office&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FAX: 303-415-9702<br>&gt; 3380 Mitchell Lane&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="mailto:orion@nwra.com">orion@nwra.com</a><br>&gt; Boulder, CO 80301&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://www.nwra.com" target="_blank">http://www.nwra.com</a><br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt; Subscription: <a href="https://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">https://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>&gt; Link to this post:<br>&gt; <a href="http://www.open-mpi.org/community/lists/users/2016/05/29160.php" target="_blank">http://www.open-mpi.org/community/lists/users/2016/05/29160.php</a><br>&gt;<br>&gt;<br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt; Subscription: <a href="https://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">https://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>&gt; Link to this post:<br>&gt; <a href="http://www.open-mpi.org/community/lists/users/2016/05/29161.php" target="_blank">http://www.open-mpi.org/community/lists/users/2016/05/29161.php</a><br><br><br>--<br>Jeff Squyres<br><a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a><br>For corporate legal information go to:<br><a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>Subscription: <a href="https://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">https://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>Link to this post:<br><a href="http://www.open-mpi.org/community/lists/users/2016/05/29162.php" target="_blank">http://www.open-mpi.org/community/lists/users/2016/05/29162.php</a><br><br><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>Subscription: <a href="https://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">https://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>Link to this post: <a href="http://www.open-mpi.org/community/lists/users/2016/05/29163.php" target="_blank">http://www.open-mpi.org/community/lists/users/2016/05/29163.php</a><o:p></o:p></p></blockquote></div></div></div></blockquote></div></div></body></html>
