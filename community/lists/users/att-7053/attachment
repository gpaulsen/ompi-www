<html><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">
Brian,<div><br></div><div>In your code branch for the parallel run you could set an environment or internal variable when you call mpi_init. Can you parse the command line (arg 0) and figure out if you are running parallel or serial.</div><div><br></div><div>Doug Reeder<br><div><div>On Oct 20, 2008, at 3:40 PM, Adams, Brian M wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"> <font face="Arial, sans-serif" size="2"> <div>I work on an application (DAKOTA) that has opted for single binaries with source code to detect serial vs. MPI execution at run-time.  While I realize there are many other ways to handle this (wrapper scripts, command-line switches, different binaries for serial vs. MPI, etc.), I'm looking for a reliable way to detect (in source) whether a binary has been launched in serial or with orterun.</div> <div> </div> <div>We typically do this via detecting environment variables, so the easiest path for me would be to know an environment variable present when an application is invoked with orterun that is not typically present outside that MPI runtime environment.  Some candidates that came up in my particular environment include the following, but I don't know if any is a safe bet:</div> <div> </div> <div><font face="Courier New">OMPI_MCA_gpr_replica_uri</font></div> <div><font face="Courier New">OMPI_MCA_mpi_paffinity_processor</font></div> <div><font face="Courier New">OMPI_MCA_mpi_yield_when_idle</font></div> <div><font face="Courier New">OMPI_MCA_ns_nds</font></div> <div><font face="Courier New">OMPI_MCA_ns_nds_cellid</font></div> <div><font face="Courier New">OMPI_MCA_ns_nds_jobid</font></div> <div><font face="Courier New">OMPI_MCA_ns_nds_num_procs</font></div> <div><font face="Courier New">OMPI_MCA_ns_nds_vpid</font></div> <div><font face="Courier New">OMPI_MCA_ns_nds_vpid_start</font></div> <div><font face="Courier New">OMPI_MCA_ns_replica_uri</font></div> <div><font face="Courier New">OMPI_MCA_orte_app_num</font></div> <div><font face="Courier New">OMPI_MCA_orte_base_nodename</font></div> <div><font face="Courier New">OMPI_MCA_orte_precondition_transports</font></div> <div><font face="Courier New">OMPI_MCA_pls</font></div> <div><font face="Courier New">OMPI_MCA_ras</font></div> <div><font face="Courier New">OMPI_MCA_rds</font></div> <div><font face="Courier New">OMPI_MCA_rmaps</font></div> <div><font face="Courier New">OMPI_MCA_rmgr</font></div> <div><font face="Courier New">OMPI_MCA_universe</font></div> <div><font face="Courier New"> </font></div> <div>I'd also welcome suggestions for other in-source tests that might reliably detect run via orterun.  Thanks!</div> <div> </div> <div>Brian</div> <div>----------</div> <div>Brian M. Adams, PhD (<a href="mailto:briadam@sandia.gov">briadam@sandia.gov</a>)</div> <div>Optimization and Uncertainty Estimation</div> <div>Sandia National Laboratories, Albuquerque, NM</div> <div><a href="http://www.sandia.gov/~briadam"><font color="#0000FF"><u>http://www.sandia.gov/~briadam</u></font></a></div> <div> </div> <div> </div> </font><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">_______________________________________________</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">users mailing list</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><a href="mailto:users@open-mpi.org">users@open-mpi.org</a></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></div> </blockquote></div><br></div></body></html>
