<html>
<head>
<style><!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Tahoma
}
--></style>
</head>
<body class='hmmessage'>
<font class="Apple-style-span" face="Tahoma" size="4"><span class="Apple-style-span" style="font-size: 10pt;">thanks</span></font><div style="font-family: Tahoma; font-size: 10pt; "><br></div><div style="font-family: Tahoma; font-size: 10pt; ">I have to use #PBS to submit any jobs in my cluster.&nbsp;</div><div style="font-family: Tahoma; font-size: 10pt; ">I cannot use command line to hang a job on my cluster.&nbsp;</div><div style="font-family: Tahoma; font-size: 10pt; "><br></div><div style="font-family: Tahoma; font-size: 10pt; ">this is my script:&nbsp;</div><div style="font-family: Tahoma; font-size: 10pt; ">--------------------------------------</div><div><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px;">#!/bin/bash</span></font></div><div><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px;">#PBS -N jobname</span></font></div><div><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px;">#PBS -l walltime=00:08:00,nodes=1</span></font></div><div><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px;">#PBS -q queuename</span></font></div><div><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px;">COMMAND=/mypath/myprog</span></font></div><div><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px;">NCORES=5</span></font></div><div><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px;"><br></span></font></div><div><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px; ">cd $PBS_O_WORKDIR</span></font></div><div><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px;">NODES=`cat $PBS_NODEFILE | wc -l`</span></font></div><div><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px;">NPROC=$(( $NCORES * $NODES ))</span></font></div><div><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px;"><br></span></font></div><div><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px;">mpirun -np $NPROC --mca btl self,sm,openib &nbsp;$COMMAND</span></font></div><div style="font-family: Tahoma; font-size: 10pt; "><br></div><div style="font-family: Tahoma; font-size: 10pt; ">-------------------------------------------<br><br></div><div style="font-family: Tahoma; font-size: 10pt; ">Where should I put the&nbsp;<span style="text-indent: 0px !important; color: rgb(42, 42, 42); font-family: Tahoma, Verdana, Arial, sans-serif; line-height: 17px; ">(gdb --batch -ex 'bt full' -ex 'info reg' -pid ZOMBIE_PID) in the script ?&nbsp;</span></div><div style="font-family: Tahoma; font-size: 10pt; "><span style="text-indent: 0px !important; color: rgb(42, 42, 42); font-family: Tahoma, Verdana, Arial, sans-serif; line-height: 17px; ">And how to get&nbsp;</span><span class="Apple-style-span" style="font-family: Tahoma, Verdana, Arial, sans-serif; color: rgb(42, 42, 42); line-height: 17px; ">ZOMBIE_PID</span><span class="Apple-style-span" style="color: rgb(42, 42, 42); font-family: Tahoma, Verdana, Arial, sans-serif; font-size: 13px; line-height: 17px; ">&nbsp;from the script ?&nbsp;</span></div><div style="font-family: Tahoma; font-size: 10pt; "><br></div><div><font class="Apple-style-span" face="Tahoma" size="4"><span class="Apple-style-span" style="font-size: 10pt;">Any help is&nbsp;</span></font><font class="Apple-style-span" face="Tahoma" size="3"><span class="Apple-style-span" style="font-size: 13px;">appreciated</span></font><font class="Apple-style-span" face="Tahoma" size="4"><span class="Apple-style-span" style="font-size: 10pt;">.&nbsp;</span></font></div><div style="font-family: Tahoma; font-size: 10pt; "><br></div><div style="font-family: Tahoma; font-size: 10pt; ">thanks</div><div style="font-family: Tahoma; font-size: 10pt; "><br></div><div style="font-family: Tahoma; font-size: 10pt; ">Oct. 25 2010</div><div style="font-family: Tahoma; font-size: 10pt; "><br><hr id="stopSpelling">Date: Mon, 25 Oct 2010 19:24:35 +0200<br>From: jed@59a2.org<br>To: users@open-mpi.org<br>Subject: Re: [OMPI users] Open MPI program cannot complete<br><br><div class="ecxgmail_quote">On Mon, Oct 25, 2010 at 19:07, Jack Bryan <span dir="ltr">&lt;<a href="mailto:dtustudy68@hotmail.com">dtustudy68@hotmail.com</a>&gt;</span> wrote:<br><blockquote class="ecxgmail_quote" style="border-left:1px #ccc solid;padding-left:1ex">
<div>I need to use #PBS parallel job script to submit a job on MPI cluster.&nbsp;</div></blockquote><div><br></div><div>Is it not possible to reproduce locally? &nbsp;Most clusters have a way to submit an interactive job (which would let you start this thing and then inspect individual processes). &nbsp;Ashley's Padb suggestion will certainly be better in a non-interactive environment.</div>
<div>&nbsp;</div><blockquote class="ecxgmail_quote" style="border-left:1px #ccc solid;padding-left:1ex"><div>Where should I put the&nbsp;<span style="color:rgb(42, 42, 42);font-family:Tahoma, Verdana, Arial, sans-serif;line-height:17px">(gdb --batch -ex 'bt full' -ex 'info reg' -pid ZOMBIE_PID) in the script ?&nbsp;</span></div>
</blockquote><div><br></div><div>Is control returning to your script after rank 0 has exited? &nbsp;In that case, you can just put this on the next line.</div><div>&nbsp;</div><blockquote class="ecxgmail_quote" style="border-left:1px #ccc solid;padding-left:1ex">
<div><span style="color:rgb(42, 42, 42);font-family:Tahoma, Verdana, Arial, sans-serif;line-height:17px">How to get the&nbsp;</span><span style="color:rgb(42, 42, 42);font-family:Tahoma, Verdana, Arial, sans-serif;line-height:17px">ZOMBIE_PID ?&nbsp;</span></div>
</blockquote></div><br><div>"ps" from the command line, or getpid() from C code.</div><div><br></div><div>Jed</div>
<br>_______________________________________________
users mailing list
users@open-mpi.org
http://www.open-mpi.org/mailman/listinfo.cgi/users</div> 		 	   		  </body>
</html>
