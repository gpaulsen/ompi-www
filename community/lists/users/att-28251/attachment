<div dir="ltr">Example 4.23 of MPI 3.1 (it is hardly a new example, but may have a different number in older versions) demonstrates the use of (buffer=NULL,count=0,type=MPI_DATATYPE_NULL).  While examples in the MPI standard are not normative text, this is certainly a valid use of MPI.  I can&#39;t find a citation where it says explicitly that this is correct, but it follows logically from other text.<br><br>The MPICH macro MPIR_ERRTEST_USERBUFFER that is used through the code to test for valid user buffers begins with &quot;if (count &gt; 0...&quot; and thus does concern itself with the type or buffer pointer when count=0.  Furthermore, this macro is redundantly protected with a count&gt;0 check when used in MPI_Alltoallw (and other collectives).<br><br>Best,<br><br>Jeff<br><br>On Tue, Jan 12, 2016 at 4:18 PM, Gilles Gouaillardet &lt;<a href="mailto:gilles@rist.or.jp">gilles@rist.or.jp</a>&gt; wrote:<br>&gt;<br>&gt; Hi Jim,<br>&gt;<br>&gt; can you please confirm my understanding is correct :<br>&gt;<br>&gt; - OpenMPI does *not* accept MPI_DATATYPE_NULL as an input of MPI_Alltoallw<br>&gt; - mpich does accept MPI_DATATYPE_NULL as an input of MPI_Alltoallw *if* the corresponding count *is* zero<br>&gt; - mpich does *not* accept MPI_DATATYPE_NULL as an input of MPI_Alltoallw *if* the corresponding count is *not* zero<br>&gt;<br>&gt; So you are considering as a bug the fact OpenMPI does not accept MPI_DATATYPE_NULL *with* a zero count.<br>&gt;<br>&gt; am i correct ?<br>&gt;<br>&gt; Cheers,<br>&gt;<br>&gt; Gilles<br>&gt;<br>&gt;<br>&gt; On 1/13/2016 8:27 AM, Jim Edwards wrote:<br>&gt;<br>&gt; Hi,<br>&gt;<br>&gt; I am using OpenMPI-1.8.3 built with gcc 4.8.3<br>&gt; and I am using an MPI_Alltoallw call to perform <br>&gt; an all to some (or some to all) communication.  <br>&gt;<br>&gt; In the case in which my task is not sending (or receiving) any data I set the<br>&gt; datatype for that send or recv buffer to MPI_DATATYPE_NULL - this <br>&gt; works fine with other mpi libraries but fails in openmpi.   If I set<br>&gt; the datatype to something else say MPI_CHAR - it works fine.   I think<br>&gt; that this is a bug in open-mpi - would you agree?<br>&gt;<br>&gt;<br>&gt;<br>&gt;<br>&gt; --<br>&gt; Jim Edwards<br>&gt;<br>&gt; CESM Software Engineer<br>&gt; National Center for Atmospheric Research<br>&gt; Boulder, CO<br>&gt;<br>&gt;<br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt; Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>&gt; Link to this post: <a href="http://www.open-mpi.org/community/lists/users/2016/01/28249.php">http://www.open-mpi.org/community/lists/users/2016/01/28249.php</a><br>&gt;<br>&gt;<br>&gt;<br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt; Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>&gt; Link to this post: <a href="http://www.open-mpi.org/community/lists/users/2016/01/28250.php">http://www.open-mpi.org/community/lists/users/2016/01/28250.php</a><br><br><br><br><br>--<br>Jeff Hammond<br><a href="mailto:jeff.science@gmail.com">jeff.science@gmail.com</a><br><a href="http://jeffhammond.github.io/">http://jeffhammond.github.io/</a><br><div class="gmail_extra">
</div></div>

