<html><head></head><body>Can you send the output of lstopo -p ? (you&#39;ll have to install hwloc)<br>
Brice<br><br><div class="gmail_quote"><br>
tmishima@jcity.maeda.co.jp a écrit :<blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;">
<pre style="white-space: pre-wrap; word-wrap:break-word; font-family: monospace"><br />Hi,<br /><br />I updated openmpi from version 1.5.4 to 1.5.5.<br />Then, an execution speed of my application becomes quite slower than<br />before,<br />due to wrong core bindings. As far as I checked, it seems that<br />openmpi-1.5.4<br />gives correct core bindings for my magnycore based machine.<br /><br />1) my script is as follows:<br />export OMP_NUM_THREADS=4<br />mpirun -machinefile pbs_hosts \<br />       -np 8 \<br />       -x OMP_NUM_THREADS \<br />       -bind-to-core \<br />       -cpus-per-proc ${OMP_NUM_THREADS} \<br />       -report-bindings \<br />       ./Solver<br /><br />2)binding reports are as follows:<br />openmpi-1.5.4:<br />[node03.cluster:21706] [[55518,0],0] odls:default:fork binding child<br />[[55518,1],3] to cpus 22220000<br />[node03.cluster:21706] [[55518,0],0] odls:default:fork binding child<br />[[55518,1],4] to cpus 4444<br />[node03.cluster:21706] [[55518,0],0]
odls:default:fork binding child<br />[[55518,1],5] to cpus 44440000<br />[node03.cluster:21706] [[55518,0],0] odls:default:fork binding child<br />[[55518,1],6] to cpus 8888<br />[node03.cluster:21706] [[55518,0],0] odls:default:fork binding child<br />[[55518,1],7] to cpus 88880000<br />[node03.cluster:21706] [[55518,0],0] odls:default:fork binding child<br />[[55518,1],0] to cpus 1111<br />[node03.cluster:21706] [[55518,0],0] odls:default:fork binding child<br />[[55518,1],1] to cpus 11110000<br />[node03.cluster:21706] [[55518,0],0] odls:default:fork binding child<br />[[55518,1],2] to cpus 2222<br />openmpi-1.5.5:<br />[node03.cluster:04706] [[40566,0],0] odls:default:fork binding child<br />[[40566,1],3] to cpus f000<br />[node03.cluster:04706] [[40566,0],0] odls:default:fork binding child<br />[[40566,1],4] to cpus 000f0000<br />[node03.cluster:04706] [[40566,0],0] odls:default:fork binding child<br />[[40566,1],5] to cpus 00f00000<br />[node03.cluster:04706] [[40566,0],0]
odls:default:fork binding child<br />[[40566,1],6] to cpus 0f000000<br />[node03.cluster:04706] [[40566,0],0] odls:default:fork binding child<br />[[40566,1],7] to cpus f0000000<br />[node03.cluster:04706] [[40566,0],0] odls:default:fork binding child<br />[[40566,1],0] to cpus 000f<br />[node03.cluster:04706] [[40566,0],0] odls:default:fork binding child<br />[[40566,1],1] to cpus 00f0<br />[node03.cluster:04706] [[40566,0],0] odls:default:fork binding child<br />[[40566,1],2] to cpus 0f00<br /><br />3)node03 has 32 cores with 4 magnycores(8cores/cpu-type).<br /><br />Regards,<br />Tetsuya Mishima<br /><br /><hr /><br />users mailing list<br />users@open-mpi.org<br /><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br /></pre></blockquote></div></body></html>
