<html><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">
You would be much better off to not use nohup, and then just kill the mpirun.<div><br></div><div>What I mean is a batch system (<a href="http://www.clusterresources.com/pages/products/torque-resource-manager.php">http://www.clusterresources.com/pages/products/torque-resource-manager.php</a>).  Most batch systems have a launching system that lets you kill all the remote processes when you kill the job.  </div><div><br></div><div>Look at how MPI works.  When you are starting the way you are starting MPI (without a batch system) you are using ether ssh or rsh to start the remote processes.  Once these are started, the user has no control over the remote processes. </div><div><br></div><div>Try killing your mpirun not your orted or pw.x.  You will be much happier with a batch system. </div><div>Or make a script that ssh to hostfile and kills pw.x on all of them.</div><div><div> <span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0; "><div><br class="Apple-interchange-newline">Brock Palen</div><div>www.umich.edu/~brockp</div><div>Center for Advanced Computing</div><div><a href="mailto:brockp@umich.edu">brockp@umich.edu</a></div><div>(734)936-1985</div><br class="Apple-interchange-newline"></span><br class="Apple-interchange-newline"> </div><br><div><html>On Jul 27, 2008, at 2:04 PM, vega lew wrote:</html><br class="Apple-interchange-newline"><blockquote type="cite"> Dear <span class="EC_Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px;">Brock Palen,<br><br>Thank you for your responding.<br><br>My linux is redhat enterprise 4. My compiler is </span><span class="EC_Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px;">10.1.015</span><span class="EC_Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px;"> version of intel fortran and intel c.<br><br>You said </span>'when the job is killed all the children are also'<br><br>But I started my OPENMPI job using the nohup command to put the job background like this,<br>" nohup mpirun -hostfile ~/hostfile -np 64 pw.x &lt; input > output  &amp; ".<br><br>When I killed one of the process named pw.x, all the others didn't stop.<br>When I killed the process named orted, the pw.x process in the same node stoped immediately,<br>but the job in the other node were still running.<br><br>Do you think there is something wrong with my cluster or openmpi or the software named pw.x?<br><br>Is there a command for openmpi to force all the process to stop in the cluster or a list of nodes to stop.  <br><span class="EC_Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spaci ng: normal; line-height: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px;"></span><br><font size="4"><span style="font-family: Lucida Handwriting,Cursive;">Vega Lew (weijia liu)</span></font><br>PH.D Candidate in Chemical Engineering<br>State Key Laboratory of Materials-oriented Chemical Engineering<br>College of Chemistry and Chemical Engineering<br>Nanjing University of Technology, 210009, Nanjing, Jiangsu, China<br><br><hr>From: <a href="mailto:brockp@umich.edu">brockp@umich.edu</a><br>Date: Sat, 26 Jul 2008 12:52:08 -0400<br>To: <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>Subject: Re: [OMPI users] How to cease the process triggered by OPENMPI<br><br> Does the cluster your using use a batch system?  Like SLURM, PBS or other?<div><br></div><div>If so many have native ways to launch jobs that OMPI can use.  SO that when the job is killed all the children are also.<br><div> <span class="EC_Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px;"><div><br class="EC_Apple-interchange-newline">Brock Palen</div><div>www.umich.edu/~brockp</div><div>Center for Advanced Computing</div><div><a href="mailto:brockp@umich.edu">brockp@umich.edu</a></div><div>(734)936-1985</div><br class="EC_Apple-interchange-newline"></span><br class="EC_Apple-interchange-newline"> </div><br><div>On Jul 26, 2008, at 12:25 PM, vega lew wrote:<br class="EC_Apple-interchange-newline"><blockquote> Dear all,<br><br>I have enjoyed the openmpi a couple of days. With the help of openmpi I could run ESPRESSO efficiently.<br><br>I started the mpi-job by the openmpi command like this,<br><br>" nohup mpirun -hostfile ~/hostfile -np 64 pw.x &lt; input > output &amp;".<br><br>When I want to stop the job before it finished, I find it not easy to stop all the process manually. When I killed the process<br>in one node of the cluster, the processes in other nodes were still running. So I must ssh to every node, find the <br>process id and kill the process. If there are 100 processors or more for one mpi job, the situation even worse.<br><br>Is there a command for openmpi to force all the process to stop in the cluster or a list of nodes to stop.  <br><br>vega<br><br><font size="4"><span style="font-family: Lucida Handwriting,Cursive;">Vega Lew</span></font> （weijia liu)<br>PH.D Candidate in Chemical Engineering<br> State Key Laboratory of Materials-oriented Chemical Engineering<br>College of Chemistry and Chemical Engineering<br>Nanjing University of Technology, 210009, Nanjing, Jiangsu, China<br><hr>Explore the seven wonders of the world <a href="http://search.msn.com/results.aspx?q=7+wonders+world&amp;mkt=en-US&amp;form=QBRE" target="_blank">Learn more!</a><div style="margin-right: 0px; margin-bottom: 0px; margin-left: 0px;">_______________________________________________</div><div style="margin-right: 0px; margin-bottom: 0px; margin-left: 0px;">users mailing list</div><div style="margin-right: 0px; margin-bottom: 0px; margin-left: 0px;"><a href="mailto:users@open-mpi.org">users@open-mpi.org</a></div><div style="margin-right: 0px; margin-bottom: 0px; margin-left: 0px;"><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></div> </blockquote></div><br></div><br><hr>Get news, entertainment and everything you care about at Live.com. <a href="http://www.live.com/getstarted.aspx " target="_new">Check it out!</a><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">_______________________________________________</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">users mailing list</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><a href="mailto:users@open-mpi.org">users@open-mpi.org</a></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></div> </blockquote></div><br></div></body></html>
