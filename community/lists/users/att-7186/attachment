<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=us-ascii">
<meta name=Generator content="Microsoft Word 11 (filtered medium)">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:blue;
	text-decoration:underline;}
p
	{mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman";}
tt
	{font-family:"Courier New";}
span.EmailStyle19
	{mso-style-type:personal-reply;
	font-family:Arial;
	color:navy;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:686062746;
	mso-list-template-ids:-273921048;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:72.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l0:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:108.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=blue>

<div class=Section1>

<p class=MsoNormal><font size=2 color=navy face=Arial><span style='font-size:
10.0pt;font-family:Arial;color:navy'>Helllo Jeff, Gustavo, Mi<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 color=navy face=Arial><span style='font-size:
10.0pt;font-family:Arial;color:navy'>&nbsp;&nbsp; Thank for the advice. I am
familiar with the difference in the compiler code generation for C, C++ &amp; FORTRAN.
I even tried to look at some of the common block symbols. The name of the
symbol remains the same. The only difference that I observe is in FORTRAN
compiled *.o &nbsp;</span></font><font size=2 color=red face=Arial><span
style='font-size:10.0pt;font-family:Arial;color:red'>0000000000515bc0 B
aux7loc_ </span></font><font size=2 color=navy face=Arial><span
style='font-size:10.0pt;font-family:Arial;color:navy'>&nbsp;and the C++
compiled code &nbsp;</span></font><font size=2 color=red face=Arial><span
style='font-size:10.0pt;font-family:Arial;color:red'>U aux7loc_</span></font><font
size=2 color=navy face=Arial><span style='font-size:10.0pt;font-family:Arial;
color:navy'> &nbsp;the memory is not allocated as it has been declared as
extern in C++. When the executable loads the shared library it finds all the
undefined symbols. Atleast if it did not manage to find a single symbol it
prints undefined symbol error. <o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 color=navy face=Arial><span style='font-size:
10.0pt;font-family:Arial;color:navy'>I am completely stuck up and do not know
how to continue further.<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 color=navy face=Arial><span style='font-size:
10.0pt;font-family:Arial;color:navy'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 color=navy face=Arial><span style='font-size:
10.0pt;font-family:Arial;color:navy'>Thanks,<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 color=navy face=Arial><span style='font-size:
10.0pt;font-family:Arial;color:navy'>Rajesh<o:p></o:p></span></font></p>

<div>

<p class=MsoNormal><font size=3 face="Times New Roman"><span style='font-size:
12.0pt'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><b><font size=2 face=Tahoma><span style='font-size:10.0pt;
font-family:Tahoma;font-weight:bold'>From:</span></font></b><font size=2
face=Tahoma><span style='font-size:10.0pt;font-family:Tahoma'>
users-bounces@open-mpi.org [mailto:users-bounces@open-mpi.org] <b><span
style='font-weight:bold'>On Behalf Of </span></b>Mi Yan<br>
<b><span style='font-weight:bold'>Sent:</span></b> samedi 1 novembre 2008 23:26<br>
<b><span style='font-weight:bold'>To:</span></b> Open MPI Users<br>
<b><span style='font-weight:bold'>Cc:</span></b> 'Open MPI Users';
users-bounces@open-mpi.org<br>
<b><span style='font-weight:bold'>Subject:</span></b> Re: [OMPI users] MPI +
Mixed language coding(Fortran90 + C++)</span></font><o:p></o:p></p>

</div>

<p class=MsoNormal><font size=3 face="Times New Roman"><span style='font-size:
12.0pt'><o:p>&nbsp;</o:p></span></font></p>

<p style='margin-bottom:12.0pt'><font size=3 face="Times New Roman"><span
style='font-size:12.0pt'>So your tests show:<br>
1. &quot;Shared library in FORTRAN + MPI executable in FORTRAN&quot; works.<br>
2. &quot;Shared library in C++ + MPI executable in FORTRAN &quot; does not
work.<br>
<br>
It seems to me that the symbols in C library are not really recognized by FORTRAN
executable as you thought. What compilers did yo use to built OpenMPI?<br>
<br>
Different compiler has different convention to handle symbols. E.g. if there is
a variable &quot;var_foo&quot; in your FORTRAN code, some FORTRN compiler will
save &quot;var_foo_&quot; in the object file by default; if you want to access
&quot;var_foo&quot; in C code, you actually need to refer &quot;var_foo_&quot;
in C code. If you define &quot;var_foo&quot; in a module in the FORTAN
compiler, some FORTRAN compiler may append the module name to &quot;var_foo&quot;.
<br>
So I suggest to check the symbols in the object files generated by your FORTAN
and C compiler to see the difference.<br>
<br>
Mi<br>
<img width=16 height=16 id="_x0000_i1025"
src="cid:image001.gif@01C93D99.62B0BBD0"
alt="Inactive hide details for &quot;Rajesh Ramaya&quot; &lt;rajesh.ramaya@e-xstream.com&gt;"
border=0>&quot;Rajesh Ramaya&quot; &lt;rajesh.ramaya@e-xstream.com&gt;<br>
<br>
<o:p></o:p></span></font></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%'>
 <tr>
  <td width="40%" valign=top style='width:40.0%;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal style='margin-left:144.0pt'><b><font size=2
  face="Times New Roman"><span style='font-size:10.0pt;font-weight:bold'>&quot;Rajesh
  Ramaya&quot; &lt;rajesh.ramaya@e-xstream.com&gt;</span></font></b><font
  size=2><span style='font-size:10.0pt'> </span></font><br>
  <font size=2><span style='font-size:10.0pt'>Sent by:
  users-bounces@open-mpi.org</span></font> <o:p></o:p></p>
  <p style='margin-left:144.0pt'><font size=2 face="Times New Roman"><span
  style='font-size:10.0pt'>10/31/2008 03:07 PM</span></font> <o:p></o:p></p>
  <table class=MsoNormalTable border=1 cellpadding=0 style='margin-left:144.0pt'>
   <tr>
    <td width=168 valign=top bgcolor=white style='width:126.0pt;background:
    white;padding:.75pt .75pt .75pt .75pt'>
    <p class=MsoNormal align=center style='text-align:center'><font size=2
    face="Times New Roman"><span style='font-size:10.0pt'>Please respond to<br>
    Open MPI Users &lt;users@open-mpi.org&gt;</span></font><o:p></o:p></p>
    </td>
   </tr>
  </table>
  <p class=MsoNormal><font size=3 face="Times New Roman"><span
  style='font-size:12.0pt'><o:p></o:p></span></font></p>
  </td>
  <td width="60%" valign=top style='width:60.0%;padding:0cm 0cm 0cm 0cm'>
  <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
   style='width:100.0%'>
   <tr>
    <td width="1%" valign=top style='width:1.0%;padding:0cm 0cm 0cm 0cm'>
    <p class=MsoNormal><font size=3 face="Times New Roman"><span
    style='font-size:12.0pt'><img width=58 height=1 id="_x0000_i1026"
    src="cid:image002.gif@01C93D99.CFE5BC00" border=0><o:p></o:p></span></font></p>
    <p class=MsoNormal align=right style='text-align:right'><font size=2
    face="Times New Roman"><span style='font-size:10.0pt'>To</span></font><o:p></o:p></p>
    </td>
    <td width="100%" valign=top style='width:100.0%;padding:0cm 0cm 0cm 0cm'>
    <p class=MsoNormal><font size=3 face="Times New Roman"><span
    style='font-size:12.0pt'><img width=1 height=1 id="_x0000_i1027"
    src="cid:image003.gif@01C93D99.CFE5BC00" border=0><br>
    </span></font><font size=2><span style='font-size:10.0pt'>&quot;'Open MPI
    Users'&quot; &lt;users@open-mpi.org&gt;, &quot;'Jeff Squyres'&quot;
    &lt;jsquyres@cisco.com&gt;</span></font><o:p></o:p></p>
    </td>
   </tr>
   <tr>
    <td width="1%" valign=top style='width:1.0%;padding:0cm 0cm 0cm 0cm'>
    <p class=MsoNormal><font size=3 face="Times New Roman"><span
    style='font-size:12.0pt'><img width=58 height=1 id="_x0000_i1028"
    src="cid:image002.gif@01C93D99.CFE5BC00" border=0><o:p></o:p></span></font></p>
    <p class=MsoNormal align=right style='text-align:right'><font size=2
    face="Times New Roman"><span style='font-size:10.0pt'>cc</span></font><o:p></o:p></p>
    </td>
    <td width="100%" valign=top style='width:100.0%;padding:0cm 0cm 0cm 0cm'>
    <p class=MsoNormal><font size=3 face="Times New Roman"><span
    style='font-size:12.0pt'><img width=1 height=1 id="_x0000_i1029"
    src="cid:image003.gif@01C93D99.CFE5BC00" border=0><o:p></o:p></span></font></p>
    </td>
   </tr>
   <tr>
    <td width="1%" valign=top style='width:1.0%;padding:0cm 0cm 0cm 0cm'>
    <p class=MsoNormal><font size=3 face="Times New Roman"><span
    style='font-size:12.0pt'><img width=58 height=1 id="_x0000_i1030"
    src="cid:image002.gif@01C93D99.CFE5BC00" border=0><o:p></o:p></span></font></p>
    <p class=MsoNormal align=right style='text-align:right'><font size=2
    face="Times New Roman"><span style='font-size:10.0pt'>Subject</span></font><o:p></o:p></p>
    </td>
    <td width="100%" valign=top style='width:100.0%;padding:0cm 0cm 0cm 0cm'>
    <p class=MsoNormal><font size=3 face="Times New Roman"><span
    style='font-size:12.0pt'><img width=1 height=1 id="_x0000_i1031"
    src="cid:image003.gif@01C93D99.CFE5BC00" border=0><br>
    </span></font><font size=2><span style='font-size:10.0pt'>Re: [OMPI users]
    MPI + Mixed language coding(Fortran90 + C++)</span></font><o:p></o:p></p>
    </td>
   </tr>
  </table>
  <p class=MsoNormal><font size=3 face="Times New Roman"><span
  style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></font></p>
  <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0>
   <tr>
    <td width=58 valign=top style='width:43.5pt;padding:0cm 0cm 0cm 0cm'>
    <p class=MsoNormal><font size=3 face="Times New Roman"><span
    style='font-size:12.0pt'><img width=1 height=1 id="_x0000_i1032"
    src="cid:image003.gif@01C93D99.CFE5BC00" border=0><o:p></o:p></span></font></p>
    </td>
    <td width=336 valign=top style='width:252.0pt;padding:0cm 0cm 0cm 0cm'>
    <p class=MsoNormal><font size=3 face="Times New Roman"><span
    style='font-size:12.0pt'><img width=1 height=1 id="_x0000_i1033"
    src="cid:image003.gif@01C93D99.CFE5BC00" border=0><o:p></o:p></span></font></p>
    </td>
   </tr>
  </table>
  <p class=MsoNormal><font size=3 face="Times New Roman"><span
  style='font-size:12.0pt'><o:p></o:p></span></font></p>
  </td>
 </tr>
</table>

<p style='margin-bottom:12.0pt'><font size=3 face="Times New Roman"><span
style='font-size:12.0pt'><br>
</span></font><tt><font size=2 face="Courier New"><span style='font-size:10.0pt'>Hello
Jeff Squyres,</span></font></tt><font size=2 face="Courier New"><span
style='font-size:10.0pt;font-family:"Courier New"'><br>
<tt><font face="Courier New">&nbsp; Thank you very much for the immediate
reply. I am able to successfully</font></tt><br>
<tt><font face="Courier New">access the data from the common block but the
values are zero. In my</font></tt><br>
<tt><font face="Courier New">algorithm I even update a common block but the
update made by the shared</font></tt><br>
<tt><font face="Courier New">library is not taken in to account by the executable.
Can you please be very</font></tt><br>
<tt><font face="Courier New">specific how to make the parallel algorithm aware
of the data? Actually I am</font></tt><br>
<tt><font face="Courier New">not writing any MPI code inside? It's the
executable (third party software)</font></tt><br>
<tt><font face="Courier New">who does that part. All that I am doing is to
compile my code with MPI c</font></tt><br>
<tt><font face="Courier New">compiler and add it in the LD_LIBIRARY_PATH. </font></tt><br>
<tt><font face="Courier New">In fact I did a simple test by creating a shared
library using a FORTRAN</font></tt><br>
<tt><font face="Courier New">code and the update made to the common block is
taken in to account by the</font></tt><br>
<tt><font face="Courier New">executable. Is there any flag or pragma that need
to be activated for mixed</font></tt><br>
<tt><font face="Courier New">language MPI?</font></tt><br>
<tt><font face="Courier New">Thank you once again for the reply.</font></tt><br>
<br>
<tt><font face="Courier New">Rajesh &nbsp; </font></tt><br>
<br>
<tt><font face="Courier New">-----Original Message-----</font></tt><br>
<tt><font face="Courier New">From: users-bounces@open-mpi.org [<a
href="mailto:users-bounces@open-mpi.org">mailto:users-bounces@open-mpi.org</a>]
On</font></tt><br>
<tt><font face="Courier New">Behalf Of Jeff Squyres</font></tt><br>
<tt><font face="Courier New">Sent: vendredi 31 octobre 2008 18:53</font></tt><br>
<tt><font face="Courier New">To: Open MPI Users</font></tt><br>
<tt><font face="Courier New">Subject: Re: [OMPI users] MPI + Mixed language
coding(Fortran90 + C++)</font></tt><br>
<br>
<tt><font face="Courier New">On Oct 31, 2008, at 11:57 AM, Rajesh Ramaya wrote:</font></tt><br>
<br>
<tt><font face="Courier New">&gt; &nbsp; &nbsp; I am completely new to MPI. I
have a basic question concerning &nbsp;</font></tt><br>
<tt><font face="Courier New">&gt; MPI and mixed language coding. I hope any of
you could help me out. &nbsp;</font></tt><br>
<tt><font face="Courier New">&gt; Is it possible to access FORTRAN common
blocks in C++ in a MPI &nbsp;</font></tt><br>
<tt><font face="Courier New">&gt; compiled code. It works without MPI but as
soon I switch to MPI the &nbsp;</font></tt><br>
<tt><font face="Courier New">&gt; access of common block does not work anymore.</font></tt><br>
<tt><font face="Courier New">&gt; I have a Linux MPI executable which loads a
shared library at &nbsp;</font></tt><br>
<tt><font face="Courier New">&gt; runtime and resolves all undefined symbols
etc &nbsp;The shared library &nbsp;</font></tt><br>
<tt><font face="Courier New">&gt; is written in C++ and the MPI executable in
written in FORTRAN. Some &nbsp;</font></tt><br>
<tt><font face="Courier New">&gt; of the input that the shared library looking
for are in the Fortran &nbsp;</font></tt><br>
<tt><font face="Courier New">&gt; common blocks. As I access those common
blocks during runtime the &nbsp;</font></tt><br>
<tt><font face="Courier New">&gt; values are not &nbsp;initialized. &nbsp;I
would like to know if what I am &nbsp;</font></tt><br>
<tt><font face="Courier New">&gt; doing is possible ?I hope that my problem is
clear......</font></tt><br>
<br>
<br>
<tt><font face="Courier New">Generally, MPI should not get in the way of
sharing common blocks &nbsp;</font></tt><br>
<tt><font face="Courier New">between Fortran and C/C++. &nbsp;Indeed, in Open
MPI itself, we share a few &nbsp;</font></tt><br>
<tt><font face="Courier New">common blocks between Fortran and the main C Open
MPI implementation.</font></tt><br>
<br>
<tt><font face="Courier New">What is the exact symptom that you are seeing?
&nbsp;Is the application &nbsp;</font></tt><br>
<tt><font face="Courier New">failing to resolve symbols at run-time, possibly
indicating that &nbsp;</font></tt><br>
<tt><font face="Courier New">something hasn't instantiated a common block?
&nbsp;Or are you able to &nbsp;</font></tt><br>
<tt><font face="Courier New">successfully access the data from the common
block, but it doesn't &nbsp;</font></tt><br>
<tt><font face="Courier New">have the values you expect (e.g., perhaps you're
seeing all zeros)?</font></tt><br>
<br>
<tt><font face="Courier New">If the former, you might want to check your build
procedure. &nbsp;You &nbsp;</font></tt><br>
<tt><font face="Courier New">*should* be able to simply replace your C++ / F90
compilers with &nbsp;</font></tt><br>
<tt><font face="Courier New">mpicxx and mpif90, respectively, and be able to
build an MPI version &nbsp;</font></tt><br>
<tt><font face="Courier New">of your app. &nbsp;If the latter, you might need
to make your parallel &nbsp;</font></tt><br>
<tt><font face="Courier New">algorithm aware of what data is available in which
MPI process -- &nbsp;</font></tt><br>
<tt><font face="Courier New">perhaps not all the data is filled in on each MPI
process...?</font></tt><br>
<br>
<tt><font face="Courier New">-- </font></tt><br>
<tt><font face="Courier New">Jeff Squyres</font></tt><br>
<tt><font face="Courier New">Cisco Systems</font></tt><br>
<br>
<br>
<tt><font face="Courier New">_______________________________________________</font></tt><br>
<tt><font face="Courier New">users mailing list</font></tt><br>
<tt><font face="Courier New">users@open-mpi.org</font></tt><br>
<tt><font face="Courier New"><a
href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></font></tt><br>
<br>
<tt><font face="Courier New">_______________________________________________</font></tt><br>
<tt><font face="Courier New">users mailing list</font></tt><br>
<tt><font face="Courier New">users@open-mpi.org</font></tt><br>
<tt><font face="Courier New"><a
href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></font></tt></span></font><o:p></o:p></p>

</div>

</body>

</html>

