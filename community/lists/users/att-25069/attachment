<html><head><meta http-equiv="Content-Type" content="text/html charset=us-ascii"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div>Here is what "modinfo mlx4_core" gives</div><div><br></div><div>filename:&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;/lib/modules/3.13.0-34-generic/kernel/drivers/net/ethernet/mellanox/mlx4/mlx4_core.ko<br>version:&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;2.2-1<br>license:&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Dual BSD/GPL<br>description:&nbsp; &nbsp;&nbsp;Mellanox ConnectX HCA low-level driver<br>author:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Roland Dreier<br>srcversion:&nbsp;&nbsp; &nbsp;&nbsp;3AE29A0A6538EBBE9227361<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00001010sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d0000100Fsv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d0000100Esv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d0000100Dsv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d0000100Csv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d0000100Bsv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d0000100Asv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00001009sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00001008sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00001007sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00001006sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00001005sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00001004sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00001003sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00001002sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d0000676Esv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00006746sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00006764sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d0000675Asv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00006372sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00006750sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00006368sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d0000673Csv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00006732sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00006354sv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d0000634Asv*sd*bc*sc*i*<br>alias:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pci:v000015B3d00006340sv*sd*bc*sc*i*<br>depends:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;<br>intree:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Y<br>vermagic:&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;3.13.0-34-generic SMP mod_unload modversions&nbsp;<br>signer:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Magrathea: Glacier signing key<br>sig_key:&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;50:0B:C5:C8:7D:4B:11:5C:F3:C1:50:4F:7A:92:E2:33:C6:14:3D:58<br>sig_hashalgo:&nbsp;&nbsp;&nbsp;sha512<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;debug_level:Enable debug tracing if &gt; 0 (int)<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;msi_x:attempt to use MSI-X if nonzero (int)<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;num_vfs:enable #num_vfs functions if num_vfs &gt; 0<br>num_vfs=port1,port2,port1+2 (array of byte)<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;probe_vf:number of vfs to probe by pf driver (num_vfs &gt; 0)<br>probe_vf=port1,port2,port1+2 (array of byte)<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;log_num_mgm_entry_size:log mgm size, that defines the num of qp per mcg, for example: 10 gives 248.range: 7&nbsp;&lt;= log_num_mgm_entry_size &lt;= 12. To activate device managed flow steering when available, set to -1 (int)<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;enable_64b_cqe_eqe:Enable 64 byte CQEs/EQEs when the FW supports this (default: True) (bool)<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;log_num_mac:Log2 max number of MACs per ETH port (1-7) (int)<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;log_num_vlan:Log2 max number of VLANs per ETH port (0-7) (int)<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;use_prio:Enable steering by VLAN priority on ETH ports (0/1, default 0) (bool)<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;log_mtts_per_seg:Log2 number of MTT entries per segment (1-7) (int)<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;port_type_array:Array of port types: HW_DEFAULT (0) is default 1 for IB, 2 for Ethernet (array of int)<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;enable_qos:Enable Quality of Service support in the HCA (default: off) (bool)<br>parm:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;internal_err_reset:Reset device on internal errors if non-zero (default 1, in SRIOV mode default is 0) (int)</div><div><br class="Apple-interchange-newline"><blockquote type="cite"><div dir="ltr">most likely you installing old ofed which does not have this parameter:<div><br></div><div>try:</div><div><br></div><div>#modinfo mlx4_core</div><div><br></div><div>and see if it is there.</div><div>I would suggest install latest OFED or Mellanox OFED.</div>
</div><div class="gmail_extra"><br><br><div class="gmail_quote">On Mon, Aug 18, 2014 at 9:53 PM, Rio Yokota <span dir="ltr">&lt;<a href="mailto:rioyokota@mac.com" target="_blank">rioyokota@mac.com</a>&gt;</span> wrote:<br>
<blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div style="word-wrap:break-word"><div>I get "ofed_info: command not found". Note that I don't install the entire OFED, but do a component wise installation by doing "apt-get install infiniband-diags ibutils ibverbs-utils libmlx4-dev" for the drivers and utilities.</div>
<div><br><blockquote type="cite"><div><div class="h5"><div dir="ltr">Hi,<div>what ofed version do you use?</div><div>(ofed_info -s)</div></div><div class="gmail_extra"><br><br><div class="gmail_quote">On Sun, Aug 17, 2014 at 7:16 PM, Rio Yokota <span dir="ltr">&lt;<a href="mailto:rioyokota@mac.com" target="_blank">rioyokota@mac.com</a>&gt;</span> wrote:<br>

<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">I have recently upgraded from Ubuntu 12.04 to 14.04 and OpenMPI gives the following warning upon execution, which did not appear before the upgrade.<br>


<br>
WARNING: It appears that your OpenFabrics subsystem is configured to only<br>
allow registering part of your physical memory. This can cause MPI jobs to<br>
run with erratic performance, hang, and/or crash.<br>
<br>
Everything that I could find on google suggests to change log_num_mtt, but I cannot do this for the following reasons:<br>
1. There is no log_num_mtt in /sys/module/mlx4_core/parameters/<br>
2. Adding "options mlx4_core log_num_mtt=24" to /etc/modprobe.d/mlx4.conf doesn't seem to change anything<br>
3. I am not sure how I can restart the driver because there is no "/etc/init.d/openibd" file (I've rebooted the system but it didn't do anything to create log_num_mtt)<br>
<br>
[Template information]<br>
1. OpenFabrics is from the Ubuntu distribution using "apt-get install infiniband-diags ibutils ibverbs-utils libmlx4-dev"<br>
2. OS is Ubuntu 14.04 LTS<br>
3. Subnet manager is from the Ubuntu distribution using "apt-get install opensm"<br>
4. Output of ibv_devinfo is:<br>
hca_id: mlx4_0<br>
&nbsp; &nbsp; &nbsp; &nbsp; transport:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; InfiniBand (0)<br>
&nbsp; &nbsp; &nbsp; &nbsp; fw_ver:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.10.600<br>
&nbsp; &nbsp; &nbsp; &nbsp; node_guid:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0002:c903:003d:52b0<br>
&nbsp; &nbsp; &nbsp; &nbsp; sys_image_guid:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0002:c903:003d:52b3<br>
&nbsp; &nbsp; &nbsp; &nbsp; vendor_id:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x02c9<br>
&nbsp; &nbsp; &nbsp; &nbsp; vendor_part_id:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4099<br>
&nbsp; &nbsp; &nbsp; &nbsp; hw_ver:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x0<br>
&nbsp; &nbsp; &nbsp; &nbsp; board_id:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;MT_1100120019<br>
&nbsp; &nbsp; &nbsp; &nbsp; phys_port_cnt:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; port:&nbsp; &nbsp;1<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; state:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PORT_ACTIVE (4)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; max_mtu:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4096 (5)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; active_mtu:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4096 (5)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sm_lid:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; port_lid:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; port_lmc:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x00<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; link_layer:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;InfiniBand<br>
5. Output of ifconfig for IB is<br>
ib0&nbsp; &nbsp; &nbsp; &nbsp;Link encap:UNSPEC&nbsp; HWaddr 80-00-00-48-FE-80-00-00-00-00-00-00-00-00-00-00<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.1&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::202:c903:3d:52b1/64 Scope:Link<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:2044&nbsp; Metric:1<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:26 errors:0 dropped:0 overruns:0 frame:0<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:34 errors:0 dropped:16 overruns:0 carrier:0<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:256<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:5843 (5.8 KB)&nbsp; TX bytes:4324 (4.3 KB)<br>
6. ulimit -l is "unlimited"<br>
<br>
Thanks,<br>
Rio<br>
_______________________________________________<br>
users mailing list<br>
<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
Link to this post: <a href="http://www.open-mpi.org/community/lists/users/2014/08/25048.php" target="_blank">http://www.open-mpi.org/community/lists/users/2014/08/25048.php</a><br>
</blockquote></div><br></div>
_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
</div></div>Link to this post: <a href="http://www.open-mpi.org/community/lists/users/2014/08/25049.php" target="_blank">http://www.open-mpi.org/community/lists/users/2014/08/25049.php</a></blockquote></div><br></div><br>
_______________________________________________<br>
users mailing list<br>
<a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
Link to this post: <a href="http://www.open-mpi.org/community/lists/users/2014/08/25062.php" target="_blank">http://www.open-mpi.org/community/lists/users/2014/08/25062.php</a><br></blockquote></div><br></div>
_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/users<br>Link to this post: http://www.open-mpi.org/community/lists/users/2014/08/25063.php</blockquote></div><br></body></html>
