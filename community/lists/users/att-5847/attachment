<HTML dir=ltr><HEAD><TITLE>Re: [OMPI users] using OpenMPI + SGE in a heterogeneous network</TITLE>
<META http-equiv=Content-Type content="text/html; charset=unicode">
<META content="MSHTML 6.00.6000.16640" name=GENERATOR></HEAD>
<BODY>
<DIV id=idOWAReplyText44340 dir=ltr>
<DIV dir=ltr><FONT face=Arial color=#000000 size=2>Hi&nbsp;Reuti</FONT></DIV>
<DIV dir=ltr><FONT face=Arial size=2></FONT>&nbsp;</DIV>
<DIV dir=ltr><FONT face=Arial size=2></FONT>&nbsp;</DIV>
<DIV dir=ltr><FONT face=Arial size=2>I tried this but the problem I ran into was that the value of the environment variable OMPI_MCA_btl set in the PE start script is not propagated to the&nbsp;job script. Therefore the mpirun environment is not aware of its value.&nbsp;I must be missing something here, do you have any idea? </FONT></DIV>
<DIV dir=ltr><FONT face=Arial size=2>(I associate each hostgroup with its own PE, similar to the suggestion in that url, but with&nbsp; a common start script)</FONT></DIV><FONT face=Arial size=2></FONT></DIV>
<DIV dir=ltr>&nbsp;</DIV>
<DIV dir=ltr>Thanks</DIV>
<DIV dir=ltr>&nbsp;</DIV>
<DIV dir=ltr>Henk</DIV>
<DIV dir=ltr><BR><FONT size=2><BR>A transparent solution would be to create a "starter_method" in the&nbsp;<BR>parallel queue, which will check the node that it's running on and&nbsp;<BR>hence you know which type of interface to use. Export the variable&nbsp;<BR>and exec the real script; i.e. something like:<BR><BR>#!/bin/sh<BR>if [ "${HOSTNAME%%[0-9]*}" = "node_ib" ]; then<BR>&nbsp;&nbsp;&nbsp;&nbsp; export OMPI_MCA_btl=tcp<BR>else<BR>&nbsp;&nbsp;&nbsp;&nbsp; export OMPI_MCA_btl=openib<BR>fi<BR>exec "$@"<BR><BR><BR>I think you get the idea of the script. Maybe you have some special&nbsp;<BR>names for these machines. Another indicator would be the $PE or&nbsp;<BR>$QUEUE of SGE. If you want to be sure to get only nodes of one and&nbsp;<BR>the same type (but you don't care which at submission time), you will&nbsp;<BR>need to setup something like:<BR><BR><A href="http://gridengine.info/articles/2006/02/14/grouping-jobs-to-nodes-via-wildcard-pes">http://gridengine.info/articles/2006/02/14/grouping-jobs-to-nodes-via-wildcard-pes</A><BR><BR>anyway.<BR><BR>HTH - Reuti<BR><BR><BR>&gt;<BR>&gt; mpirun -np $NSLOTS executable<BR>&gt;<BR>&gt; as I have seen in some of the OpenMPI FAQs.<BR>&gt;<BR>&gt; Thanks<BR>&gt;<BR>&gt; Henk<BR>&gt;<BR>&gt; From: users-bounces@open-mpi.org on behalf of Reuti<BR>&gt; Sent: Fri 6/6/2008 6:47 PM<BR>&gt; To: Open MPI Users<BR>&gt; Subject: Re: [OMPI users] using OpenMPI + SGE in a heterogeneous&nbsp;<BR>&gt; network<BR>&gt;<BR>&gt; Am 06.06.2008 um 19:31 schrieb Patrick Geoffray:<BR>&gt;<BR>&gt; &gt; SLIM H.A. wrote:<BR>&gt; &gt;&gt; I would be grateful for any advice<BR>&gt; &gt;<BR>&gt; &gt; Just to check, you are not using the MTL for MX, right ? Only the&nbsp;<BR>&gt; BTL<BR>&gt; &gt; interface allow to choose between several devices at run time.<BR>&gt;<BR>&gt; At least there would be the option to built two binaries and decide<BR>&gt; at runtime which to use in your jobscript - depending on the machine<BR>&gt; you landed on.<BR>&gt;<BR>&gt; -- Reuti<BR>&gt; _______________________________________________<BR>&gt; users mailing list<BR>&gt; users@open-mpi.org<BR>&gt; <A href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</A><BR>&gt;<BR>&gt; _______________________________________________<BR>&gt; users mailing list<BR>&gt; users@open-mpi.org<BR>&gt; <A href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</A><BR><BR>_______________________________________________<BR>users mailing list<BR>users@open-mpi.org<BR><A href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</A><BR></DIV></FONT></BODY></HTML>
