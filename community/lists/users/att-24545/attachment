<html><head><meta http-equiv="Content-Type" content="text/html charset=utf-8"><base></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">FWIW: support for the --resv-ports option was deprecated and removed on the OMPI side a long time ago.<div><br></div><div>I'm not familiar enough with "oshrun" to know if it is doing anything unusual - I believe it is just a renaming of our usual "mpirun". I suspect this is some interaction with sbatch, but I'll take a look. I haven't see that warning. Mike indicated he thought it is due to both slurm and OMPI trying to control stdin/stdout, in which case it shouldn't be happening but you can safely ignore it</div><div><br></div><div><br><div><div><div>On Jun 5, 2014, at 3:04 AM, Timur Ismagilov &lt;<a href="mailto:tismagilov@mail.ru">tismagilov@mail.ru</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><p>I use cmd line</p><p>$sbatch -p test --exclusive -N 2 -o hello_oshmem.out -e hello_oshmem.err shrun_mxm3.0 ./hello_oshmem<br><br>where script shrun_mxm3.0:</p><p>$cat shrun_mxm3.0<br></p><p>&nbsp; #!/bin/sh</p><p>&nbsp; #srun --resv-ports "$@"<br>&nbsp; #exit $?</p><p>&nbsp; [ x"$TMPDIR" == x"" ] &amp;&amp; TMPDIR=/tmp<br>&nbsp; HOSTFILE=${TMPDIR}/hostfile.${SLURM_JOB_ID}<br>&nbsp; srun hostname -s|sort|uniq -c|awk '{print $2" slots="$1}' &gt; $HOSTFILE || { rm -f $HOSTFILE; exit 255; }<br>&nbsp; LD_PRELOAD=/mnt/data/users/dm2/vol3/semenov/_scratch/mxm/mxm-3.0/lib/libmxm.so oshrun -x LD_PRELOAD -x MXM_SHM_KCOPY_MODE=off --hostfile $HOSTFILE "$@"<br><br>&nbsp; rc=$?<br>&nbsp; rm -f $HOSTFILE</p><p>&nbsp; exit $rc</p><p>I configured openmpi using</p><p>./configure CC=icc CXX=icpc F77=ifort FC=ifort --prefix=/mnt/data/users/dm2/vol3/semenov/_scratch/openmpi-1.8.1_mxm-3.0 --with-mxm=/mnt/data/users/dm2/vol3/semenov/_scratch/mxm/mxm-3.0/ --with- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;slurm --with-platform=contrib/platform/mellanox/optimized<br><br><br>Fri, 30 May 2014 07:09:54 -0700 от Ralph Castain &lt;<a href="mailto:rhc@open-mpi.org">rhc@open-mpi.org</a>&gt;:<br></p><blockquote style="border-left-width: 1px; border-left-style: solid; border-left-color: rgb(8, 87, 166); margin: 10px; padding: 0px 0px 0px 10px;"><div id=""><div class="js-helper js-readmsg-msg"><base target="_self" href="https://e.mail.ru/"><div id="style_14014589990000001015_BODY">Can you pass along the cmd line that generated that output, and how OMPI was configured?<div><br><div><div>On May 30, 2014, at 5:11 AM, Тимур Исмагилов &lt;<a href="x-msg://e.mail.ru/compose/?mailto=mailto%3atismagilov@mail.ru" target="_blank">tismagilov@mail.ru</a>&gt; wrote:</div><br><blockquote type="cite"><div><p>Hello!</p><p><span data-mce-style="font-family: Arial, Tahoma, Verdana, sans-serif;font-size: 13px;line-height: 18.200000762939453px;" style="font-family: Arial, Tahoma, Verdana, sans-serif; font-size: 13px; line-height: 18.200000762939453px;">I am using Open MPI v1.8.1 and slurm 2.5.6.</span></p><p><span data-mce-style="font-family: Arial, Tahoma, Verdana, sans-serif;font-size: 13px;line-height: 18.200000762939453px;" style="font-family: Arial, Tahoma, Verdana, sans-serif; font-size: 13px; line-height: 18.200000762939453px;">I got this messages when i try to run example (hello_oshmem.cpp) program:</span></p><p>[warn] Epoll ADD(1) on fd 0 failed. Old events were 0; read change was 1 (add); write change was 0 (none): Operation not permitted<br>[warn] Epoll ADD(4) on fd 1 failed. Old events were 0; read change was 0 (none); write change was 1 (add): Operation not permitted<br>Hello, world, I am 0 of 2<br>Hello, world, I am 1 of 2</p><p>What does this warnings mean?</p><p>I lunch this job using sbatch and mpirun with hostfile (got it from : &nbsp;$srun hostname -s|sort|uniq -c|awk '{print $2" slots="$1}' &gt; $HOSTFILE)<br></p><p>Regards,<br>Timur<span style="font-family: Arial, Tahoma, Verdana, sans-serif; font-size: 13px; line-height: 18.200000762939453px;"><br></span></p></div>_______________________________________________<br>users mailing list<br><a href="x-msg://e.mail.ru/compose/?mailto=mailto%3ausers@open%2dmpi.org" target="_blank">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></blockquote></div><br></div></div><base target="_self" href="https://e.mail.ru/"></div></div></blockquote><br><br></div></blockquote></div><br></div></div></body></html>
