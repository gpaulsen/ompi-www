<html><head></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><br><div><div>On Nov 25, 2011, at 3:42 AM, Reuti wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div>Hi Ralph,<br><br>Am 25.11.2011 um 03:47 schrieb Ralph Castain:<br><br><blockquote type="cite"><br></blockquote><blockquote type="cite">On Nov 24, 2011, at 2:00 AM, Reuti wrote:<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><blockquote type="cite">Hi,<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">Am 24.11.2011 um 05:26 schrieb Jaison Paul:<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">I am trying to access OpenMPI processes over Internet using ssh and not quite successful, yet. I believe that I should be able to do it.<br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">I have to run one process on my PC and the rest on a remote cluster over internet. I have set the public keys (at .ssh/authorized_keys) to access remote nodes without a password.<br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">I use hostfile to run mpi. It will read something like:<br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">-----------------------------<br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">localhost<br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><a href="mailto:user@remotehost.com">user@remotehost.com</a><br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">this is not a valid syntax for Open MPI.<br></blockquote></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">This isn't correct<br></blockquote><br>I'm completely sorry about this, it wasn't my intention to misguide anyone.</div></blockquote><div><br></div>Not a problem at all!</div><div><br><blockquote type="cite"><div> But this syntax isn't something I would have expected to work, nor is it documented in `man mpiexec` AFAICS. I suggest to add it there or at <a href="http://www.open-mpi.org/faq/?category=running">http://www.open-mpi.org/faq/?category=running</a>. Or maybe a complete new man page for "hostfile", where also slots= and max_slots= are explained in one location.<br></div></blockquote><div><br></div>Yeah, our documentation is somewhat out-of-date in that area. The best explanation is on the wiki:</div><div><br></div><div><a href="https://svn.open-mpi.org/trac/ompi/wiki/HostFilePlan">https://svn.open-mpi.org/trac/ompi/wiki/HostFilePlan</a></div><div><br></div><div>That was the design document I used when I wrote the code.</div><div><br><blockquote type="cite"><div><br>NB: Checking orte/util/hostfile/hostfile.c even ^ to exclude hosts is supported, but from which initial list will they be excluded? In the `man orte_hosts` I find --default-hostfile which could be the initial list, but --default-hostfile isn't in mpirun's man page.<br></div></blockquote><div><br></div>The "initial list" is whatever hostfile you provided - either the default hostfile or one specified on the cmd line. Remember, we use a progression here:</div><div><br></div><div>1. if a default hostfile exists, get our allocation from it. Any other hostfiles specified on the cmd line are then used to filter hosts from the default hostfile - i.e., we will ignore any hostname given in the cmd line hostfile if it wasn't included in the default hostfile. The "exclude" option applies in both cases. Any exclude directive in the default hostfile will ensure that host isn't included in the allocation. An excluded host in the cmd line hostfile will ensure that host is removed from the final allocation, should it have been present in the default hostfile.</div><div><br></div><div>2. if a default hostfile doesn't exist, then cycle across all hostfiles given on the cmd line and use the aggregate list as the allocation. I believe any exclude option here would apply only to the individual hostfile - i.e., if one hostfile includes a node and another excludes it, I suspect the node will wind up in the allocation.</div><div><br></div><div>Once we have that global allocation, the nodes used for launch of each app_context are filtered from that global allocation using the hostfile specified for that app_context. So any exclude in that hostfile will impact only the associated app_context.</div><div><br></div><div>Confusing and complex, I know - unfortunately, that is what I was told the community would want. :-/</div><div><br></div><div>HTH</div><div>Ralph</div><div><br></div><div><blockquote type="cite"><div><br>-- Reuti<br><br><br><blockquote type="cite">- we have long supported that syntax in a hostfile, and there is no issue with having a different user name at each node.<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">Jaison: are you sure your nodes are setup for password-less ssh? In other words, have you setup your .ssh files on the remote nodes so they will allow us to ssh a process on them without providing a password? This is the typical problem we see.<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">-----------------------------<br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">But it fails.<br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">The issue seems to be the user! That is, the user on my PC is different to that of user at remotehosts. That's my assumption.<br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">Is this the problem? Is there any work-around to solve this issue? Do I need to have same username at all nodes to solve this issue?<br></blockquote></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">You can define nicknames for an ssh connection in a file ~/.ssh/config like:<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">Host foobar<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> &nbsp;User baz<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> &nbsp;Hostname the.remote.server.demo<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> &nbsp;Port 1234<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">While this will work with any nickname for an ssh connection, in your case the nickname must match the one specified in the hostfile, as Open MPI won't use this lookup file:<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">Host <a href="http://remotehost.com">remotehost.com</a><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> &nbsp;User user<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">ssh should then use the entries therein to initiate the connection. For details you can have a look at `man ssh_config`.<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">-- Reuti<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">_______________________________________________<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">users mailing list<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br></blockquote></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">_______________________________________________<br></blockquote><blockquote type="cite">users mailing list<br></blockquote><blockquote type="cite"><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br></blockquote><blockquote type="cite"><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br></blockquote><br><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></div></blockquote></div><br></body></html>
