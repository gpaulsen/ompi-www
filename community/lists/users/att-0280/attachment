<HTML><BODY style="word-wrap: break-word; -khtml-nbsp-mode: space; -khtml-line-break: after-white-space; "><DIV>Hi,</DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>I have been using Open MPI in conjunction with PETSc on OSX 10.4, and had been having trouble with undefined symbols when trying tests with PETSc:</DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">/usr/bin/ld: Undefined symbols:</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">_pmpi_wtick__</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">_pmpi_wtime__</DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>After playing around with things for a while, I realized that these undefined symbols only appeared in libmpi_f90.a, and were somehow being pulled into the PETSc libraries when they were built.  The problem occurred when trying to build an executable that included libraries with these undefined symbols.  The simplest solution I could think of was to edit include/mpif.h.in.  In the last two lines of this file I simply changed:</DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>&gt;       double precision MPI_WTIME, MPI_WTICK, PMPI_WTIME, PMPI_WTICK</DIV><DIV>&gt;       external MPI_WTIME, MPI_WTICK, PMPI_WTIME, PMPI_WTICK</DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>to:</DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>&lt;       double precision MPI_WTIME, MPI_WTICK</DIV><DIV>&lt;       external MPI_WTIME, MPI_WTICK</DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>This fixed the problem for me, and I am wondering whether this is a reasonable fix.  My understanding is that the functions are not actually part of open-mpi.  Would this approach break anything else?  If not, it would be nice to include it, since the only other option I can think of for fixing things on OSX 10.4 with the current build procedures is to strip libraries of undefined symbols before they are used.</DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>Thanks,</DIV><DIV>Charles</DIV><DIV><BR class="khtml-block-placeholder"></DIV><BR><DIV> <P style="margin: 0.0px 0.0px 0.0px 0.0px"><FONT face="Helvetica" size="3" style="font: 12.0px Helvetica">Charles A. Williams</FONT></P> <P style="margin: 0.0px 0.0px 0.0px 0.0px"><FONT face="Helvetica" size="3" style="font: 12.0px Helvetica">Dept. of Earth &amp; Environmental Sciences</FONT></P> <P style="margin: 0.0px 0.0px 0.0px 0.0px"><FONT face="Helvetica" size="3" style="font: 12.0px Helvetica">Science Center, 2C01B</FONT></P> <P style="margin: 0.0px 0.0px 0.0px 0.0px"><FONT face="Helvetica" size="3" style="font: 12.0px Helvetica">Rensselaer Polytechnic Institute</FONT></P> <P style="margin: 0.0px 0.0px 0.0px 0.0px"><FONT face="Helvetica" size="3" style="font: 12.0px Helvetica">Troy, NY<SPAN class="Apple-converted-space">  </SPAN>12180</FONT></P> <P style="margin: 0.0px 0.0px 0.0px 0.0px"><FONT face="Helvetica" size="3" style="font: 12.0px Helvetica">Phone:<SPAN class="Apple-converted-space"><SPAN class="Apple-converted-tab">    </SPAN></SPAN>(518) 276-3369</FONT></P> <P style="margin: 0.0px 0.0px 0.0px 0.0px"><FONT face="Helvetica" size="3" style="font: 12.0px Helvetica">FAX:<SPAN class="Apple-converted-space"><SPAN class="Apple-converted-tab">        </SPAN></SPAN>(518) 276-2012</FONT></P> <P style="margin: 0.0px 0.0px 0.0px 0.0px"><FONT face="Helvetica" size="3" style="font: 12.0px Helvetica">e-mail:<SPAN class="Apple-converted-space"><SPAN class="Apple-converted-tab">    </SPAN></SPAN><A href="mailto:willic3@rpi.edu">willic3@rpi.edu</A></FONT></P> <BR class="Apple-interchange-newline"> </DIV><BR></BODY></HTML>
