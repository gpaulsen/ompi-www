<html><body><div style="color:#000; background-color:#fff; font-family:times new roman, new york, times, serif;font-size:10pt">For example there are 10 nodes, and each node contains 20 cores. We will have 200 cores in total and let say there are 2000 MPI processes. We start the application with 10 MPI on each core. Let say Comm(Pi, Pj) denotes how much communication Pi and Pj make with each other and let say each process Pi has to communicate with few other processes Pj, Pk, Pl, Pm..... Pz. Secondly let say Load(Pi) denotes the computational load of process Pi. <br><br>Now, we know that sending a message between two nodes is more expensive then sending a message within a node (two processes that communicate reside on the cores that exist in the same node). This is true atleast in my supercomputing centers that I use. In my previous work I only consider Load[ ] and not Comm[ ]. In that work, all the MPI processes calculate their new ranks and then call
 MPI_Comm_split with key = new_rank and color = 0. So all the processes get the new rank and then the actual data is provided to each process for computation. We have found that the total execution time decreases. Now we need to consider the communications as well. We will bring the computational load balance but those MPI which communicate more will be mapped to the same node (not necessarily same cores). I have solved this optimization problem using ILP and that shows good results. But the thing is, in the solution I have found that after applying ILP or my heuristic, the cores (on all nodes) will no longer contain same number of MPI processes (load and communications are balanced instead of count of MPI processes per core). So this means either I use process migration for few processes or I run more than 2000 (means at every core I run few more processes) so that at the end imbalance in the number or MPI processes per core can be achieved (to achieve
 balance in load and communications). I need your suggestions in these regards,<br><br>thanks and best regards,<br>Mudassar<br><div style="font-family: times new roman, new york, times, serif; font-size: 10pt;"><div style="font-family: times new roman, new york, times, serif; font-size: 12pt;"><font face="Arial" size="2"><hr size="1"><b><span style="font-weight:bold;">From:</span></b> Josh Hursey &lt;jjhursey@open-mpi.org&gt;<br><b><span style="font-weight: bold;">To:</span></b> Open MPI Users &lt;users@open-mpi.org&gt;<br><b><span style="font-weight: bold;">Cc:</span></b> Mudassar Majeed &lt;mudassarm30@yahoo.com&gt;<br><b><span style="font-weight: bold;">Sent:</span></b> Thursday, November 10, 2011 5:11 PM<br><b><span style="font-weight: bold;">Subject:</span></b> Re: [OMPI users] Process Migration<br></font><br>
Note that the "migrate me from my current node to node &lt;foo&gt;" scenario<br>is covered by the migration API exported by the C/R infrastructure, as<br>I noted earlier.<br>&nbsp; http://osl.iu.edu/research/ft/ompi-cr/api.php#api-cr_migrate<br><br>The "move rank N to node &lt;foo&gt;" scenario could probably be added as an<br>extension of this interface (since you can do that via the command<br>line now) if that is what you are looking for.<br><br>-- Josh<br><br>On Thu, Nov 10, 2011 at 11:03 AM, Ralph Castain &lt;<a ymailto="mailto:rhc@open-mpi.org" href="mailto:rhc@open-mpi.org">rhc@open-mpi.org</a>&gt; wrote:<br>&gt; So what you are looking for is an MPI extension API that let's you say<br>&gt; "migrate me from my current node to node &lt;foo&gt;"? Or do you have a rank that<br>&gt; is the "master" that would order "move rank N to node &lt;foo&gt;"?<br>&gt; Either could be provided, I imagine - just want to ensure I understand what<br>&gt; you need.
 Can you pass along a brief description of the syntax and<br>&gt; functionality you would need?<br>&gt;<br>&gt; On Nov 10, 2011, at 8:27 AM, Mudassar Majeed wrote:<br>&gt;<br>&gt; Thank you for your reply. In our previous publication, we have figured it<br>&gt; out that run more than one processes on cores and balancing the<br>&gt; computational load considerably reduces the total execution time. You know<br>&gt; the MPI_Graph_create function, we created another function MPI_Load_create<br>&gt; that maps the processes on cores such that balance of computational load can<br>&gt; be achieved on cores. We were having some issues with increase in<br>&gt; communication cost due to ranks rearrangements (due to MPI_Comm_split, with<br>&gt; color=0), so in this research work we will see how can we balance both<br>&gt; computation load on each core and communication load on each node. Those<br>&gt; processes that communicate more will reside on the same node
 keeping the<br>&gt; computational load balance over the cores. I solved this problem using ILP<br>&gt; but ILP takes time and can't be used in run time so I am thinking about an<br>&gt; heuristic. That's why I want to see if it is possible to migrate a process<br>&gt; from one core to another or not. Then I will see how good my heuristic will<br>&gt; be.<br>&gt;<br>&gt; thanks<br>&gt; Mudassar<br>&gt;<br>&gt; ________________________________<br>&gt; From: Jeff Squyres &lt;<a ymailto="mailto:jsquyres@cisco.com" href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a>&gt;<br>&gt; To: Mudassar Majeed &lt;<a ymailto="mailto:mudassarm30@yahoo.com" href="mailto:mudassarm30@yahoo.com">mudassarm30@yahoo.com</a>&gt;; Open MPI Users<br>&gt; &lt;<a ymailto="mailto:users@open-mpi.org" href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>&gt; Cc: Ralph Castain &lt;<a ymailto="mailto:rhc@open-mpi.org"
 href="mailto:rhc@open-mpi.org">rhc@open-mpi.org</a>&gt;<br>&gt; Sent: Thursday, November 10, 2011 2:19 PM<br>&gt; Subject: Re: [OMPI users] Process Migration<br>&gt;<br>&gt; On Nov 10, 2011, at 8:11 AM, Mudassar Majeed wrote:<br>&gt;<br>&gt;&gt; Thank you for your reply. I am implementing a load balancing function for<br>&gt;&gt; MPI, that will balance the computation load and the communication both at a<br>&gt;&gt; time. So my algorithm assumes that all the cores may at the end get<br>&gt;&gt; different number of processes to run.<br>&gt;<br>&gt; Are you talking about over-subscribing cores?&nbsp; I.e., putting more than 1 MPI<br>&gt; process on each core?<br>&gt;<br>&gt; In general, that's not a good idea.<br>&gt;<br>&gt;&gt; In the beginning (before that function will be called), each core will<br>&gt;&gt; have equal number of processes. So I am thinking either to start more<br>&gt;&gt; processes on each core (than needed) and run my function for
 load balancing<br>&gt;&gt; and then block the remaining processes (on each core). In this way I will be<br>&gt;&gt; able to achieve different number of processes per core.<br>&gt;<br>&gt; Open MPI spins aggressively looking for network progress.&nbsp; For example, if<br>&gt; you block in an MPI_RECV waiting for a message, Open MPI is actively banging<br>&gt; on the CPU looking for network progress.&nbsp; Because of this (and other<br>&gt; reasons), you probably do not want to over-subscribe your processors<br>&gt; (meaning: you probably don't want to put more than 1 process per core).<br>&gt;<br>&gt; --<br>&gt; Jeff Squyres<br>&gt; <a ymailto="mailto:jsquyres@cisco.com" href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a><br>&gt; For corporate legal information go to:<br>&gt; http://www.cisco.com/web/about/doing_business/legal/cri/<br>&gt;<br>&gt;<br>&gt;<br>&gt;<br>&gt;<br>&gt; _______________________________________________<br>&gt; users mailing
 list<br>&gt; <a ymailto="mailto:users@open-mpi.org" href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt; http://www.open-mpi.org/mailman/listinfo.cgi/users<br>&gt;<br><br><br><br>-- <br>Joshua Hursey<br>Postdoctoral Research Associate<br>Oak Ridge National Laboratory<br>http://users.nccs.gov/~jjhursey<br><br><br></div></div></div></body></html>
