<html>
<head>
<style><!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Verdana
}
--></style>
</head>
<body class='hmmessage'>
My hosts have infiniband and ethernet interfaces. I found the solution to my problem. I use --mca btl ^tcp. So My program never runs on ethernet interfaces.<div><br class="webkit-block-placeholder"></div><div>Thank you.<br><br><hr id="stopSpelling">From: rhc@open-mpi.org<br>Date: Sun, 14 Mar 2010 16:58:39 -0600<br>To: users@open-mpi.org<br>Subject: Re: [OMPI users] mpirun over infiniband.<br><br>

<base>I'm afraid I'm confused by your question, so please clarify: the hostnames that have ethernet interfaces do NOT have infiniband interfaces on them? If so, why would you expect OMPI to use infiniband when you execute on those hosts? Or do they contain an infiniband interface in addition to the ethernet interface?<div><br></div><div><br><div><div>On Mar 14, 2010, at 4:47 PM, nad labassi wrote:</div><br class="ecxApple-interchange-newline"><blockquote><span class="ecxApple-style-span" style="border-collapse:separate;font-family:Helvetica;font-size:medium;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><div class="ecxhmmessage" style="font-size:10pt;font-family:Verdana">Hi,<br><br>My problem is: I installed openmpi 1.2.9, with mvapi support, but the<br>execution is done on ethernet, unless I use ipoib.<br><br>I built openmpi with the command:<br><br>./configure CC=/home/pgi/linux86-64/6.2/bin/pgcc<br>CXX=/home/pgi/linux86-64/6.2/bin/pgCC<span class="ecxApple-converted-space"> </span><br>FC=/home/pgi/linux86-64/6.2/bin/pgf90<span class="ecxApple-converted-space"> </span><br>--without-tm --without-gm --without-mx --with-sge --without-openib<span class="ecxApple-converted-space"> </span><br>--with-mvapi=/usr/mellanox --with-mvapi-libdir=/usr/lib64<span class="ecxApple-converted-space"> </span><br>--with-threads=posix<br>--prefix=/home/openmpi-1.2.9_mvapi<br><br>I run the program with the commande:<br><br>/home/openmpi-1.2.9_mvapi/bin/mpirun --mca btl mvapi,self -n 8<br>-machinefile /home/myaccount/machines<br>/home/myaccount/mpihello_openmpi-1.2.9.exe<br><br>When the machines file contains hostnames for ethernet interfaces,<br>the execution is never done on infiniband<br><br>When the machines file contains hostnames for ib interfaces (ipoib),<br>then the execution is done on infiniband.<br><br>I want the execution to be done on infiniband, while the machines<br>file contains hostnames for ethernet interfaces.<br><br><br> ompi_info --param btl mvapi outputs are:<br><br>                 MCA btl: parameter "btl_base_debug" (current value:<br>"0")<br>                          If btl_base_debug is 1 standard debug is<br>output, if &gt; 1 verbose debug is output<br>                 MCA btl: parameter "btl" (current value: &lt;none&gt;)<br>                          Default selection set of components for the<br>btl framework (&lt;none&gt; means "use all<br> components that can be found")<br>                 MCA btl: parameter "btl_base_verbose" (current<br>value: "0")<br>                          Verbosity level for the btl framework (0 =<br>no verbosity)<br>                 MCA btl: parameter "btl_mvapi_max_btls" (current<br>value: "4")<br>                          maximum number of HCAs/ports to use<br>                 MCA btl: parameter "btl_mvapi_free_list_num"<br>(current value: "8")<br>                          initial size of free lists<br>                 MCA btl: parameter "btl_mvapi_free_list_max"<br>(current value: "-1")<br>                          maximum size of free lists<br>                 MCA btl: parameter "btl_mvapi_free_list_inc"<br>(current value: "32")<br>                          increment size of free lists<br>                 MCA btl: parameter "btl_mvapi_mpool" (current value:<br>"rdma")<br>                          name of the memory pool to be used<br>                 MCA btl: parameter "btl_mvapi_reg_mru_len" (current<br>value: "16")<br>                          length of the registration cache most<br>recently used list<br>                 MCA btl: parameter "btl_mvapi_use_srq" (current<br>value: "0")<br>                          if 1 use the IB shared receive queue to<br>post receive descriptors<br>                 MCA btl: parameter "btl_mvapi_ib_cq_size" (current<br>value: "10000")<br>                          size of the IB completion queue<br>                 MCA btl: parameter "btl_mvapi_ib_sg_list_size"<br>(current value: "1")<br>                          size of IB segment list<br>                 MCA btl: parameter "btl_mvapi_ib_pkey_ix" (current<br>value: "0")<br>                          IB pkey index<br>                 MCA btl: parameter "btl_mvapi_ib_psn" (current<br>value: "0")<br>                          IB Packet sequence starting number<br>                 MCA btl: parameter "btl_mvapi_ib_qp_ous_rd_atom"<br>(current value: "4")<br>                          IB outstanding atomic reads<br><br>                 MCA btl: parameter "btl_mvapi_ib_mtu" (current<br>value: "3")<br>                          IB MTU, in bytes.  Valid values are: 1=256<br>bytes, 2=512 bytes, 3=1024 bytes, 4=2<br>048 bytes, 5=4096 bytes.<br>                 MCA btl: parameter "btl_mvapi_ib_min_rnr_timer"<br>(current value: "5")<br>                          IB min rnr timer<br>                 MCA btl: parameter "btl_mvapi_ib_timeout" (current<br>value: "10")<br>                          IB transmit timeout<br>                 MCA btl: parameter "btl_mvapi_ib_retry_count"<br>(current value: "7")<br>                          IB transmit retry count<br>                 MCA btl: parameter "btl_mvapi_ib_rnr_retry" (current<br>value: "7")<br>                          IB rnr retry<br>                 MCA btl: parameter "btl_mvapi_ib_max_rdma_dst_ops"<br>(current value: "4")<br>                          IB max rdma destination operations<br>                 MCA btl: parameter "btl_mvapi_ib_service_level"<br>(current value: "0")<br>                          IB service level<br>                 MCA btl: parameter "btl_mvapi_ib_static_rate"<br>(current value: "0")<br>(current value: "0")<br>                          IB static rate<br>                 MCA btl: parameter "btl_mvapi_ib_src_path_bits"<br>(current value: "0")<br>                          IB source path bits<br>                 MCA btl: parameter "btl_mvapi_rd_num" (current<br>value: "8")<br>                          number of receive descriptors to post to a<br>QP<br>                 MCA btl: parameter "btl_mvapi_rd_low" (current<br>value: "6")<br>                          low water mark before reposting occurs<br>                 MCA btl: parameter "btl_mvapi_rd_win" (current<br>value: "4")<br>                          window size at which generate explicity<br>credit message<br>                 MCA btl: parameter "btl_mvapi_srq_rd_max" (current<br>value: "1000")<br>                          Maximum number of receive descriptors<br>posted per SRQ.<br><br>                 MCA btl: parameter "btl_mvapi_srq_rd_per_peer"<br>(current value: "16")<br>                          receive descriptors posted per peer, SRQ<br>mode only<br>                 MCA btl: parameter "btl_mvapi_srq_sd_max" (current<br>value: "8")<br>                          Maximum number of send descriptors posted<br>per process<br>                 MCA btl: parameter "btl_mvapi_use_eager_rdma"<br>(current value: "1")<br>                          user RDMA for eager messages<br>                 MCA btl: parameter "btl_mvapi_eager_rdma_threshold"<br>(current value: "16")<br>                          Open rdma channel for eager messages after<br>this number of messages received from<br> peer (zero to disable)<br>                 MCA btl: parameter "btl_mvapi_max_eager_rdma"<br><br>(current value: "16")<br>                          Maximum number of eager RDMA connections<br>                 MCA btl: parameter "btl_mvapi_eager_rdma_num"<br>(current value: "16")<br>                          Number of RDMA buffers for eager messages<br>                 MCA btl: parameter "btl_mvapi_exclusivity" (current<br>value: "1024")<br>                          BTL exclusivity<br>                 MCA btl: parameter "btl_mvapi_eager_limit" (current<br>value: "12288")<br>                          eager send limit<br>                 MCA btl: parameter "btl_mvapi_min_send_size"<br>(current value: "32768")<br>                          minimum send size<br>                 MCA btl: parameter "btl_mvapi_max_send_size"<br>(current value: "65536")<br>                          maximum send size<br>                 MCA btl: parameter "btl_mvapi_min_rdma_size"<br>(current value: "1048576")<br>                          minimum rdma size<br>                 MCA btl: parameter "btl_mvapi_max_rdma_size"<br>(current value: "1048576")<br>                          maximium rdma size<br>                 MCA btl: parameter "btl_mvapi_flags" (current value:<br>"6")<br>                          BTL flags, SEND=1, PUT=2, GET=4<br>                 MCA btl: parameter "btl_mvapi_bandwidth" (current<br>value: "800")<br>                          Approximate maximum bandwidth of<br>interconnect<br>                 MCA btl: parameter "btl_mvapi_priority" (current<br>value: "0")<br>                 MCA btl: parameter "btl_base_warn_component_unused"<br>(current value: "1")<br>                          This parameter is used to turn on warning<br>messages when certain NICs are not use<br><br><br>Thanks a lot,<br><br>Nadjet.<br><br><br><br><br><hr>Hotmail : une messagerie fiable avec une protection anti-spam performante<span class="ecxApple-converted-space"> </span><a href="https://signup.live.com/signup.aspx?id=60969">Inscrivez-vous</a>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></div></span></blockquote></div><br></div></div> 		 	   		  <br /><hr />Hotmail : une messagerie performante et gratuite avec une sécurité signée Microsoft <a href='https://signup.live.com/signup.aspx?id=60969' target='_new'>Profitez-en</a></body>
</html>
