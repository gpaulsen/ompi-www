<html><head><meta http-equiv="Content-Type" content="text/html charset=us-ascii"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">Are these NICs on the same IP subnet, per chance? You don't have to specify them by name - you can say "-mca btl_tcp_if_include 10.10/16" or something.<div><br><div><div>On May 6, 2014, at 4:50 PM, Clay Kirkland &lt;<a href="mailto:clay.kirkland@versityinc.com">clay.kirkland@versityinc.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div dir="ltr"><div><div><div><div><div>&nbsp;Well it turns out&nbsp; I can't seem to get all three of my machines on the same page.<br></div>Two of them are using eth0 and one is using eth1.&nbsp;&nbsp; Centos seems unable to bring <br></div>
up multiple network interfaces for some reason and when I use the mca param to <br>use eth0 it works on two machines but not the other.&nbsp;&nbsp; Is there some way to use <br></div>only eth1 on one host and only eth0 on the other two?&nbsp;&nbsp; Maybe environment variables<br>
</div>but I can't seem to get that to work either.<br><br></div>&nbsp;Clay<br></div><div class="gmail_extra"><br><br><div class="gmail_quote">On Tue, May 6, 2014 at 6:28 PM, Clay Kirkland <span dir="ltr">&lt;<a href="mailto:clay.kirkland@versityinc.com" target="_blank">clay.kirkland@versityinc.com</a>&gt;</span> wrote:<br>
<blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr"><div>&nbsp;That last trick seems to work.&nbsp; I can get it to work once in a while with those tcp options but it is<br>
tricky as I have three machines and two of them use eth0 as primary network interface and one <br>
uses eth1.&nbsp;&nbsp; But by fiddling with network options and perhaps moving a cable or two I think I can<br>get it all to work&nbsp;&nbsp;&nbsp; Thanks much for the tip.<span class="HOEnZb"><font color="#888888"><br><br></font></span></div><span class="HOEnZb"><font color="#888888">&nbsp;Clay<br>
</font></span></div><div class="HOEnZb"><div class="h5"><div class="gmail_extra"><br><br><div class="gmail_quote">
On Tue, May 6, 2014 at 11:00 AM,  <span dir="ltr">&lt;<a href="mailto:users-request@open-mpi.org" target="_blank">users-request@open-mpi.org</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">

Send users mailing list submissions to<br>
&nbsp; &nbsp; &nbsp; &nbsp; <a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
<br>
To subscribe or unsubscribe via the World Wide Web, visit<br>
&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
or, via email, send a message with subject or body 'help' to<br>
&nbsp; &nbsp; &nbsp; &nbsp; <a href="mailto:users-request@open-mpi.org" target="_blank">users-request@open-mpi.org</a><br>
<br>
You can reach the person managing the list at<br>
&nbsp; &nbsp; &nbsp; &nbsp; <a href="mailto:users-owner@open-mpi.org" target="_blank">users-owner@open-mpi.org</a><br>
<br>
When replying, please edit your Subject line so it is more specific<br>
than "Re: Contents of users digest..."<br>
<br>
<br>
Today's Topics:<br>
<br>
&nbsp; &nbsp;1. Re: MPI_Barrier hangs on second attempt but only &nbsp;when<br>
&nbsp; &nbsp; &nbsp; multiple hosts used. (Daniels, Marcus G)<br>
&nbsp; &nbsp;2. ROMIO bug reading darrays (Richard Shaw)<br>
&nbsp; &nbsp;3. MPI File Open does not work (Imran Ali)<br>
&nbsp; &nbsp;4. Re: MPI File Open does not work (Jeff Squyres (jsquyres))<br>
&nbsp; &nbsp;5. Re: MPI File Open does not work (Imran Ali)<br>
&nbsp; &nbsp;6. Re: MPI File Open does not work (Jeff Squyres (jsquyres))<br>
&nbsp; &nbsp;7. Re: MPI File Open does not work (Imran Ali)<br>
&nbsp; &nbsp;8. Re: MPI File Open does not work (Jeff Squyres (jsquyres))<br>
&nbsp; &nbsp;9. Re: users Digest, Vol 2879, Issue 1 (Jeff Squyres (jsquyres))<br>
<br>
<br>
----------------------------------------------------------------------<br>
<br>
Message: 1<br>
Date: Mon, 5 May 2014 19:28:07 +0000<br>
From: "Daniels, Marcus G" &lt;<a href="mailto:mdaniels@lanl.gov" target="_blank">mdaniels@lanl.gov</a>&gt;<br>
To: "'<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>'" &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] MPI_Barrier hangs on second attempt but only<br>
&nbsp; &nbsp; &nbsp; &nbsp; when &nbsp; &nbsp;multiple hosts used.<br>
Message-ID:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &lt;<a href="mailto:532C594B7920A549A2A91CB4312CC57640DC5007@ECS-EXG-P-MB01.win.lanl.gov" target="_blank">532C594B7920A549A2A91CB4312CC57640DC5007@ECS-EXG-P-MB01.win.lanl.gov</a>&gt;<br>
Content-Type: text/plain; charset="utf-8"<br>
<br>
<br>
<br>
From: Clay Kirkland [mailto:<a href="mailto:clay.kirkland@versityinc.com" target="_blank">clay.kirkland@versityinc.com</a>]<br>
Sent: Friday, May 02, 2014 03:24 PM<br>
To: <a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a> &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br>
Subject: [OMPI users] MPI_Barrier hangs on second attempt but only when multiple hosts used.<br>
<br>
I have been using MPI for many many years so I have very well debugged mpi tests. &nbsp; I am<br>
having trouble on either openmpi-1.4.5 &nbsp;or &nbsp;openmpi-1.6.5 versions though with getting the<br>
MPI_Barrier calls to work. &nbsp; It works fine when I run all processes on one machine but when<br>
I run with two or more hosts the second call to MPI_Barrier always hangs. &nbsp; Not the first one,<br>
but always the second one. &nbsp; I looked at FAQ's and such but found nothing except for a comment<br>
that MPI_Barrier problems were often problems with fire walls. &nbsp;Also mentioned as a problem<br>
was not having the same version of mpi on both machines. &nbsp;I turned firewalls off and removed<br>
and reinstalled the same version on both hosts but I still see the same thing. &nbsp; I then installed<br>
lam mpi on two of my machines and that works fine. &nbsp; I can call the MPI_Barrier function when run on<br>
one of two machines by itself &nbsp;many times with no hangs. &nbsp;Only hangs if two or more hosts are involved.<br>
These runs are all being done on CentOS release 6.4. &nbsp; Here is test program I used.<br>
<br>
main (argc, argv)<br>
int argc;<br>
char **argv;<br>
{<br>
&nbsp; &nbsp; char message[20];<br>
&nbsp; &nbsp; char hoster[256];<br>
&nbsp; &nbsp; char nameis[256];<br>
&nbsp; &nbsp; int fd, i, j, jnp, iret, myrank, np, ranker, recker;<br>
&nbsp; &nbsp; MPI_Comm comm;<br>
&nbsp; &nbsp; MPI_Status status;<br>
<br>
&nbsp; &nbsp; MPI_Init( &amp;argc, &amp;argv );<br>
&nbsp; &nbsp; MPI_Comm_rank( MPI_COMM_WORLD, &amp;myrank);<br>
&nbsp; &nbsp; MPI_Comm_size( MPI_COMM_WORLD, &amp;np);<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; gethostname(hoster,256);<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; printf(" In rank %d and host= %s &nbsp;Do Barrier call 1.\n",myrank,hoster);<br>
&nbsp; &nbsp; MPI_Barrier(MPI_COMM_WORLD);<br>
&nbsp; &nbsp; &nbsp; &nbsp; printf(" In rank %d and host= %s &nbsp;Do Barrier call 2.\n",myrank,hoster);<br>
&nbsp; &nbsp; MPI_Barrier(MPI_COMM_WORLD);<br>
&nbsp; &nbsp; &nbsp; &nbsp; printf(" In rank %d and host= %s &nbsp;Do Barrier call 3.\n",myrank,hoster);<br>
&nbsp; &nbsp; MPI_Barrier(MPI_COMM_WORLD);<br>
&nbsp; &nbsp; MPI_Finalize();<br>
&nbsp; &nbsp; exit(0);<br>
}<br>
<br>
&nbsp; Here are three runs of test program. &nbsp;First with two processes on one host, then with<br>
two processes on another host, and finally with one process on each of two hosts. &nbsp;The<br>
first two runs are fine but the last run hangs on the second MPI_Barrier.<br>
<br>
[root@centos MPI]# /usr/local/bin/mpirun -np 2 --host centos a.out<br>
&nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 1.<br>
&nbsp;In rank 1 and host= centos &nbsp;Do Barrier call 1.<br>
&nbsp;In rank 1 and host= centos &nbsp;Do Barrier call 2.<br>
&nbsp;In rank 1 and host= centos &nbsp;Do Barrier call 3.<br>
&nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 2.<br>
&nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 3.<br>
[root@centos MPI]# /usr/local/bin/mpirun -np 2 --host RAID a.out<br>
/root/.bashrc: line 14: unalias: ls: not found<br>
&nbsp;In rank 0 and host= RAID &nbsp;Do Barrier call 1.<br>
&nbsp;In rank 0 and host= RAID &nbsp;Do Barrier call 2.<br>
&nbsp;In rank 0 and host= RAID &nbsp;Do Barrier call 3.<br>
&nbsp;In rank 1 and host= RAID &nbsp;Do Barrier call 1.<br>
&nbsp;In rank 1 and host= RAID &nbsp;Do Barrier call 2.<br>
&nbsp;In rank 1 and host= RAID &nbsp;Do Barrier call 3.<br>
[root@centos MPI]# /usr/local/bin/mpirun -np 2 --host centos,RAID a.out<br>
/root/.bashrc: line 14: unalias: ls: not found<br>
&nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 1.<br>
&nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 2.<br>
In rank 1 and host= RAID &nbsp;Do Barrier call 1.<br>
&nbsp;In rank 1 and host= RAID &nbsp;Do Barrier call 2.<br>
<br>
&nbsp; Since it is such a simple test and problem and such a widely used MPI function, it must obviously<br>
be an installation or configuration problem. &nbsp; A pstack for each of the hung MPI_Barrier processes<br>
on the two machines shows this:<br>
<br>
[root@centos ~]# pstack 31666<br>
#0 &nbsp;0x0000003baf0e8ee3 in __epoll_wait_nocancel () from /lib64/libc.so.6<br>
#1 &nbsp;0x00007f5de06125eb in epoll_dispatch () from /usr/local/lib/libmpi.so.1<br>
#2 &nbsp;0x00007f5de061475a in opal_event_base_loop () from /usr/local/lib/libmpi.so.1<br>
#3 &nbsp;0x00007f5de0639229 in opal_progress () from /usr/local/lib/libmpi.so.1<br>
#4 &nbsp;0x00007f5de0586f75 in ompi_request_default_wait_all () from /usr/local/lib/libmpi.so.1<br>
#5 &nbsp;0x00007f5ddc59565e in ompi_coll_tuned_sendrecv_actual () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
#6 &nbsp;0x00007f5ddc59d8ff in ompi_coll_tuned_barrier_intra_two_procs () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
#7 &nbsp;0x00007f5de05941c2 in PMPI_Barrier () from /usr/local/lib/libmpi.so.1<br>
#8 &nbsp;0x0000000000400a43 in main ()<br>
<br>
[root@RAID openmpi-1.6.5]# pstack 22167<br>
#0 &nbsp;0x00000030302e8ee3 in __epoll_wait_nocancel () from /lib64/libc.so.6<br>
#1 &nbsp;0x00007f7ee46885eb in epoll_dispatch () from /usr/local/lib/libmpi.so.1<br>
#2 &nbsp;0x00007f7ee468a75a in opal_event_base_loop () from /usr/local/lib/libmpi.so.1<br>
#3 &nbsp;0x00007f7ee46af229 in opal_progress () from /usr/local/lib/libmpi.so.1<br>
#4 &nbsp;0x00007f7ee45fcf75 in ompi_request_default_wait_all () from /usr/local/lib/libmpi.so.1<br>
#5 &nbsp;0x00007f7ee060b65e in ompi_coll_tuned_sendrecv_actual () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
#6 &nbsp;0x00007f7ee06138ff in ompi_coll_tuned_barrier_intra_two_procs () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
#7 &nbsp;0x00007f7ee460a1c2 in PMPI_Barrier () from /usr/local/lib/libmpi.so.1<br>
#8 &nbsp;0x0000000000400a43 in main ()<br>
<br>
&nbsp;Which looks exactly the same on each machine. &nbsp;Any thoughts or ideas would be greatly appreciated as<br>
I am stuck.<br>
<br>
&nbsp;Clay Kirkland<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
-------------- next part --------------<br>
HTML attachment scrubbed and removed<br>
<br>
------------------------------<br>
<br>
Message: 2<br>
Date: Mon, 5 May 2014 22:20:59 -0400<br>
From: Richard Shaw &lt;<a href="mailto:jrs65@cita.utoronto.ca" target="_blank">jrs65@cita.utoronto.ca</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br>
Subject: [OMPI users] ROMIO bug reading darrays<br>
Message-ID:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &lt;<a href="mailto:CAN%2BevmkC%2B9KAcNPAUSScZiufwDJ3JfcSYMB-8ZdX1etDkabioQ@mail.gmail.com" target="_blank">CAN+evmkC+9KAcNPAUSScZiufwDJ3JfcSYMB-8ZdX1etDkabioQ@mail.gmail.com</a>&gt;<br>
Content-Type: text/plain; charset="utf-8"<br>
<br>
Hello,<br>
<br>
I think I've come across a bug when using ROMIO to read in a 2D distributed<br>
array. I've attached a test case to this email.<br>
<br>
In the testcase I first initialise an array of 25 doubles (which will be a<br>
5x5 grid), then I create a datatype representing a 5x5 matrix distributed<br>
in 3x3 blocks over a 2x2 process grid. As a reference I use MPI_Pack to<br>
pull out the block cyclic array elements local to each process (which I<br>
think is correct). Then I write the original array of 25 doubles to disk,<br>
and use MPI-IO to read it back in (performing the Open, Set_view, and<br>
Real_all), and compare to the reference.<br>
<br>
Running this with OMPI, the two match on all ranks.<br>
<br>
&gt; mpirun -mca io ompio -np 4 ./darr_read.x<br>
=== Rank 0 === (9 elements)<br>
Packed: &nbsp;0.0 &nbsp;1.0 &nbsp;2.0 &nbsp;5.0 &nbsp;6.0 &nbsp;7.0 10.0 11.0 12.0<br>
Read: &nbsp; &nbsp;0.0 &nbsp;1.0 &nbsp;2.0 &nbsp;5.0 &nbsp;6.0 &nbsp;7.0 10.0 11.0 12.0<br>
<br>
=== Rank 1 === (6 elements)<br>
Packed: 15.0 16.0 17.0 20.0 21.0 22.0<br>
Read: &nbsp; 15.0 16.0 17.0 20.0 21.0 22.0<br>
<br>
=== Rank 2 === (6 elements)<br>
Packed: &nbsp;3.0 &nbsp;4.0 &nbsp;8.0 &nbsp;9.0 13.0 14.0<br>
Read: &nbsp; &nbsp;3.0 &nbsp;4.0 &nbsp;8.0 &nbsp;9.0 13.0 14.0<br>
<br>
=== Rank 3 === (4 elements)<br>
Packed: 18.0 19.0 23.0 24.0<br>
Read: &nbsp; 18.0 19.0 23.0 24.0<br>
<br>
<br>
<br>
However, using ROMIO the two differ on two of the ranks:<br>
<br>
&gt; mpirun -mca io romio -np 4 ./darr_read.x<br>
=== Rank 0 === (9 elements)<br>
Packed: &nbsp;0.0 &nbsp;1.0 &nbsp;2.0 &nbsp;5.0 &nbsp;6.0 &nbsp;7.0 10.0 11.0 12.0<br>
Read: &nbsp; &nbsp;0.0 &nbsp;1.0 &nbsp;2.0 &nbsp;5.0 &nbsp;6.0 &nbsp;7.0 10.0 11.0 12.0<br>
<br>
=== Rank 1 === (6 elements)<br>
Packed: 15.0 16.0 17.0 20.0 21.0 22.0<br>
Read: &nbsp; &nbsp;0.0 &nbsp;1.0 &nbsp;2.0 &nbsp;0.0 &nbsp;1.0 &nbsp;2.0<br>
<br>
=== Rank 2 === (6 elements)<br>
Packed: &nbsp;3.0 &nbsp;4.0 &nbsp;8.0 &nbsp;9.0 13.0 14.0<br>
Read: &nbsp; &nbsp;3.0 &nbsp;4.0 &nbsp;8.0 &nbsp;9.0 13.0 14.0<br>
<br>
=== Rank 3 === (4 elements)<br>
Packed: 18.0 19.0 23.0 24.0<br>
Read: &nbsp; &nbsp;0.0 &nbsp;1.0 &nbsp;0.0 &nbsp;1.0<br>
<br>
<br>
<br>
My interpretation is that the behaviour with OMPIO is correct.<br>
Interestingly everything matches up using both ROMIO and OMPIO if I set the<br>
block shape to 2x2.<br>
<br>
This was run on OS X using 1.8.2a1r31632. I have also run this on Linux<br>
with OpenMPI 1.7.4, and OMPIO is still correct, but using ROMIO I just get<br>
segfaults.<br>
<br>
Thanks,<br>
Richard<br>
-------------- next part --------------<br>
HTML attachment scrubbed and removed<br>
-------------- next part --------------<br>
A non-text attachment was scrubbed...<br>
Name: darr_read.c<br>
Type: text/x-csrc<br>
Size: 2218 bytes<br>
Desc: not available<br>
URL: &lt;<a href="http://www.open-mpi.org/MailArchives/users/attachments/20140505/5a5ab0ba/attachment.bin" target="_blank">http://www.open-mpi.org/MailArchives/users/attachments/20140505/5a5ab0ba/attachment.bin</a>&gt;<br>


<br>
------------------------------<br>
<br>
Message: 3<br>
Date: Tue, 06 May 2014 13:24:35 +0200<br>
From: Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no" target="_blank">imranal@student.matnat.uio.no</a>&gt;<br>
To: &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br>
Subject: [OMPI users] MPI File Open does not work<br>
Message-ID: &lt;<a href="mailto:d57bdf499c00360b737205b085c50660@ulrik.uio.no" target="_blank">d57bdf499c00360b737205b085c50660@ulrik.uio.no</a>&gt;<br>
Content-Type: text/plain; charset="utf-8"<br>
<br>
<br>
<br>
I get the following error when I try to run the following python<br>
code<br>
import mpi4py.MPI as MPI<br>
comm = MPI.COMM_WORLD<br>
<br>
MPI.File.Open(comm,"some.file")<br>
<br>
$ mpirun -np 1 python<br>
test_mpi.py<br>
Traceback (most recent call last):<br>
&nbsp;File "test_mpi.py", line<br>
3, in &lt;module&gt;<br>
&nbsp;MPI.File.Open(comm," h5ex_d_alloc.h5")<br>
&nbsp;File "File.pyx",<br>
line 67, in mpi4py.MPI.File.Open<br>
(src/mpi4py.MPI.c:89639)<br>
mpi4py.MPI.Exception: MPI_ERR_OTHER: known<br>
error not in<br>
list<br>
--------------------------------------------------------------------------<br>
mpirun<br>
noticed that the job aborted, but has no info as to the process<br>
that<br>
caused that<br>
situation.<br>
--------------------------------------------------------------------------<br>
<br>
<br>
My mpirun version is (Open MPI) 1.6.2. I installed openmpi using the<br>
dorsal script (<a href="https://github.com/FEniCS/dorsal" target="_blank">https://github.com/FEniCS/dorsal</a>) for Redhat Enterprise 6<br>
(OS I am using, release 6.5) . It configured the build as following :<br>
<br>
<br>
./configure --enable-mpi-thread-multiple --enable-opal-multi-threads<br>
--with-threads=posix --disable-mpi-profile<br>
<br>
I need emphasize that I do<br>
not have root acces on the system I am running my application.<br>
<br>
Imran<br>
<br>
<br>
<br>
-------------- next part --------------<br>
HTML attachment scrubbed and removed<br>
<br>
------------------------------<br>
<br>
Message: 4<br>
Date: Tue, 6 May 2014 12:56:04 +0000<br>
From: "Jeff Squyres (jsquyres)" &lt;<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] MPI File Open does not work<br>
Message-ID: &lt;<a href="mailto:E7DF28CB-D4FB-4087-928E-18E61D1D24CF@cisco.com" target="_blank">E7DF28CB-D4FB-4087-928E-18E61D1D24CF@cisco.com</a>&gt;<br>
Content-Type: text/plain; charset="us-ascii"<br>
<br>
The thread support in the 1.6 series is not very good. &nbsp;You might try:<br>
<br>
- Upgrading to 1.6.5<br>
- Or better yet, upgrading to 1.8.1<br>
<br>
<br>
On May 6, 2014, at 7:24 AM, Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no" target="_blank">imranal@student.matnat.uio.no</a>&gt; wrote:<br>
<br>
&gt; I get the following error when I try to run the following python code<br>
&gt;<br>
&gt; import mpi4py.MPI as MPI<br>
&gt; comm = &nbsp;MPI.COMM_WORLD<br>
&gt; MPI.File.Open(comm,"some.file")<br>
&gt;<br>
&gt; $ mpirun -np 1 python test_mpi.py<br>
&gt; Traceback (most recent call last):<br>
&gt; &nbsp; File "test_mpi.py", line 3, in &lt;module&gt;<br>
&gt; &nbsp; &nbsp; MPI.File.Open(comm," h5ex_d_alloc.h5")<br>
&gt; &nbsp; File "File.pyx", line 67, in mpi4py.MPI.File.Open (src/mpi4py.MPI.c:89639)<br>
&gt; mpi4py.MPI.Exception: MPI_ERR_OTHER: known error not in list<br>
&gt; --------------------------------------------------------------------------<br>
&gt; mpirun noticed that the job aborted, but has no info as to the process<br>
&gt; that caused that situation.<br>
&gt; --------------------------------------------------------------------------<br>
&gt;<br>
&gt; My mpirun version is (Open MPI) 1.6.2. I installed openmpi using the dorsal script (<a href="https://github.com/FEniCS/dorsal" target="_blank">https://github.com/FEniCS/dorsal</a>) for Redhat Enterprise 6 (OS I am using, release 6.5) . It configured the build as following :<br>


&gt;<br>
&gt; ./configure --enable-mpi-thread-multiple --enable-opal-multi-threads --with-threads=posix --disable-mpi-profile<br>
&gt;<br>
&gt; I need emphasize that I do not have root acces on the system I am running my application.<br>
&gt;<br>
&gt; Imran<br>
&gt;<br>
&gt;<br>
&gt; _______________________________________________<br>
&gt; users mailing list<br>
&gt; <a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
<br>
<br>
--<br>
Jeff Squyres<br>
<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a><br>
For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
<br>
<br>
<br>
------------------------------<br>
<br>
Message: 5<br>
Date: Tue, 6 May 2014 15:32:21 +0200<br>
From: Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no" target="_blank">imranal@student.matnat.uio.no</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] MPI File Open does not work<br>
Message-ID: &lt;<a href="mailto:FA6DFFFF-6C66-4A47-84FC-148FB51CE162@math.uio.no" target="_blank">FA6DFFFF-6C66-4A47-84FC-148FB51CE162@math.uio.no</a>&gt;<br>
Content-Type: text/plain; charset=us-ascii<br>
<br>
<br>
6. mai 2014 kl. 14:56 skrev Jeff Squyres (jsquyres) &lt;<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a>&gt;:<br>
<br>
&gt; The thread support in the 1.6 series is not very good. &nbsp;You might try:<br>
&gt;<br>
&gt; - Upgrading to 1.6.5<br>
&gt; - Or better yet, upgrading to 1.8.1<br>
&gt;<br>
<br>
I will attempt that than. I read at<br>
<br>
<a href="http://www.open-mpi.org/faq/?category=building#install-overwrite" target="_blank">http://www.open-mpi.org/faq/?category=building#install-overwrite</a><br>
<br>
that I should completely uninstall my previous version. Could you recommend to me how I can go about doing it (without root access).<br>
I am uncertain where I can use make uninstall.<br>
<br>
Imran<br>
<br>
&gt;<br>
&gt; On May 6, 2014, at 7:24 AM, Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no" target="_blank">imranal@student.matnat.uio.no</a>&gt; wrote:<br>
&gt;<br>
&gt;&gt; I get the following error when I try to run the following python code<br>
&gt;&gt;<br>
&gt;&gt; import mpi4py.MPI as MPI<br>
&gt;&gt; comm = &nbsp;MPI.COMM_WORLD<br>
&gt;&gt; MPI.File.Open(comm,"some.file")<br>
&gt;&gt;<br>
&gt;&gt; $ mpirun -np 1 python test_mpi.py<br>
&gt;&gt; Traceback (most recent call last):<br>
&gt;&gt; &nbsp;File "test_mpi.py", line 3, in &lt;module&gt;<br>
&gt;&gt; &nbsp; &nbsp;MPI.File.Open(comm," h5ex_d_alloc.h5")<br>
&gt;&gt; &nbsp;File "File.pyx", line 67, in mpi4py.MPI.File.Open (src/mpi4py.MPI.c:89639)<br>
&gt;&gt; mpi4py.MPI.Exception: MPI_ERR_OTHER: known error not in list<br>
&gt;&gt; --------------------------------------------------------------------------<br>
&gt;&gt; mpirun noticed that the job aborted, but has no info as to the process<br>
&gt;&gt; that caused that situation.<br>
&gt;&gt; --------------------------------------------------------------------------<br>
&gt;&gt;<br>
&gt;&gt; My mpirun version is (Open MPI) 1.6.2. I installed openmpi using the dorsal script (<a href="https://github.com/FEniCS/dorsal" target="_blank">https://github.com/FEniCS/dorsal</a>) for Redhat Enterprise 6 (OS I am using, release 6.5) . It configured the build as following :<br>


&gt;&gt;<br>
&gt;&gt; ./configure --enable-mpi-thread-multiple --enable-opal-multi-threads --with-threads=posix --disable-mpi-profile<br>
&gt;&gt;<br>
&gt;&gt; I need emphasize that I do not have root acces on the system I am running my application.<br>
&gt;&gt;<br>
&gt;&gt; Imran<br>
&gt;&gt;<br>
&gt;&gt;<br>
&gt;&gt; _______________________________________________<br>
&gt;&gt; users mailing list<br>
&gt;&gt; <a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
&gt;&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
&gt;<br>
&gt;<br>
&gt; --<br>
&gt; Jeff Squyres<br>
&gt; <a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a><br>
&gt; For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
&gt;<br>
&gt; _______________________________________________<br>
&gt; users mailing list<br>
&gt; <a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
<br>
<br>
<br>
------------------------------<br>
<br>
Message: 6<br>
Date: Tue, 6 May 2014 13:34:38 +0000<br>
From: "Jeff Squyres (jsquyres)" &lt;<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] MPI File Open does not work<br>
Message-ID: &lt;<a href="mailto:2A933C0E-80F6-4DED-B44C-53B5F37EFC0C@cisco.com" target="_blank">2A933C0E-80F6-4DED-B44C-53B5F37EFC0C@cisco.com</a>&gt;<br>
Content-Type: text/plain; charset="us-ascii"<br>
<br>
On May 6, 2014, at 9:32 AM, Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no" target="_blank">imranal@student.matnat.uio.no</a>&gt; wrote:<br>
<br>
&gt; I will attempt that than. I read at<br>
&gt;<br>
&gt; <a href="http://www.open-mpi.org/faq/?category=building#install-overwrite" target="_blank">http://www.open-mpi.org/faq/?category=building#install-overwrite</a><br>
&gt;<br>
&gt; that I should completely uninstall my previous version.<br>
<br>
Yes, that is best. &nbsp;OR: you can install into a whole separate tree and ignore the first installation.<br>
<br>
&gt; Could you recommend to me how I can go about doing it (without root access).<br>
&gt; I am uncertain where I can use make uninstall.<br>
<br>
If you don't have write access into the installation tree (i.e., it was installed via root and you don't have root access), then your best bet is simply to install into a new tree. &nbsp;E.g., if OMPI is installed into /opt/openmpi-1.6.2, try installing into /opt/openmpi-1.6.5, or even $HOME/installs/openmpi-1.6.5, or something like that.<br>


<br>
--<br>
Jeff Squyres<br>
<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a><br>
For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
<br>
<br>
<br>
------------------------------<br>
<br>
Message: 7<br>
Date: Tue, 6 May 2014 15:40:34 +0200<br>
From: Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no" target="_blank">imranal@student.matnat.uio.no</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] MPI File Open does not work<br>
Message-ID: &lt;<a href="mailto:14F0596C-C5C5-4B1A-A4A8-8849D44AB76A@math.uio.no" target="_blank">14F0596C-C5C5-4B1A-A4A8-8849D44AB76A@math.uio.no</a>&gt;<br>
Content-Type: text/plain; charset=us-ascii<br>
<br>
<br>
6. mai 2014 kl. 15:34 skrev Jeff Squyres (jsquyres) &lt;<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a>&gt;:<br>
<br>
&gt; On May 6, 2014, at 9:32 AM, Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no" target="_blank">imranal@student.matnat.uio.no</a>&gt; wrote:<br>
&gt;<br>
&gt;&gt; I will attempt that than. I read at<br>
&gt;&gt;<br>
&gt;&gt; <a href="http://www.open-mpi.org/faq/?category=building#install-overwrite" target="_blank">http://www.open-mpi.org/faq/?category=building#install-overwrite</a><br>
&gt;&gt;<br>
&gt;&gt; that I should completely uninstall my previous version.<br>
&gt;<br>
&gt; Yes, that is best. &nbsp;OR: you can install into a whole separate tree and ignore the first installation.<br>
&gt;<br>
&gt;&gt; Could you recommend to me how I can go about doing it (without root access).<br>
&gt;&gt; I am uncertain where I can use make uninstall.<br>
&gt;<br>
&gt; If you don't have write access into the installation tree (i.e., it was installed via root and you don't have root access), then your best bet is simply to install into a new tree. &nbsp;E.g., if OMPI is installed into /opt/openmpi-1.6.2, try installing into /opt/openmpi-1.6.5, or even $HOME/installs/openmpi-1.6.5, or something like that.<br>


<br>
My install was in my user directory (i.e $HOME). I managed to locate the source directory and successfully run make uninstall.<br>
<br>
Will let you know how things went after installation.<br>
<br>
Imran<br>
<br>
&gt;<br>
&gt; --<br>
&gt; Jeff Squyres<br>
&gt; <a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a><br>
&gt; For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
&gt;<br>
&gt; _______________________________________________<br>
&gt; users mailing list<br>
&gt; <a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
<br>
<br>
<br>
------------------------------<br>
<br>
Message: 8<br>
Date: Tue, 6 May 2014 14:42:52 +0000<br>
From: "Jeff Squyres (jsquyres)" &lt;<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] MPI File Open does not work<br>
Message-ID: &lt;<a href="mailto:710E3328-EDAA-4A13-9F07-B45FE319113D@cisco.com" target="_blank">710E3328-EDAA-4A13-9F07-B45FE319113D@cisco.com</a>&gt;<br>
Content-Type: text/plain; charset="us-ascii"<br>
<br>
On May 6, 2014, at 9:40 AM, Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no" target="_blank">imranal@student.matnat.uio.no</a>&gt; wrote:<br>
<br>
&gt; My install was in my user directory (i.e $HOME). I managed to locate the source directory and successfully run make uninstall.<br>
<br>
<br>
FWIW, I usually install Open MPI into its own subdir. &nbsp;E.g., $HOME/installs/openmpi-x.y.z. &nbsp;Then if I don't want that install any more, I can just "rm -rf $HOME/installs/openmpi-x.y.z" -- no need to "make uninstall". &nbsp;Specifically: if there's nothing else installed in the same tree as Open MPI, you can just rm -rf its installation tree.<br>


<br>
--<br>
Jeff Squyres<br>
<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a><br>
For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
<br>
<br>
<br>
------------------------------<br>
<br>
Message: 9<br>
Date: Tue, 6 May 2014 14:50:34 +0000<br>
From: "Jeff Squyres (jsquyres)" &lt;<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] users Digest, Vol 2879, Issue 1<br>
Message-ID: &lt;<a href="mailto:C60AA7E1-96A7-4CCD-9B5B-11A38FB87772@cisco.com" target="_blank">C60AA7E1-96A7-4CCD-9B5B-11A38FB87772@cisco.com</a>&gt;<br>
Content-Type: text/plain; charset="us-ascii"<br>
<br>
Are you using TCP as the MPI transport?<br>
<br>
If so, another thing to try is to limit the IP interfaces that MPI uses for its traffic to see if there's some kind of problem with specific networks.<br>
<br>
For example:<br>
<br>
&nbsp; &nbsp;mpirun --mca btl_tcp_if_include eth0 ...<br>
<br>
If that works, then try adding in any/all other IP interfaces that you have on your machines.<br>
<br>
A sorta-wild guess: you have some IP interfaces that aren't working, or at least, don't work in the way that OMPI wants them to work. &nbsp;So the first barrier works because it flows across eth0 (or some other first network that, as far as OMPI is concerned, works just fine). &nbsp;But then the next barrier round-robin advances to the next IP interface, and it doesn't work for some reason.<br>


<br>
We've seen virtual machine bridge interfaces cause problems, for example. &nbsp;E.g., if a machine has a Xen virtual machine interface (vibr0, IIRC?), then OMPI will try to use it to communicate with peer MPI processes because it has a "compatible" IP address, and OMPI think it should be connected/reachable to peers. &nbsp;If this is the case, you might want to disable such interfaces and/or use btl_tcp_if_include or btl_tcp_if_exclude to select the interfaces that you want to use.<br>


<br>
Pro tip: if you use btl_tcp_if_exclude, remember to exclude the loopback interface, too. &nbsp;OMPI defaults to a btl_tcp_if_include="" (blank) and btl_tcp_if_exclude="lo0". So if you override btl_tcp_if_exclude, you need to be sure to *also* include lo0 in the new value. &nbsp;For example:<br>


<br>
&nbsp; &nbsp;mpirun --mca btl_tcp_if_exclude lo0,virb0 ...<br>
<br>
Also, if possible, try upgrading to Open MPI 1.8.1.<br>
<br>
<br>
<br>
On May 4, 2014, at 2:15 PM, Clay Kirkland &lt;<a href="mailto:clay.kirkland@versityinc.com" target="_blank">clay.kirkland@versityinc.com</a>&gt; wrote:<br>
<br>
&gt; &nbsp;I am configuring with all defaults. &nbsp; Just doing a ./configure and then<br>
&gt; make and make install. &nbsp; I have used open mpi on several kinds of<br>
&gt; unix &nbsp;systems this way and have had no trouble before. &nbsp; I believe I<br>
&gt; last had success on a redhat version of linux.<br>
&gt;<br>
&gt;<br>
&gt; On Sat, May 3, 2014 at 11:00 AM, &lt;<a href="mailto:users-request@open-mpi.org" target="_blank">users-request@open-mpi.org</a>&gt; wrote:<br>
&gt; Send users mailing list submissions to<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; <a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
&gt;<br>
&gt; To subscribe or unsubscribe via the World Wide Web, visit<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
&gt; or, via email, send a message with subject or body 'help' to<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; <a href="mailto:users-request@open-mpi.org" target="_blank">users-request@open-mpi.org</a><br>
&gt;<br>
&gt; You can reach the person managing the list at<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; <a href="mailto:users-owner@open-mpi.org" target="_blank">users-owner@open-mpi.org</a><br>
&gt;<br>
&gt; When replying, please edit your Subject line so it is more specific<br>
&gt; than "Re: Contents of users digest..."<br>
&gt;<br>
&gt;<br>
&gt; Today's Topics:<br>
&gt;<br>
&gt; &nbsp; &nbsp;1. MPI_Barrier hangs on second attempt but only when multiple<br>
&gt; &nbsp; &nbsp; &nbsp; hosts used. (Clay Kirkland)<br>
&gt; &nbsp; &nbsp;2. Re: MPI_Barrier hangs on second attempt but only when<br>
&gt; &nbsp; &nbsp; &nbsp; multiple hosts used. (Ralph Castain)<br>
&gt;<br>
&gt;<br>
&gt; ----------------------------------------------------------------------<br>
&gt;<br>
&gt; Message: 1<br>
&gt; Date: Fri, 2 May 2014 16:24:04 -0500<br>
&gt; From: Clay Kirkland &lt;<a href="mailto:clay.kirkland@versityinc.com" target="_blank">clay.kirkland@versityinc.com</a>&gt;<br>
&gt; To: <a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
&gt; Subject: [OMPI users] MPI_Barrier hangs on second attempt but only<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; when &nbsp; &nbsp;multiple hosts used.<br>
&gt; Message-ID:<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;CAJDnjA8Wi=FEjz6Vz+Bc34b+nFE=<a href="mailto:TF4B7g0BQgMbeKg7H-pV%2BA@mail.gmail.com" target="_blank">TF4B7g0BQgMbeKg7H-pV+A@mail.gmail.com</a>&gt;<br>
&gt; Content-Type: text/plain; charset="utf-8"<br>
&gt;<br>
&gt; I have been using MPI for many many years so I have very well debugged mpi<br>
&gt; tests. &nbsp; I am<br>
&gt; having trouble on either openmpi-1.4.5 &nbsp;or &nbsp;openmpi-1.6.5 versions though<br>
&gt; with getting the<br>
&gt; MPI_Barrier calls to work. &nbsp; It works fine when I run all processes on one<br>
&gt; machine but when<br>
&gt; I run with two or more hosts the second call to MPI_Barrier always hangs.<br>
&gt; Not the first one,<br>
&gt; but always the second one. &nbsp; I looked at FAQ's and such but found nothing<br>
&gt; except for a comment<br>
&gt; that MPI_Barrier problems were often problems with fire walls. &nbsp;Also<br>
&gt; mentioned as a problem<br>
&gt; was not having the same version of mpi on both machines. &nbsp;I turned<br>
&gt; firewalls off and removed<br>
&gt; and reinstalled the same version on both hosts but I still see the same<br>
&gt; thing. &nbsp; I then installed<br>
&gt; lam mpi on two of my machines and that works fine. &nbsp; I can call the<br>
&gt; MPI_Barrier function when run on<br>
&gt; one of two machines by itself &nbsp;many times with no hangs. &nbsp;Only hangs if two<br>
&gt; or more hosts are involved.<br>
&gt; These runs are all being done on CentOS release 6.4. &nbsp; Here is test program<br>
&gt; I used.<br>
&gt;<br>
&gt; main (argc, argv)<br>
&gt; int argc;<br>
&gt; char **argv;<br>
&gt; {<br>
&gt; &nbsp; &nbsp; char message[20];<br>
&gt; &nbsp; &nbsp; char hoster[256];<br>
&gt; &nbsp; &nbsp; char nameis[256];<br>
&gt; &nbsp; &nbsp; int fd, i, j, jnp, iret, myrank, np, ranker, recker;<br>
&gt; &nbsp; &nbsp; MPI_Comm comm;<br>
&gt; &nbsp; &nbsp; MPI_Status status;<br>
&gt;<br>
&gt; &nbsp; &nbsp; MPI_Init( &amp;argc, &amp;argv );<br>
&gt; &nbsp; &nbsp; MPI_Comm_rank( MPI_COMM_WORLD, &amp;myrank);<br>
&gt; &nbsp; &nbsp; MPI_Comm_size( MPI_COMM_WORLD, &amp;np);<br>
&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; gethostname(hoster,256);<br>
&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; printf(" In rank %d and host= %s &nbsp;Do Barrier call<br>
&gt; 1.\n",myrank,hoster);<br>
&gt; &nbsp; &nbsp; MPI_Barrier(MPI_COMM_WORLD);<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; printf(" In rank %d and host= %s &nbsp;Do Barrier call<br>
&gt; 2.\n",myrank,hoster);<br>
&gt; &nbsp; &nbsp; MPI_Barrier(MPI_COMM_WORLD);<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; printf(" In rank %d and host= %s &nbsp;Do Barrier call<br>
&gt; 3.\n",myrank,hoster);<br>
&gt; &nbsp; &nbsp; MPI_Barrier(MPI_COMM_WORLD);<br>
&gt; &nbsp; &nbsp; MPI_Finalize();<br>
&gt; &nbsp; &nbsp; exit(0);<br>
&gt; }<br>
&gt;<br>
&gt; &nbsp; Here are three runs of test program. &nbsp;First with two processes on one<br>
&gt; host, then with<br>
&gt; two processes on another host, and finally with one process on each of two<br>
&gt; hosts. &nbsp;The<br>
&gt; first two runs are fine but the last run hangs on the second MPI_Barrier.<br>
&gt;<br>
&gt; [root@centos MPI]# /usr/local/bin/mpirun -np 2 --host centos a.out<br>
&gt; &nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 1.<br>
&gt; &nbsp;In rank 1 and host= centos &nbsp;Do Barrier call 1.<br>
&gt; &nbsp;In rank 1 and host= centos &nbsp;Do Barrier call 2.<br>
&gt; &nbsp;In rank 1 and host= centos &nbsp;Do Barrier call 3.<br>
&gt; &nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 2.<br>
&gt; &nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 3.<br>
&gt; [root@centos MPI]# /usr/local/bin/mpirun -np 2 --host RAID a.out<br>
&gt; /root/.bashrc: line 14: unalias: ls: not found<br>
&gt; &nbsp;In rank 0 and host= RAID &nbsp;Do Barrier call 1.<br>
&gt; &nbsp;In rank 0 and host= RAID &nbsp;Do Barrier call 2.<br>
&gt; &nbsp;In rank 0 and host= RAID &nbsp;Do Barrier call 3.<br>
&gt; &nbsp;In rank 1 and host= RAID &nbsp;Do Barrier call 1.<br>
&gt; &nbsp;In rank 1 and host= RAID &nbsp;Do Barrier call 2.<br>
&gt; &nbsp;In rank 1 and host= RAID &nbsp;Do Barrier call 3.<br>
&gt; [root@centos MPI]# /usr/local/bin/mpirun -np 2 --host centos,RAID a.out<br>
&gt; /root/.bashrc: line 14: unalias: ls: not found<br>
&gt; &nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 1.<br>
&gt; &nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 2.<br>
&gt; In rank 1 and host= RAID &nbsp;Do Barrier call 1.<br>
&gt; &nbsp;In rank 1 and host= RAID &nbsp;Do Barrier call 2.<br>
&gt;<br>
&gt; &nbsp; Since it is such a simple test and problem and such a widely used MPI<br>
&gt; function, it must obviously<br>
&gt; be an installation or configuration problem. &nbsp; A pstack for each of the<br>
&gt; hung MPI_Barrier processes<br>
&gt; on the two machines shows this:<br>
&gt;<br>
&gt; [root@centos ~]# pstack 31666<br>
&gt; #0 &nbsp;0x0000003baf0e8ee3 in __epoll_wait_nocancel () from /lib64/libc.so.6<br>
&gt; #1 &nbsp;0x00007f5de06125eb in epoll_dispatch () from /usr/local/lib/libmpi.so.1<br>
&gt; #2 &nbsp;0x00007f5de061475a in opal_event_base_loop () from<br>
&gt; /usr/local/lib/libmpi.so.1<br>
&gt; #3 &nbsp;0x00007f5de0639229 in opal_progress () from /usr/local/lib/libmpi.so.1<br>
&gt; #4 &nbsp;0x00007f5de0586f75 in ompi_request_default_wait_all () from<br>
&gt; /usr/local/lib/libmpi.so.1<br>
&gt; #5 &nbsp;0x00007f5ddc59565e in ompi_coll_tuned_sendrecv_actual () from<br>
&gt; /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; #6 &nbsp;0x00007f5ddc59d8ff in ompi_coll_tuned_barrier_intra_two_procs () from<br>
&gt; /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; #7 &nbsp;0x00007f5de05941c2 in PMPI_Barrier () from /usr/local/lib/libmpi.so.1<br>
&gt; #8 &nbsp;0x0000000000400a43 in main ()<br>
&gt;<br>
&gt; [root@RAID openmpi-1.6.5]# pstack 22167<br>
&gt; #0 &nbsp;0x00000030302e8ee3 in __epoll_wait_nocancel () from /lib64/libc.so.6<br>
&gt; #1 &nbsp;0x00007f7ee46885eb in epoll_dispatch () from /usr/local/lib/libmpi.so.1<br>
&gt; #2 &nbsp;0x00007f7ee468a75a in opal_event_base_loop () from<br>
&gt; /usr/local/lib/libmpi.so.1<br>
&gt; #3 &nbsp;0x00007f7ee46af229 in opal_progress () from /usr/local/lib/libmpi.so.1<br>
&gt; #4 &nbsp;0x00007f7ee45fcf75 in ompi_request_default_wait_all () from<br>
&gt; /usr/local/lib/libmpi.so.1<br>
&gt; #5 &nbsp;0x00007f7ee060b65e in ompi_coll_tuned_sendrecv_actual () from<br>
&gt; /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; #6 &nbsp;0x00007f7ee06138ff in ompi_coll_tuned_barrier_intra_two_procs () from<br>
&gt; /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; #7 &nbsp;0x00007f7ee460a1c2 in PMPI_Barrier () from /usr/local/lib/libmpi.so.1<br>
&gt; #8 &nbsp;0x0000000000400a43 in main ()<br>
&gt;<br>
&gt; &nbsp;Which looks exactly the same on each machine. &nbsp;Any thoughts or ideas would<br>
&gt; be greatly appreciated as<br>
&gt; I am stuck.<br>
&gt;<br>
&gt; &nbsp;Clay Kirkland<br>
&gt; -------------- next part --------------<br>
&gt; HTML attachment scrubbed and removed<br>
&gt;<br>
&gt; ------------------------------<br>
&gt;<br>
&gt; Message: 2<br>
&gt; Date: Sat, 3 May 2014 06:39:20 -0700<br>
&gt; From: Ralph Castain &lt;<a href="mailto:rhc@open-mpi.org" target="_blank">rhc@open-mpi.org</a>&gt;<br>
&gt; To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br>
&gt; Subject: Re: [OMPI users] MPI_Barrier hangs on second attempt but only<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; when &nbsp; &nbsp;multiple hosts used.<br>
&gt; Message-ID: &lt;<a href="mailto:3CF53D73-15D9-40BB-A2DE-50BA3561A0F4@open-mpi.org" target="_blank">3CF53D73-15D9-40BB-A2DE-50BA3561A0F4@open-mpi.org</a>&gt;<br>
&gt; Content-Type: text/plain; charset="us-ascii"<br>
&gt;<br>
&gt; Hmmm...just testing on my little cluster here on two nodes, it works just fine with 1.8.2:<br>
&gt;<br>
&gt; [rhc@bend001 v1.8]$ mpirun -n 2 --map-by node ./a.out<br>
&gt; &nbsp;In rank 0 and host= bend001 &nbsp;Do Barrier call 1.<br>
&gt; &nbsp;In rank 0 and host= bend001 &nbsp;Do Barrier call 2.<br>
&gt; &nbsp;In rank 0 and host= bend001 &nbsp;Do Barrier call 3.<br>
&gt; &nbsp;In rank 1 and host= bend002 &nbsp;Do Barrier call 1.<br>
&gt; &nbsp;In rank 1 and host= bend002 &nbsp;Do Barrier call 2.<br>
&gt; &nbsp;In rank 1 and host= bend002 &nbsp;Do Barrier call 3.<br>
&gt; [rhc@bend001 v1.8]$<br>
&gt;<br>
&gt;<br>
&gt; How are you configuring OMPI?<br>
&gt;<br>
&gt;<br>
&gt; On May 2, 2014, at 2:24 PM, Clay Kirkland &lt;<a href="mailto:clay.kirkland@versityinc.com" target="_blank">clay.kirkland@versityinc.com</a>&gt; wrote:<br>
&gt;<br>
&gt; &gt; I have been using MPI for many many years so I have very well debugged mpi tests. &nbsp; I am<br>
&gt; &gt; having trouble on either openmpi-1.4.5 &nbsp;or &nbsp;openmpi-1.6.5 versions though with getting the<br>
&gt; &gt; MPI_Barrier calls to work. &nbsp; It works fine when I run all processes on one machine but when<br>
&gt; &gt; I run with two or more hosts the second call to MPI_Barrier always hangs. &nbsp; Not the first one,<br>
&gt; &gt; but always the second one. &nbsp; I looked at FAQ's and such but found nothing except for a comment<br>
&gt; &gt; that MPI_Barrier problems were often problems with fire walls. &nbsp;Also mentioned as a problem<br>
&gt; &gt; was not having the same version of mpi on both machines. &nbsp;I turned firewalls off and removed<br>
&gt; &gt; and reinstalled the same version on both hosts but I still see the same thing. &nbsp; I then installed<br>
&gt; &gt; lam mpi on two of my machines and that works fine. &nbsp; I can call the MPI_Barrier function when run on<br>
&gt; &gt; one of two machines by itself &nbsp;many times with no hangs. &nbsp;Only hangs if two or more hosts are involved.<br>
&gt; &gt; These runs are all being done on CentOS release 6.4. &nbsp; Here is test program I used.<br>
&gt; &gt;<br>
&gt; &gt; main (argc, argv)<br>
&gt; &gt; int argc;<br>
&gt; &gt; char **argv;<br>
&gt; &gt; {<br>
&gt; &gt; &nbsp; &nbsp; char message[20];<br>
&gt; &gt; &nbsp; &nbsp; char hoster[256];<br>
&gt; &gt; &nbsp; &nbsp; char nameis[256];<br>
&gt; &gt; &nbsp; &nbsp; int fd, i, j, jnp, iret, myrank, np, ranker, recker;<br>
&gt; &gt; &nbsp; &nbsp; MPI_Comm comm;<br>
&gt; &gt; &nbsp; &nbsp; MPI_Status status;<br>
&gt; &gt;<br>
&gt; &gt; &nbsp; &nbsp; MPI_Init( &amp;argc, &amp;argv );<br>
&gt; &gt; &nbsp; &nbsp; MPI_Comm_rank( MPI_COMM_WORLD, &amp;myrank);<br>
&gt; &gt; &nbsp; &nbsp; MPI_Comm_size( MPI_COMM_WORLD, &amp;np);<br>
&gt; &gt;<br>
&gt; &gt; &nbsp; &nbsp; &nbsp; &nbsp; gethostname(hoster,256);<br>
&gt; &gt;<br>
&gt; &gt; &nbsp; &nbsp; &nbsp; &nbsp; printf(" In rank %d and host= %s &nbsp;Do Barrier call 1.\n",myrank,hoster);<br>
&gt; &gt; &nbsp; &nbsp; MPI_Barrier(MPI_COMM_WORLD);<br>
&gt; &gt; &nbsp; &nbsp; &nbsp; &nbsp; printf(" In rank %d and host= %s &nbsp;Do Barrier call 2.\n",myrank,hoster);<br>
&gt; &gt; &nbsp; &nbsp; MPI_Barrier(MPI_COMM_WORLD);<br>
&gt; &gt; &nbsp; &nbsp; &nbsp; &nbsp; printf(" In rank %d and host= %s &nbsp;Do Barrier call 3.\n",myrank,hoster);<br>
&gt; &gt; &nbsp; &nbsp; MPI_Barrier(MPI_COMM_WORLD);<br>
&gt; &gt; &nbsp; &nbsp; MPI_Finalize();<br>
&gt; &gt; &nbsp; &nbsp; exit(0);<br>
&gt; &gt; }<br>
&gt; &gt;<br>
&gt; &gt; &nbsp; Here are three runs of test program. &nbsp;First with two processes on one host, then with<br>
&gt; &gt; two processes on another host, and finally with one process on each of two hosts. &nbsp;The<br>
&gt; &gt; first two runs are fine but the last run hangs on the second MPI_Barrier.<br>
&gt; &gt;<br>
&gt; &gt; [root@centos MPI]# /usr/local/bin/mpirun -np 2 --host centos a.out<br>
&gt; &gt; &nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 1.<br>
&gt; &gt; &nbsp;In rank 1 and host= centos &nbsp;Do Barrier call 1.<br>
&gt; &gt; &nbsp;In rank 1 and host= centos &nbsp;Do Barrier call 2.<br>
&gt; &gt; &nbsp;In rank 1 and host= centos &nbsp;Do Barrier call 3.<br>
&gt; &gt; &nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 2.<br>
&gt; &gt; &nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 3.<br>
&gt; &gt; [root@centos MPI]# /usr/local/bin/mpirun -np 2 --host RAID a.out<br>
&gt; &gt; /root/.bashrc: line 14: unalias: ls: not found<br>
&gt; &gt; &nbsp;In rank 0 and host= RAID &nbsp;Do Barrier call 1.<br>
&gt; &gt; &nbsp;In rank 0 and host= RAID &nbsp;Do Barrier call 2.<br>
&gt; &gt; &nbsp;In rank 0 and host= RAID &nbsp;Do Barrier call 3.<br>
&gt; &gt; &nbsp;In rank 1 and host= RAID &nbsp;Do Barrier call 1.<br>
&gt; &gt; &nbsp;In rank 1 and host= RAID &nbsp;Do Barrier call 2.<br>
&gt; &gt; &nbsp;In rank 1 and host= RAID &nbsp;Do Barrier call 3.<br>
&gt; &gt; [root@centos MPI]# /usr/local/bin/mpirun -np 2 --host centos,RAID a.out<br>
&gt; &gt; /root/.bashrc: line 14: unalias: ls: not found<br>
&gt; &gt; &nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 1.<br>
&gt; &gt; &nbsp;In rank 0 and host= centos &nbsp;Do Barrier call 2.<br>
&gt; &gt; In rank 1 and host= RAID &nbsp;Do Barrier call 1.<br>
&gt; &gt; &nbsp;In rank 1 and host= RAID &nbsp;Do Barrier call 2.<br>
&gt; &gt;<br>
&gt; &gt; &nbsp; Since it is such a simple test and problem and such a widely used MPI function, it must obviously<br>
&gt; &gt; be an installation or configuration problem. &nbsp; A pstack for each of the hung MPI_Barrier processes<br>
&gt; &gt; on the two machines shows this:<br>
&gt; &gt;<br>
&gt; &gt; [root@centos ~]# pstack 31666<br>
&gt; &gt; #0 &nbsp;0x0000003baf0e8ee3 in __epoll_wait_nocancel () from /lib64/libc.so.6<br>
&gt; &gt; #1 &nbsp;0x00007f5de06125eb in epoll_dispatch () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #2 &nbsp;0x00007f5de061475a in opal_event_base_loop () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #3 &nbsp;0x00007f5de0639229 in opal_progress () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #4 &nbsp;0x00007f5de0586f75 in ompi_request_default_wait_all () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #5 &nbsp;0x00007f5ddc59565e in ompi_coll_tuned_sendrecv_actual () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; &gt; #6 &nbsp;0x00007f5ddc59d8ff in ompi_coll_tuned_barrier_intra_two_procs () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; &gt; #7 &nbsp;0x00007f5de05941c2 in PMPI_Barrier () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #8 &nbsp;0x0000000000400a43 in main ()<br>
&gt; &gt;<br>
&gt; &gt; [root@RAID openmpi-1.6.5]# pstack 22167<br>
&gt; &gt; #0 &nbsp;0x00000030302e8ee3 in __epoll_wait_nocancel () from /lib64/libc.so.6<br>
&gt; &gt; #1 &nbsp;0x00007f7ee46885eb in epoll_dispatch () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #2 &nbsp;0x00007f7ee468a75a in opal_event_base_loop () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #3 &nbsp;0x00007f7ee46af229 in opal_progress () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #4 &nbsp;0x00007f7ee45fcf75 in ompi_request_default_wait_all () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #5 &nbsp;0x00007f7ee060b65e in ompi_coll_tuned_sendrecv_actual () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; &gt; #6 &nbsp;0x00007f7ee06138ff in ompi_coll_tuned_barrier_intra_two_procs () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; &gt; #7 &nbsp;0x00007f7ee460a1c2 in PMPI_Barrier () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #8 &nbsp;0x0000000000400a43 in main ()<br>
&gt; &gt;<br>
&gt; &gt; &nbsp;Which looks exactly the same on each machine. &nbsp;Any thoughts or ideas would be greatly appreciated as<br>
&gt; &gt; I am stuck.<br>
&gt; &gt;<br>
&gt; &gt; &nbsp;Clay Kirkland<br>
&gt; &gt;<br>
&gt; &gt;<br>
&gt; &gt;<br>
&gt; &gt;<br>
&gt; &gt; _______________________________________________<br>
&gt; &gt; users mailing list<br>
&gt; &gt; <a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
&gt; &gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
&gt;<br>
&gt; -------------- next part --------------<br>
&gt; HTML attachment scrubbed and removed<br>
&gt;<br>
&gt; ------------------------------<br>
&gt;<br>
&gt; Subject: Digest Footer<br>
&gt;<br>
&gt; _______________________________________________<br>
&gt; users mailing list<br>
&gt; <a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
&gt;<br>
&gt; ------------------------------<br>
&gt;<br>
&gt; End of users Digest, Vol 2879, Issue 1<br>
&gt; **************************************<br>
&gt;<br>
&gt; _______________________________________________<br>
&gt; users mailing list<br>
&gt; <a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
<br>
<br>
--<br>
Jeff Squyres<br>
<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a><br>
For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
<br>
<br>
<br>
------------------------------<br>
<br>
Subject: Digest Footer<br>
<br>
_______________________________________________<br>
users mailing list<br>
<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
<a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
<br>
------------------------------<br>
<br>
End of users Digest, Vol 2881, Issue 1<br>
**************************************<br>
</blockquote></div><br></div>
</div></div></blockquote></div><br></div>
_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users</blockquote></div><br></div></body></html>
