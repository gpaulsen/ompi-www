<html><head><meta http-equiv="Content-Type" content="text/html charset=us-ascii"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">&lt;laugh&gt; nothing that profound, I fear. Just the old man's brain continuing to itch over something while in that light sleep stage until the scratching gets enough that you realize the cause of the itch :-)<div><br></div><div><br><div><div>On Feb 14, 2014, at 2:59 AM, Reuti &lt;<a href="mailto:reuti@staff.uni-marburg.de">reuti@staff.uni-marburg.de</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div style="font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Am 14.02.2014 um 11:23 schrieb<span class="Apple-converted-space">&nbsp;</span><a href="mailto:tmishima@jcity.maeda.co.jp">tmishima@jcity.maeda.co.jp</a>:<br><br><blockquote type="cite">You've found it in the dream, interesting!<br></blockquote><br>It happens sometimes to get insights while dreaming:<br><br><a href="https://skeptics.stackexchange.com/questions/5317/was-the-periodic-table-discovered-in-a-dream-by-dmitri-mendeleyev">https://skeptics.stackexchange.com/questions/5317/was-the-periodic-table-discovered-in-a-dream-by-dmitri-mendeleyev</a><br><br>-- Reuti<br><br><br><blockquote type="cite">Tetsuya Mishima<br><br><blockquote type="cite">Thanks - hit me in the middle of the night over here that we had missed<br></blockquote>some options, but nice to find you had also seen it. Slightly modified<br>patch will be applied and brought over to 1.7.5<br><blockquote type="cite"><br><br>On Feb 13, 2014, at 10:16 PM, <a href="mailto:tmishima@jcity.maeda.co.jp">tmishima@jcity.maeda.co.jp</a> wrote:<br><br><blockquote type="cite"><br><br><br>Please try attached patch - from r30723.<br><br>(See attached file: patch.rmaps_base_frame.from_r30723)<br><br>Tetsuya Mishima<br><br><blockquote type="cite">Thanks for prompt help.<br>Could you please resent the patch as attachment which can be applied<br></blockquote></blockquote></blockquote>with<br><blockquote type="cite"><blockquote type="cite">"patch" command, my mail client messes long lines.<br><blockquote type="cite"><br><br>On Fri, Feb 14, 2014 at 7:40 AM, &nbsp;&lt;<a href="mailto:tmishima@jcity.maeda.co.jp">tmishima@jcity.maeda.co.jp</a>&gt;wrote:<br><br><br>Thanks. I'm not familiar with mindist mapper. But obviously<br>checking for ORTE_MAPPING_BYDIST is missing. In addition,<br>ORTE_MAPPING_PPR is missing again by my mistake.<br><br>Please try this patch.<br><br>if OPAL_HAVE_HWLOC<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYCORE == ORTE_GET_MAPPING_POLICY<br>(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_CORE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYL1CACHE ==<br></blockquote></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_L1CACHE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYL2CACHE ==<br></blockquote></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_L2CACHE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYL3CACHE ==<br></blockquote></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_L3CACHE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYSOCKET ==<br></blockquote></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_SOCKET);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYNUMA == ORTE_GET_MAPPING_POLICY<br>(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_NUMA);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYBOARD == ORTE_GET_MAPPING_POLICY<br>(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_BOARD);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYHWTHREAD ==<br></blockquote></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_HWTHREAD);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_PPR == ORTE_GET_MAPPING_POLICY<br>(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_SLOT);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYDIST == ORTE_GET_MAPPING_POLICY<br>(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_SLOT);<br>#endif<br><br>Tetsuya Mishima<br><br><blockquote type="cite">Hi,<br>after this patch we get this in jenkins:<br><br>07:03:15 [vegas12.mtr.labs.mlnx:01646] [[26922,0],0] ORTE_ERROR_LOG:<br></blockquote></blockquote>Not<br><blockquote type="cite">implemented in file rmaps_mindist_module.c at line 39107:03:15<br>[vegas12.mtr.labs.mlnx:01646] [[26922,0],0] ORTE_ERROR_LOG: Not<br><blockquote type="cite">implemented in file base/rmaps_base_map_job.c at line 285<br><br><br><br><br><br>On Fri, Feb 14, 2014 at 6:35 AM, &nbsp;&lt;<a href="mailto:tmishima@jcity.maeda.co.jp">tmishima@jcity.maeda.co.jp</a>&gt;wrote:<br><br><br>Sorry, one more shot - byslot was dropped!<br><br>&nbsp;&nbsp;if (NULL == spec) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* check for map-by object directives - we set the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* ranking to match if one was given<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ORTE_MAPPING_GIVEN &amp; ORTE_GET_MAPPING_DIRECTIVE(mapping))<br></blockquote></blockquote></blockquote></blockquote>{<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ORTE_MAPPING_BYSLOT == ORTE_GET_MAPPING_POLICY<br></blockquote></blockquote>(mapping))<br><blockquote type="cite">{<br><blockquote type="cite">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_SLOT);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYNODE == ORTE_GET_MAPPING_POLICY<br>(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_NODE);<br>#if OPAL_HAVE_HWLOC<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYCORE == ORTE_GET_MAPPING_POLICY<br>(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_CORE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYL1CACHE ==<br></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_L1CACHE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYL2CACHE ==<br></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_L2CACHE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYL3CACHE ==<br></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_L3CACHE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYSOCKET ==<br></blockquote></blockquote></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_SOCKET);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYNUMA == ORTE_GET_MAPPING_POLICY<br>(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_NUMA);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYBOARD ==<br></blockquote></blockquote></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_BOARD);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYHWTHREAD ==<br></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp, ORTE_RANK_BY_HWTHREAD);<br>#endif<br><br>Tetusya Mishima<br><br><blockquote type="cite">I've found it. Please add 2 lines(770, 771) in rmaps_base_frame.c:<br><br>747 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (NULL == spec) {<br>748 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* check for map-by object directives - we set the<br>749 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* ranking to match if one was given<br>750 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>751 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ORTE_MAPPING_GIVEN &amp; ORTE_GET_MAPPING_DIRECTIVE<br>(mapping)) {<br>752 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ORTE_MAPPING_BYCORE == ORTE_GET_MAPPING_POLICY<br>(mapping)) {<br>753 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote></blockquote></blockquote></blockquote>ORTE_RANK_BY_CORE);<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">754 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYNODE ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>755 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote></blockquote></blockquote></blockquote>ORTE_RANK_BY_NODE);<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">756 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYL1CACHE ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>757 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote>ORTE_RANK_BY_L1CACHE);<br><blockquote type="cite"><blockquote type="cite">758 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYL2CACHE ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>759 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote>ORTE_RANK_BY_L2CACHE);<br><blockquote type="cite"><blockquote type="cite">760 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYL3CACHE ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>761 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote>ORTE_RANK_BY_L3CACHE);<br><blockquote type="cite"><blockquote type="cite">762 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYSOCKET ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>763 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote></blockquote>ORTE_RANK_BY_SOCKET);<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">764 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYNUMA ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>765 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote></blockquote></blockquote></blockquote>ORTE_RANK_BY_NUMA);<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">766 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYBOARD ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>767 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote></blockquote>ORTE_RANK_BY_BOARD);<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">768 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYHWTHREAD ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>769 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br>ORTE_RANK_BY_HWTHREAD);<br>770 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_PPR ==<br></blockquote></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>771 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote></blockquote></blockquote></blockquote>ORTE_RANK_BY_SLOT);<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">772 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>Tetsuya Mishima<br><br><blockquote type="cite">You are welcome, Ralph.<br><br>But, after fixing it, I'm facing another problem whin I use ppr<br></blockquote></blockquote></blockquote>option:<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">[mishima@manage openmpi-1.7.4]$ mpirun -np 2 -map-by ppr:1:socket<br></blockquote>-bind-to<br><blockquote type="cite">socket -report-bindings ~/mis/openmpi/demos/m<br>yprog<br>[manage.cluster:28057] [[25570,0],0] ORTE_ERROR_LOG: Not<br></blockquote></blockquote></blockquote></blockquote>implemented<br><blockquote type="cite">in<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">file rmaps_ppr.c at line 389<br>[manage.cluster:28057] [[25570,0],0] ORTE_ERROR_LOG: Not<br></blockquote></blockquote></blockquote></blockquote>implemented<br><blockquote type="cite">in<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">file base/rmaps_base_map_job.c at line 285<br><br>I confirmed it worked when it reverted back.<br>I'm a little bit confused. Could you take a look?<br><br>Tetsuya Mishima<br><br><blockquote type="cite">Thanks - these used to be bitmaps, but changed when we started<br></blockquote></blockquote></blockquote>getting<br><blockquote type="cite">so<br><blockquote type="cite">many options. Sadly, they are very rarely used, so bugs like this<br></blockquote></blockquote></blockquote></blockquote>can<br><blockquote type="cite"><blockquote type="cite">go<br><blockquote type="cite"><blockquote type="cite">unnoticed for long times. Appreciate you taking such<br><blockquote type="cite">a close look at them.<br><br>Ralph<br><br>On Feb 13, 2014, at 4:55 PM, <a href="mailto:tmishima@jcity.maeda.co.jp">tmishima@jcity.maeda.co.jp</a> wrote:<br><br><blockquote type="cite"><br>Hi Ralph,<br><br>I would report one more finding in openmpi-1.7.5a1.<br><br>Because ORTE_MAPPING_BY...s are not a bit field expression,<br>at orte_rmaps_base_set_ranking_policy in rmaps_base_frame.c<br>you should not use "&amp;" to compare them:<br><br>747 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (NULL == spec) {<br>748 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* check for map-by object directives - we set<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>the<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">749 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* ranking to match if one was given<br>750 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>751 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ORTE_MAPPING_GIVEN &amp;<br></blockquote></blockquote></blockquote></blockquote></blockquote>ORTE_GET_MAPPING_DIRECTIVE<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>752 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ORTE_MAPPING_BYCORE ==<br></blockquote></blockquote></blockquote></blockquote>ORTE_GET_MAPPING_POLICY<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(mapping)) {<br>753 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote></blockquote>ORTE_RANK_BY_CORE);<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">754 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYNODE ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>755 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote></blockquote>ORTE_RANK_BY_NODE);<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">756 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYL1CACHE ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>757 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote>ORTE_RANK_BY_L1CACHE);<br><blockquote type="cite"><blockquote type="cite">758 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYL2CACHE ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>759 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote>ORTE_RANK_BY_L2CACHE);<br><blockquote type="cite"><blockquote type="cite">760 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYL3CACHE ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>761 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote>ORTE_RANK_BY_L3CACHE);<br><blockquote type="cite"><blockquote type="cite">762 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYSOCKET ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>763 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote>ORTE_RANK_BY_SOCKET);<br><blockquote type="cite"><blockquote type="cite">764 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYNUMA ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>765 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote></blockquote>ORTE_RANK_BY_NUMA);<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">766 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYBOARD ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>767 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br></blockquote></blockquote>ORTE_RANK_BY_BOARD);<br><blockquote type="cite"><blockquote type="cite">768 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (ORTE_MAPPING_BYHWTHREAD ==<br>ORTE_GET_MAPPING_POLICY(mapping)) {<br>769 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_SET_RANKING_POLICY(tmp,<br>ORTE_RANK_BY_HWTHREAD);<br>770 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>Regards,<br>Tetsuya Mishima<br><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br><br></blockquote><br></blockquote><br></blockquote></blockquote><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users_______________________________________________">http://www.open-mpi.org/mailman/listinfo.cgi/users_______________________________________________</a><br><br><blockquote type="cite"><blockquote type="cite"><br><blockquote type="cite"><br><blockquote type="cite">users mailing list<br>users@open-mpi.orghttp://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br>users@open-mpi.org<br><br></blockquote><br></blockquote></blockquote>http://www.open-mpi.org/mailman/listinfo.cgi/users_______________________________________________<br><br><blockquote type="cite"><blockquote type="cite"><br><blockquote type="cite">users mailing list<br>users@open-mpi.orghttp://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br></blockquote></blockquote>&lt;patch.rmaps_base_frame.from_r30723&gt;_______________________________________________<br><br><blockquote type="cite"><blockquote type="cite">users mailing list<br>users@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br>users@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br>users@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></div></blockquote></div><br></div></body></html>
