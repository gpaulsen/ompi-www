<div dir="ltr"><div><div><div><div>More investigation suggests its the use of -fopenmp (and also its new name -qopenmp) just to compile in OpenMP code, even if it is never executed<br><br>mpiexec -n 12 ./one_f_debug.exe<br></div>fails silently<br><br>mpiexec -n 2 ./one_f_debug.exe<br></div>has a segfault<br><br></div>Both the segfault and the reason why changing the process count suppresses it are still a mystery<br><br></div>John<br></div><div class="gmail_extra"><br><div class="gmail_quote">On 17 November 2014 16:41, John Bray <span dir="ltr">&lt;<a href="mailto:jbray@allinea.com" target="_blank">jbray@allinea.com</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr"><div><div><div><div><div>I have succesfully been using OpenMPI 1.8.3 compiled with Intel-14, using<br><br>./configure --prefix=/usr/local/mpi/$(basename $PWD) --with-threads=posix --enable-mpi-thread-multiple --disable-vt --with-scif=no<br><br></div>I have now switched to Intel 15.0.1, and configuring with the same options, I get minor changes in config.log about warning spotting, but it makes all the binaries, and I can compile my own fortran code with mpif90/mpicc<br><br>but a command &#39;mpiexec --verbose -n 12 ./fortran_binary&#39; does nothing<br><br></div>I checked the FAQ and started using<br><br>./configure --prefix=/usr/local/mpi/$(basename $PWD) --with-threads=posix --enable-mpi-thread-multiple --disable-vt --with-scif=no CC=icc CXX=icpc F77=ifort FC=ifort<br><br></div>but that makes no difference.<br><br></div>Only with -d do I get any more information<br><br>mpirun -d --verbose -n 12 /home/jbray/5.0/mic2/one/intel-15_openmpi-1.8.3/one_f_debug.exe <br>[mic2:21851] procdir: /tmp/openmpi-sessions-jbray@mic2_0/27642/0/0<br>[mic2:21851] jobdir: /tmp/openmpi-sessions-jbray@mic2_0/27642/0<br>[mic2:21851] top: openmpi-sessions-jbray@mic2_0<br>[mic2:21851] tmp: /tmp<br>[mic2:21851] sess_dir_cleanup: job session dir does not exist<br>[mic2:21851] procdir: /tmp/openmpi-sessions-jbray@mic2_0/27642/0/0<br>[mic2:21851] jobdir: /tmp/openmpi-sessions-jbray@mic2_0/27642/0<br>[mic2:21851] top: openmpi-sessions-jbray@mic2_0<br>[mic2:21851] tmp: /tmp<br>[mic2:21851] sess_dir_finalize: proc session dir does not exist<br></div>&lt;12 times&gt;<br><br><div><br>[mic2:21851] sess_dir_cleanup: job session dir does not exist<br>exiting with status 139<br><br></div><div>My C codes do not have this problem<br><br></div><div>Compiler options are<br></div><div><br>mpicxx -g -O0 -fno-inline-functions -openmp -o one_c_debug.exe async.c collective.c compute.c memory.c one.c openmp.c p2p.c variables.c auditmpi.c   control.c inout.c perfio.c ring.c wave.c io.c   leak.c mpiio.c pthreads.c -openmp -lpthread<br><br>mpif90 -g -O0  -fno-inline-functions -openmp -o one_f_debug.exe control.o io.f90 leak.f90 memory.f90 one.f90 ring.f90 slow.f90 swapbounds.f90 variables.f90 wave.f90 *.F90 -openmp<br><br></div><div>Any suggestions as to what is upsetting Fortran with Intel-15<span class="HOEnZb"><font color="#888888"><br><br></font></span></div><span class="HOEnZb"><font color="#888888"><div>John<br></div><div><br></div><div><br><br><div><div><br><br></div></div></div></font></span></div>
</blockquote></div><br></div>

