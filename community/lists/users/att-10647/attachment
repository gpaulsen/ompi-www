<table cellspacing="0" cellpadding="0" border="0" ><tr><td valign="top" style="font: inherit;">Hi Josh,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Thanks for the response. I am actually testing it on a single node (though in the near future i will run it on a set of nodes). Therefore, my application is running on the same machine as mpirun.<br>When I run the application and triggers the checkpointing mechanism from a seperate terminal, it checkpoints fine. <br><br>However, when I try to checkpoint it from within the main program as show below, it hangs.<br><br>kind regards,<br><br>Jean<br><br><br>--- On <b>Mon, 14/9/09, Josh Hursey <i>&lt;jjhursey@open-mpi.org&gt;</i></b> wrote:<br><blockquote style="border-left: 2px solid rgb(16, 16, 255); margin-left: 5px; padding-left: 5px;"><br>From: Josh Hursey &lt;jjhursey@open-mpi.org&gt;<br>Subject: Re: [OMPI users] Application hangs when checkpointing application (update)<br>To: "Open MPI
 Users" &lt;users@open-mpi.org&gt;<br>Date: Monday, 14 September, 2009, 1:27 PM<br><br><div class="plainMail">Is your application running on the same machine as mpirun?<br><br>How did you configure Open MPI? Note that is program will not work without the FT thread enabled, which would be one reason why it would seem to hang (since it is waiting for the application to enter the MPI library):<br>&nbsp; --enable-ft-thread --enable-mpi-threads<br><br>I do not think the message that you saw is related. Often orte_checkpoint cannot figure out the jobid on first contact with the HNP/mpirun process, so this is displayed as an INVALID handle.<br><br>-- Josh<br><br>On Sep 11, 2009, at 9:50 AM, Jean Potsam wrote:<br><br>&gt; <br>&gt; Hi Everyone,<br>&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;I noticed that it hangs just before displaying the following while trying to checkpoint the application.<br>&gt; <br>&gt;
 ############################<br>&gt; [sun06:15252] orte_checkpoint: notify_hnp: Requested a checkpoint of jobid [INVALID]<br>&gt; ###############################<br>&gt; <br>&gt; Can it be related to the above?<br>&gt; <br>&gt; Thanks<br>&gt; <br>&gt; <br>&gt; ----------------------------------------------------------------------------------------------------------------------<br>&gt; Hi Everyone,<br>&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;I wrote a small program with a function to trigger the checkpointing mechanism as follows:<br>&gt; <br>&gt; ############################################<br>&gt; <br>&gt; #include &lt;mpi.h&gt;<br>&gt; #include &lt;stdio.h&gt;<br>&gt; #include &lt;stdlib.h&gt;<br>&gt; #include &lt;unistd.h&gt;<br>&gt; #include &lt;signal.h&gt;<br>&gt; void trigger_checkpoint();<br>&gt; int main(int argc, char **argv)<br>&gt; {<br>&gt; int rank,size;<br>&gt; MPI_Init(&amp;argc,
 &amp;argv);<br>&gt; MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);<br>&gt; MPI_Comm_size(MPI_COMM_WORLD, &amp;size);<br>&gt; printf("I am processor no %d of a total of %d procs \n", rank, size);<br>&gt; system("sleep 10");<br>&gt; trigger_checkpoint();<br>&gt; printf("I am processor no %d of a total of %d procs \n", rank, size);<br>&gt; system("sleep 10");<br>&gt; printf("I am processor no %d of a total of %d procs \n", rank, size);<br>&gt; system("sleep 10");<br>&gt; printf("bye \n");<br>&gt; MPI_Finalize();<br>&gt; return 0;<br>&gt; }<br>&gt; <br>&gt; void trigger_checkpoint()<br>&gt; {<br>&gt;&nbsp;&nbsp;&nbsp;printf("hi\n");<br>&gt;&nbsp;&nbsp;&nbsp;system("ompi-checkpoint -v `pidof mpirun` ");<br>&gt; }<br>&gt; #############################################<br>&gt; <br>&gt; <br>&gt; The application works fine on my laptop with ubuntu as the OS. However, when I tried running it on one of the machines at my uni, with suse linux installed, the application
 hangs as soon as the ompi-checkpoint is triggered. This is what I get:<br>&gt; <br>&gt; <br>&gt; <br>&gt; ##########################################################<br>&gt; I am processor no 0 of a total of 1 procs<br>&gt; hi<br>&gt; I am processor no 0 of a total of 1 procs<br>&gt; [sun06:15426] orte_checkpoint: Checkpointing...<br>&gt; [sun06:15426]&nbsp; &nbsp; PID 15411<br>&gt; [sun06:15426]&nbsp; &nbsp; Connected to Mpirun [[12727,0],0]<br>&gt; [sun06:15426] orte_checkpoint: notify_hnp: Contact Head Node Process PID 15411<br>&gt; ###################################################<br>&gt; <br>&gt; does anyone has some ideas about this?<br>&gt; <br>&gt; Thanks a lot<br>&gt; <br>&gt; Jean.<br>&gt; <br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt; <a ymailto="mailto:users@open-mpi.org" href="/mc/compose?to=users@open-mpi.org">users@open-mpi.org</a><br>&gt; <a
 href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br><br>_______________________________________________<br>users mailing list<br><a ymailto="mailto:users@open-mpi.org" href="/mc/compose?to=users@open-mpi.org">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br></div></blockquote></td></tr></table><br>


      
