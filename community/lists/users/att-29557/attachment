<html><head><meta http-equiv="Content-Type" content="text/html charset=utf-8"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class="">Why donâ€™t you have your application look at the&nbsp;OMPI_COMM_WORLD_LOCAL_RANK envar, and then use that to calculate the offset location for your threads (i.e., local rank 0 is on socket 0, local rank 1 is on socket 1, etc.). You can then putenv the correct value of the GOMP envar<div class=""><br class=""><div class=""><br class=""><div><blockquote type="cite" class=""><div class="">On Jun 28, 2016, at 8:40 PM, Saliya Ekanayake &lt;<a href="mailto:esaliya@gmail.com" class="">esaliya@gmail.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><div class=""><div dir="ltr" class="">Hi,<div class=""><br class=""></div><div class="">I am trying to do something like below with OpenMPI and OpenMP (threads).</div><div class=""><br class=""></div><div class=""><span id="cid:ii_1559a3ab8f7ac698">&lt;image.png&gt;</span><br class=""></div><div class=""><br class=""></div><div class="">I was trying to use the explicit thread affinity with GOMP_CPU_AFFINITY environment&nbsp;variable as described here (<a href="https://gcc.gnu.org/onlinedocs/libgomp/GOMP_005fCPU_005fAFFINITY.html" class="">https://gcc.gnu.org/onlinedocs/libgomp/GOMP_005fCPU_005fAFFINITY.html</a>).&nbsp;</div><div class=""><br class=""></div><div class="">However, both P0 and P1 processes will read the same GOMP_CPU_AFFINITY and will place threads on the same set of cores.</div><div class=""><br class=""></div><div class="">Is there a way to overcome this and pass process specific affinity scheme to OpenMP when running with OpenMPI? For example, can I say T0 of P0 should be in Core 0, but T0 of P1 should be Core 4?</div><div class=""><br class=""></div><div class="">P.S. I can manually achieve this within the program using&nbsp;<b class="">sched_setaffinity()</b>, but that's not portable.</div><div class=""><br class=""></div><div class="">Thank you,</div><div class="">Saliya<br clear="all" class=""><div class=""><br class=""></div>-- <br class=""><div class="gmail_signature" data-smartmail="gmail_signature"><div dir="ltr" class=""><div class=""><div dir="ltr" class=""><div dir="ltr" class=""><div dir="ltr" class=""><span style="color:rgb(136,136,136)" class="">Saliya Ekanayake</span></div><div dir="ltr" class="">Ph.D. Candidate | Research Assistant</div><div dir="ltr" class="">School of Informatics and Computing | Digital Science Center</div><div dir="ltr" class="">Indiana University, Bloomington<br class=""><br class=""><font color="#888888" class=""></font></div></div></div></div></div></div>
</div></div>
_______________________________________________<br class="">users mailing list<br class=""><a href="mailto:users@open-mpi.org" class="">users@open-mpi.org</a><br class="">Subscription: https://www.open-mpi.org/mailman/listinfo.cgi/users<br class="">Link to this post: http://www.open-mpi.org/community/lists/users/2016/06/29556.php</div></blockquote></div><br class=""></div></div></body></html>
