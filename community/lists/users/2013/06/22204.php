<?
$subject_val = "Re: [OMPI users] Intel compiled undefined reference errors (i.e. mpi_reduce_)";
include("../../include/msg-header.inc");
?>
<!-- received="Mon Jun 24 14:57:14 2013" -->
<!-- isoreceived="20130624185714" -->
<!-- sent="Mon, 24 Jun 2013 13:56:38 -0500" -->
<!-- isosent="20130624185638" -->
<!-- name="Jason Maldonis" -->
<!-- email="maldonis_at_[hidden]" -->
<!-- subject="Re: [OMPI users] Intel compiled undefined reference errors (i.e. mpi_reduce_)" -->
<!-- id="CA+LevY+caToM8LyRL5bNt9iS_dqAD0WcmBmPOKPBbZTHC4H5gw_at_mail.gmail.com" -->
<!-- charset="windows-1252" -->
<!-- inreplyto="1182FB2B5679CE4B8BAD97725F014BB73281C390_at_FMSMSX104.amr.corp.intel.com" -->
<!-- expires="-1" -->
<div class="center">
<table border="2" width="100%" class="links">
<tr>
<th><a href="date.php">Date view</a></th>
<th><a href="index.php">Thread view</a></th>
<th><a href="subject.php">Subject view</a></th>
<th><a href="author.php">Author view</a></th>
</tr>
</table>
</div>
<p class="headers">
<strong>Subject:</strong> Re: [OMPI users] Intel compiled undefined reference errors (i.e. mpi_reduce_)<br>
<strong>From:</strong> Jason Maldonis (<em>maldonis_at_[hidden]</em>)<br>
<strong>Date:</strong> 2013-06-24 14:56:38
</p>
<ul class="links">
<!-- next="start" -->
<li><strong>Next message:</strong> <a href="22205.php">Mathieu Gontier: "[OMPI users] OpenMPI on Windows - policy"</a>
<li><strong>Previous message:</strong> <a href="22203.php">Elken, Tom: "Re: [OMPI users] Intel compiled undefined reference errors (i.e.	mpi_reduce_)"</a>
<li><strong>In reply to:</strong> <a href="22203.php">Elken, Tom: "Re: [OMPI users] Intel compiled undefined reference errors (i.e.	mpi_reduce_)"</a>
<!-- nextthread="start" -->
<!-- reply="end" -->
</ul>
<hr>
<!-- body="start" -->
<p>
Apologies if I am not supposed to respond that this worked, but it did!
<br>
<p>Thank you Tom! You saved me hours of work and I learned something
<br>
important. Now I have an executable!
<br>
<p>Best,
<br>
Jason
<br>
<p><p>On Mon, Jun 24, 2013 at 1:21 PM, Elken, Tom &lt;tom.elken_at_[hidden]&gt; wrote:
<br>
<p><span class="quotelev1">&gt;  I saw a couple of issues noted below &#133;****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; * *
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ******
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; Now I am still getting some undefined reference errors. Namely:****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; [root_at_odie 060911_rmc_eam_gr_vk_t4]# make****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ifort -g -debug all -check all -implicitnone -warn all -o rmc_test ran2.o
</span><br>
<span class="quotelev1">&gt; globals.o read_inputs.o model.o rmc_functions.o scattering_factors.o fem1.o
</span><br>
<span class="quotelev1">&gt; gr.o eam.o rmc_v_1_0.o  -L /export/apps/openmpi_intel_20130618/lib -lmpi**
</span><br>
<span class="quotelev1">&gt; **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *[Tom] *
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *From your makefile below, this compile command is generated by your
</span><br>
<span class="quotelev1">&gt; DEBUG target.  Fixes to the FC_DEBUG command noted below in your makefile&#133;
</span><br>
<span class="quotelev1">&gt; *
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ifort: warning #10182: disabling optimization; runtime debug checks enabled
</span><br>
<span class="quotelev1">&gt; ****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; fem1.o: In function `fem':****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; /state/partition1/home/jjmaldonis/Jinwoo/2011/060911_rmc_eam_gr_vk_t4/fem1.f90:583:
</span><br>
<span class="quotelev1">&gt; undefined reference to `mpi_reduce_'****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; /state/partition1/home/jjmaldonis/Jinwoo/2011/060911_rmc_eam_gr_vk_t4/fem1.f90:584:
</span><br>
<span class="quotelev1">&gt; undefined reference to `mpi_reduce_'****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; fem1.o: In function `fem_update':****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *[Tom] * &lt;snip&gt;****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; The above undefined reference errors are my problem.****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; Below are my PATH and LD_LIBRARY_PATH variables, if they are of help.****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; echo $PATH****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; /usr/lib64/qt-3.3/bin:/state/partition1/apps/intel_20130618/composer_xe_2013.3.163/bin/intel64:/state/partition1/apps/intel_20130618/composer_xe_2013.3.163/mpirt/bin/intel64:/state/partition1/apps/intel_20130618/composer_xe_2013.3.163/bin/intel64:/state/partition1/apps/intel_20130618/composer_xe_2013.3.163/bin/intel64_mic:/state/partition1/apps/intel_20130618/composer_xe_2013.3.163/debugger/gui/intel64:/export/apps/intel_20130618/advisor_xe_2013/bin64:/export/apps/intel_20130618/inspector_xe_2013/bin64:/export/apps/intel_20130618/vtune_amplifier_xe_2013/bin64:/usr/local/bin:/bin:/usr/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/opt/eclipse:/opt/ganglia/bin:/opt/ganglia/sbin:/usr/java/latest/bin:/opt/maven/bin:/export/apps/openmpi_intel_20130618/:/opt/pdsh/bin:/opt/rocks/bin:/opt/rocks/sbin:/opt/condor/bin:/opt/condor/sbin:/usr/local/samba/sbin:/opt/gridengine/bin/linux-x64:/export/apps/openmpi_intel_20130618/bin/:/usr/local/samba/sbin:/export/apps/openmpi_intel_20130618/bin/
</span><br>
<span class="quotelev1">&gt; ****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *[Tom] *
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *You should try to get*
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; /export/apps/openmpi_intel_20130618/bin ****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *earlier in your path, ahead of this part:*
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; /state/partition1/apps/intel_20130618/composer_xe_2013.3.163/mpirt/bin/intel64
</span><br>
<span class="quotelev1">&gt; ****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *which comes from the intel compilers &#145;compilervars.[c]sh&#146; script and
</span><br>
<span class="quotelev1">&gt; points to the Intel MPI run-time libraries (which you don&#146;t want, since you
</span><br>
<span class="quotelev1">&gt; are using Open MPI).*
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *Either that, or use a full path to your OpenMPI/Intel mpirun when you
</span><br>
<span class="quotelev1">&gt; are ready to run the app., such as: *
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; /export/apps/openmpi_intel_20130618/bin/mpirun &#133;. ./rmc_test**
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *[Tom] *&lt;snip&gt;****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; Below I will paste my makefile, and attached are the compressed
</span><br>
<span class="quotelev1">&gt; &quot;./configure ...&quot; and &quot;make all install&quot; command logs. Please let me know
</span><br>
<span class="quotelev1">&gt; anything else that you need.****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; #****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; # default makefile for ifort compiler with more or less****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; # appropriate options for debugging and high performance****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; #****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; # application name****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; APP = rmc_test****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; # list of source files****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; SRC = ran2.f90 globals.f90 read_inputs.f90 model.f90 rmc_functions.f90
</span><br>
<span class="quotelev1">&gt; scattering_factors.f90 fem1.f90 gr.f90 eam.f90 rmc_v_1_0.f90****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; # list of object files****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; OBJ = ran2.o globals.o read_inputs.o model.o rmc_functions.o
</span><br>
<span class="quotelev1">&gt; scattering_factors.o fem1.o gr.o eam.o rmc_v_1_0.o****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; # define libraries needed by the linker****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; LIBS = -L /export/apps/openmpi_intel_20130618/lib -lmpi****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *[Tom] *
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *Make this blank, so you will depend on &#145;mpif90&#146; to provide the linking
</span><br>
<span class="quotelev1">&gt; information:*
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *LIBS =*
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; * *
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; # -rpath
</span><br>
<span class="quotelev1">&gt; /state/partition1/apps/intel_20130618/composer_xe_2013.3.163/compiler/lib/
</span><br>
<span class="quotelev1">&gt; ****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; # compiler options for debugging****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; FC_DEBUG = ifort -g -debug all -check all -implicitnone -warn all****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *[Tom] You should make this more like your FC_OPT definition, using
</span><br>
<span class="quotelev1">&gt; mpif90 rather than ifort, such as:*
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *FC_DEBUG = mpif90 -g -debug all -check all -implicitnone -warn all*
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; *[Tom] Cheers, Tom*****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; # compiler options for optmized running****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; #FC_OPT = ifort -O3 -xO -ipo -no-prec-div -static****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; #FC_OPT = mpif90 -O3 -ipo -static****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; FC_OPT = mpif90 -O3****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; # build rules****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; .SUFFIXES: .f90 .o****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; .f90.o:****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt;         ${FC_DEBUG} -c $&lt;****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; debug: ${OBJ}****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt;         ${FC_DEBUG} -o ${APP} ${OBJ} ${LIBS}****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; opt: ${SRC}****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt;         ${FC_OPT} -o ${APP} ${SRC} ${LIBS}****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; ** **
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; clean:****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt;         rm -f *.mod *.o ${APP}****
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt;         ln -s /export/apps/openmpi_intel_20130618/lib/mpi.mod ./mpi.mod***
</span><br>
<span class="quotelev1">&gt; *
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt; _______________________________________________
</span><br>
<span class="quotelev1">&gt; users mailing list
</span><br>
<span class="quotelev1">&gt; users_at_[hidden]
</span><br>
<span class="quotelev1">&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a>
</span><br>
<span class="quotelev1">&gt;
</span><br>
<span class="quotelev1">&gt;
</span><br>
<p><hr>
<ul>
<li>text/html attachment: <a href="http://www.open-mpi.org/community/lists/users/att-22204/attachment">attachment</a>
</ul>
<!-- attachment="attachment" -->
<!-- body="end" -->
<hr>
<ul class="links">
<!-- next="start" -->
<li><strong>Next message:</strong> <a href="22205.php">Mathieu Gontier: "[OMPI users] OpenMPI on Windows - policy"</a>
<li><strong>Previous message:</strong> <a href="22203.php">Elken, Tom: "Re: [OMPI users] Intel compiled undefined reference errors (i.e.	mpi_reduce_)"</a>
<li><strong>In reply to:</strong> <a href="22203.php">Elken, Tom: "Re: [OMPI users] Intel compiled undefined reference errors (i.e.	mpi_reduce_)"</a>
<!-- nextthread="start" -->
<!-- reply="end" -->
</ul>
<div class="center">
<table border="2" width="100%" class="links">
<tr>
<th><a href="date.php">Date view</a></th>
<th><a href="index.php">Thread view</a></th>
<th><a href="subject.php">Subject view</a></th>
<th><a href="author.php">Author view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<? include("../../include/msg-footer.inc") ?>
