<html><head><meta http-equiv="Content-Type" content="text/html charset=iso-8859-1"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">The problem is with the tree-spawn nature of the rsh/ssh launcher. For scalability, mpirun only launches a first "layer" of daemons. Each of those daemons then launches another layer in a tree-like fanout. The default pattern is such that you first notice it when you have four nodes in your allocation.<div><br></div><div>You have two choices:</div><div><br></div><div>* you can just add the MCA param plm_rsh_no_tree_spawn=1 to your environment/cmd line</div><div><br></div><div>* you can resolve the tree spawn issue so that a daemon on one of your nodes is capable of ssh-ing a daemon on another node</div><div><br></div><div>Either way will work.</div><div>Ralph</div><div><br></div><div><br><div><div><div>On Apr 11, 2014, at 11:17 AM, Allan Wu &lt;<a href="mailto:allwu@cs.ucla.edu">allwu@cs.ucla.edu</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div dir="ltr"><div class="gmail_default" style="font-family:'trebuchet ms',sans-serif;font-size:small">Hello everyone,</div><div class="gmail_default" style="font-family:'trebuchet ms',sans-serif;font-size:small">

<br></div><div class="gmail_default" style="font-family:'trebuchet ms',sans-serif;font-size:small">I am running a simple helloworld program on several nodes using OpenMPI 1.8. Running commands on single node or small number of nodes are successful, but when I tried to run the same binary on four different nodes, problems occurred.&nbsp;</div>

<div class="gmail_default" style="font-family:'trebuchet ms',sans-serif;font-size:small"><br></div><div class="gmail_default" style="font-family:'trebuchet ms',sans-serif;font-size:small">I am using 'mpirun' command line like the following:</div>

<div class="gmail_default" style="font-family:'trebuchet ms',sans-serif;font-size:small"># mpirun --prefix /mnt/embedded_root/openmpi -np 4 --map-by node -hostfile hostfile ./helloworld</div><div class="gmail_default" style="font-family:'trebuchet ms',sans-serif;font-size:small">

<div class="gmail_default">And my hostfile looks something like these:</div><div class="gmail_default">10.0.0.16</div><div class="gmail_default">10.0.0.17</div><div class="gmail_default">10.0.0.18</div><div class="gmail_default">

10.0.0.19</div><div class="gmail_default"><br></div></div><div class="gmail_default" style="font-family:'trebuchet ms',sans-serif;font-size:small">When executing this command, it will result in an error message "sh: syntax error: unexpected word", and the program will deadlock. When I added "--debug-devel" the output is in the attachment "err_msg_0.txt". In the log, "fpga0" is the hostname of "10.0.0.16" and "fpga1" is for "10.0.0.17" and so on.</div>

<div class="gmail_default" style="font-family:'trebuchet ms',sans-serif;font-size:small"><br></div><div class="gmail_default" style="font-family:'trebuchet ms',sans-serif;font-size:small">However, the weird part is that after I remove one line in the hostfile, the problem goes away. It does not matter which host I remove, as long as there is less than four hosts, the program can execute without any problem.&nbsp;</div>

<div class="gmail_default"><div class="gmail_default"><br></div><div style="font-family:'trebuchet ms',sans-serif;font-size:small">I also tried using hostname in the hostfile, as:</div><div style="font-family:'trebuchet ms',sans-serif;font-size:small">

fpga0</div><div style="font-family:'trebuchet ms',sans-serif;font-size:small">fpga1</div><div style="font-family:'trebuchet ms',sans-serif;font-size:small">fpga2</div><div style="font-family:'trebuchet ms',sans-serif;font-size:small">

fpga3</div><div style="font-family:'trebuchet ms',sans-serif;font-size:small">And the same problem occurs, and the error message becomes "Host key verification failed.". I have setup public/private key pairs on all nodes, and each node can ssh to any node without problems. I also attached the message of --debug-devel as "err_msg_1.txt".&nbsp;</div>

<div style="font-family:'trebuchet ms',sans-serif;font-size:small"><br></div><div style="font-size:small"><font face="trebuchet ms, sans-serif">I'm running MPI programs on embedded ARM processors. I have previously posted questions on cross-compilation on the develop mailing list, which contains the setup I used. If you need the information please refer to <a href="http://www.open-mpi.org/community/lists/devel/2014/04/14440.php">http://www.open-mpi.org/community/lists/devel/2014/04/14440.php</a>, and the output of<span style="font-size:13px">&nbsp;</span><span style="font-size:13px">'ompi-info --all' is also attached with this email.</span></font></div>

<div style="font-family:'trebuchet ms',sans-serif;font-size:small"><br></div></div><div><div dir="ltr"><div class="gmail_default" style="font-family:'trebuchet ms',sans-serif;font-size:small">Please let me know if I need to provide more information. Thanks in advance!</div>

<div dir="ltr"><br></div><div class="gmail_default" style="font-family:'trebuchet ms',sans-serif;font-size:small">Regards,</div>--<br>Di Wu (Allan)<br>PhD student,&nbsp;<a href="http://vast.cs.ucla.edu/" target="_blank">VAST&nbsp;Laboratory</a>,<br>

Department of Computer Science, UC Los Angeles<br>Email: <a href="mailto:allwu@cs.ucla.edu" target="_blank">allwu@cs.ucla.edu</a><br></div></div>
</div>
<span>&lt;err_msg_0.txt&gt;</span><span>&lt;err_msg_1.txt&gt;</span><span>&lt;log.tar.gz&gt;</span>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users</blockquote></div><br></div></div></body></html>
