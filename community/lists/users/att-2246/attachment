<div>Brian</div>
<div>&nbsp;</div>
<div>But does it matter which core the process gets bound to? They are all identical, and as long as the task is parallelized in equal chunks (that's the key part), it should not matter. The last time I had to do this, the problem had to do with real-time processing of a very large radar image. My approach was to spawn *ONE* MPI process per blade and 12 threads (to utilize the 12 processors). Inside the task entry point of each pthread, I called sched_setaffinity(). Then I set the scheduling algorithm to real time with a very high task priority to avoid preemption. It turns out that the last two steps did not buy me much because ours was a lean, embedded architecture anyway, designed to run real-time applications, but I definitely got a speed up from the task distribution.
</div>
<div>&nbsp;</div>
<div>It sure would be very nice for openMPI to have this feature; no questions about that. All I am saying is: if a user wants it today, a reasonable workaround is available so he/she does not need to wait.</div>
<div>&nbsp;</div>
<div>This is my $0.01's worth, since I am probably a lot less experienced.</div>
<div>&nbsp;</div>
<div>Durga<br><br>&nbsp;</div>
<div><span class="gmail_quote">On 11/29/06, <b class="gmail_sendername">Brian W. Barrett</b> &lt;<a href="mailto:bbarrett@lanl.gov">bbarrett@lanl.gov</a>&gt; wrote:</span>
<blockquote class="gmail_quote" style="PADDING-LEFT: 1ex; MARGIN: 0px 0px 0px 0.8ex; BORDER-LEFT: #ccc 1px solid">It would be difficult to do well without some MPI help, in my<br>opinion.&nbsp;&nbsp;You certainly could use the Linux processor affinity API
<br>directly in the MPI application.&nbsp;&nbsp;But how would the process know<br>which core to bind to?&nbsp;&nbsp;It could wait until after MPI_INIT and call<br>MPI_COMM_RANK, but MPI implementations allocate many of their<br>resources during MPI_INIT, so there's high potential of the resources
<br>(ie, memory) ending up associated with a different processor than the<br>one the process gets pinned to.&nbsp;&nbsp;That isn't a big deal on Intel<br>machines, but is a major issue for AMD processors.<br><br>Just my $0.02, anyway.
<br><br>Brian<br><br>On Nov 28, 2006, at 6:09 PM, Durga Choudhury wrote:<br><br>&gt; Jeff (and everybody else)<br>&gt;<br>&gt; First of all, pardon me if this is a stupid comment; I am learning<br>&gt; the nuts-and-bolts of parallel programming; but my comment is as
<br>&gt; follows:<br>&gt;<br>&gt; Why can't this be done *outside* openMPI, by calling Linux's<br>&gt; processor affinity APIs directly? I work with a blade server kind<br>&gt; of archirecture, where each blade has 12 CPUs. I use pthread within
<br>&gt; each blade and MPI to talk across blades. I use the Linux system<br>&gt; calls to attach a thread to a specific CPU and it seems to work<br>&gt; fine. The only drawback is: it makes the code unportable to a<br>&gt; different OS. But even if you implemented paffinity within openMPI,
<br>&gt; the code will still be unportable to a different implementation of<br>&gt; MPI, which, as is, it is not.<br>&gt;<br>&gt; Hope this helps to the original poster.<br>&gt;<br>&gt; Durga<br>&gt;<br>&gt;<br>&gt; On 11/28/06, Jeff Squyres &lt;
<a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a>&gt; wrote: There is not,<br>&gt; right now.&nbsp;&nbsp;However, this is mainly because back when I<br>&gt; implemented the processor affinity stuff in OMPI (well over a year
<br>&gt; ago), no one had any opinions on exactly what interface to expose to<br>&gt; the use.&nbsp;&nbsp;:-)<br>&gt;<br>&gt; So right now there's only this lame control:<br>&gt;<br>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.open-mpi.org/faq/?category=tuning#using-paffinity">
http://www.open-mpi.org/faq/?category=tuning#using-paffinity</a><br>&gt;<br>&gt; I am not opposed to implementing more flexible processor affinity<br>&gt; controls, but the Big Discussion over the past few months is exactly
<br>&gt; how to expose it to the end user.&nbsp;&nbsp;There have been several formats<br>&gt; proposed (e.g., mpirun command line parameters, magic MPI attributes,<br>&gt; MCA parameters, etc.), but nothing that has been &quot;good&quot; and &quot;right&quot;.
<br>&gt; So here's the time to chime in -- anyone have any opinions on this?<br>&gt;<br>&gt;<br>&gt;<br>&gt; On Nov 25, 2006, at 9:31 AM, <a href="mailto:shaposh@isp.nsc.ru">shaposh@isp.nsc.ru</a> wrote:<br>&gt;<br>&gt; &gt; Hello,
<br>&gt; &gt; i cant figure out, is there a way with open-mpi to bind all<br>&gt; &gt; threads on a given node to a specified subset of CPUs.<br>&gt; &gt; For example, on a multi-socket multi-core machine, i want to use<br>
&gt; &gt; only a single core on each CPU.<br>&gt; &gt; Thank You.<br>&gt; &gt;<br>&gt; &gt; Best Regards,<br>&gt; &gt; Alexander Shaposhnikov<br>&gt; &gt; _______________________________________________<br>&gt; &gt; users mailing list
<br>&gt; &gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt; &gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>&gt;<br>&gt;<br>
&gt; --<br>&gt; Jeff Squyres<br>&gt; Server Virtualization Business Unit<br>&gt; Cisco Systems<br>&gt;<br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt; <a href="mailto:users@open-mpi.org">
users@open-mpi.org</a><br>&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>&gt;<br>&gt;<br>&gt;<br>&gt; --<br>&gt; Devil wanted omnipresence;<br>&gt; He therefore created communists.
<br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users
</a><br><br>--<br>&nbsp;&nbsp;Brian Barrett<br>&nbsp;&nbsp;Open MPI Team, CCS-1<br>&nbsp;&nbsp;Los Alamos National Laboratory<br><br><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org
</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br></blockquote></div><br><br clear="all"><br>-- <br>Devil wanted omnipresence;<br>He therefore created communists. 

