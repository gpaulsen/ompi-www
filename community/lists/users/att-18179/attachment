<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta name=Generator content="Microsoft Word 12 (filtered medium)"><!--[if !mso]><style>v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style><![endif]--><style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Futura Bk";
	panose-1:2 11 5 2 2 2 4 2 3 3;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Arial","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.yiv290640733msonormal, li.yiv290640733msonormal, div.yiv290640733msonormal
	{mso-style-name:yiv290640733msonormal;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	font-size:8.0pt;
	font-family:"Arial","sans-serif";}
span.yiv290640733msohyperlink
	{mso-style-name:yiv290640733msohyperlink;}
span.yiv290640733msohyperlinkfollowed
	{mso-style-name:yiv290640733msohyperlinkfollowed;}
span.yiv290640733emailstyle17
	{mso-style-name:yiv290640733emailstyle17;}
p.yiv290640733msonormal1, li.yiv290640733msonormal1, div.yiv290640733msonormal1
	{mso-style-name:yiv290640733msonormal1;
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Arial","sans-serif";}
span.yiv290640733msohyperlink1
	{mso-style-name:yiv290640733msohyperlink1;
	color:blue;
	text-decoration:underline;}
span.yiv290640733msohyperlinkfollowed1
	{mso-style-name:yiv290640733msohyperlinkfollowed1;
	color:purple;
	text-decoration:underline;}
span.yiv290640733emailstyle171
	{mso-style-name:yiv290640733emailstyle171;
	font-family:"Arial","sans-serif";
	color:windowtext;}
span.EmailStyle25
	{mso-style-type:personal-reply;
	font-family:"Futura Bk","sans-serif";
	color:#1F497D;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-size:10.0pt;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext="edit" spidmax="1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext="edit">
<o:idmap v:ext="edit" data="1" />
</o:shapelayout></xml><![endif]--></head><body lang=EN-US link=blue vlink=purple><div class=WordSection1><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Futura Bk","sans-serif";color:#1F497D'>Hi Devendra,<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Futura Bk","sans-serif";color:#1F497D'>thanks for your interesting answer, up to now I expected to get a fully operational openmpi installation package<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Futura Bk","sans-serif";color:#1F497D'>by installing openmpi from the “science” repository ( <a href="http://download.opensuse.org/repositories/science/openSUSE_11.3">http://download.opensuse.org/repositories/science/openSUSE_11.3</a>” ).<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Futura Bk","sans-serif";color:#1F497D'>To compile your script I need to have the openmpi sources which I do not have at present, I will try to get them.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Futura Bk","sans-serif";color:#1F497D'>How do I compile and build using multiple processors?<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Futura Bk","sans-serif";color:#1F497D'>Is there a special flag which tells the compiler to care for multiple CPUs?<o:p></o:p></span></p><div><p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span style='font-size:9.0pt;font-family:"Calibri","sans-serif";color:#1F497D'><br></span><span style='font-size:11.0pt;font-family:"Futura Bk","sans-serif";color:#1F497D'>Andre</span><span style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:#1F497D'><br><br></span><span style='font-size:10.0pt;font-family:"Calibri","sans-serif";color:#1F497D'><o:p></o:p></span></p></div><p class=MsoNormal><span style='font-size:11.0pt;font-family:"Futura Bk","sans-serif";color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0cm 0cm 0cm'><p class=MsoNormal><b><span style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'>From:</span></b><span style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'> users-bounces@open-mpi.org [mailto:users-bounces@open-mpi.org] <b>On Behalf Of </b>devendra rai<br><b>Sent:</b> Montag, 16. Januar 2012 13:25<br><b>To:</b> Open MPI Users<br><b>Subject:</b> Re: [OMPI users] mpirun hangs when used on more than 2 CPUs<o:p></o:p></span></p></div></div><p class=MsoNormal><o:p>&nbsp;</o:p></p><div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'>Hello Andre,<o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'><o:p>&nbsp;</o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'>It may be possible that your openmpi does not support threaded MPI-calls (if these are happening). I had a similar problem, and it was traced to this cause. If you installed your openmpi from available repositories, chances are that you do not have thread-support.<o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'><o:p>&nbsp;</o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'>Here's a small script that you can use to determine whether or not you have thread support:<o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:#0060BF'><o:p>&nbsp;</o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:#0060BF'>#include &lt;mpi.h&gt;<o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:#0060BF'>#include &lt;iostream&gt;<o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:#0060BF'>int main(int argc, char **argv)<br>{<br>&nbsp; int myrank;<br>&nbsp; int desired_thread_support = MPI_THREAD_MULTIPLE;<br>&nbsp; int provided_thread_support;<br><br>&nbsp; MPI_Init_thread(&amp;argc, &amp;argv, desired_thread_support, &amp;provided_thread_support);<br><br>&nbsp; /* check if the thread support has been provided */<br>&nbsp; if (provided_thread_support!=desired_thread_support)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; &quot;MPI thread support not available! Aborted. &quot; &lt;&lt; std::endl;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exit(-1);<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp; MPI_Finalize();<br>&nbsp; return 0;<br>}</span><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'><o:p>&nbsp;</o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'>Compile and build as usual, using multiple processors.<o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'><o:p>&nbsp;</o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'>Maybe this helps. If you do discover that you do not have support available, you will need to rebuild MPI with </span><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:#0000BF'>--enable-mpi-threads=yes</span><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'> flag.<o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'><o:p>&nbsp;</o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'>HTH.<o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'><o:p>&nbsp;</o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'><o:p>&nbsp;</o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'>Devendra<o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Verdana","sans-serif";color:black'><o:p>&nbsp;</o:p></span></p></div><div><div><div><div class=MsoNormal align=center style='text-align:center;background:white'><span style='font-size:10.0pt;color:black'><hr size=1 width="100%" align=center></span></div><p class=MsoNormal style='background:white'><b><span style='font-size:10.0pt;color:black'>From:</span></b><span style='font-size:10.0pt;color:black'> &quot;Theiner, Andre&quot; &lt;andre.theiner@hp.com&gt;<br><b>To:</b> &quot;users@open-mpi.org&quot; &lt;users@open-mpi.org&gt; <br><b>Sent:</b> Monday, 16 January 2012, 11:55<br><b>Subject:</b> [OMPI users] mpirun hangs when used on more than 2 CPUs</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p>&nbsp;</o:p></span></p><div id=yiv290640733><div><div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>&nbsp;</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>Hi everyone,</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>may I have your help on a strange problem?</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>High performance computing is new to me and I have not much idea about OpenMPI and OpenFoam (OF) which uses the “mpirun” command.</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>I have to support the OF application in my company and have been trying to find the problem since about 1 week.</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>The versions are openmpi-1.3.2 and OF 2.0.1 which are running on openSUSE 11.3 x86_64.</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>The computer is brand new, has 96 GB RAM, 12 CPUs and was installed with Linux some weeks ago.</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>I installed OF 2.0.1 according to the vendors instructions at <a href="http://www.openfoam.org/archive/2.0.1/download/suse.php" target="_blank">http://www.openfoam.org/archive/2.0.1/download/suse.php</a>.</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>&nbsp;</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>Here the problem:</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>The experienced user tested the OF with a test case out of one of the vendors tutorials.</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>He only used the computing power of his local machine “caelde04” , no other computers were accessed by mpirun.</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>&nbsp;</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>He found no problem when testing in single “processor mode” but in “multiprocessor mode” his calculations hangs when he distributes</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>the calculations to more than 2 CPUs. The OF vendor thinks this is an OpenMPI problem somehow and that is why I am trying to get</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>help from this forum here.</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;color:black'>I attached 2 files, one is the “decomposeParDict” which resides in the “system” subdirectory of his test case and the other is the log file</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='line-height:200%;background:white'><span style='font-size:12.0pt;line-height:200%;color:black'>from the “decomposePar” command and the mpirun command “mpirun -np 9 interFoam –parallel”.</span><span style='font-size:12.0pt;line-height:200%;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='line-height:200%;background:white'><span style='font-size:12.0pt;line-height:200%;color:black'>Do you have an idea where the problem is or how I can narrow it down?<br>Thanks much for any help.</span><span style='font-size:12.0pt;line-height:200%;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='margin-bottom:12.0pt;background:white'><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><br></span><span style='font-size:12.0pt;color:black'>Andre</span><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></p></div><div><p class=MsoNormal style='background:white'><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'>&nbsp;<o:p></o:p></span></p></div></div></div></div><p class=MsoNormal style='margin-bottom:12.0pt;background:white'><span style='font-size:12.0pt;font-family:"Times New Roman","serif";color:black'><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><o:p></o:p></span></p></div></div></div></div></body></html>