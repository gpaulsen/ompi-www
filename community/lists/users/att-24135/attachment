<html><head><meta http-equiv="Content-Type" content="text/html charset=windows-1252"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">Just add "-mca rmaps seq" to your command line, then. The mapper will take your hostfile (no rankfile) and map each proc sequentially to the listed nodes. You need to list each node once for each proc - something like this:<div><br></div><div>nodeA</div><div>nodeB</div><div>nodeB</div><div>nodeC</div><div>nodeA</div><div>nodeC</div><div>...</div><div><br></div><div>would produce your described pattern</div><div><br><div><br></div><div><br><div><div>On Apr 10, 2014, at 7:25 AM, Gan, Qi PW &lt;<a href="mailto:Qi.Gan2@pw.utc.com">Qi.Gan2@pw.utc.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div lang="EN-US" link="blue" vlink="purple" style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div class="WordSection1" style="page: WordSection1;"><div style="margin: 0in 0in 0.0001pt; font-size: 11pt; font-family: Calibri, sans-serif;">We have OMPI 1.4.0, 1.4.5 and 1.6.5 installed on our system.<o:p></o:p></div><p style="margin-right: 0in; margin-left: 0in; font-size: 12pt; font-family: 'Times New Roman', serif;"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;&gt;What version of OMPI are you using? We have a "seq" mapper that does what you want, but the precise cmd line option for directing to use it depends a bit on the version.<o:p></o:p></span></p><p style="margin-right: 0in; margin-left: 0in; font-size: 12pt; font-family: 'Times New Roman', serif;"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;&gt;On Apr 9, 2014, at 9:22 AM, Gan, Qi PW &lt;Qi.Gan2_at_[hidden]&gt; wrote:<o:p></o:p></span></p><p style="margin-right: 0in; margin-left: 0in; font-size: 12pt; font-family: 'Times New Roman', serif;"><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Hi,<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; I have a problem when setting the processes of a parallel job with specified order. Suppose a job with 6 processes (rank0 to rank5) needs to run on 3 hosts (A, B, C) with following order:<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Rank0 -- A<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Rank1 -- B<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Rank2 -- B<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Rank3 -- C<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Rank4 -- A<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Rank5 -- C<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Specifying this order (ABBCAC) in hostfile doesn’t work because Open MPI only supports “byslot” (AABBCC) or “bynode” (ABCABC) ranking orders.<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; However, if I use rankfile to implement this order in the format of<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; rank 0=A slot=&lt;slot setting&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; rank 0=B slot=&lt;slot setting&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; rank 0=B slot=&lt;slot setting&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; rank 0=C slot=&lt;slot setting&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; rank 0=A slot=&lt;slot setting&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; rank 0=C slot=&lt;slot setting&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; I run into another problem on how to determine the &lt;slot setting&gt; for each rank. If I bind each rank to all cores/CPUs on a node (e.g. rank 0=A slot=0-n, where n is the maximal CPU number), I run into the following errors:<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; *** An error occurred in MPI_comm_size<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; *** on a NULL communicator<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; *** Unknown error<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; *** MPI_ERRORS_ARE_FATAL (your MPI job will now abort)<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; forrtl: severe (174): SIGSEGV, segmentation fault occurred<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; If I don’t select all cores, I need to identify which cores are available to my job in order to avoid CPU oversubscribing since the nodes are shared by multiple jobs.<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Our system is the intel based cluster (12 or 16 cores per node) and the job is submitted by LSF batch submitter.<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Here is my question: how to implement a specified order of processes at node level without binding at core/cpu level?<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Any help and suggestions would be appreciated.<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Thanks,<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; Chee<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; _______________________________________________<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; users mailing list<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt; users_at_[hidden]<span class="Apple-converted-space">&nbsp;</span></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><br></span><span class="quotelev11" style="color: rgb(153, 0, 153);"><span style="font-size: 9pt; font-family: Verdana, sans-serif;">&gt;<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" style="color: purple; text-decoration: underline;">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></span></span><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><o:p></o:p></span></p><div style="margin: 0in 0in 0.0001pt; font-size: 11pt; font-family: Calibri, sans-serif;"><o:p>&nbsp;</o:p></div></div>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org" style="color: purple; text-decoration: underline;">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" style="color: purple; text-decoration: underline;">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></div></blockquote></div><br></div></div></body></html>
