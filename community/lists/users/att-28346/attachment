<div dir="ltr">Howard,<div><br></div><div>Welp. That worked! I&#39;m assuming oshmem = OpenSHMEM, right? If so, yeah, for now, not important on my wee workstation. (If it isn&#39;t, is it something I should work on getting to work?)</div><div><br></div><div>Matt</div></div><div class="gmail_extra"><br><div class="gmail_quote">On Fri, Jan 22, 2016 at 2:47 PM, Howard Pritchard <span dir="ltr">&lt;<a href="mailto:hppritcha@gmail.com" target="_blank">hppritcha@gmail.com</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr">HI Matt,<div><br></div><div>If you don&#39;t need oshmem, you could try again with --disable-oshmem added to the config line</div><div><br></div><div>Howard</div><div><br></div></div><div class="gmail_extra"><br><div class="gmail_quote"><div><div class="h5">2016-01-22 12:15 GMT-07:00 Matt Thompson <span dir="ltr">&lt;<a href="mailto:fortran@gmail.com" target="_blank">fortran@gmail.com</a>&gt;</span>:<br></div></div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div><div class="h5"><div dir="ltr">All,<div><br></div><div>I&#39;m trying to duplicate an issue I had with ESMF long ago (not sure if I reported it here or at ESMF, but...). It had been a while, so I started from scratch. I first built Open MPI 1.10.2 with Intel Fortran 16.0.0.109 and my system GCC (4.8.5 from RHEL7) with mostly defaults:</div><div><br></div><div><div><div># ./configure --disable-wrapper-rpath CC=gcc CXX=g++ FC=ifort \</div><div>#    CFLAGS=&#39;-fPIC -m64&#39; CXXFLAGS=&#39;-fPIC -m64&#39; FCFLAGS=&#39;-fPIC -m64&#39; \</div><div>#     --prefix=/ford1/share/gmao_SIteam/MPI/openmpi-1.10.2-ifort-16.0.0.109-shared | &amp; tee configure.intel16.0.0.109-shared.log</div></div><div><br></div><div>This built and checked just fine. Huzzah! And, indeed, it died in ESMF during a link in an odd way (ESMF is looking at it).</div><div><br></div><div>As a thought, I decided to see if building Open MPI statically might help or not. So, I tried to build Open MPI with:</div><div><br></div><div># ./configure --disable-shared --enable-static --disable-wrapper-rpath CC=gcc CXX=g++ FC=ifort \</div><div>#    CFLAGS=&#39;-fPIC -m64&#39; CXXFLAGS=&#39;-fPIC -m64&#39; FCFLAGS=&#39;-fPIC -m64&#39; \</div><div>#     --prefix=/ford1/share/gmao_SIteam/MPI/openmpi-1.10.2-ifort-16.0.0.109-static | &amp; tee configure.intel16.0.0.109-static.log</div><div><br></div><div>I just added --disable-shared --enable-static being lazy. But, when I do this, I get this (when built with make V=1):</div><div><br></div><div>Making all in tools/oshmem_info</div><div>make[2]: Entering directory `/ford1/share/gmao_SIteam/MPI/src/openmpi-1.10.2/oshmem/tools/oshmem_info&#39;</div><div>/bin/sh ../../../libtool  --tag=CC   --mode=link gcc -std=gnu99  -O3 -DNDEBUG -fPIC -m64 -finline-functions -fno-strict-aliasing -pthread   -o oshmem_info oshmem_info.o param.o ../../../ompi/<a href="http://libmpi.la" target="_blank">libmpi.la</a> ../../../oshmem/<a href="http://liboshmem.la" target="_blank">liboshmem.la</a> ../../../orte/<a href="http://libopen-rte.la" target="_blank">libopen-rte.la</a> ../../../opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a> -lrt -lm -lutil  </div><div>libtool: link: gcc -std=gnu99 -O3 -DNDEBUG -fPIC -m64 -finline-functions -fno-strict-aliasing -pthread -o oshmem_info oshmem_info.o param.o  ../../../ompi/.libs/libmpi.a ../../../oshmem/.libs/liboshmem.a /ford1/share/gmao_SIteam/MPI/src/openmpi-1.10.2/ompi/.libs/libmpi.a -libverbs /ford1/share/gmao_SIteam/MPI/src/openmpi-1.10.2/orte/.libs/libopen-rte.a ../../../orte/.libs/libopen-rte.a /ford1/share/gmao_SIteam/MPI/src/openmpi-1.10.2/opal/.libs/libopen-pal.a ../../../opal/.libs/libopen-pal.a -lnuma -ldl -lrt -lm -lutil -pthread</div><div>/usr/bin/ld: ../../../oshmem/.libs/liboshmem.a(memheap_base_static.o): undefined reference to symbol &#39;_end&#39;</div><div>/usr/bin/ld: note: &#39;_end&#39; is defined in DSO /lib64/libnl-route-3.so.200 so try adding it to the linker command line</div><div>/lib64/libnl-route-3.so.200: could not read symbols: Invalid operation</div><div>collect2: error: ld returned 1 exit status</div><div>make[2]: *** [oshmem_info] Error 1</div><div>make[2]: Leaving directory `/ford1/share/gmao_SIteam/MPI/src/openmpi-1.10.2/oshmem/tools/oshmem_info&#39;</div><div>make[1]: *** [all-recursive] Error 1</div><div>make[1]: Leaving directory `/ford1/share/gmao_SIteam/MPI/src/openmpi-1.10.2/oshmem&#39;</div><div>make: *** [all-recursive] Error 1</div><div><br></div><div>So, what did I do wrong? Or is there something I need to add to the configure line? I have built static versions of Open MPI in the past (say 1.8.7 era with Intel Fortran 15), but this is a new OS (RHEL 7 instead of 6) so I can see issues possible.</div><div><br></div><div>Anyone seen this before? As I said, the &quot;usual&quot; build way is just fine. Perhaps I need an extra RPM that isn&#39;t installed? I do have libnl-devel installed.</div><span><font color="#888888"><div><br></div><div>-- <br></div><div><div dir="ltr"><div><div dir="ltr"><div>Matt Thompson</div></div></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><div><div>Man Among Men</div></div></div><div><div><div>Fulcrum of History</div></div></div></blockquote></div></div>
</font></span></div></div>
<br></div></div>_______________________________________________<br>
users mailing list<br>
<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" rel="noreferrer" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
Link to this post: <a href="http://www.open-mpi.org/community/lists/users/2016/01/28344.php" rel="noreferrer" target="_blank">http://www.open-mpi.org/community/lists/users/2016/01/28344.php</a><br></blockquote></div><br></div>
<br>_______________________________________________<br>
users mailing list<br>
<a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" rel="noreferrer" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
Link to this post: <a href="http://www.open-mpi.org/community/lists/users/2016/01/28345.php" rel="noreferrer" target="_blank">http://www.open-mpi.org/community/lists/users/2016/01/28345.php</a><br></blockquote></div><br><br clear="all"><div><br></div>-- <br><div class="gmail_signature"><div dir="ltr"><div><div dir="ltr"><div>Matt Thompson</div></div></div><blockquote style="margin:0 0 0 40px;border:none;padding:0px"><div><div><div>Man Among Men</div></div></div><div><div><div>Fulcrum of History</div></div></div></blockquote></div></div>
</div>

