<font face="'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, sans-serif"><span style=" font-size:14px; font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><div><br></div><div>&nbsp; Hi&nbsp;</div><div><br></div><div>&nbsp; &nbsp; The following program deadlocks in mpi_finalize with OMPI 1.8.1 but works correctly with OMPI 1.6.5</div><div><br></div><div>&nbsp; &nbsp; Is there a work around?</div><div><br></div><div>&nbsp; Thanks</div><div><br></div><div>&nbsp;Jamil</div><div><br></div><div><div>program mpiio</div><div>use mpi</div><div>implicit none</div><div>integer(kind=4) :: iprov, fh, ierr</div><div>call mpi_init_thread(MPI_THREAD_SERIALIZED, iprov, ierr)</div><div>if (iprov &lt; MPI_THREAD_SERIALIZED) stop 'mpi_init_thread'</div><div>call mpi_file_open(MPI_COMM_WORLD, 'test.dat', &amp;</div><div>MPI_MODE_WRONLY + MPI_MODE_CREATE, MPI_INFO_NULL, fh, ierr)</div><div>call mpi_file_close(fh, ierr)</div><div>call mpi_finalize(ierr)</div><div>end program mpiio</div></div><div><br></div><div><div>(gdb) bt</div><div>#0 &nbsp;0x0000003155a0e054 in __lll_lock_wait () from /lib64/libpthread.so.0</div><div>#1 &nbsp;0x0000003155a09388 in _L_lock_854 () from /lib64/libpthread.so.0</div><div>#2 &nbsp;0x0000003155a09257 in pthread_mutex_lock () from /lib64/libpthread.so.0</div><div>#3 &nbsp;0x00007ffff7819f3c in ompi_attr_free_keyval () from /gpfs/thirdparty/zenotech/home/jappa/apps6.4/lib/libmpi.so.1</div><div>#4 &nbsp;0x00007ffff7857be1 in PMPI_Keyval_free () from /gpfs/thirdparty/zenotech/home/jappa/apps6.4/lib/libmpi.so.1</div><div>#5 &nbsp;0x00007ffff15b21f2 in ADIOI_End_call () from /gpfs/thirdparty/zenotech/home/jappa/apps6.4/lib/openmpi/mca_io_romio.so</div><div>#6 &nbsp;0x00007ffff781a325 in ompi_attr_delete_impl () from /gpfs/thirdparty/zenotech/home/jappa/apps6.4/lib/libmpi.so.1</div><div>#7 &nbsp;0x00007ffff781a4ec in ompi_attr_delete_all () from /gpfs/thirdparty/zenotech/home/jappa/apps6.4/lib/libmpi.so.1</div><div>#8 &nbsp;0x00007ffff7832ad5 in ompi_mpi_finalize () from /gpfs/thirdparty/zenotech/home/jappa/apps6.4/lib/libmpi.so.1</div><div>#9 &nbsp;0x00007ffff7b12e59 in pmpi_finalize__ () from /gpfs/thirdparty/zenotech/home/jappa/apps6.4/lib/libmpi_mpifh.so.2</div><div>#10 0x0000000000400b64 in mpiio () at t.f90:10</div><div>#11 0x0000000000400b9a in main ()</div><div>#12 0x000000315561ecdd in __libc_start_main () from /lib64/libc.so.6</div><div>#13 0x0000000000400a19 in _start ()</div></div></span></font>
