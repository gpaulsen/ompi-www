<HTML><BODY style="word-wrap: break-word; -khtml-nbsp-mode: space; -khtml-line-break: after-white-space; ">Feel free to correct me if im wrong.<DIV><BR class="khtml-block-placeholder"></DIV><DIV>OMPI assumes you have a fast network and checks for them.  If they are not found it falls back to tcp.  </DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>So if you leave out the --mca etc etc....   It should use the mx if its available.  Im not sure how MX responds  if one of the hosts does not have a working card (not activated)  because the mpi job will still run.  Just not using MX to that host.  All other hosts will us MX.   </DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>If openmpi sees that a node has more than one cpu (SMP)  It will use the sm (shared mem)  method to communicate over the mx.  and if a proc sends to its self,  the self method is used.  So its like a priority order.  </DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>I know there is a way (its in the archives)  to see the priority on how OMPI choses what method to use.  and uses the highest priority that will allow the communication to complete.</DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>I know there is also some magic being working on/implemented.  That will stripe over multiple networks for large messages when more bandwidth is needed.  I dont know if OMPI will have this ability or not.  Someone else can chime in on that.<BR><DIV> <SPAN class="Apple-style-span" style="border-collapse: separate; border-spacing: 0px 0px; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; text-align: auto; -khtml-text-decorations-in-effect: none; text-indent: 0px; -apple-text-size-adjust: auto; text-transform: none; orphans: 2; white-space: normal; widows: 2; word-spacing: 0px; "><SPAN class="Apple-style-span" style="border-collapse: separate; border-spacing: 0px 0px; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; text-align: auto; -khtml-text-decorations-in-effect: none; text-indent: 0px; -apple-text-size-adjust: auto; text-transform: none; orphans: 2; white-space: normal; widows: 2; word-spacing: 0px; "><DIV><BR class="khtml-block-placeholder"></DIV><DIV>Brock Palen</DIV><DIV>Center for Advanced Computing</DIV><DIV><A href="mailto:brockp@umich.edu">brockp@umich.edu</A></DIV><DIV>(734)936-1985</DIV><BR class="Apple-interchange-newline"></SPAN></SPAN> </DIV><BR><DIV><DIV>On Nov 21, 2006, at 11:28 PM, Iannetti, Anthony C. ((GRC-RTB0)) wrote:</DIV><BR class="Apple-interchange-newline"><BLOCKQUOTE type="cite"><O:SMARTTAGTYPE namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="PostalCode"> <O:SMARTTAGTYPE namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="State"> <O:SMARTTAGTYPE namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="City"> <O:SMARTTAGTYPE namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="PlaceType"> <O:SMARTTAGTYPE namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="PlaceName"> <O:SMARTTAGTYPE namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="place"> <DIV class="Section1"><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy">Dear OpenMPI List:<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal" style="text-indent:.5in"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size:10.0pt;font-family:Arial;color:navy">From looking at a recent thread, I see an mpirun command with shared memory and mx:<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy">mpirun –mca btl mx,sm,self –np 2 pi3f90.x<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy">This works.  I may have forgot to mention it, but I am using 1.1.2.  I see there is an –mca mtl in version 1.2b1 .  I do not think this exists in 1.1.2.<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy">Still, I would like to know what –mca is given automatically.<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy">Thanks,<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy">Tony<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy"><O:P> </O:P></SPAN></FONT></P> <DIV><P class="MsoAutoSig"><FONT size="3" color="navy" face="Times New Roman"><SPAN style="font-size:12.0pt;color:navy">Anthony C. Iannetti, P.E.<O:P></O:P></SPAN></FONT></P><P class="MsoAutoSig"><ST1:PLACE w:st="on"><ST1:PLACENAME w:st="on"><FONT size="3" color="navy" face="Times New Roman"><SPAN style="font-size:12.0pt;color:navy">NASA</SPAN></FONT></ST1:PLACENAME><FONT color="navy"><SPAN style="color:navy"> <ST1:PLACENAME w:st="on">Glenn</ST1:PLACENAME> <ST1:PLACENAME w:st="on">Research</ST1:PLACENAME> <ST1:PLACETYPE w:st="on">Center</ST1:PLACETYPE></SPAN></FONT></ST1:PLACE><FONT color="navy"><SPAN style="color:navy"><O:P></O:P></SPAN></FONT></P><P class="MsoAutoSig"><FONT size="3" color="navy" face="Times New Roman"><SPAN style="font-size:12.0pt;color:navy">Propulsion Systems Division, Combustion Branch<O:P></O:P></SPAN></FONT></P><P class="MsoAutoSig"><ST1:PLACE w:st="on"><ST1:CITY w:st="on"><FONT size="3" color="navy" face="Times New Roman"><SPAN style="font-size:12.0pt;color:navy">21000</SPAN></FONT></ST1:CITY><FONT color="navy"><SPAN style="color:navy"> Brookpark Road, <ST1:STATE w:st="on">MS</ST1:STATE></SPAN></FONT></ST1:PLACE><FONT color="navy"><SPAN style="color:navy"> 5-10<O:P></O:P></SPAN></FONT></P><P class="MsoAutoSig"><ST1:PLACE w:st="on"><ST1:CITY w:st="on"><FONT size="3" color="navy" face="Times New Roman"><SPAN style="font-size:12.0pt;color:navy">Cleveland</SPAN></FONT></ST1:CITY><FONT color="navy"><SPAN style="color:navy">, <ST1:STATE w:st="on">OH</ST1:STATE> <ST1:POSTALCODE w:st="on">44135</ST1:POSTALCODE></SPAN></FONT></ST1:PLACE><FONT color="navy"><SPAN style="color:navy"><O:P></O:P></SPAN></FONT></P><P class="MsoAutoSig"><FONT size="3" color="navy" face="Times New Roman"><SPAN style="font-size:12.0pt;color:navy">phone: (216)433-5586<O:P></O:P></SPAN></FONT></P><P class="MsoAutoSig"><FONT size="3" color="navy" face="Times New Roman"><SPAN style="font-size:12.0pt;color:navy">email: <A href="mailto:Anthony.C.Iannetti@nasa.gov">Anthony.C.Iannetti@nasa.gov</A><O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="3" color="navy" face="Times New Roman"><SPAN style="font-size:12.0pt;color:navy"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="3" color="navy" face="Times New Roman"><SPAN style="font-size:12.0pt;color:navy">Please note:  All opinions expressed in this message are my own and NOT of NASA.  Only the NASA Administrator can speak on behalf of NASA.<O:P></O:P></SPAN></FONT></P> </DIV><P class="MsoNormal"><FONT size="2" color="navy" face="Arial"><SPAN style="font-size: 10.0pt;font-family:Arial;color:navy"><O:P> </O:P></SPAN></FONT></P> <DIV> <DIV class="MsoNormal" align="center" style="text-align:center"><FONT size="3" face="Times New Roman"><SPAN style="font-size:12.0pt"> <HR size="2" width="100%" align="center" tabindex="-1"> </SPAN></FONT></DIV><P class="MsoNormal"><B><FONT size="2" face="Tahoma"><SPAN style="font-size:10.0pt; font-family:Tahoma;font-weight:bold">From:</SPAN></FONT></B><FONT size="2" face="Tahoma"><SPAN style="font-size:10.0pt;font-family:Tahoma"> Iannetti, Anthony C. (GRC-RTB0) <BR> <B><SPAN style="font-weight:bold">Sent:</SPAN></B> Tuesday, November 21, 2006 8:39 PM<BR> <B><SPAN style="font-weight:bold">To:</SPAN></B> '<A href="mailto:users@open-mpi.org">users@open-mpi.org</A>'<BR> <B><SPAN style="font-weight:bold">Subject:</SPAN></B> MX performance problem on two processor nodes</SPAN></FONT><O:P></O:P></P> </DIV><P class="MsoNormal"><FONT size="3" face="Times New Roman"><SPAN style="font-size: 12.0pt"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial">Dear OpenMPI List:<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial">            I am running the Myrinet MX btl with OpenMPI on MacOSX 10.4.  I am running into a problem.  When I run on one processor per node, OpenMPI runs just fine.   When I run on two processors per node (slots=2), it seems to take forever (something is hanging).<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial">Here is the command:<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial">mpirun –mca btl mx,self –np 2 pi3f90.x<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial">However, if I give the command:<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial">mpirun –np 2 pi3f90.x<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial">The process runs normally. But, I do not know if it is using the Myrinet network.  Is there a way to diagnose this problem.  mpirun –v and –d do not seem to indicate which mca is actually being used.<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial">Thanks,<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial">Tony<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="2" face="Arial"><SPAN style="font-size:10.0pt; font-family:Arial"><O:P> </O:P></SPAN></FONT></P><P class="MsoAutoSig"><FONT size="3" face="Times New Roman"><SPAN style="font-size: 12.0pt">Anthony C. Iannetti, P.E.<O:P></O:P></SPAN></FONT></P><P class="MsoAutoSig"><ST1:PLACE w:st="on"><ST1:PLACENAME w:st="on"><FONT size="3" face="Times New Roman"><SPAN style="font-size:12.0pt">NASA</SPAN></FONT></ST1:PLACENAME> <ST1:PLACENAME w:st="on">Glenn</ST1:PLACENAME> <ST1:PLACENAME w:st="on">Research</ST1:PLACENAME> <ST1:PLACETYPE w:st="on">Center</ST1:PLACETYPE></ST1:PLACE><O:P></O:P></P><P class="MsoAutoSig"><FONT size="3" face="Times New Roman"><SPAN style="font-size: 12.0pt">Propulsion Systems Division, Combustion Branch<O:P></O:P></SPAN></FONT></P><P class="MsoAutoSig"><ST1:PLACE w:st="on"><ST1:CITY w:st="on"><FONT size="3" face="Times New Roman"><SPAN style="font-size:12.0pt">21000</SPAN></FONT></ST1:CITY> Brookpark Road, <ST1:STATE w:st="on">MS</ST1:STATE></ST1:PLACE> 5-10<O:P></O:P></P><P class="MsoAutoSig"><ST1:PLACE w:st="on"><ST1:CITY w:st="on"><FONT size="3" face="Times New Roman"><SPAN style="font-size:12.0pt">Cleveland</SPAN></FONT></ST1:CITY>, <ST1:STATE w:st="on">OH</ST1:STATE> <ST1:POSTALCODE w:st="on">44135</ST1:POSTALCODE></ST1:PLACE><O:P></O:P></P><P class="MsoAutoSig"><FONT size="3" face="Times New Roman"><SPAN style="font-size: 12.0pt">phone: (216)433-5586<O:P></O:P></SPAN></FONT></P><P class="MsoAutoSig"><FONT size="3" face="Times New Roman"><SPAN style="font-size: 12.0pt">email: <A href="mailto:Anthony.C.Iannetti@nasa.gov">Anthony.C.Iannetti@nasa.gov</A><O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="3" face="Times New Roman"><SPAN style="font-size: 12.0pt"><O:P> </O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="3" face="Times New Roman"><SPAN style="font-size: 12.0pt">Please note:  All opinions expressed in this message are my own and NOT of NASA.  Only the NASA Administrator can speak on behalf of NASA.<O:P></O:P></SPAN></FONT></P><P class="MsoNormal"><FONT size="3" face="Times New Roman"><SPAN style="font-size: 12.0pt"><O:P> </O:P></SPAN></FONT></P> </DIV> </O:SMARTTAGTYPE></O:SMARTTAGTYPE></O:SMARTTAGTYPE></O:SMARTTAGTYPE></O:SMARTTAGTYPE></O:SMARTTAGTYPE><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">_______________________________________________</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">users mailing list</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><A href="mailto:users@open-mpi.org">users@open-mpi.org</A></DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><A href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</A></DIV> </BLOCKQUOTE></DIV><BR></DIV></BODY></HTML>
