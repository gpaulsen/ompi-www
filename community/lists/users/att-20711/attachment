On Tue, Nov 13, 2012 at 1:56 AM, 赵印 <span dir="ltr">&lt;<a href="mailto:yin_zhao@126.com" target="_blank">yin_zhao@126.com</a>&gt;</span> wrote:<br><div class="gmail_quote"><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
<div style="line-height:1.7;font-size:14px;font-family:arial"><p style="color:rgb(34,34,34);clear:both;vertical-align:baseline;line-height:18px;font-family:Arial,&#39;Liberation Sans&#39;,&#39;DejaVu Sans&#39;,sans-serif;margin:0px 0px 1em;word-wrap:break-word;border:0px;padding:0px">
I have a problem here.</p><p style="color:rgb(34,34,34);clear:both;vertical-align:baseline;line-height:18px;font-family:Arial,&#39;Liberation Sans&#39;,&#39;DejaVu Sans&#39;,sans-serif;margin:0px 0px 1em;word-wrap:break-word;border:0px;padding:0px">
My program runs perfectly in MPI version 1.6 series, but it would run into some problem in MPI version 1.4x series. <strong style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">Does MPI 1.4x version have a bug related in MPI_Recv.</strong></p>
<p>The log in Node[1] says that &quot;MPI_Recv in node[1] can not probe tag [11] from source[0]&quot;. But in node [0], the log says it Isend message with Tag [11] to dest [1].</p><p style="color:rgb(34,34,34);clear:both;vertical-align:baseline;line-height:18px;font-family:Arial,&#39;Liberation Sans&#39;,&#39;DejaVu Sans&#39;,sans-serif;margin:0px 0px 1em;word-wrap:break-word;border:0px;padding:0px">
</p><pre style="color:rgb(34,34,34);line-height:normal;margin-top:0px;margin-bottom:10px;padding:5px;border:0px;vertical-align:baseline;background-color:rgb(238,238,238);font-family:Consolas,Menlo,Monaco,&#39;Lucida Console&#39;,&#39;Liberation Mono&#39;,&#39;DejaVu Sans Mono&#39;,&#39;Bitstream Vera Sans Mono&#39;,&#39;Courier New&#39;,monospace,serif;overflow:auto;width:auto;max-height:600px">
<code><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent;color:rgb(43,145,175)">int</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent"> provided</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">;</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">

MPI_Init_thread</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">(&amp;</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">argc</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">,</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent"> </span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">&amp;</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">argv</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">,</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent"> MPI_THR!
 EAD_MULTIPLE</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">,</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent"> </span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">&amp;</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">provided</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">);</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">
</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent;color:rgb(0,0,139)">if</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent"> </span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">(</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">provided </span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">!=</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent"> MPI_THREAD_MULTIPLE</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">)</span><span>
</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">{</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">
   printf</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">(</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent;color:rgb(128,0,0)">&quot;Sorry, your MPI library does not provide MPI_THREAD_MULTIPLE\n&quot;</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">);</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">
   MPI_Abort</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">(</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">MPI_COMM_WORLD</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">,</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent"> </span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent;color:rgb(128,0,0)">0</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">);</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">
</span><span style="margin:0px;padding:0px;border:0px;vertical-align:baseline;background-color:transparent">}</span></code></pre><p style="color:rgb(34,34,34);font-family:arial,sans-serif;line-height:normal"></p><p style="color:rgb(34,34,34);clear:both;vertical-align:baseline;line-height:18px;font-family:Arial,&#39;Liberation Sans&#39;,&#39;DejaVu Sans&#39;,sans-serif;margin:0px 0px 1em;word-wrap:break-word;border:0px;padding:0px">
<b>Both of my 1.6x and 1.4x library do not support <span style="font-family:Consolas,Menlo,Monaco,&#39;Lucida Console&#39;,&#39;Liberation Mono&#39;,&#39;DejaVu Sans Mono&#39;,&#39;Bitstream Vera Sans Mono&#39;,&#39;Courier New&#39;,monospace,serif;background-color:rgb(238,238,238)">MPI_THREAD_MULTIPLE. Is this the reason? But why it runs perfect with 1.6x version. </span></b></p>
<p>Thanks very much for your help.</p><p style="color:rgb(34,34,34);clear:both;vertical-align:baseline;line-height:18px;font-family:Arial,&#39;Liberation Sans&#39;,&#39;DejaVu Sans&#39;,sans-serif;margin:0px 0px 1em;word-wrap:break-word;border:0px;padding:0px">
<br></p><p style="color:rgb(34,34,34);clear:both;vertical-align:baseline;line-height:18px;font-family:Arial,&#39;Liberation Sans&#39;,&#39;DejaVu Sans&#39;,sans-serif;margin:0px 0px 1em;word-wrap:break-word;border:0px;padding:0px">
Esaon </p></div><br><br></blockquote><div>You need to build openmpi by configuring it with the multi-threading flags.  Something like --enable-mpi-thread-multiple.  Most distributions ship openmpi built without these flags.</div>
<div><br></div><div>  Brian </div></div>

