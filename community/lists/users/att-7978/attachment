<table cellspacing="0" cellpadding="0" border="0" ><tr><td valign="top" style="font: inherit;">I'm trying to run a job based on openmpi.&nbsp; For some reason, the program and the global communicator are not in sync and it reads that there is only one processors, whereas, there should be 2 or more.&nbsp; Any advice on where to look?&nbsp; Here is my PBS script.&nbsp; Thanx!<br><br>PBS SCRIPT:<br>#!/bin/sh<br>### Set the job name<br>#PBS -N HH<br>### Declare myprogram non-rerunable<br>#PBS -r n<br>### Combine standard error and standard out to one file.<br>#PBS -j oe<br>### Have PBS mail you results<br>#PBS -m ae<br>#PBS -M tedhyu@wag.caltech.edu<br>### Set the queue name, given to you when you get a reservation.<br>#PBS -q workq<br>### Specify the number of cpus for your job.&nbsp; This example will run on 32 cpus<br>### using 8 nodes with 4 processes per node.<br>#PBS -l nodes=1:ppn=2,walltime=70:00:00<br># Switch to the working directory; by default
 PBS launches processes from your home directory.<br># Jobs should only be run from /home, /project, or /work; PBS returns results via NFS.<br>PBS_O_WORKDIR=/temp1/tedhyu/HH<br>export CODE=/project/source/seqquest/seqquest_source_v261j/hive_CentOS4.5_parallel/build_261j/quest_ompi.x<br><br>echo Working directory is $PBS_O_WORKDIR<br>mkdir -p $PBS_O_WORKDIR<br>cd $PBS_O_WORKDIR<br>rm -rf *<br>cp /ul/tedhyu/fuelcell/HOH/test/HH.in ./lcao.in<br>cp /ul/tedhyu/atom_pbe/* .<br>echo Running on host `hostname`<br>echo Time is `date`<br>echo Directory is `pwd`<br>echo This jobs runs on the following processors:<br>echo `cat $PBS_NODEFILE`<br>Number=`wc -l $PBS_NODEFILE | awk '{print $1}'`<br><br>export Number<br>echo ${Number}<br># Define number of processors<br>NPROCS=`wc -l &lt; $PBS_NODEFILE`<br># And the number or hosts<br>NHOSTS=`cat $PBS_NODEFILE|uniq|wc -l`<br>echo This job has allocated $NPROCS cpus<br>echo NHOSTS<br>#mpirun&nbsp; -machinefile
 $PBS_NODEFILE&nbsp; ${CODE} &gt;/ul/tedhyu/fuelcell/HOH/test/HH.out<br>#mpiexec -np 2&nbsp; ${CODE} &gt;/ul/tedhyu/fuelcell/HOH/test/HH.out<br>/opt/mpich-1.2.5.10-ch_p4-gcc/bin/mpirun -machinefile $PBS_NODEFILE -np $NPROCS ${CODE} &gt;/ul/tedhyu/fuelcell/HOH/test/HH.out<br>cd ..<br>rm -rf HH<br><br></td></tr></table><br>

      
