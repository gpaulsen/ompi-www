On Fri, Sep 11, 2009 at 6:35 PM, Doug Reeder <span dir="ltr">&lt;<a href="mailto:dlr@rain.org">dlr@rain.org</a>&gt;</span> wrote:<br><div class="gmail_quote"><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;">
<div style="word-wrap:break-word">Andreas,<div><br></div><div>Have you checked that ifort is creating 64 bit objects. If I remember correctly with 10.1 the default was to create 32 bit objects.</div><div><br></div></div></blockquote>
<div><br></div><div>I have not done so yet. I was under the impression that it was building 32-bit initially. Then when I ran configure without the -m64 option to CFLAGS and CXXFLAGS, I would get the following message:</div>
<div><br></div><div><div>*** Fortran 77 compiler</div><div>checking whether we are using the GNU Fortran 77 compiler... no</div><div>checking whether ifort accepts -g... yes</div><div>checking if Fortran 77 compiler works... yes</div>
<div>checking ifort external symbol convention... no underscore</div><div>checking if C and Fortran 77 are link compatible... no</div><div>**********************************************************************</div><div>It appears that your Fortran 77 compiler is unable to link against</div>
<div>object files created by your C compiler.  This typically indicates</div><div>one of a few possibilities:</div><div><br></div><div>  - A conflict between CFLAGS and FFLAGS</div><div>  - A problem with your compiler installation(s)</div>
<div>  - Different default build options between compilers (e.g., C</div><div>    building for 32 bit and Fortran building for 64 bit)</div><div>  - Incompatible compilers</div><div><br></div><div>Such problems can usually be solved by picking compatible compilers</div>
<div>and/or CFLAGS and FFLAGS.  More information (including exactly what</div><div>command was given to the compilers and what error resulted when the</div><div>commands were executed) is available in the config.log file in this</div>
<div>directory.</div><div>**********************************************************************</div><div><br></div><div>So I (naively) figured that it had to build 64-bit, added the flags, and ran configure successfully (or so I thought). I tried running ifort -V (as suggested by Warner Yuen in a follow-up email), but I just discovered that maybe something&#39;s messed up with my path since I get different results from an xterm and the Terminal. I will need to figure out what&#39;s going on here first... </div>
<div><div></div></div></div><div><br></div><div>Thanks,</div><div><br></div><div>Andreas</div><div> </div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;"><div style="word-wrap:break-word">
<div>Doug Reeder<br><div><div><div></div><div class="h5"><div>On Sep 11, 2009, at 3:25 PM, Andreas Haselbacher wrote:</div><br></div></div><blockquote type="cite"><div><div></div><div class="h5">On Fri, Sep 11, 2009 at 5:10 PM, Jeff Squyres <span dir="ltr">&lt;<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a>&gt;</span> wrote:<br>
<div class="gmail_quote"><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"> <div>On Sep 11, 2009, at 10:05 AM, Andreas Haselbacher wrote:<br> <br> <blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
 I&#39;ve built openmpi version 1.3.3 on a MacPro with OS X 10.5.8 and the Intel 10.1.006 Fortran compiler and gcc 4.0.  As far as I can tell, the configure and make commands completed fine. There are some warnings, but it&#39;s not clear to me that they are critical - or the explanation for what&#39;s not working. After installing, I try to compile a simple F77 hello world code. The output is:<br>
 <br> % mpif77 helloworld_mpi.f -o helloworld_mpi<br> ld: warning in /opt/openmpi/lib/libmpi_f77.a, file is not of required architecture<br> </blockquote> <br></div> This means that it skipped that library because it didn&#39;t match what you were trying to compile against.<br>
 <br> Can you send the output of mpif77 --showme?<div><br></div></blockquote><div><br></div><div>ifort -I/opt/openmpi/include -L/opt/openmpi/lib -lmpi_f77 -lmpi -lopen-rte -lopen-pal -lutil</div><div> </div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
 <div> <br> <blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"> Undefined symbols:<br>  &quot;_mpi_init_&quot;, referenced from:<br>      _MAIN__ in ifortIsUNoZ.o<br> </blockquote>
 <br></div> None of these symbols were found because libmpi_f77.a was skipped.<div><br></div></blockquote><div><br></div><div>Right.</div><div> </div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
 <div> <br> <blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"> Here&#39;s my configure command:<br> <br> ./configure --prefix=/opt/openmpi --enable-static --disable-shared CC=gcc CFLAGS=-m64 CXX=g++ CXXFLAGS=-m64 F77=ifort FC=ifort FFLAGS=-assume nounderscore FCFLAGS=-assume nounderscore<br>
 </blockquote> <br></div> I do not have the intel compilers for Mac; do they default to producing 64 bit objects?  I ask because it looks like you forced the C and C++ compilers to produce 64 bit objects -- do you need to do the same with ifort?  (via the FCFLAGS and FFLAGS env variables)<br>
 </blockquote><div><br></div><div>If I remember correctly, I had to add those flags, otherwise configure claimed that the compilers were not compatible. I can rerun configure if you suspect that this is an issue.  I did not add these flags to the Fortran variables because configure did not complain further, but I can see that this might be an issue. </div>
 <div> </div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"> <br> Also, did you quote the &quot;-assume nounderscore&quot; arguments to FFLAGS/FCFLAGS?  I.e., something like this:<br>
 <br>    &quot;FFLAGS=-assume nounderscore&quot;<br><font color="#888888"> <br></font></blockquote><div><br></div><div>Yes, I did. </div><div><br></div><div>Andreas</div><div> </div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
<font color="#888888"> -- <br> Jeff Squyres<br> <a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a><br> <br> </font></blockquote></div><br></div></div> _______________________________________________<br>
users mailing list<br><a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></blockquote>
</div><br></div></div><br>_______________________________________________<br>
users mailing list<br>
<a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
<a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br></blockquote></div><br>

