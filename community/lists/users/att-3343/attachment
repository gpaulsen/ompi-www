<HTML><BODY style="word-wrap: break-word; -khtml-nbsp-mode: space; -khtml-line-break: after-white-space; "><DIV><BR class="khtml-block-placeholder"></DIV><DIV>George, </DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>This is one of the things I tried, and the setting the oob interface did not work, </DIV><DIV>with the error message below. </DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>Also, per this thread:</DIV><SPAN class="Apple-tab-span" style="white-space:pre">	</SPAN><A href="http://www.open-mpi.org/community/lists/users/2007/05/3319.php">http://www.open-mpi.org/community/lists/users/2007/05/3319.php</A><DIV>I believe it is oob_tcp_include, not oob_tcp_if_include. The latter is silently</DIV><DIV>ignored in 1.2, as far as I can tell. </DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>Interestingly, telling the MPI layer to use lo0 (or to not use tcp at all) works fine. </DIV><DIV>But when I try to do the same for the OOB layer, it complains. The full error is:</DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>[mymac.local:07001] [0,0,0] mca_oob_tcp_init: invalid address '' returned for selected oob interfaces.</DIV><DIV>[mymac.local:07001] [0,0,0] ORTE_ERROR_LOG: Error in file oob_tcp.c at line 1196</DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>mpirun actually hangs at this point and no processes are spawned. I have to ^C to stop it. </DIV><DIV>I see this behavior on both Mac OS and on Linux with 1.2.2. </DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>Bill</DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV><BR class="khtml-block-placeholder"></DIV><DIV>George Bosilica wrote:</DIV><DIV><BLOCKQUOTE type="cite"><DIV><FONT class="Apple-style-span" face="Verdana">There are 2 sets of sockets: one for the oob layer and one for the </FONT><FONT class="Apple-style-span" face="Verdana"><BR></FONT><FONT class="Apple-style-span" face="Verdana">MPI layer (at least if TCP support is enabled). Therefore, in order </FONT><FONT class="Apple-style-span" face="Verdana"><BR></FONT><FONT class="Apple-style-span" face="Verdana">to achieve what you're looking for you should add to the command line </FONT><FONT class="Apple-style-span" face="Verdana"><BR></FONT><FONT class="Apple-style-span" face="Verdana"> "--mca oob_tcp_if_include lo0 --mca btl_tcp_if_include lo0".</FONT><FONT class="Apple-style-span" face="Verdana"> </FONT></DIV><DIV>On May 29, 2007, at 3:58 PM, Bill Saphir wrote:<DIV><BLOCKQUOTE type="cite"></BLOCKQUOTE></DIV></DIV></BLOCKQUOTE></DIV><DIV><DIV><BLOCKQUOTE type="cite"><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><BR></DIV></BLOCKQUOTE><DIV><BR class="khtml-block-placeholder"></DIV>----- original message below ---<BR><BR><BLOCKQUOTE type="cite"><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">We have run into the following problem:</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><BR></DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">- start up Open MPI application on a laptop</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">- disconnect from network</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">- application hangs</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><BR></DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">I believe that the problem is that all sockets created by Open MPI are bound to the external network interface.</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">For example, when I start up a 2 process MPI job on my Mac (no hosts specified), I get the following tcp</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">connections. 192.168.5.2 is an address on my LAN.</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><BR></DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">tcp4 <SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">  </SPAN>192.168.5.2.49459<SPAN class="Apple-converted-space">      </SPAN>192.168.5.2.49463<SPAN class="Apple-converted-space">      </SPAN>ESTABLISHED</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">tcp4 <SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">  </SPAN>192.168.5.2.49463<SPAN class="Apple-converted-space">      </SPAN>192.168.5.2.49459<SPAN class="Apple-converted-space">      </SPAN>ESTABLISHED</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">tcp4 <SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">  </SPAN>192.168.5.2.49456<SPAN class="Apple-converted-space">      </SPAN>192.168.5.2.49462<SPAN class="Apple-converted-space">      </SPAN>ESTABLISHED</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">tcp4 <SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">  </SPAN>192.168.5.2.49462<SPAN class="Apple-converted-space">      </SPAN>192.168.5.2.49456<SPAN class="Apple-converted-space">      </SPAN>ESTABLISHED</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">tcp4 <SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">  </SPAN>192.168.5.2.49456<SPAN class="Apple-converted-space">      </SPAN>192.168.5.2.49460<SPAN class="Apple-converted-space">      </SPAN>ESTABLISHED</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">tcp4 <SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">  </SPAN>192.168.5.2.49460<SPAN class="Apple-converted-space">      </SPAN>192.168.5.2.49456<SPAN class="Apple-converted-space">      </SPAN>ESTABLISHED</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">tcp4 <SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">  </SPAN>192.168.5.2.49456<SPAN class="Apple-converted-space">      </SPAN>192.168.5.2.49458<SPAN class="Apple-converted-space">      </SPAN>ESTABLISHED</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">tcp4 <SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">      </SPAN>0<SPAN class="Apple-converted-space">  </SPAN>192.168.5.2.49458<SPAN class="Apple-converted-space">      </SPAN>192.168.5.2.49456<SPAN class="Apple-converted-space">      </SPAN>ESTABLISHED</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><BR></DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Since this application is confined to a single machine, I would like it to use 127.0.0.1,</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">which will remain available as the laptop moves around. I am unable to force it to bind</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">sockets to this address, however.</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><BR></DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Some of the things I've tried are:</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">- explicitly setting the hostname to 127.0.0.1 (--host 127.0.0.1)</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">- turning off the tcp btl (--mca btl ^tcp) and other variations (--mca btl self,sm)</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">- using --mca oob_tcp_include lo0</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><BR></DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">The first two have no effect. The last one results in an error message of:</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">[myhost.locall:05830] [0,0,0] mca_oob_tcp_init: invalid address '' returned for selected oob interfaces.</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><BR></DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Is there any way to force Open MPI to bind all sockets to 127.0.0.1?</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><BR></DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">As a side question -- I'm curious what all of these tcp connections are used for.<SPAN class="Apple-converted-space">  </SPAN>As I increase the number</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">of processes, it looks like there are 4 sockets created per MPI process, without using the tcp btl.</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Perhaps stdin/out/err + control?</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><BR></DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Bill</DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><BR></DIV><DIV style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><BR></DIV> </BLOCKQUOTE></DIV><BR></DIV></BODY></HTML>
