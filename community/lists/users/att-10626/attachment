On Fri, Sep 11, 2009 at 5:10 PM, Jeff Squyres <span dir="ltr">&lt;<a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a>&gt;</span> wrote:<br><div class="gmail_quote"><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;">
<div class="im">On Sep 11, 2009, at 10:05 AM, Andreas Haselbacher wrote:<br>
<br>
<blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
I&#39;ve built openmpi version 1.3.3 on a MacPro with OS X 10.5.8 and the Intel 10.1.006 Fortran compiler and gcc 4.0.  As far as I can tell, the configure and make commands completed fine. There are some warnings, but it&#39;s not clear to me that they are critical - or the explanation for what&#39;s not working. After installing, I try to compile a simple F77 hello world code. The output is:<br>

<br>
% mpif77 helloworld_mpi.f -o helloworld_mpi<br>
ld: warning in /opt/openmpi/lib/libmpi_f77.a, file is not of required architecture<br>
</blockquote>
<br></div>
This means that it skipped that library because it didn&#39;t match what you were trying to compile against.<br>
<br>
Can you send the output of mpif77 --showme?<div class="im"><br></div></blockquote><div><br></div><div>ifort -I/opt/openmpi/include -L/opt/openmpi/lib -lmpi_f77 -lmpi -lopen-rte -lopen-pal -lutil</div><div> </div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;">
<div class="im">
<br>
<blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
Undefined symbols:<br>
  &quot;_mpi_init_&quot;, referenced from:<br>
      _MAIN__ in ifortIsUNoZ.o<br>
</blockquote>
<br></div>
None of these symbols were found because libmpi_f77.a was skipped.<div class="im"><br></div></blockquote><div><br></div><div>Right.</div><div> </div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;">
<div class="im">
<br>
<blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
Here&#39;s my configure command:<br>
<br>
./configure --prefix=/opt/openmpi --enable-static --disable-shared CC=gcc CFLAGS=-m64 CXX=g++ CXXFLAGS=-m64 F77=ifort FC=ifort FFLAGS=-assume nounderscore FCFLAGS=-assume nounderscore<br>
</blockquote>
<br></div>
I do not have the intel compilers for Mac; do they default to producing 64 bit objects?  I ask because it looks like you forced the C and C++ compilers to produce 64 bit objects -- do you need to do the same with ifort?  (via the FCFLAGS and FFLAGS env variables)<br>
</blockquote><div><br></div><div>If I remember correctly, I had to add those flags, otherwise configure claimed that the compilers were not compatible. I can rerun configure if you suspect that this is an issue.  I did not add these flags to the Fortran variables because configure did not complain further, but I can see that this might be an issue. </div>
<div> </div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;">
<br>
Also, did you quote the &quot;-assume nounderscore&quot; arguments to FFLAGS/FCFLAGS?  I.e., something like this:<br>
<br>
    &quot;FFLAGS=-assume nounderscore&quot;<br><font color="#888888">
<br></font></blockquote><div><br></div><div>Yes, I did. </div><div><br></div><div>Andreas</div><div> </div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;"><font color="#888888">
-- <br>
Jeff Squyres<br>
<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a><br>
<br>
</font></blockquote></div><br>

