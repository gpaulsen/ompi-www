<div dir="ltr">Ralph:<div><br></div><div>Intel MPI supports a wide range of conduits in the same library (<a href="https://software.intel.com/sites/default/files/Reference_Manual_1.pdf">https://software.intel.com/sites/default/files/Reference_Manual_1.pdf</a>, section 3.3.1), which can be selected at runtime, so I don&#39;t understand your specialization argument.  Are you suggesting that a lack of CPU-specific optimizations are responsible for the ~20% difference here?  I have a hard time believing that, especially if OpenMPI is compiled with the Intel compiler, which will inline optimized memcpy, etc.</div><div><br></div><div>A more likely source of the difference is the eager limit (I_MPI_EAGER_THRESHOLD), which is 262144 bytes in Intel MPI, which is larger than any of the limits that I can find OpenMPI using.  Perhaps you consider the eager limit a network-specific optimization, although Intel MPI does not treat it that way (the default is not network-specific).  Obviously, it is easy enough for an OpenMPI user to replicate this behavior with MCA settings and see if that makes a difference.</div><div><br></div><div>Of course, since Intel MPI is based on MPICH, there are plenty of intrinsic differences that could explain the performance gap observed.</div><div><br></div><div>Jeff<br><div class="gmail_extra"><br><div class="gmail_quote">On Mon, Nov 23, 2015 at 9:03 AM, Ralph Castain <span dir="ltr">&lt;<a href="mailto:rhc@open-mpi.org" target="_blank">rhc@open-mpi.org</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex"><div style="word-wrap:break-word">FWIW: the usual reason for differences between IMPI and OMPI lies in OMPI’s default settings, which are focused on ensuring it can run anywhere as opposed to being optimized for a specific platform. You might look at the MCA params relating to your environment and networks to optimize them for your cluster<div><br></div><div><br><div><blockquote type="cite"><div><div class="h5"><div>On Nov 23, 2015, at 8:07 AM, <a href="mailto:Michael.Rachner@dlr.de" target="_blank">Michael.Rachner@dlr.de</a> wrote:</div><br></div></div><div><div><div class="h5"><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255)"><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">Dear Gilles,<u></u><u></u></span></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)"><u></u> <u></u></span></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">In the meantime the administrators have installed (Thanks!)  OpenMPI-1.10.1 with Intel-16.0.0 on the cluster.<u></u><u></u></span></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">I have tested it with our code:  It works.<u></u><u></u></span></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">The time spent for MPI-data transmission was the same as with OpenMPI-1.8.3&amp;Intel-14.0.4, but was ~20% higher than with IMPI-5.1.1&amp;Intel-16.0.0<u></u><u></u></span></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">for the same case running on 3 nodes and 8 procs per node.<u></u><u></u></span></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)"><u></u> <u></u></span></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">Greetings<u></u><u></u></span></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">  Michael Rachner<u></u><u></u></span></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)"><u></u> <u></u></span></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"><u></u> <u></u></span></div><div><div style="border-style:solid none none;border-top-color:rgb(181,196,223);border-top-width:1pt;padding:3pt 0cm 0cm"><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><b><span style="font-size:10pt;font-family:Tahoma,sans-serif;color:windowtext">Von:</span></b><span style="font-size:10pt;font-family:Tahoma,sans-serif;color:windowtext"><span> </span>users [<a href="mailto:users-bounces@open-mpi.org" style="color:purple;text-decoration:underline" target="_blank">mailto:users-bounces@open-mpi.org</a>]<span> </span><b>Im Auftrag von<span> </span></b>Gilles Gouaillardet<br><b>Gesendet:</b><span> </span>Freitag, 20. November 2015 00:53<br><b>An:</b><span> </span>Open MPI Users<br><b>Betreff:</b><span> </span>Re: [OMPI users] Bug in Fortran-module MPI of OpenMPI 1.10.0 with Intel-Ftn-compiler<u></u><u></u></span></div></div></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><u></u> <u></u></div><p class="MsoNormal" style="margin:0cm 0cm 12pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">Michael,<br><br>in the mean time, you can use &#39;mpi_f08&#39; instead of &#39;use mpi&#39;<br>this is really a f90 binding issue, and f08 is safe<br><br>Cheers,<br><br>Gilles<u></u><u></u></p><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">On 11/19/2015 10:21 PM,<span> </span><a href="mailto:Michael.Rachner@dlr.de" style="color:purple;text-decoration:underline" target="_blank">Michael.Rachner@dlr.de</a><span> </span>wrote:<u></u><u></u></div></div><blockquote style="margin-top:5pt;margin-bottom:5pt"><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">Thank You,  Nick and Gilles,</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">I hope the administrators of the cluster will be so kind  and will update OpenMPI for me (and others) soon.</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">Greetings</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">Michael</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><b><span lang="EN-US" style="font-size:10pt;font-family:Tahoma,sans-serif">Von:</span></b><span lang="EN-US" style="font-size:10pt;font-family:Tahoma,sans-serif"><span> </span>users [<a href="mailto:users-bounces@open-mpi.org" style="color:purple;text-decoration:underline" target="_blank">mailto:users-bounces@open-mpi.org</a>]<span> </span><b>Im Auftrag von<span> </span></b>Gilles Gouaillard</span><span style="font-size:10pt;font-family:Tahoma,sans-serif">et<br><b>Gesendet:</b><span> </span>Donnerstag, 19. November 2015 12:59<br><b>An:</b><span> </span>Open MPI Users<br><b>Betreff:</b><span> </span>Re: [OMPI users] Bug in Fortran-module MPI of OpenMPI 1.10.0 with Intel-Ftn-compiler</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"> <u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">Thanks Nick for the pointer !<u></u><u></u></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"> <u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">Michael,<u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"> <u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">good news is you do not have to upgrade ifort,<u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">but you have to update to 1.10.1<u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">(intel 16 changed the way gcc pragmas are handled, and ompi has been made aware in 1.10.1)<u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">1.10.1 fixes many bugs from 1.10.0, so I strongly encourage anyone to use 1.10.1<u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"> <u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">Cheers,<u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"> <u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">Gilles<br><br>On Thursday, November 19, 2015, Nick Papior &lt;<a href="mailto:nickpapior@gmail.com" style="color:purple;text-decoration:underline" target="_blank">nickpapior@gmail.com</a>&gt; wrote:<u></u><u></u></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">Maybe I can chip in,<u></u><u></u></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"> <u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">We use OpenMPI 1.10.1 with Intel /2016.1.0.423501 without problems.<u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"> <u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">I could not get 1.10.0 to work, one reason is: <a href="http://www.open-mpi.org/community/lists/users/2015/09/27655.php" style="color:purple;text-decoration:underline" target="_blank">http://www.open-mpi.org/community/lists/users/2015/09/27655.php</a><u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"> <u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">On a side-note, please note that if you require scalapack you may need to follow this approach:<u></u><u></u></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><a href="https://software.intel.com/en-us/forums/intel-math-kernel-library/topic/590302" style="color:purple;text-decoration:underline" target="_blank">https://software.intel.com/en-us/forums/intel-math-kernel-library/topic/590302</a><u></u><u></u></div></div></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"> <u></u><u></u></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">2015-11-19 11:24 GMT+01:00 &lt;<a href="mailto:Michael.Rachner@dlr.de" style="color:purple;text-decoration:underline" target="_blank">Michael.Rachner@dlr.de</a>&gt;:<u></u><u></u></div><div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">Sorry, Gilles,</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">I cannot  update to more recent versions, because what I used is the newest combination of OpenMPI and Intel-Ftn  available on that cluster.</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">When looking at the list of improvements  on the OpenMPI website for  OpenMPI 1.10.1 compared to 1.10.0, I do not remember having seen this item to be corrected.</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">Greeting</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)">Michael Rachner</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US" style="font-size:11pt;font-family:Calibri,sans-serif;color:rgb(31,73,125)"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><b><span style="font-size:10pt;font-family:Tahoma,sans-serif">Von:</span></b><span style="font-size:10pt;font-family:Tahoma,sans-serif"><span> </span>users [<a href="mailto:users-bounces@open-mpi.org" style="color:purple;text-decoration:underline" target="_blank">mailto:</a><a></a><a href="mailto:users-bounces@open-mpi.org" style="color:purple;text-decoration:underline" target="_blank">users-bounces@open-mpi.org</a>]<span> </span><b>Im Auftrag von<span> </span></b>Gilles Gouaillardet<br><b>Gesendet:</b><span> </span>Donnerstag, 19. November 2015 10:21<br><b>An:</b><span> </span>Open MPI Users<br><b>Betreff:</b><span> </span>Re: [OMPI users] Bug in Fortran-module MPI of OpenMPI 1.10.0 with Intel-Ftn-compiler</span><u></u><u></u></div><div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"> <u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">Michael,<br><br>I remember i saw similar reports.<br><br>Could you give a try to the latest v1.10.1 ?<br>And if that still does not work, can you upgrade icc suite and give it an other try ?<br><br>I cannot remember whether this is an ifort bug or the way ompi uses fortran...<br><br>Btw, any reason why you do not<br>Use mpi_f08 ?<br><br>HTH<br><br>Gilles<br><br><a></a><a href="mailto:Michael.Rachner@dlr.de" style="color:purple;text-decoration:underline" target="_blank">Michael.Rachner@dlr.de</a><span> </span>wrote:<u></u><u></u></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">Dear developers of OpenMPI,</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">I am trying to run our parallelized Ftn-95 code on a Linux cluster with OpenMPI-1-10.0 and Intel-16.0.0 Fortran compiler.</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">In the code I use the  module MPI  (“use MPI”-stmts).</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">However I am not able to compile the code, because of compiler error messages like this:</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">/src_SPRAY/mpi_wrapper.f90(2065): error #6285: There is no matching specific subroutin for this generic subroutine call.   [MPI_REDUCE]</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">The problem seems for me to be this one:</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">The interfaces in the module MPI for the MPI-routines do not accept a send or receive buffer array, which is</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">actually a variable, an array element or a constant (like MPI_IN_PLACE).</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">Example 1:</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">     This does not work (gives the compiler error message:      error #6285: There is no matching specific subroutin for this generic subroutine call  )</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">             ivar=123    !<span> </span></span><span lang="EN-US" style="font-family:Wingdings">ß</span><span lang="EN-US"><span> </span>ivar is an integer variable, not an array</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">         <span> </span><b>call</b><span> </span>MPI_BCAST( ivar, 1, MPI_INTEGER, 0, MPI_COMM_WORLD), ierr_mpi )    !<span> </span></span><span lang="EN-US" style="font-family:Wingdings">ß</span><span lang="EN-US">- this should work, but is not accepted by the compiler</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">      only this cumbersome workaround works:</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">              ivar=123</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">                allocate( iarr(1) )</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">                iarr(1) = ivar</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><b><span lang="EN-US">         call</span></b><span lang="EN-US"><span> </span>MPI_BCAST( iarr, 1, MPI_INTEGER, 0, MPI_COMM_WORLD, ierr_mpi )    !<span> </span></span><span lang="EN-US" style="font-family:Wingdings">ß</span><span lang="EN-US">- this workaround works</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">                ivar = iarr(1)</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">                deallocate( iarr(1) )      </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">Example 2:</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">     Any call of an MPI-routine with MPI_IN_PLACE does not work, like that coding:</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">     <span> </span><b>if</b>(lmaster)<span> </span><b>then</b></span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">       <span> </span><b>call</b><span> </span>MPI_REDUCE( MPI_IN_PLACE, rbuffarr, nelem, MPI_REAL8, MPI_MAX &amp;    !<span> </span></span><span lang="EN-US" style="font-family:Wingdings">ß</span><span lang="EN-US">- this should work, but is not accepted by the compiler</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">                                         ,0_INT4, MPI_COMM_WORLD, ierr_mpi )</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">     <span> </span><b>else</b>  ! slaves</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">       <span> </span><b>call</b><span> </span>MPI_REDUCE( rbuffarr, rdummyarr, nelem, MPI_REAL8, MPI_MAX &amp;</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">                        ,0_INT4, MPI_COMM_WORLD, ierr_mpi )</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">     <span> </span><b>endif</b></span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">    </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">    This results in this compiler error message:</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">      /src_SPRAY/mpi_wrapper.f90(2122): error #6285: There is no matching specific subroutine for this generic subroutine call.   [MPI_REDUCE]</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">            call MPI_REDUCE( MPI_IN_PLACE, rbuffarr, nelem, MPI_REAL8, MPI_MAX &amp;</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">-------------^</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">In our code I observed the bug with MPI_BCAST, MPI_REDUCE, MPI_ALLREDUCE,</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">but probably there may be other MPI-routines with the same kind of bug.</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">This bug occurred for                               :     OpenMPI-1.10.0  with Intel-16.0.0</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">In contrast, this bug did NOT occur for:     OpenMPI-1.8.8    with Intel-16.0.0</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">                                                                            OpenMPI-1.8.8    with Intel-15.0.3</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">                                                                            OpenMPI-1.10.0  with gfortran-5.2.0</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US"> </span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">Greetings</span><u></u><u></u></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><span lang="EN-US">Michael Rachner</span><u></u><u></u></div></div></div></div></div></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><br>_______________________________________________<br>users mailing list<br><a></a><a href="mailto:users@open-mpi.org" style="color:purple;text-decoration:underline" target="_blank">users@open-mpi.org</a><br>Subscription:<span> </span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" style="color:purple;text-decoration:underline" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>Link to this post:<span> </span><a href="http://www.open-mpi.org/community/lists/users/2015/11/28052.php" style="color:purple;text-decoration:underline" target="_blank">http://www.open-mpi.org/community/lists/users/2015/11/28052.php</a><u></u><u></u></div></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><br><br clear="all"><u></u><u></u></div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"> <u></u><u></u></div></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">--<span> </span><u></u><u></u></div><div><div><div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif">Kind regards Nick<u></u><u></u></div></div></div></div></div></div><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><br><br><br><u></u><u></u></div><pre style="margin:0cm 0cm 0.0001pt;font-size:10pt;font-family:&#39;Courier New&#39;">_______________________________________________<u></u><u></u></pre><pre style="margin:0cm 0cm 0.0001pt;font-size:10pt;font-family:&#39;Courier New&#39;">users mailing list<u></u><u></u></pre><pre style="margin:0cm 0cm 0.0001pt;font-size:10pt;font-family:&#39;Courier New&#39;"><a href="mailto:users@open-mpi.org" style="color:purple;text-decoration:underline" target="_blank">users@open-mpi.org</a><u></u><u></u></pre><pre style="margin:0cm 0cm 0.0001pt;font-size:10pt;font-family:&#39;Courier New&#39;">Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" style="color:purple;text-decoration:underline" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><u></u><u></u></pre><pre style="margin:0cm 0cm 0.0001pt;font-size:10pt;font-family:&#39;Courier New&#39;">Link to this post: <a href="http://www.open-mpi.org/community/lists/users/2015/11/28056.php" style="color:purple;text-decoration:underline" target="_blank">http://www.open-mpi.org/community/lists/users/2015/11/28056.php</a><u></u><u></u></pre></blockquote><div style="margin:0cm 0cm 0.0001pt;font-size:12pt;font-family:&#39;Times New Roman&#39;,serif"><u></u> <u></u></div></div><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important;background-color:rgb(255,255,255)">_______________________________________________</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255)"><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important;background-color:rgb(255,255,255)">users mailing list</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255)"><a href="mailto:users@open-mpi.org" style="color:purple;text-decoration:underline;font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255)" target="_blank">users@open-mpi.org</a><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255)"><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important;background-color:rgb(255,255,255)">Subscription:<span> </span></span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" style="color:purple;text-decoration:underline;font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255)" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255)"></div></div><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important;background-color:rgb(255,255,255)">Link to this post:<span> </span></span><a href="http://www.open-mpi.org/community/lists/users/2015/11/28098.php" style="color:purple;text-decoration:underline;font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(255,255,255)" target="_blank">http://www.open-mpi.org/community/lists/users/2015/11/28098.php</a></div></blockquote></div><br></div></div><br>_______________________________________________<br>
users mailing list<br>
<a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" rel="noreferrer" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
Link to this post: <a href="http://www.open-mpi.org/community/lists/users/2015/11/28099.php" rel="noreferrer" target="_blank">http://www.open-mpi.org/community/lists/users/2015/11/28099.php</a><br></blockquote></div><br><br clear="all"><div><br></div>-- <br><div class="gmail_signature">Jeff Hammond<br><a href="mailto:jeff.science@gmail.com" target="_blank">jeff.science@gmail.com</a><br><a href="http://jeffhammond.github.io/" target="_blank">http://jeffhammond.github.io/</a></div>
</div></div></div>

