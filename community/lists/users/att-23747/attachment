<html><head><meta http-equiv="Content-Type" content="text/html charset=us-ascii"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">Your patch looks fine to me, so I'll apply it. As for this second issue - good catch. Yes, if the binding directive was provided in the default MCA param file, then the proc would attempt to bind itself on startup. The best fix actually is to just tell them not to do so. We already have that mechanism for when we actually bind them - what we should instead be doing is using that flag to indicate that any specified binding has already been applied.<div><br></div><div>I will follow that path. Thanks for pointing it out!</div><div>Ralph</div><div><br><div><div>On Mar 3, 2014, at 12:55 AM, <a href="mailto:tmishima@jcity.maeda.co.jp">tmishima@jcity.maeda.co.jp</a> wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div style="font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br><br>Hi Ralph, I misunderstood the point of the problem.<br><br>The problem is that BIND_TO_OBJ is re-tried and done in<br>orte_ess_base_proc_binding @ ess_base_fns.c, although you try to<br>BIND_TO_NONE in rmaps_rr_mapper.c when it's oversubscribed.<br>Furthermore, binding in orte_ess_base_proc_binding does not support<br>cpus_per_rank. So when BIND_TO_CORE is specified and it's<br>oversubscribed with pe=N, the final binding we get is broken.<br><br>If you really want to BIND TO NONE, you should delete binding part of<br>orte_ess_base_proc_binding. Or, if it's used for other purpose and<br>impossible to delete, it's better that you instead delete<br>"OPAL_SET_BINDING_ POLICY(OPAL_BIND_TO_NONE) in the rr_mappers and<br>just leave warning message.<br><br><br>Tetsuya<br><br><blockquote type="cite">Hi Ralph, I have tested your fix - 30895. I'm afraid to say<br>I found a mistake.<br><br>You should include "SETTING BIND_TO_NONE" in the above if-clause<br>at the line 74, 256, 511, 656. Othrewise, just warning message<br>disappears but binding to core is still overwritten by binding<br>to none. Pleaes see attached patch.<br><br>(See attached file: patch_from_30895)<br><br>Tetsuya<br><br><br><blockquote type="cite">Hi Ralph, I understood what you meant.<br><br>I often use float for our applicatoin.<br>float c = (float)(unsinged int a - unsinged int b) could<br>be very huge number, if a &lt; b. So I always carefully cast to<br>int from unsigned int when I subtract them. I didn't know/mind<br>inc d = (unsinged int a - unsinged int b) has no problem.<br>I noticed it by your suggestion, thanks.<br><br>Therefore, I think my fix is not necesarry.<br><br>Tetsuya<br><br><br><blockquote type="cite">Yes, indeed. In future, when we will have many many cores<br>in the machine, we will have to take care of overrun of<br>num_procs.<br><br>Tetsuya<br><br><blockquote type="cite">Cool - easily modified. Thanks!<br><br>Of course, you understand (I'm sure) that the cast does nothing to<br></blockquote>protect the code from blowing up if we overrun the var. In other<br></blockquote></blockquote></blockquote>words,<br><blockquote type="cite"><blockquote type="cite">if<br><blockquote type="cite">the unsigned var has wrapped, then casting it to int<br><blockquote type="cite">won't help - you'll still get a negative integer, and the code will<br></blockquote>trash.<br><blockquote type="cite"><br><br>On Feb 28, 2014, at 3:43 PM, <a href="mailto:tmishima@jcity.maeda.co.jp">tmishima@jcity.maeda.co.jp</a> wrote:<br><br><blockquote type="cite"><br><br>Hi Ralph, I'm a litte bit late to your release.<br><br>I found a minor mistake in byobj_span -integer casting problem.<br><br>--- rmaps_rr_mappers.30892.c &nbsp;&nbsp;&nbsp;2014-03-01 08:31:50 +0900<br>+++ rmaps_rr_mappers.c &nbsp;2014-03-01 08:33:22 +0900<br>@@ -689,7 +689,7 @@<br>&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;/* compute how many objs need an extra proc */<br>- &nbsp;&nbsp;&nbsp;if (0 &gt; (nxtra_objs = app-&gt;num_procs - (navg * nobjs))) {<br>+ &nbsp;&nbsp;&nbsp;if (0 &gt; (nxtra_objs = (int)app-&gt;num_procs - (navg *<br></blockquote></blockquote></blockquote>(int)nobjs)))<br><blockquote type="cite">{<br><blockquote type="cite"><blockquote type="cite">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nxtra_objs = 0;<br>&nbsp;&nbsp;&nbsp;}<br><br>Tetsuya<br><br><blockquote type="cite">Please take a look at<br></blockquote></blockquote></blockquote></blockquote><a href="https://svn.open-mpi.org/trac/ompi/ticket/4317">https://svn.open-mpi.org/trac/ompi/ticket/4317</a><br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br><br>On Feb 27, 2014, at 8:13 PM, tmishima@jcity.maeda.co.jp wrote:<br><br><blockquote type="cite"><br><br>Hi Ralph, I can't operate our cluster for a few days, sorry.<br><br>But now, I'm narrowing down the cause by browsing the source<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>code.<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>My best guess is the line 529. The<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>opal_hwloc_base_get_obj_by_type<br><blockquote type="cite"><blockquote type="cite">will<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">reset the object pointer to the first one when you move on to<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>the<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">next<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">node.<br><br>529 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (NULL == (obj =<br></blockquote></blockquote>opal_hwloc_base_get_obj_by_type<br><blockquote type="cite"><blockquote type="cite">(node-&gt;topology, target, cache_level, i,<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>OPAL_HWLOC_AVAILABLE)))<br><blockquote type="cite">{<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">530 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_ERROR_LOG(ORTE_ERR_NOT_FOUND);<br>531 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return ORTE_ERR_NOT_FOUND;<br>532 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>if node-&gt;slots=1, then nprocs is set as nprocs=1 in the second<br></blockquote></blockquote></blockquote></blockquote></blockquote>pass:<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>495 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nprocs = (node-&gt;slots - node-&gt;slots_inuse) /<br>orte_rmaps_base.cpus_per_rank;<br>496 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (nprocs &lt; 1) {<br>497 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (second_pass) {<br>498 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* already checked for oversubscription<br></blockquote></blockquote>permission,<br><blockquote type="cite"><blockquote type="cite">so at least put<br>499 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* one proc on it<br>500 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>501 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nprocs = 1;<br><br>Therefore, opal_hwloc_base_get_obj_by_type is called one by one<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>at<br><blockquote type="cite"><blockquote type="cite">each<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">node, which means<br>the object we get is always first one.<br><br>It's not elegant but I guess you need dummy calls of<br>opal_hwloc_base_get_obj_by_type to<br>move the object pointer to the right place or modify<br>opal_hwloc_base_get_obj_by_type itself.<br><br>Tetsuya<br><br><blockquote type="cite">I'm having trouble seeing why it is failing, so I added some<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>more<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">debug<br><blockquote type="cite"><blockquote type="cite">output. Could you run the failure case again with -mca<br></blockquote></blockquote>rmaps_base_verbose<br><blockquote type="cite"><blockquote type="cite">10?<br><blockquote type="cite"><br>Thanks<br>Ralph<br><br>On Feb 27, 2014, at 6:11 PM, <a href="mailto:tmishima@jcity.maeda.co.jp">tmishima@jcity.maeda.co.jp</a> wrote:<br><br><blockquote type="cite"><br><br>Just checking the difference, not so significant meaning...<br><br>Anyway, I guess it's due to the behavior when slot counts is<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>missing<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(regarded as slots=1) and it's oversubscribed<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>unintentionally.<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>I'm going out now, so I can't verify it quickly. If I provide<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>the<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">correct slot counts, it wll work, I guess. How do you think?<br><br>Tetsuya<br><br><blockquote type="cite">"restore" in what sense?<br><br>On Feb 27, 2014, at 4:10 PM, <a href="mailto:tmishima@jcity.maeda.co.jp">tmishima@jcity.maeda.co.jp</a><br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>wrote:<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br><blockquote type="cite"><br><br>Hi Ralph, this is just for your information.<br><br>I tried to restore previous orte_rmaps_rr_byobj. Then I<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>gets<br><blockquote type="cite"><blockquote type="cite">the<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">result<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">below with this command line:<br><br>mpirun -np 8 -host node05,node06 -report-bindings -map-by<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>socket:pe=2<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">-display-map &nbsp;-bind-to core:overload-allowed<br></blockquote></blockquote></blockquote></blockquote>~/mis/openmpi/demos/myprog<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">Data for JOB [31184,1] offset 0<br><br>======================== &nbsp;&nbsp;JOB MAP<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>========================<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>Data for node: node05 &nbsp;Num slots: 1 &nbsp;&nbsp;&nbsp;Max slots: 0 &nbsp;&nbsp;&nbsp;Num<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>procs:<br><blockquote type="cite">7<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">&nbsp;&nbsp;&nbsp;Process OMPI jobid: [31184,1] App: 0 Process rank: 0<br>&nbsp;&nbsp;&nbsp;Process OMPI jobid: [31184,1] App: 0 Process rank: 2<br>&nbsp;&nbsp;&nbsp;Process OMPI jobid: [31184,1] App: 0 Process rank: 4<br>&nbsp;&nbsp;&nbsp;Process OMPI jobid: [31184,1] App: 0 Process rank: 6<br>&nbsp;&nbsp;&nbsp;Process OMPI jobid: [31184,1] App: 0 Process rank: 1<br>&nbsp;&nbsp;&nbsp;Process OMPI jobid: [31184,1] App: 0 Process rank: 3<br>&nbsp;&nbsp;&nbsp;Process OMPI jobid: [31184,1] App: 0 Process rank: 5<br><br>Data for node: node06 &nbsp;Num slots: 1 &nbsp;&nbsp;&nbsp;Max slots: 0 &nbsp;&nbsp;&nbsp;Num<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>procs:<br><blockquote type="cite">1<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">&nbsp;&nbsp;&nbsp;Process OMPI jobid: [31184,1] App: 0 Process rank: 7<br><br><br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>=============================================================<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">[node06.cluster:18857] MCW rank 7 bound to socket 0[core 0<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 1[hwt 0]]: [B/B/./.][./././.]<br>[node05.cluster:21399] MCW rank 3 bound to socket 1[core 6<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">1[core 7[hwt 0]]: [./././.][././B/B]<br>[node05.cluster:21399] MCW rank 4 bound to socket 0[core 0<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 1[hwt 0]]: [B/B/./.][./././.]<br>[node05.cluster:21399] MCW rank 5 bound to socket 1[core 4<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">1[core 5[hwt 0]]: [./././.][B/B/./.]<br>[node05.cluster:21399] MCW rank 6 bound to socket 0[core 2<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 3[hwt 0]]: [././B/B][./././.]<br>[node05.cluster:21399] MCW rank 0 bound to socket 0[core 0<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 1[hwt 0]]: [B/B/./.][./././.]<br>[node05.cluster:21399] MCW rank 1 bound to socket 1[core 4<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">1[core 5[hwt 0]]: [./././.][B/B/./.]<br>[node05.cluster:21399] MCW rank 2 bound to socket 0[core 2<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 3[hwt 0]]: [././B/B][./././.]<br>....<br><br><br>Then I add "-hostfile pbs_hosts" and the result is:<br><br>[mishima@manage work]$cat pbs_hosts<br>node05 slots=8<br>node06 slots=8<br>[mishima@manage work]$ mpirun -np 8 -hostfile<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>~/work/pbs_hosts<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">-report-bindings -map-by socket:pe=2 -display-map<br>~/mis/openmpi/demos/myprog<br>Data for JOB [30254,1] offset 0<br><br>======================== &nbsp;&nbsp;JOB MAP<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>========================<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>Data for node: node05 &nbsp;Num slots: 8 &nbsp;&nbsp;&nbsp;Max slots: 0 &nbsp;&nbsp;&nbsp;Num<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>procs:<br><blockquote type="cite">4<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">&nbsp;&nbsp;&nbsp;Process OMPI jobid: [30254,1] App: 0 Process rank: 0<br>&nbsp;&nbsp;&nbsp;Process OMPI jobid: [30254,1] App: 0 Process rank: 2<br>&nbsp;&nbsp;&nbsp;Process OMPI jobid: [30254,1] App: 0 Process rank: 1<br>&nbsp;&nbsp;&nbsp;Process OMPI jobid: [30254,1] App: 0 Process rank: 3<br><br>Data for node: node06 &nbsp;Num slots: 8 &nbsp;&nbsp;&nbsp;Max slots: 0 &nbsp;&nbsp;&nbsp;Num<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>procs:<br><blockquote type="cite">4<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">&nbsp;&nbsp;&nbsp;Process OMPI jobid: [30254,1] App: 0 Process rank: 4<br>&nbsp;&nbsp;&nbsp;Process OMPI jobid: [30254,1] App: 0 Process rank: 6<br>&nbsp;&nbsp;&nbsp;Process OMPI jobid: [30254,1] App: 0 Process rank: 5<br>&nbsp;&nbsp;&nbsp;Process OMPI jobid: [30254,1] App: 0 Process rank: 7<br><br><br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>=============================================================<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">[node05.cluster:21501] MCW rank 2 bound to socket 0[core 2<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 3[hwt 0]]: [././B/B][./././.]<br>[node05.cluster:21501] MCW rank 3 bound to socket 1[core 6<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">1[core 7[hwt 0]]: [./././.][././B/B]<br>[node05.cluster:21501] MCW rank 0 bound to socket 0[core 0<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 1[hwt 0]]: [B/B/./.][./././.]<br>[node05.cluster:21501] MCW rank 1 bound to socket 1[core 4<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">1[core 5[hwt 0]]: [./././.][B/B/./.]<br>[node06.cluster:18935] MCW rank 6 bound to socket 0[core 2<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 3[hwt 0]]: [././B/B][./././.]<br>[node06.cluster:18935] MCW rank 7 bound to socket 1[core 6<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">1[core 7[hwt 0]]: [./././.][././B/B]<br>[node06.cluster:18935] MCW rank 4 bound to socket 0[core 0<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 1[hwt 0]]: [B/B/./.][./././.]<br>[node06.cluster:18935] MCW rank 5 bound to socket 1[core 4<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>[hwt<br><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">1[core 5[hwt 0]]: [./././.][B/B/./.]<br>....<br><br><br>I think previous version's behavior would be close to what<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>I<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">expect.<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>Tetusya<br><br><blockquote type="cite">They have 4 cores/socket and 2 sockets, totally 4 X 2 = 8<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>cores,<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">each.<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>Here is the output of lstopo.<br><br>mishima@manage round_robin]$ rsh node05<br>Last login: Tue Feb 18 15:10:15 from manage<br>[mishima@node05 ~]$ lstopo<br>Machine (32GB)<br>NUMANode L#0 (P#0 16GB) + Socket L#0 + L3 L#0 (6144KB)<br>L2 L#0 (512KB) + L1d L#0 (64KB) + L1i L#0 (64KB) + Core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>L#0<br><blockquote type="cite">+<br><blockquote type="cite">PU<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">L#0<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(P#0)<br>L2 L#1 (512KB) + L1d L#1 (64KB) + L1i L#1 (64KB) + Core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>L#1<br><blockquote type="cite">+<br><blockquote type="cite">PU<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">L#1<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(P#1)<br>L2 L#2 (512KB) + L1d L#2 (64KB) + L1i L#2 (64KB) + Core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>L#2<br><blockquote type="cite">+<br><blockquote type="cite">PU<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">L#2<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(P#2)<br>L2 L#3 (512KB) + L1d L#3 (64KB) + L1i L#3 (64KB) + Core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>L#3<br><blockquote type="cite">+<br><blockquote type="cite">PU<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">L#3<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(P#3)<br>NUMANode L#1 (P#1 16GB) + Socket L#1 + L3 L#1 (6144KB)<br>L2 L#4 (512KB) + L1d L#4 (64KB) + L1i L#4 (64KB) + Core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>L#4<br><blockquote type="cite">+<br><blockquote type="cite">PU<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">L#4<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(P#4)<br>L2 L#5 (512KB) + L1d L#5 (64KB) + L1i L#5 (64KB) + Core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>L#5<br><blockquote type="cite">+<br><blockquote type="cite">PU<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">L#5<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(P#5)<br>L2 L#6 (512KB) + L1d L#6 (64KB) + L1i L#6 (64KB) + Core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>L#6<br><blockquote type="cite">+<br><blockquote type="cite">PU<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">L#6<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(P#6)<br>L2 L#7 (512KB) + L1d L#7 (64KB) + L1i L#7 (64KB) + Core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>L#7<br><blockquote type="cite">+<br><blockquote type="cite">PU<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">L#7<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">(P#7)<br>....<br><br>I foucused on byobj_span and bynode. I didn't notice byobj<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>was<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">modified,<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">sorry.<br><br>Tetsuya<br><br><blockquote type="cite">Hmmm..what does your node look like again (sockets and<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>cores)?<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>On Feb 27, 2014, at 3:19 PM, <a href="mailto:tmishima@jcity.maeda.co.jp">tmishima@jcity.maeda.co.jp</a><br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>wrote:<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br><blockquote type="cite"><br>Hi Ralph, I'm afraid to say your new "map-by obj" causes<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>another<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">problem.<br><blockquote type="cite"><blockquote type="cite"><br>I have overload message with this command line as shown<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>below:<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>mpirun -np 8 -host node05,node06 -report-bindings<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>-map-by<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket:pe=2<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">-display-map ~/mis/openmpi/d<br>emos/myprog<br><br></blockquote></blockquote><br></blockquote><br></blockquote></blockquote><br></blockquote></blockquote><br></blockquote></blockquote><br></blockquote></blockquote><br></blockquote><br></blockquote><br></blockquote>--------------------------------------------------------------------------<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">A request was made to bind to that would result in<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>binding<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">more<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">processes than cpus on a resource:<br><br>Bind to: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CORE<br>Node: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node05<br>#processes: &nbsp;2<br>#cpus: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br><br>You can override this protection by adding the<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>"overload-allowed"<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">option to your binding directive.<br><br></blockquote></blockquote><br></blockquote><br></blockquote></blockquote><br></blockquote></blockquote><br></blockquote></blockquote><br></blockquote></blockquote><br></blockquote><br></blockquote><br></blockquote>--------------------------------------------------------------------------<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>Then, I add "-bind-to core:overload-allowed" to see what<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>happenes.<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>mpirun -np 8 -host node05,node06 -report-bindings<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>-map-by<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket:pe=2<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">-display-map -bind-to core:o<br>verload-allowed ~/mis/openmpi/demos/myprog<br>Data for JOB [14398,1] offset 0<br><br>======================== &nbsp;&nbsp;JOB MAP<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>========================<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>Data for node: node05 &nbsp;Num slots: 1 &nbsp;&nbsp;&nbsp;Max slots: 0<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>Num<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">procs:<br><blockquote type="cite"><blockquote type="cite">4<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">&nbsp;&nbsp;Process OMPI jobid: [14398,1] App: 0 Process rank: 0<br>&nbsp;&nbsp;Process OMPI jobid: [14398,1] App: 0 Process rank: 1<br>&nbsp;&nbsp;Process OMPI jobid: [14398,1] App: 0 Process rank: 2<br>&nbsp;&nbsp;Process OMPI jobid: [14398,1] App: 0 Process rank: 3<br><br>Data for node: node06 &nbsp;Num slots: 1 &nbsp;&nbsp;&nbsp;Max slots: 0<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>Num<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">procs:<br><blockquote type="cite"><blockquote type="cite">4<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">&nbsp;&nbsp;Process OMPI jobid: [14398,1] App: 0 Process rank: 4<br>&nbsp;&nbsp;Process OMPI jobid: [14398,1] App: 0 Process rank: 5<br>&nbsp;&nbsp;Process OMPI jobid: [14398,1] App: 0 Process rank: 6<br>&nbsp;&nbsp;Process OMPI jobid: [14398,1] App: 0 Process rank: 7<br><br><br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>=============================================================<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">[node06.cluster:18443] MCW rank 6 bound to socket 0[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>0&gt; [hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 1[hwt 0]]: [B/B/./.][./././.]<br>[node05.cluster:20901] MCW rank 2 bound to socket 0[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>0<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 1[hwt 0]]: [B/B/./.][./././.]<br>[node06.cluster:18443] MCW rank 7 bound to socket 0[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>2<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 3[hwt 0]]: [././B/B][./././.]<br>[node05.cluster:20901] MCW rank 3 bound to socket 0[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>2<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 3[hwt 0]]: [././B/B][./././.]<br>[node06.cluster:18443] MCW rank 4 bound to socket 0[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>0<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 1[hwt 0]]: [B/B/./.][./././.]<br>[node05.cluster:20901] MCW rank 0 bound to socket 0[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>0<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 1[hwt 0]]: [B/B/./.][./././.]<br>[node06.cluster:18443] MCW rank 5 bound to socket 0[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>2<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 3[hwt 0]]: [././B/B][./././.]<br>[node05.cluster:20901] MCW rank 1 bound to socket 0[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>2<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; socket<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0[core 3[hwt 0]]: [././B/B][./././.]<br>Hello world from process 4 of 8<br>Hello world from process 2 of 8<br>Hello world from process 6 of 8<br>Hello world from process 0 of 8<br>Hello world from process 5 of 8<br>Hello world from process 1 of 8<br>Hello world from process 7 of 8<br>Hello world from process 3 of 8<br><br>When I add "map-by obj:span", it works fine:<br><br>mpirun -np 8 -host node05,node06 -report-bindings<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>-map-by<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket:pe=2,span<br><blockquote type="cite"><blockquote type="cite">-display-map &nbsp;~/mis/ope<br>nmpi/demos/myprog<br>Data for JOB [14703,1] offset 0<br><br>======================== &nbsp;&nbsp;JOB MAP<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>========================<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>Data for node: node05 &nbsp;Num slots: 1 &nbsp;&nbsp;&nbsp;Max slots: 0<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>Num<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">procs:<br><blockquote type="cite"><blockquote type="cite">4<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">&nbsp;&nbsp;Process OMPI jobid: [14703,1] App: 0 Process rank: 0<br>&nbsp;&nbsp;Process OMPI jobid: [14703,1] App: 0 Process rank: 2<br>&nbsp;&nbsp;Process OMPI jobid: [14703,1] App: 0 Process rank: 1<br>&nbsp;&nbsp;Process OMPI jobid: [14703,1] App: 0 Process rank: 3<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">Data for node: node06 &nbsp;Num slots: 1 &nbsp;&nbsp;&nbsp;Max<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>slots: 0 &nbsp;&nbsp;&nbsp;Num<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">procs:<br><blockquote type="cite"><blockquote type="cite">4<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">&nbsp;&nbsp;Process OMPI jobid: [14703,1] App: 0 Process rank: 4<br>&nbsp;&nbsp;Process OMPI jobid: [14703,1] App: 0 Process rank: 6<br>&nbsp;&nbsp;Process OMPI jobid: [14703,1] App: 0 Process rank: 5<br>&nbsp;&nbsp;Process OMPI jobid: [14703,1] App: 0 Process rank: 7<br><br><br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>=============================================================<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">[node06.cluster:18491] MCW rank 6 bound to socket 0[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>2<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 3[hwt 0]]: [././B/B][./././.]<br>[node05.cluster:20949] MCW rank 2 bound to socket 0[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>2<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 3[hwt 0]]: [././B/B][./././.]<br>[node06.cluster:18491] MCW rank 7 bound to socket 1[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>6<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 1[core 7[hwt 0]]: [./././.][././B/B]<br><blockquote type="cite"><blockquote type="cite">[node05.cluster:20949] MCW rank 3 bound to socket 1[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>6<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">1[core 7[hwt 0]]: [./././.][././B/B]<br>[node06.cluster:18491] MCW rank 4 bound to socket 0[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>0<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 1[hwt 0]]: [B/B/./.][./././.]<br>[node05.cluster:20949] MCW rank 0 bound to socket 0[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>0<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">0[core 1[hwt 0]]: [B/B/./.][./././.]<br>[node06.cluster:18491] MCW rank 5 bound to socket 1[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>4<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">1[core 5[hwt 0]]: [./././.][B/B/./.]<br>[node05.cluster:20949] MCW rank 1 bound to socket 1[core<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>4<br><blockquote type="cite"><blockquote type="cite">[hwt<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">0]],<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">socket<br><blockquote type="cite"><blockquote type="cite">1[core 5[hwt 0]]: [./././.][B/B/./.]<br>....<br><br>So, byobj_span would be okay. Of course, bynode and<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>byslot<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">should<br><blockquote type="cite"><blockquote type="cite">be<br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">okay.<br><blockquote type="cite"><blockquote type="cite">Could you take a look at orte_rmaps_rr_byobj again?<br><br>Regards,<br>Tetsuya Mishima<br><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;&gt;&gt;&gt;&gt;<br></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br>_______________________________________________<br>users mailing list<br>users@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br>users@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br>users@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br>users@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br>users@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br>users@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/users<br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br></blockquote></blockquote>- patch_from_30895_______________________________________________<br><blockquote type="cite">users mailing list<br><a href="mailto:users@open-mpi.orghttp">users@open-mpi.orghttp</a>://<a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">www.open-mpi.org/mailman/listinfo.cgi/users</a><br></blockquote><br>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></div></blockquote></div><br></div></body></html>
