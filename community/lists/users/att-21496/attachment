<html><head><meta http-equiv="Content-Type" content="text/html charset=iso-8859-1"><base href="x-msg://8067/"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">The MPI standard is quite clear about this. All collective communications should be entered in exactly the same order by all participants. If I'm not mistaken there is an entire subsection&nbsp;(5.13)&nbsp;addressing the correctness of calling the MPI collectives.<div><br></div><div>&nbsp; George.</div><div><br><div><div>On Mar 4, 2013, at 23:16 , Andrew J Gomes &lt;<a href="mailto:a-gomes@northwestern.edu">a-gomes@northwestern.edu</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div fpstyle="1" ocsi="0" style="font-family: 'Courier New'; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; "><div style="direction: ltr; font-family: Tahoma; font-size: 10pt; "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">I have the following code which does not give the expected result:</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">if (mpi_rank!=0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">{ MPI_Reduce(&amp;intensity,&amp;</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">intensity ,1,MPI_DOUBLE,MPI_SUM,0,MPI_</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">COMM_WORLD);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">MPI_Reduce(&amp;intensity2,&amp;</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">intensity2 ,1,MPI_DOUBLE,MPI_SUM,0,MPI_</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">COMM_WORLD); }</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">else</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">{&nbsp;</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">MPI_Reduce(MPI_IN_PLACE,&amp;</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">intensity2 ,1,MPI_DOUBLE,MPI_SUM,0,MPI_</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">COMM_WORLD);</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">MPI_Reduce(MPI_IN_PLACE,&amp;</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">intensity ,1,MPI_DOUBLE,MPI_SUM,0,MPI_</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">COMM_WORLD);}</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">However if I change the the order of the else block (reduction of intensity variable before intensity2 variable) to :</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">else</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">{&nbsp;</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">MPI_Reduce(MPI_IN_PLACE,&amp;</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">intensity ,1,MPI_DOUBLE,MPI_SUM,0,MPI_</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">COMM_WORLD);</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">MPI_Reduce(MPI_IN_PLACE,&amp;</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">intensity2 ,1,MPI_DOUBLE,MPI_SUM,0,MPI_</span><wbr style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">COMM_WORLD);}</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">I get the expected result. This surprised me. Is there a reason the order of the else block should match the order of the if block? Is there a more robust way of implementing this type of code. Thank you</span><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><br style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); "><span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; background-color: rgb(255, 255, 255); ">Andrew</span></div>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></div></blockquote></div><br></div></body></html>
