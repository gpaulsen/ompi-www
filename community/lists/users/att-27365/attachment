<html><head><meta http-equiv="Content-Type" content="text/html charset=windows-1252"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class="">Hmmm…puzzling. Unfortunately, the developers don’t have access to SGE machines, so I can only shoot in the dark here. Still, we can see what’s going on if you have patience with us.<div class=""><br class=""></div><div class="">Couple of things we can try so we get more info:</div><div class=""><br class=""></div><div class="">* there is no MCA param pls_gridengine_verbose in the 1.8 series. Please set “-mca plm_base_verbose 5” on the cmd line</div><div class=""><br class=""></div><div class="">* I take it you configured 1.8.7 with —enable-debug, yes? If not, please do so</div><div class=""><br class=""></div><div class="">* Add “—leave-session-attached” to the cmd line</div><div class=""><br class=""></div><div class="">* You state that this cluster has hetero nodes, but you didn’t set “—hetero-nodes” on the cmd line. You probably need to do so.</div><div class=""><br class=""></div><div class="">* We set the following qrsh options “under the cover” when we launch via qrsh:</div><div class=""><div class="">&nbsp; &nbsp; &nbsp; &nbsp; opal_argv_append_nosize(&amp;rsh_agent_argv, "-inherit");</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; /* Don't use the "-noshell" flag as qrsh would have a problem&nbsp;</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* swallowing a long command */</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; opal_argv_append_nosize(&amp;rsh_agent_argv, "-nostdin");</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; opal_argv_append_nosize(&amp;rsh_agent_argv, "-V");</div></div><div class=""><br class=""></div><div class="">In other words, mpirun will launch the orteds using a cmd line like “qrsh -inherit -nostdin -V orted”. Does your installation have an issue with any of those?</div><div class=""><br class=""></div><div class="">If you get a chance to run with the above changes, please send along the output and I’ll see what can be done.</div><div class="">Ralph</div><div class=""><br class=""></div><div class=""><br class=""></div><div class=""><div><blockquote type="cite" class=""><div class="">On Jul 30, 2015, at 2:19 PM, Lane, William &lt;<a href="mailto:William.Lane@cshs.org" class="">William.Lane@cshs.org</a>&gt; wrote:</div><br class="Apple-interchange-newline"><div class=""><div style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; direction: ltr; font-family: Tahoma; font-size: 10pt;" class="">I'm running a mixed cluster of Blades (HS21 and HS22 chassis), x3550-M3 and X3550-M4 systems, some of which support hyperthreading, while others<br class="">don't (specifically the HS21 blades) all on CentOS 6.3 w/SGE.<br class=""><br class="">I have no problems running my simple OpenMPI 1.8.7 test code outside of SGE (with or without the --bind-to core switch, but can only run the jobs within<br class="">SGE via qrsh on a limited number of slots (4 at most) successfully. The errors are very similar to the ones I was getting running OpenMPI 1.8.5 - 1.8.6 outside of SGE<br class="">on this same cluster.<br class=""><br class="">Strangely, when running the test code outside of SGE w/the --bind-to core switch, mpirun still binds processes to hyperthreading cores. Additionally,<br class="">the --bind-to core switch prevents the OpenMPI 1.8.7 test code from running at all within SGE (it outputs warnings about missing NUMA libraries reducing performance<br class="">then exits).<br class=""><br class="">We would rather run out OpenMPI jobs from within SGE so that we can get accounting data on OpenMPI jobs for administrative purposes.<br class=""><br class="">The orte PE I'm been using seems to meet all the requirements for previous versions of OpenMPI:<br class=""><blockquote class="">the allocation rule is fill-up, rather than round-robin (I'm not sure if this makes a difference or not)<br class="">&nbsp;<br class="">The value NONE in user_lists and xuser_lists mean enable everybody and exclude nobody.<span class="Apple-converted-space">&nbsp;</span><br class="">&nbsp;<br class="">The value of control_slaves must be TRUE; otherwise, qrsh exits with an error message.<span class="Apple-converted-space">&nbsp;</span><br class="">&nbsp;<br class="">The value of job_is_first_task must be FALSE or the job launcher consumes a slot. In other words, mpirun itself will count as one of the slots and the job will fail, because only n-1 processes will start.&nbsp;<span class="Apple-converted-space">&nbsp;</span><br class="">&nbsp;<br class="">And be sure the queue will make use of the PE that you specified<br class=""></blockquote><br class="">Below is the command line I've been using to generate the errors found in the attached file out.txt:<br class=""><br class="">qrsh -V -now yes -pe orte 186 mpirun -np 186 --prefix /hpc/apps/mpi/openmpi/1.8.7/ --mca btl_tcp_if_include eth0 --mca pls_gridengine_verbose 1 /hpc/home/lanew/mpi/openmpi/ProcessColors3 &gt;&gt; out.txt 2&gt;&amp;1<br class=""><br class="">Sorry for the length. Thanks in advance for any help in resolving this nagging issue (I wish we had a homogenous cluster now).<br class=""><br class="">-Bill L.<br class=""></div><span style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none; display: inline !important;" class="">IMPORTANT WARNING: This message is intended for the use of the person or entity to which it is addressed and may contain information that is privileged and confidential, the disclosure of which is governed by applicable law. If the reader of this message is not the intended recipient, or the employee or agent responsible for delivering it to the intended recipient, you are hereby notified that any dissemination, distribution or copying of this information is strictly prohibited. Thank you for your cooperation.</span><span id="cid:AB75C086-49D7-47FA-84E4-B5B65A0C6435">&lt;out.txt&gt;</span><span style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none; display: inline !important;" class="">_______________________________________________</span><br style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class=""><span style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none; display: inline !important;" class="">users mailing list</span><br style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class=""><a href="mailto:users@open-mpi.org" style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class="">users@open-mpi.org</a><br style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class=""><span style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none; display: inline !important;" class="">Subscription:<span class="Apple-converted-space">&nbsp;</span></span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class="">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class=""><span style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none; display: inline !important;" class="">Link to this post:<span class="Apple-converted-space">&nbsp;</span></span><a href="http://www.open-mpi.org/community/lists/users/2015/07/27363.php" style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class="">http://www.open-mpi.org/community/lists/users/2015/07/27363.php</a></div></blockquote></div><br class=""></div></body></html>
