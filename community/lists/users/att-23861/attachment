<html><head><meta http-equiv="Content-Type" content="text/html charset=iso-8859-1"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><br><div><div>On Mar 16, 2014, at 12:16 AM, Jianyu Liu &lt;<a href="mailto:jerry_leo@msn.com">jerry_leo@msn.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div class="hmmessage" style="font-size: 12pt; font-family: Calibri; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div dir="ltr">Thanks for your kindly input<br><br>More further questions<br><br>1.&nbsp; How to check and change the ordering of network&nbsp; interfaces, such as tcp, ib, etc.,&nbsp; in the kernel?<br></div></div></blockquote><div><br></div>Heck if I know - does it matter? If you want to use a specific one, just tell it to do so.</div><div><br><blockquote type="cite"><div class="hmmessage" style="font-size: 12pt; font-family: Calibri; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div dir="ltr"><br>2.&nbsp; One of my applications only can run with "--mca btl tcp,self",&nbsp; otherwise aborted without specific error messages, even if run on single node.&nbsp; &nbsp; How to figure out the possible reasons?<span class="Apple-converted-space">&nbsp;</span><br></div></div></blockquote><div><br></div><div><br></div>Sounds odd - if it was an MPI error, it should say something. You can configure it with "--enable-debug" to add debug capability, and then do things like add "-mca plm_base_verbose 5" to watch the launch sequence, and "-mca odls_base_verbose 5" to see the procs actually spawned. Setting "-mca btl_base_verbose 100" should tell you something about what is going on in the btl layer. Etc.</div><div><br></div><div><br><blockquote type="cite"><div class="hmmessage" style="font-size: 12pt; font-family: Calibri; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div dir="ltr"><br>Appreciating your kindly input<br><br>Jianyu<br><br><br><div>&gt; From:<span class="Apple-converted-space">&nbsp;</span><a href="mailto:rhc@open-mpi.org">rhc@open-mpi.org</a><br>&gt; Date: Sat, 15 Mar 2014 07:21:31 -0700<br>&gt; To:<span class="Apple-converted-space">&nbsp;</span><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt; Subject: Re: [OMPI users] Question about '--mca btl tcp,self'<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; On Mar 14, 2014, at 10:18 PM, Jianyu Liu &lt;<a href="mailto:jerry_leo@msn.com">jerry_leo@msn.com</a>&gt; wrote:<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;&gt; On Mar 14, 2014, at 10:16:34 AM,Jeff Squyres &lt;jsquyres_at_[hidden]&gt; wrote:<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;&gt;&gt; On Mar 14, 2014, at 10:11 AM, Ralph Castain &lt;rhc_at_[hidden]&gt; wrote:<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;&gt;&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;&gt;&gt;&gt; 1. If specified '--mca btl tcp,self', which interface application will run on, use GigE adaper OR use the OpenFabrics interface in IP over IB mode (just like a high performance GigE adapter) ?<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;&gt;&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;&gt;&gt; Both - ip over ib looks just like an Ethernet adaptor<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;&gt; To be clear: the TCP BTL will use all TCP interfaces (regardless of underlying physical transport). Your GigE adapter and your IP adapter both present IP interfaces to&gt;the OS, and both support TCP. So the TCP BTL will use them, because it just sees the TCP/IP interfaces.<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; Thanks for your kindly input.<br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; Please see if I have understood correctly<br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; Assume there are two nework<br>&gt; &gt; Gigabit Ethernet<br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; eth0-renamed : 192.168.[1-22].[1-14] / 255.255.192.0<br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; InfiniBand network<br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; ib0 : 172.20.[1-22].[1-4] / 255.255.0.0<br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; 1. If specified '--mca btl tcp,self<br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; The control information ( such as setup and teardown ) are routed to and passed by Gigabit Ethernet in TCP/IP mode<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; Not necessarily - the out-of-band (OOB) system will pickup one of the TCP interfaces, but which one depends on the ordering in the kernel.<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; The MPI messages are routed to and passed by InfiniBand network in IP over IB mode<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; Not necessarily - could use either device<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; On the same machine, the TCP lookback device will be used for passing control and MPI messages<span class="Apple-converted-space">&nbsp;</span><br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; I believe the TCP BTL would use the selected device for loopback, ignoring the loopback device<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; 2. If specified '--mca btl tcp,self --mca btl_tcp_if_include ib0'<br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; Both of control information ( such as setup and teardown ) and MPI messages are routed to and passed by InfiniBand network in IP over IB mode<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; No - control info is sent by the OOB, not the BTL. To get what you describe, you would have to add "-mca oob_tcp_if_include ib0"<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; On the same machine, The TCP lookback device will be used for passing control and MPI messages<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; No - the TCP MPI messages would loopback via the ib0 device<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; 3. If specified '--mca btl openib,self'<br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; The control information ( such as setup and teardown ) are routed to and passed by InfiniBand network in IP over IB mode<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; Not necessarily - same answer as #1<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; The MPI messages are routed to and passed by InfiniBand network in RDMA mode<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; Well, it will use IB, but may not use RDMA. That is an internal decision tree made per-message based on a variety of factors<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; On the same machine, the TCP lookback device will be used for passing control and MPI messages<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; No - you excluded TCP for MPI messages, and so it would have to loopback within the IB stack. Control messages would loopback via TCP<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; 4. If without specifiying any 'mca btl' parameters<br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; The control information ( such as setup and teardown ) are routed to and passed by Gigabit Ethernet in TCP/IP mode<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; Not necessarily - same answer as #1<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; The MPI messages are routed and passed by InfiniBand network in RDMA mode<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; Same as #3<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; On the same machine, the shared memory (sm) BTL will be used for control and MPI passing messages<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; Not for control - just for MPI<br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; Appreciating your kindly input<br>&gt; &gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; Jianyu<span class="Apple-converted-space">&nbsp;</span><br>&gt; &gt; _______________________________________________<br>&gt; &gt; users mailing list<br>&gt; &gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt; &gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>&gt;<span class="Apple-converted-space">&nbsp;</span><br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt;<span class="Apple-converted-space">&nbsp;</span><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt;<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br></div></div>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></div></blockquote></div><br></body></html>
