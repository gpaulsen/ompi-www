<html><body><div style="color:#000; background-color:#fff; font-family:times new roman, new york, times, serif;font-size:12pt"><div id="yiv596014939yui_3_2_0_19_133519995092048"><span id="yiv596014939yui_3_2_0_19_133519995092079">Hi ,Thank you For your reply.<br>
&nbsp; <br>
</span><span id="result_box" class="short_text" lang="en"><span class="">I have some problems：<br>
(1)<br>
</span></span><span>Now ,</span><span id="result_box" class="short_text" lang="en"><span class="">In</span> <span class="hps">the my platform </span><span class="">,</span> <span class="hps">all nodes</span> <span class="hps">have the same path</span><span class=""> and LD_LIBRARY_PATH.<br>
&nbsp;I set in .bashrc&nbsp; <br>
/--------------------------------------------------------------------------------/<br>
  <span style="color: rgb(128, 0, 0);">#BLCR</span><br>
export PATH=$PATH:/usr/local/BLCR/bin<br>
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/BLCR/lib<br>
  <span style="color: rgb(128, 0, 0);">#openMPI</span><br>
export PATH=$PATH:/root/kidd_openMPI/bin<br>
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/root/kidd_openMPI/lib<br>
</span></span></div><div>/-------------------------------------------------------------------------------------------/<br>
but ,when I&nbsp; running&nbsp; mpirun&nbsp; , I have to <span id="result_box" class="short_text" lang="en"><span class="">add</span><span class="">&nbsp; " -x&nbsp; LD_LIBRARY_PATH" ,or&nbsp; it can't&nbsp; run<br>
</span>&nbsp;example:&nbsp; mpirun -hostfile hosts&nbsp; -np&nbsp; 2&nbsp; ./TEST .<br>
&nbsp;Error Message==&gt; <span style="background-color: rgb(192, 0, 0);"></span><br>
  <span style="color: rgb(128, 0, 0);">./TEST: error while loading shared libraries: libcr.so.0: cannot open shared object file: No such file or directory</span><br>
&nbsp;(2)&nbsp; </span><span id="result_box" class="short_text" lang="en"><span class="">BLCR</span> <span class="hps">need</span> <span class="hps">to</span> <span class="hps">unify linux-kernel&nbsp; of all</span> <span class="hps">the Node</span> <span class="hps"></span><span class="">?</span></span><br>
<span id="result_box" class="short_text" lang="en">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Now ,</span><span id="result_box" class="short_text" lang="en"><span class="">I</span> <span class="hps">reset</span> <span class="hps">all&nbsp; Node</span><span class="hps"></span><span class="">.(using Ubuntu 10.04)<br>
  <br>
&nbsp;(3) <br>
&nbsp; &nbsp; &nbsp; Now , My porgram using&nbsp; DLL . I implements some DLL&nbsp; ,MPI-Program calls DLLs .&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ompi can check/Restart&nbsp; Program contains&nbsp; DLL ?</span></span><span id="result_box" class="short_text" lang="en"><span class="hps"></span> </span></div>     <font id="yiv596014939yui_3_2_0_19_133519995092092" face="Arial" size="2"> <hr size="1"></font><div><br></div>  <div style="font-family: times new roman, new york, times, serif; font-size: 12pt;"> <div style="font-family: times new roman, new york, times, serif; font-size: 12pt;"> <div dir="ltr"> <font face="Arial" size="2"> <hr size="1">  <b><span style="font-weight:bold;">寄件者：</span></b> Josh Hursey &lt;jjhursey@open-mpi.org&gt;<br> <b><span style="font-weight: bold;">收件者：</span></b> Open MPI Users &lt;users@open-mpi.org&gt; <br> <b><span style="font-weight: bold;">寄件日期：</span></b> 2012/4/23 (週一) 10:51 PM<br> <b><span style="font-weight: bold;">主旨：</span></b> Re: [OMPI users] Ompi-restart failed and process migration<br>
 </font> </div> <br>I wonder if the LD_LIBRARY_PATH is not being set properly upon<br>restart. In your mpirun you pass the '-x LD_LIBRARY_PATH'.<br>ompi-restart will not pass that variable along for you, so if you are<br>using that to set the BLCR path this might be your problem.<br><br>A couple solutions:<br> - have the PATH and LD_LIBRARY_PATH set the same on all nodes<br> - have ompi-restart pass the -x parameter to the underlying mpirun by<br>using the -mpirun_opts command line switch:<br>&nbsp;  ompi-restart --mpirun_opts "-x LD_LIBRARY_PATH" ...<br><br>Yes. ompi-restart will let you checkpoint a process on one node and<br>restart it on another. You will have to restart the whole application<br>since the ompi-migration operation is not available in the 1.5 series.<br><br>-- Josh<br><br>On Sat, Apr 21, 2012 at 4:11 AM, kidd &lt;<a ymailto="mailto:q19860103@yahoo.com.tw" href="mailto:q19860103@yahoo.com.tw">q19860103@yahoo.com.tw</a>&gt;
 wrote:<br>&gt; Hi all,<br>&gt; I have Some problems,I wana check/Restart Multiple process on 2 node.<br>&gt;<br>&gt;&nbsp; My environment:<br>&gt;&nbsp; BLCR= 0.8.4&nbsp;&nbsp; , openMPI= 1.5.5&nbsp; , OS = ubuntu 11.04<br>&gt; I have 2 Node :<br>&gt; &nbsp;N05(Master ,it have NFS shared file system),N07(slave<br>&gt;&nbsp; ,mount Master-Node).<br>&gt;<br>&gt;&nbsp; My configure format=./configure --prefix=/root/kidd_openMPI<br>&gt;&nbsp; --with-ft=cr --enable-ft-thread&nbsp; --with-blcr=/usr/local/BLCR<br>&gt;&nbsp; --with-blcr-libdir=/usr/local/BLCR/lib --enable-mpirun-prefix-by-default<br>&gt;&nbsp; --enable-static --enable-shared --enable-opal-multi-threads;<br>&gt;<br>&gt;&nbsp;  I had also set&nbsp; ~/.openmpi/mca-params.conf-&gt;<br>&gt; &nbsp;&nbsp;&nbsp; crs_base_snapshot_dir=/root/kidd_openMPI/Tmp<br>&gt; &nbsp;&nbsp;&nbsp; snapc_base_global_snapshot_dir=/root/kidd_openMPI/checkpoints.<br>&gt;<br>&gt; the dir-&gt;kidd_openMPI is my nfs shared
 dir.<br>&gt;<br>&gt; &nbsp;My Command :<br>&gt;&nbsp;  1. mpicc -o TEST -DDEFSIZE=3000 -DDEF_PROC=2 -fopenmp MPIMatrix.c<br>&gt;<br>&gt;&nbsp; &nbsp;2. mpirun -hostfile Hosts -am ft-enable-cr -x LD_LIBRARY_PATH<br>&gt;&nbsp; &nbsp; &nbsp; -np 2 ./TEST .<br>&gt;<br>&gt;&nbsp;  I can restart process-0 on Master,but process-1 on N07 was failed.<br>&gt;<br>&gt;&nbsp;  I checked my Node,it does not install the prelink,<br>&gt;&nbsp;  so the error(restart-failed) is caused by other reasons.<br>&gt;<br>&gt;&nbsp;  Error Message--&gt;<br>&gt;&nbsp; --------------------------------------------------------------------------<br>&gt;&nbsp; &nbsp;root@cuda05:~/kidd_openMPI/checkpoints#<br>&gt;&nbsp;  ompi-restart -hostfile Hosts ompi_global_snapshot_2892.ckpt/<br>&gt;&nbsp; --------------------------------------------------------------------------<br>&gt;&nbsp; &nbsp;&nbsp; Error: BLCR was not able to restart the process because exec failed.<br>&gt;&nbsp;
 &nbsp;&nbsp;&nbsp; Check the installation of BLCR on all of the machines in your<br>&gt;&nbsp; &nbsp;&nbsp;&nbsp; system. The following information may be of help:<br>&gt;&nbsp; &nbsp;Return Code : -1<br>&gt;&nbsp; &nbsp;BLCR Restart Command : cr_restart<br>&gt;&nbsp; &nbsp;Restart Command Line : cr_restart<br>&gt;&nbsp; /root/kidd_openMPI/checkpoints/ompi_global_snapshot_2892.ckpt/0/<br>&gt;&nbsp; opal_snapshot_1.ckpt/ompi_blcr_context.2704<br>&gt;&nbsp; --------------------------------------------------------------------------<br>&gt;&nbsp; --------------------------------------------------------------------------<br>&gt;&nbsp; Error: Unable to obtain the proper restart command to restart from the<br>&gt;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; checkpoint file (opal_snapshot_1.ckpt). Returned -1.<br>&gt;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Check the installation of the blcr checkpoint/restart service<br>&gt;&nbsp;
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; on all of the machines in your system.<br>&gt;&nbsp; ###########################################################################<br>&gt;&nbsp; problem 2: I wana let MPI-process can migration to another Node.<br>&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if Ompi-Restart&nbsp; Multiple-Node can be successful.<br>&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Can restart in another new node, rather than the original node?<br>&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; example:<br>&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; checkpoint (node1,node2,node3),then restart(node1,node3,node4).<br>&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or just restart(node1,node3(2-process) ).<br>&gt;<br>&gt; &nbsp;&nbsp; Please help me , thanks .<br>&gt;<br>&gt;<br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt; <a ymailto="mailto:users@open-mpi.org"
 href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br><br><br>-- <br>Joshua Hursey<br>Postdoctoral Research Associate<br>Oak Ridge National Laboratory<br><a href="http://users.nccs.gov/%7Ejjhursey" target="_blank">http://users.nccs.gov/~jjhursey</a><br><br>_______________________________________________<br>users mailing list<br><a ymailto="mailto:users@open-mpi.org" href="mailto:users@open-mpi.org">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br><br><br> </div> </div>  </div></body></html>
