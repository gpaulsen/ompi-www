<html><body><div style="color:#000; background-color:#fff; font-family:times new roman, new york, times, serif;font-size:12pt"><div><span>Hi Ralph,</span></div><div><span><br></span></div><div><span>The port is defined in config as 5000 it is used by both versions so you would think both would fail if where an issue.</span></div><div><span>Is there any way of reserving ports for non MPI use?</span></div><div><br></div>  <div style="font-size: 12pt; font-family: 'times new roman', 'new york', times, serif; "> <div style="font-size: 12pt; font-family: 'times new roman', 'new york', times, serif; "> <div dir="ltr"> <font size="2" face="Arial"> <hr size="1">  <b><span style="font-weight:bold;">From:</span></b> Ralph Castain &lt;rhc@open-mpi.org&gt;<br> <b><span style="font-weight: bold;">To:</span></b> Open MPI Users &lt;users@open-mpi.org&gt; <br> <b><span style="font-weight: bold;">Sent:</span></b> Friday, 20 January 2012 10:30 AM<br> <b><span
 style="font-weight: bold;">Subject:</span></b> Re: [OMPI users] system() call corrupts MPI processes<br> </font> </div> <br>Hi Randolph!<br><br>Sorry for delay - was on the road. This isn't an issue of corruption. What ORTE is complaining about is that your perl script wound up connecting to the same port that your process is listening on via ORTE. ORTE is rather particular about the message format - specifically, it requires a header that includes the name of the process and a bunch of other stuff.<br><br>Where did you get the port that you are passing to your perl script?<br><br><br>On Jan 19, 2012, at 8:22 AM, Durga Choudhury wrote:<br><br>&gt; This is just a thought:<br>&gt; <br>&gt; according to the system() man page, 'SIGCHLD' is blocked during the<br>&gt; execution of the program. Since you are executing your command as a<br>&gt; daemon in the background, it will be permanently blocked.<br>&gt; <br>&gt; Does OpenMPI daemon depend on SIGCHLD in
 any way? That is about the<br>&gt; only difference that I can think of between running the command<br>&gt; stand-alone (which works) and running via a system() API call (that<br>&gt; does not work).<br>&gt; <br>&gt; Best<br>&gt; Durga<br>&gt; <br>&gt; <br>&gt; On Thu, Jan 19, 2012 at 9:52 AM, Jeff Squyres &lt;<a ymailto="mailto:jsquyres@cisco.com" href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a>&gt; wrote:<br>&gt;&gt; Which network transport are you using, and what version of Open MPI are you using?&nbsp; Do you have OpenFabrics support compiled into your Open MPI installation?<br>&gt;&gt; <br>&gt;&gt; If you're just using TCP and/or shared memory, I can't think of a reason immediately as to why this wouldn't work, but there may be a subtle interaction in there somewhere that causes badness (e.g., memory corruption).<br>&gt;&gt; <br>&gt;&gt; <br>&gt;&gt; On Jan 19, 2012, at 1:57 AM, Randolph Pullen wrote:<br>&gt;&gt; <br>&gt;&gt;&gt;
 <br>&gt;&gt;&gt; I have a section in my code running in rank 0 that must start a perl program that it then connects to via a tcp socket.<br>&gt;&gt;&gt; The initialisation section is shown here:<br>&gt;&gt;&gt; <br>&gt;&gt;&gt;&nbsp; &nbsp;  sprintf(buf, "%s/session_server.pl -p %d &amp;", PATH,port);<br>&gt;&gt;&gt;&nbsp; &nbsp;  int i = system(buf);<br>&gt;&gt;&gt;&nbsp; &nbsp;  printf("system returned %d\n", i);<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; <br>&gt;&gt;&gt; Some time after I run this code, while waiting for the data from the perl program, the error below occurs:<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; qplan connection<br>&gt;&gt;&gt; DCsession_fetch: waiting for Mcode data...<br>&gt;&gt;&gt; [dc1:05387] [[40050,1],0] ORTE_ERROR_LOG: A message is attempting to be sent to a process whose contact information is unknown in file rml_oob_send.c at line 105<br>&gt;&gt;&gt; [dc1:05387] [[40050,1],0] could not get route to [[INVALID],INVALID]<br>&gt;&gt;&gt;
 [dc1:05387] [[40050,1],0] ORTE_ERROR_LOG: A message is attempting to be sent to a process whose contact information is unknown in file base/plm_base_proxy.c at line 86<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; <br>&gt;&gt;&gt; It seems that the linux system() call is breaking OpenMPI internal connections.&nbsp; Removing the system() call and executing the perl code externaly fixes the problem but I can't go into production like that as its a security issue.<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; Any ideas ?<br>&gt;&gt;&gt; <br>&gt;&gt;&gt; (environment: OpenMPI 1.4.1 on kernel Linux dc1 2.6.18-274.3.1.el5.028stab094.3&nbsp; using TCP and mpirun)<br>&gt;&gt;&gt; _______________________________________________<br>&gt;&gt;&gt; users mailing list<br>&gt;&gt;&gt; <a ymailto="mailto:users@open-mpi.org" href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt;&gt;&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users"
 target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>&gt;&gt; <br>&gt;&gt; <br>&gt;&gt; --<br>&gt;&gt; Jeff Squyres<br>&gt;&gt; <a ymailto="mailto:jsquyres@cisco.com" href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a><br>&gt;&gt; For corporate legal information go to:<br>&gt;&gt; <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>&gt;&gt; <br>&gt;&gt; <br>&gt;&gt; _______________________________________________<br>&gt;&gt; users mailing list<br>&gt;&gt; <a ymailto="mailto:users@open-mpi.org" href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt;&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>&gt; <br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt; <a ymailto="mailto:users@open-mpi.org"
 href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br><br><br>_______________________________________________<br>users mailing list<br><a ymailto="mailto:users@open-mpi.org" href="mailto:users@open-mpi.org">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br><br><br> </div> </div>  </div></body></html>
