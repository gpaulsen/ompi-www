<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta name=Generator content="Microsoft Word 14 (filtered medium)"><!--[if !mso]><style>v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style><![endif]--><style><!--
/* Font Definitions */
@font-face
	{font-family:Helvetica;
	panose-1:2 11 5 4 2 2 2 2 2 4;}
@font-face
	{font-family:굴림;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:굴림;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:"맑은 고딕";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:"\@굴림";
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:"\@맑은 고딕";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:굴림;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-priority:99;
	mso-style-link:"풍선 도움말 텍스트 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:"맑은 고딕";}
span.apple-converted-space
	{mso-style-name:apple-converted-space;}
span.EmailStyle18
	{mso-style-type:personal-reply;
	font-family:"맑은 고딕";
	color:#1F497D;}
span.Char
	{mso-style-name:"풍선 도움말 텍스트 Char";
	mso-style-priority:99;
	mso-style-link:"풍선 도움말 텍스트";
	font-family:"맑은 고딕";}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:3.0cm 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext="edit" spidmax="1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext="edit">
<o:idmap v:ext="edit" data="1" />
</o:shapelayout></xml><![endif]--></head><body lang=KO link=blue vlink=purple><div class=WordSection1><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'>I use Open MPI 1.8.5.<o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'>The command is as following:<o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#1F497D'>$ mpirun –np 40 –hostfile machines simpleFoam –parallel<o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'>and the host file “machines” says,<o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#1F497D'>hpcnode127 cpu=20<o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#1F497D'>hpcnode128 cpu=20<o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'>Another interesting symptom is that,<o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'>if I run two mpirun’s with –np 2 option on a same node, those two mpirun’s run on the same cpu’s.<o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'>As it is shown in the following figure, only two cpu’s are working while four simpleFoam processes are running.<o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'><img width=395 height=302 id="그림_x0020_1" src="cid:image001.png@01D126D5.3DA13680"></span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'><o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'>Thank you.<o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'>Best regards,<o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'>Geon-Hong Kim.<o:p></o:p></span></p><p class=MsoNormal style='word-break:break-hangul'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕";color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0cm 0cm 0cm'><p class=MsoNormal><b><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'>From:</span></b><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'> users [mailto:users-bounces@open-mpi.org] <b>On Behalf Of </b>Ralph Castain<br><b>Sent:</b> Tuesday, November 24, 2015 4:11 PM<br><b>To:</b> Open MPI Users<br><b>Subject:</b> Re: [OMPI users] OpenMPI with infiniband, child processes of mpirun are missing or overlapped on the same cpu<o:p></o:p></span></p></div></div><p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-US>Could you please tell us what version of OpenMPI you are using, and the cmd line you used to execute the job?<o:p></o:p></span></p><div><p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p></div><div><p class=MsoNormal><span lang=EN-US>Thanks<o:p></o:p></span></p></div><div><p class=MsoNormal><span lang=EN-US>Ralph<o:p></o:p></span></p></div><div><p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p><div><blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'><div><p class=MsoNormal><span lang=EN-US>On Nov 23, 2015, at 11:05 PM, </span>김건홍<span lang=EN-US>(KIM GEON HONG) &lt;<a href="mailto:geonhong.kim@hhi.co.kr">geonhong.kim@hhi.co.kr</a>&gt; wrote:<o:p></o:p></span></p></div><p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p><div><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>Hello,<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&nbsp;<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>I tried to run a parallel computation (OpenFOAM) using Open MPI on a HPC connected with infiniband.<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>When I ran a job using mpirun over a couple of nodes (20 cpus per node), the computation was not accelerated as I expected.<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&nbsp;<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>For example, I ran the job over 40 cpus on 2 nodes, and I checked cpu usages and processes via top command.<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>I expected 20 processes would be running on each node but I found that only 19 processes were running and a cpu was in idle while others were used.<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>Following is a capture of top result.<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&nbsp;<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>As you can see, Cpu1 is in idle and there are only 19 simpleFoam processes!<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&nbsp;<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&lt;image002.png&gt;<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&nbsp;<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>I have no idea why this is happened.<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&nbsp;<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>Sometimes, a cpu is in idle while 20 processes are running but, in that case two processes running with 50% of cpu usage.<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>That is, those two different processes are assigned to the same cpu.<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&nbsp;<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>Please refer to the attached file for required information of the cluster and its environment.<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>The output of </span><span style='font-size:10.0pt;font-family:"맑은 고딕"'>“<span lang=EN-US>ulimit </span>–<span lang=EN-US>l</span>“<span class=apple-converted-space><span lang=EN-US>&nbsp;</span></span><span lang=EN-US>command on both nodes is </span>“<span lang=EN-US>unlimited</span>”<span lang=EN-US>.<o:p></o:p></span></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&nbsp;<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>Additional information for OpenFabrics-based network is as following:<o:p></o:p></span></p><div style='margin-left:38.0pt'><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;text-indent:-18.0pt'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>1.</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman","serif"'>&nbsp;&nbsp;&nbsp;&nbsp;<span class=apple-converted-space>&nbsp;</span></span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>OpenFabrics version : MLNX_OFED_LINUX-2.4.1.0.0<o:p></o:p></span></p></div><div style='margin-left:38.0pt'><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;text-indent:-18.0pt'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>2.</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman","serif"'>&nbsp;&nbsp;&nbsp;&nbsp;<span class=apple-converted-space>&nbsp;</span></span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>Linux/kernel info: RHEL6.5 2.6.32-431.el6.x86_64<br>- Linux distro/version : Red hat Enterprise Linux Server release 6.5 (Santiago)<br>- Kernel version : 2.6.32-431.el6.x86_64<o:p></o:p></span></p></div><div style='margin-left:38.0pt'><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;text-indent:-18.0pt'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>3.</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman","serif"'>&nbsp;&nbsp;&nbsp;&nbsp;<span class=apple-converted-space>&nbsp;</span></span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>Subnet manager : infiniband B class<o:p></o:p></span></p></div><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&nbsp;<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>Thank you.<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&nbsp;<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>Best regards,<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>Geon-Hong Kim.<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&nbsp;<o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'>-----------------------------------</span></b><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'>&lt;image001.png&gt;</span></b><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif";color:#1F497D'>Geon-Hong Kim</span></b><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif";color:#1F497D'>Engineer, Ph.D.</span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif";color:#1F497D'>&nbsp;</span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif";color:#1F497D'>Performance Evaluation Research Department</span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif";color:#1F497D'>Hyundai Maritime Research Institute</span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif";color:#1F497D'>Hyundai Heavy Industries Co., Ltd.</span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif";color:#1F497D'>&nbsp;</span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif";color:#1F497D'>Office +82-52-203-8053</span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif";color:#1F497D'>Fax +82-52-250-9675</span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif";color:#1F497D'>Mobile +82-10-3084-1357</span><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b><span lang=EN-US style='font-size:10.0pt;font-family:"Tahoma","sans-serif"'>-----------------------------------</span></b><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'><o:p></o:p></span></p><p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US style='font-size:10.0pt;font-family:"맑은 고딕"'>&nbsp;<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-US>&lt;system_info.tar.bz2&gt;</span><span lang=EN-US style='font-size:9.0pt;font-family:"Helvetica","sans-serif"'>_______________________________________________<br>users mailing list<br></span><span lang=EN-US><a href="mailto:users@open-mpi.org"><span style='font-size:9.0pt;font-family:"Helvetica","sans-serif";color:purple'>users@open-mpi.org</span></a></span><span lang=EN-US style='font-size:9.0pt;font-family:"Helvetica","sans-serif"'><br>Subscription:<span class=apple-converted-space>&nbsp;</span></span><span lang=EN-US><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users"><span style='font-size:9.0pt;font-family:"Helvetica","sans-serif";color:purple'>http://www.open-mpi.org/mailman/listinfo.cgi/users</span></a></span><span lang=EN-US style='font-size:9.0pt;font-family:"Helvetica","sans-serif"'><br>Link to this post:<span class=apple-converted-space>&nbsp;</span></span><span lang=EN-US><a href="http://www.open-mpi.org/community/lists/users/2015/11/28100.php"><span style='font-size:9.0pt;font-family:"Helvetica","sans-serif";color:purple'>http://www.open-mpi.org/community/lists/users/2015/11/28100.php</span></a><o:p></o:p></span></p></div></blockquote></div><p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p></div></div></body></html>