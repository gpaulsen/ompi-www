<div dir="ltr">Dear Ralph (all ;))<br><div dir="ltr"><div><br></div><div>In regards of these posts and due to you adding it to your todo list. </div><div><br></div><div>I wanted to do something similarly and implemented a &quot;quick fix&quot;.</div><div>I wanted to create a communicator per node, and then create a window to allocate an array in shared memory, however, I came to short in the current implementation, and hence needed the &quot;per-socket&quot;.</div><div><br></div><div>I implemented a way to create communicators using the comm_split_type and rely on the HWloc types.</div><div><br></div><div>Here is my commit-msg:</div><div>&quot;</div><div>We can now split communicators based on hwloc full capabilities up to BOARD.<br>I.e.:<br>  HWTHREAD,CORE,L1CACHE,L2CACHE,L3CACHE,SOCKET,NUMA,NODE,BOARD<br>where NODE is the same as SHARED.</div><div>&quot;</div><div><br></div><div>Maybe what I did could be useful somehow?</div><div>I mean to achieve the effect one could do:</div><div>comm_split_type(MPI_COMM_TYPE_Node,comm)</div><div>create new group from all nodes not belonging to this group.</div><div>This can even be more fine tuned if one wishes to create a group of &quot;master&quot; cores on each node.</div><div><br></div><div>I have not been able to compile it due to my <a href="http://autogen.pl" target="_blank">autogen.pl</a> giving me some errors. However, I think it should compile just fine.</div><div><br></div><div>Do you think it could be useful?</div><div><br></div><div>If interested you can find my, single commit branch, at: <a href="https://github.com/zerothi/ompi" target="_blank">https://github.com/zerothi/ompi</a></div><div><br></div><div>It is very little that has changed.</div><div><br></div></div><div class="gmail_extra"><br><div class="gmail_quote"><div><div class="h5">2014-11-26 1:18 GMT+01:00 Ralph Castain <span dir="ltr">&lt;<a href="mailto:rhc@open-mpi.org" target="_blank">rhc@open-mpi.org</a>&gt;</span>:<br></div></div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div><div class="h5"><div style="word-wrap:break-word">We should probably create an MPI extension that exposes the internal database so you can just get the info as it is already present, and it seems a shame to execute a collective operation just to re-create it. I’ll put it on my “to-do” list.<div><br></div><div><br><div><blockquote type="cite"><div><div><div>On Nov 25, 2014, at 4:14 PM, Teranishi, Keita &lt;<a href="mailto:knteran@sandia.gov" target="_blank">knteran@sandia.gov</a>&gt; wrote:</div><br></div></div><div><div><div><div style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><div>Adam,</div><div><br></div><div>Thanks for the suggestion.  I was using my own tokenizer (or those from boost) to extract node ID numbers, but your approach is more generic and serves my own purpose.  For the time being I will try to leverage the SCR source, and will ask you if I need any further assistance.</div><div> </div><div>Best Regards,</div><div><div><div>-----------------------------------------------------------------------------</div><div>Keita Teranishi</div></div><div>Principal Member of Technical Staff</div><div>Scalable Modeling and Analysis Systems</div><div>Sandia National Laboratories</div><div>Livermore, CA 94551</div><div><a href="tel:%2B1%20%28925%29%20294-3738" value="+19252943738" target="_blank">+1 (925) 294-3738</a></div><div><br></div></div></div><div style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><br></div><span style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><div style="font-family:Calibri;font-size:11pt;text-align:left;border-width:1pt medium medium;border-style:solid none none;padding:3pt 0in 0in;border-top-color:rgb(181,196,223)"><span style="font-weight:bold">From:<span> </span></span>&lt;Moody&gt;, &quot;Adam T.&quot; &lt;<a href="mailto:moody20@llnl.gov" target="_blank">moody20@llnl.gov</a>&gt;<br><span style="font-weight:bold">Reply-To:<span> </span></span>Open MPI Users &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br><span style="font-weight:bold">Date:<span> </span></span>Tuesday, November 25, 2014 at 3:09 PM<br><span style="font-weight:bold">To:<span> </span></span>Open MPI Users &lt;<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a>&gt;<br><span style="font-weight:bold">Subject:<span> </span></span>[EXTERNAL] Re: [OMPI users] How to find MPI ranks located in remote nodes?<br></div><div><br></div><div dir="ltr"><div style="word-wrap:break-word"><div style="direction:ltr;font-family:Tahoma;font-size:10pt">Hi Keita,<br>There is no MPI API to do this from within an MPI application.  One method I have used for this purpose is to create a function that executes an MPI_Comm_split operation using a string as a color value.  As output, it returns a communicator containing all procs that specified the same string as the calling proc.  To get a comm of all procs on the same node on a Linux system, I pass in the value of gethostname().<br><br>As an example, see scr_split.h/c from the SCR library at<span> </span><a href="https://github.com/hpc/scr." target="_blank">https://github.com/hpc/scr</a>  That implementation uses a bitonic sort along with scan operations to execute the split.  You can also accomplish this with hashing.  If you need this type of functionality, I have a cleaned-up copy that I could send you without all of the SCR related code.<br>-Adam<br><br><br><div style="font-family:&#39;Times New Roman&#39;;font-size:16px"><hr><div style="direction:ltr"><font face="Tahoma"><b>From:</b><span> </span>users [<a href="mailto:users-bounces@open-mpi.org" target="_blank">users-bounces@open-mpi.org</a>] on behalf of Ralph Castain [<a href="mailto:rhc@open-mpi.org" target="_blank">rhc@open-mpi.org</a>]<br><b>Sent:</b><span> </span>Tuesday, November 25, 2014 2:38 PM<br><b>To:</b><span> </span>Open MPI Users<br><b>Subject:</b><span> </span>Re: [OMPI users] How to find MPI ranks located in remote nodes?<br></font><br></div><div>Every process has a complete map of where every process in the job is located - not sure if there is an MPI API for accessing it, though.<div><br></div><div><br><div><blockquote type="cite"><div>On Nov 25, 2014, at 2:32 PM, Teranishi, Keita &lt;<a href="mailto:knteran@sandia.gov" target="_blank">knteran@sandia.gov</a>&gt; wrote:</div><br><div><div style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px">Hi,</div><div style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><br></div><div style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px">I am trying  to figure out a way for each local MPI rank to identify the ranks located in physically remote nodes (just different nodes) of cluster or MPPs such as Cray.  I am using MPI_Get_processor_name to get the node ID, but it requires some processing to map MPI rank to the node ID.  Is there any better ways doing this using MPI-2.2 (or earlier) capabilities?   It will be great if I can easily get a list of MPI ranks in the same physical node.  </div><div style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><br></div><div style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px">Thanks,</div><div style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><div><div>-----------------------------------------------------------------------------</div><div>Keita Teranishi</div></div><div>Principal Member of Technical Staff</div><div>Scalable Modeling and Analysis Systems</div><div>Sandia National Laboratories</div><div>Livermore, CA 94551</div><div><a href="tel:%2B1%20%28925%29%20294-3738" value="+19252943738" target="_blank">+1 (925) 294-3738</a></div><div><br></div></div><span style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">_______________________________________________</span><br style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><span style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">users mailing list</span><br style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><a href="mailto:users@open-mpi.org" style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" target="_blank">users@open-mpi.org</a><br style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><span style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">Subscription:<span> </span></span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><span style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">Link to this post:<span> </span></span><a href="http://www.open-mpi.org/community/lists/users/2014/11/25868.php" style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" target="_blank">http://www.open-mpi.org/community/lists/users/2014/11/25868.php</a></div></blockquote></div><br></div></div></div></div></div></div></span><span style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">_______________________________________________</span><br style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><span style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">users mailing list</span><br style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><a href="mailto:users@open-mpi.org" style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" target="_blank">users@open-mpi.org</a><br style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><span style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">Subscription:<span> </span></span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"></div></div><span style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">Link to this post:<span> </span></span><a href="http://www.open-mpi.org/community/lists/users/2014/11/25872.php" style="font-family:Calibri,sans-serif;font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" target="_blank">http://www.open-mpi.org/community/lists/users/2014/11/25872.php</a></div></blockquote></div><br></div></div><br>_______________________________________________<br>
users mailing list<br>
<a href="mailto:users@open-mpi.org" target="_blank">users@open-mpi.org</a><br>
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br></div></div>
Link to this post: <a href="http://www.open-mpi.org/community/lists/users/2014/11/25873.php" target="_blank">http://www.open-mpi.org/community/lists/users/2014/11/25873.php</a><span class="HOEnZb"><font color="#888888"><br></font></span></blockquote></div><span class="HOEnZb"><font color="#888888"><br><br clear="all"><br>-- <br><div><div dir="ltr"><div>Kind regards Nick</div></div></div>
</font></span></div>
<br><br clear="all"><br>-- <br><div class="gmail_signature"><div dir="ltr"><div>Kind regards Nick</div></div></div>
</div>

