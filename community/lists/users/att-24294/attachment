<div dir="ltr"><div> That last trick seems to work.  I can get it to work once in a while with those tcp options but it is<br>tricky as I have three machines and two of them use eth0 as primary network interface and one <br>
uses eth1.   But by fiddling with network options and perhaps moving a cable or two I think I can<br>get it all to work    Thanks much for the tip.<br><br></div> Clay<br></div><div class="gmail_extra"><br><br><div class="gmail_quote">
On Tue, May 6, 2014 at 11:00 AM,  <span dir="ltr">&lt;<a href="mailto:users-request@open-mpi.org" target="_blank">users-request@open-mpi.org</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
Send users mailing list submissions to<br>
        <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
<br>
To subscribe or unsubscribe via the World Wide Web, visit<br>
        <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
or, via email, send a message with subject or body &#39;help&#39; to<br>
        <a href="mailto:users-request@open-mpi.org">users-request@open-mpi.org</a><br>
<br>
You can reach the person managing the list at<br>
        <a href="mailto:users-owner@open-mpi.org">users-owner@open-mpi.org</a><br>
<br>
When replying, please edit your Subject line so it is more specific<br>
than &quot;Re: Contents of users digest...&quot;<br>
<br>
<br>
Today&#39;s Topics:<br>
<br>
   1. Re: MPI_Barrier hangs on second attempt but only  when<br>
      multiple hosts used. (Daniels, Marcus G)<br>
   2. ROMIO bug reading darrays (Richard Shaw)<br>
   3. MPI File Open does not work (Imran Ali)<br>
   4. Re: MPI File Open does not work (Jeff Squyres (jsquyres))<br>
   5. Re: MPI File Open does not work (Imran Ali)<br>
   6. Re: MPI File Open does not work (Jeff Squyres (jsquyres))<br>
   7. Re: MPI File Open does not work (Imran Ali)<br>
   8. Re: MPI File Open does not work (Jeff Squyres (jsquyres))<br>
   9. Re: users Digest, Vol 2879, Issue 1 (Jeff Squyres (jsquyres))<br>
<br>
<br>
----------------------------------------------------------------------<br>
<br>
Message: 1<br>
Date: Mon, 5 May 2014 19:28:07 +0000<br>
From: &quot;Daniels, Marcus G&quot; &lt;<a href="mailto:mdaniels@lanl.gov">mdaniels@lanl.gov</a>&gt;<br>
To: &quot;&#39;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&#39;&quot; &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] MPI_Barrier hangs on second attempt but only<br>
        when    multiple hosts used.<br>
Message-ID:<br>
        &lt;<a href="mailto:532C594B7920A549A2A91CB4312CC57640DC5007@ECS-EXG-P-MB01.win.lanl.gov">532C594B7920A549A2A91CB4312CC57640DC5007@ECS-EXG-P-MB01.win.lanl.gov</a>&gt;<br>
Content-Type: text/plain; charset=&quot;utf-8&quot;<br>
<br>
<br>
<br>
From: Clay Kirkland [mailto:<a href="mailto:clay.kirkland@versityinc.com">clay.kirkland@versityinc.com</a>]<br>
Sent: Friday, May 02, 2014 03:24 PM<br>
To: <a href="mailto:users@open-mpi.org">users@open-mpi.org</a> &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>
Subject: [OMPI users] MPI_Barrier hangs on second attempt but only when multiple hosts used.<br>
<br>
I have been using MPI for many many years so I have very well debugged mpi tests.   I am<br>
having trouble on either openmpi-1.4.5  or  openmpi-1.6.5 versions though with getting the<br>
MPI_Barrier calls to work.   It works fine when I run all processes on one machine but when<br>
I run with two or more hosts the second call to MPI_Barrier always hangs.   Not the first one,<br>
but always the second one.   I looked at FAQ&#39;s and such but found nothing except for a comment<br>
that MPI_Barrier problems were often problems with fire walls.  Also mentioned as a problem<br>
was not having the same version of mpi on both machines.  I turned firewalls off and removed<br>
and reinstalled the same version on both hosts but I still see the same thing.   I then installed<br>
lam mpi on two of my machines and that works fine.   I can call the MPI_Barrier function when run on<br>
one of two machines by itself  many times with no hangs.  Only hangs if two or more hosts are involved.<br>
These runs are all being done on CentOS release 6.4.   Here is test program I used.<br>
<br>
main (argc, argv)<br>
int argc;<br>
char **argv;<br>
{<br>
    char message[20];<br>
    char hoster[256];<br>
    char nameis[256];<br>
    int fd, i, j, jnp, iret, myrank, np, ranker, recker;<br>
    MPI_Comm comm;<br>
    MPI_Status status;<br>
<br>
    MPI_Init( &amp;argc, &amp;argv );<br>
    MPI_Comm_rank( MPI_COMM_WORLD, &amp;myrank);<br>
    MPI_Comm_size( MPI_COMM_WORLD, &amp;np);<br>
<br>
        gethostname(hoster,256);<br>
<br>
        printf(&quot; In rank %d and host= %s  Do Barrier call 1.\n&quot;,myrank,hoster);<br>
    MPI_Barrier(MPI_COMM_WORLD);<br>
        printf(&quot; In rank %d and host= %s  Do Barrier call 2.\n&quot;,myrank,hoster);<br>
    MPI_Barrier(MPI_COMM_WORLD);<br>
        printf(&quot; In rank %d and host= %s  Do Barrier call 3.\n&quot;,myrank,hoster);<br>
    MPI_Barrier(MPI_COMM_WORLD);<br>
    MPI_Finalize();<br>
    exit(0);<br>
}<br>
<br>
  Here are three runs of test program.  First with two processes on one host, then with<br>
two processes on another host, and finally with one process on each of two hosts.  The<br>
first two runs are fine but the last run hangs on the second MPI_Barrier.<br>
<br>
[root@centos MPI]# /usr/local/bin/mpirun -np 2 --host centos a.out<br>
 In rank 0 and host= centos  Do Barrier call 1.<br>
 In rank 1 and host= centos  Do Barrier call 1.<br>
 In rank 1 and host= centos  Do Barrier call 2.<br>
 In rank 1 and host= centos  Do Barrier call 3.<br>
 In rank 0 and host= centos  Do Barrier call 2.<br>
 In rank 0 and host= centos  Do Barrier call 3.<br>
[root@centos MPI]# /usr/local/bin/mpirun -np 2 --host RAID a.out<br>
/root/.bashrc: line 14: unalias: ls: not found<br>
 In rank 0 and host= RAID  Do Barrier call 1.<br>
 In rank 0 and host= RAID  Do Barrier call 2.<br>
 In rank 0 and host= RAID  Do Barrier call 3.<br>
 In rank 1 and host= RAID  Do Barrier call 1.<br>
 In rank 1 and host= RAID  Do Barrier call 2.<br>
 In rank 1 and host= RAID  Do Barrier call 3.<br>
[root@centos MPI]# /usr/local/bin/mpirun -np 2 --host centos,RAID a.out<br>
/root/.bashrc: line 14: unalias: ls: not found<br>
 In rank 0 and host= centos  Do Barrier call 1.<br>
 In rank 0 and host= centos  Do Barrier call 2.<br>
In rank 1 and host= RAID  Do Barrier call 1.<br>
 In rank 1 and host= RAID  Do Barrier call 2.<br>
<br>
  Since it is such a simple test and problem and such a widely used MPI function, it must obviously<br>
be an installation or configuration problem.   A pstack for each of the hung MPI_Barrier processes<br>
on the two machines shows this:<br>
<br>
[root@centos ~]# pstack 31666<br>
#0  0x0000003baf0e8ee3 in __epoll_wait_nocancel () from /lib64/libc.so.6<br>
#1  0x00007f5de06125eb in epoll_dispatch () from /usr/local/lib/libmpi.so.1<br>
#2  0x00007f5de061475a in opal_event_base_loop () from /usr/local/lib/libmpi.so.1<br>
#3  0x00007f5de0639229 in opal_progress () from /usr/local/lib/libmpi.so.1<br>
#4  0x00007f5de0586f75 in ompi_request_default_wait_all () from /usr/local/lib/libmpi.so.1<br>
#5  0x00007f5ddc59565e in ompi_coll_tuned_sendrecv_actual () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
#6  0x00007f5ddc59d8ff in ompi_coll_tuned_barrier_intra_two_procs () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
#7  0x00007f5de05941c2 in PMPI_Barrier () from /usr/local/lib/libmpi.so.1<br>
#8  0x0000000000400a43 in main ()<br>
<br>
[root@RAID openmpi-1.6.5]# pstack 22167<br>
#0  0x00000030302e8ee3 in __epoll_wait_nocancel () from /lib64/libc.so.6<br>
#1  0x00007f7ee46885eb in epoll_dispatch () from /usr/local/lib/libmpi.so.1<br>
#2  0x00007f7ee468a75a in opal_event_base_loop () from /usr/local/lib/libmpi.so.1<br>
#3  0x00007f7ee46af229 in opal_progress () from /usr/local/lib/libmpi.so.1<br>
#4  0x00007f7ee45fcf75 in ompi_request_default_wait_all () from /usr/local/lib/libmpi.so.1<br>
#5  0x00007f7ee060b65e in ompi_coll_tuned_sendrecv_actual () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
#6  0x00007f7ee06138ff in ompi_coll_tuned_barrier_intra_two_procs () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
#7  0x00007f7ee460a1c2 in PMPI_Barrier () from /usr/local/lib/libmpi.so.1<br>
#8  0x0000000000400a43 in main ()<br>
<br>
 Which looks exactly the same on each machine.  Any thoughts or ideas would be greatly appreciated as<br>
I am stuck.<br>
<br>
 Clay Kirkland<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
-------------- next part --------------<br>
HTML attachment scrubbed and removed<br>
<br>
------------------------------<br>
<br>
Message: 2<br>
Date: Mon, 5 May 2014 22:20:59 -0400<br>
From: Richard Shaw &lt;<a href="mailto:jrs65@cita.utoronto.ca">jrs65@cita.utoronto.ca</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>
Subject: [OMPI users] ROMIO bug reading darrays<br>
Message-ID:<br>
        &lt;<a href="mailto:CAN%2BevmkC%2B9KAcNPAUSScZiufwDJ3JfcSYMB-8ZdX1etDkabioQ@mail.gmail.com">CAN+evmkC+9KAcNPAUSScZiufwDJ3JfcSYMB-8ZdX1etDkabioQ@mail.gmail.com</a>&gt;<br>
Content-Type: text/plain; charset=&quot;utf-8&quot;<br>
<br>
Hello,<br>
<br>
I think I&#39;ve come across a bug when using ROMIO to read in a 2D distributed<br>
array. I&#39;ve attached a test case to this email.<br>
<br>
In the testcase I first initialise an array of 25 doubles (which will be a<br>
5x5 grid), then I create a datatype representing a 5x5 matrix distributed<br>
in 3x3 blocks over a 2x2 process grid. As a reference I use MPI_Pack to<br>
pull out the block cyclic array elements local to each process (which I<br>
think is correct). Then I write the original array of 25 doubles to disk,<br>
and use MPI-IO to read it back in (performing the Open, Set_view, and<br>
Real_all), and compare to the reference.<br>
<br>
Running this with OMPI, the two match on all ranks.<br>
<br>
&gt; mpirun -mca io ompio -np 4 ./darr_read.x<br>
=== Rank 0 === (9 elements)<br>
Packed:  0.0  1.0  2.0  5.0  6.0  7.0 10.0 11.0 12.0<br>
Read:    0.0  1.0  2.0  5.0  6.0  7.0 10.0 11.0 12.0<br>
<br>
=== Rank 1 === (6 elements)<br>
Packed: 15.0 16.0 17.0 20.0 21.0 22.0<br>
Read:   15.0 16.0 17.0 20.0 21.0 22.0<br>
<br>
=== Rank 2 === (6 elements)<br>
Packed:  3.0  4.0  8.0  9.0 13.0 14.0<br>
Read:    3.0  4.0  8.0  9.0 13.0 14.0<br>
<br>
=== Rank 3 === (4 elements)<br>
Packed: 18.0 19.0 23.0 24.0<br>
Read:   18.0 19.0 23.0 24.0<br>
<br>
<br>
<br>
However, using ROMIO the two differ on two of the ranks:<br>
<br>
&gt; mpirun -mca io romio -np 4 ./darr_read.x<br>
=== Rank 0 === (9 elements)<br>
Packed:  0.0  1.0  2.0  5.0  6.0  7.0 10.0 11.0 12.0<br>
Read:    0.0  1.0  2.0  5.0  6.0  7.0 10.0 11.0 12.0<br>
<br>
=== Rank 1 === (6 elements)<br>
Packed: 15.0 16.0 17.0 20.0 21.0 22.0<br>
Read:    0.0  1.0  2.0  0.0  1.0  2.0<br>
<br>
=== Rank 2 === (6 elements)<br>
Packed:  3.0  4.0  8.0  9.0 13.0 14.0<br>
Read:    3.0  4.0  8.0  9.0 13.0 14.0<br>
<br>
=== Rank 3 === (4 elements)<br>
Packed: 18.0 19.0 23.0 24.0<br>
Read:    0.0  1.0  0.0  1.0<br>
<br>
<br>
<br>
My interpretation is that the behaviour with OMPIO is correct.<br>
Interestingly everything matches up using both ROMIO and OMPIO if I set the<br>
block shape to 2x2.<br>
<br>
This was run on OS X using 1.8.2a1r31632. I have also run this on Linux<br>
with OpenMPI 1.7.4, and OMPIO is still correct, but using ROMIO I just get<br>
segfaults.<br>
<br>
Thanks,<br>
Richard<br>
-------------- next part --------------<br>
HTML attachment scrubbed and removed<br>
-------------- next part --------------<br>
A non-text attachment was scrubbed...<br>
Name: darr_read.c<br>
Type: text/x-csrc<br>
Size: 2218 bytes<br>
Desc: not available<br>
URL: &lt;<a href="http://www.open-mpi.org/MailArchives/users/attachments/20140505/5a5ab0ba/attachment.bin" target="_blank">http://www.open-mpi.org/MailArchives/users/attachments/20140505/5a5ab0ba/attachment.bin</a>&gt;<br>

<br>
------------------------------<br>
<br>
Message: 3<br>
Date: Tue, 06 May 2014 13:24:35 +0200<br>
From: Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no">imranal@student.matnat.uio.no</a>&gt;<br>
To: &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>
Subject: [OMPI users] MPI File Open does not work<br>
Message-ID: &lt;<a href="mailto:d57bdf499c00360b737205b085c50660@ulrik.uio.no">d57bdf499c00360b737205b085c50660@ulrik.uio.no</a>&gt;<br>
Content-Type: text/plain; charset=&quot;utf-8&quot;<br>
<br>
<br>
<br>
I get the following error when I try to run the following python<br>
code<br>
import mpi4py.MPI as MPI<br>
comm = MPI.COMM_WORLD<br>
<br>
MPI.File.Open(comm,&quot;some.file&quot;)<br>
<br>
$ mpirun -np 1 python<br>
test_mpi.py<br>
Traceback (most recent call last):<br>
 File &quot;test_mpi.py&quot;, line<br>
3, in &lt;module&gt;<br>
 MPI.File.Open(comm,&quot; h5ex_d_alloc.h5&quot;)<br>
 File &quot;File.pyx&quot;,<br>
line 67, in mpi4py.MPI.File.Open<br>
(src/mpi4py.MPI.c:89639)<br>
mpi4py.MPI.Exception: MPI_ERR_OTHER: known<br>
error not in<br>
list<br>
--------------------------------------------------------------------------<br>
mpirun<br>
noticed that the job aborted, but has no info as to the process<br>
that<br>
caused that<br>
situation.<br>
--------------------------------------------------------------------------<br>
<br>
<br>
My mpirun version is (Open MPI) 1.6.2. I installed openmpi using the<br>
dorsal script (<a href="https://github.com/FEniCS/dorsal" target="_blank">https://github.com/FEniCS/dorsal</a>) for Redhat Enterprise 6<br>
(OS I am using, release 6.5) . It configured the build as following :<br>
<br>
<br>
./configure --enable-mpi-thread-multiple --enable-opal-multi-threads<br>
--with-threads=posix --disable-mpi-profile<br>
<br>
I need emphasize that I do<br>
not have root acces on the system I am running my application.<br>
<br>
Imran<br>
<br>
<br>
<br>
-------------- next part --------------<br>
HTML attachment scrubbed and removed<br>
<br>
------------------------------<br>
<br>
Message: 4<br>
Date: Tue, 6 May 2014 12:56:04 +0000<br>
From: &quot;Jeff Squyres (jsquyres)&quot; &lt;<a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] MPI File Open does not work<br>
Message-ID: &lt;<a href="mailto:E7DF28CB-D4FB-4087-928E-18E61D1D24CF@cisco.com">E7DF28CB-D4FB-4087-928E-18E61D1D24CF@cisco.com</a>&gt;<br>
Content-Type: text/plain; charset=&quot;us-ascii&quot;<br>
<br>
The thread support in the 1.6 series is not very good.  You might try:<br>
<br>
- Upgrading to 1.6.5<br>
- Or better yet, upgrading to 1.8.1<br>
<br>
<br>
On May 6, 2014, at 7:24 AM, Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no">imranal@student.matnat.uio.no</a>&gt; wrote:<br>
<br>
&gt; I get the following error when I try to run the following python code<br>
&gt;<br>
&gt; import mpi4py.MPI as MPI<br>
&gt; comm =  MPI.COMM_WORLD<br>
&gt; MPI.File.Open(comm,&quot;some.file&quot;)<br>
&gt;<br>
&gt; $ mpirun -np 1 python test_mpi.py<br>
&gt; Traceback (most recent call last):<br>
&gt;   File &quot;test_mpi.py&quot;, line 3, in &lt;module&gt;<br>
&gt;     MPI.File.Open(comm,&quot; h5ex_d_alloc.h5&quot;)<br>
&gt;   File &quot;File.pyx&quot;, line 67, in mpi4py.MPI.File.Open (src/mpi4py.MPI.c:89639)<br>
&gt; mpi4py.MPI.Exception: MPI_ERR_OTHER: known error not in list<br>
&gt; --------------------------------------------------------------------------<br>
&gt; mpirun noticed that the job aborted, but has no info as to the process<br>
&gt; that caused that situation.<br>
&gt; --------------------------------------------------------------------------<br>
&gt;<br>
&gt; My mpirun version is (Open MPI) 1.6.2. I installed openmpi using the dorsal script (<a href="https://github.com/FEniCS/dorsal" target="_blank">https://github.com/FEniCS/dorsal</a>) for Redhat Enterprise 6 (OS I am using, release 6.5) . It configured the build as following :<br>

&gt;<br>
&gt; ./configure --enable-mpi-thread-multiple --enable-opal-multi-threads --with-threads=posix --disable-mpi-profile<br>
&gt;<br>
&gt; I need emphasize that I do not have root acces on the system I am running my application.<br>
&gt;<br>
&gt; Imran<br>
&gt;<br>
&gt;<br>
&gt; _______________________________________________<br>
&gt; users mailing list<br>
&gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
<br>
<br>
--<br>
Jeff Squyres<br>
<a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a><br>
For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
<br>
<br>
<br>
------------------------------<br>
<br>
Message: 5<br>
Date: Tue, 6 May 2014 15:32:21 +0200<br>
From: Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no">imranal@student.matnat.uio.no</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] MPI File Open does not work<br>
Message-ID: &lt;<a href="mailto:FA6DFFFF-6C66-4A47-84FC-148FB51CE162@math.uio.no">FA6DFFFF-6C66-4A47-84FC-148FB51CE162@math.uio.no</a>&gt;<br>
Content-Type: text/plain; charset=us-ascii<br>
<br>
<br>
6. mai 2014 kl. 14:56 skrev Jeff Squyres (jsquyres) &lt;<a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a>&gt;:<br>
<br>
&gt; The thread support in the 1.6 series is not very good.  You might try:<br>
&gt;<br>
&gt; - Upgrading to 1.6.5<br>
&gt; - Or better yet, upgrading to 1.8.1<br>
&gt;<br>
<br>
I will attempt that than. I read at<br>
<br>
<a href="http://www.open-mpi.org/faq/?category=building#install-overwrite" target="_blank">http://www.open-mpi.org/faq/?category=building#install-overwrite</a><br>
<br>
that I should completely uninstall my previous version. Could you recommend to me how I can go about doing it (without root access).<br>
I am uncertain where I can use make uninstall.<br>
<br>
Imran<br>
<br>
&gt;<br>
&gt; On May 6, 2014, at 7:24 AM, Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no">imranal@student.matnat.uio.no</a>&gt; wrote:<br>
&gt;<br>
&gt;&gt; I get the following error when I try to run the following python code<br>
&gt;&gt;<br>
&gt;&gt; import mpi4py.MPI as MPI<br>
&gt;&gt; comm =  MPI.COMM_WORLD<br>
&gt;&gt; MPI.File.Open(comm,&quot;some.file&quot;)<br>
&gt;&gt;<br>
&gt;&gt; $ mpirun -np 1 python test_mpi.py<br>
&gt;&gt; Traceback (most recent call last):<br>
&gt;&gt;  File &quot;test_mpi.py&quot;, line 3, in &lt;module&gt;<br>
&gt;&gt;    MPI.File.Open(comm,&quot; h5ex_d_alloc.h5&quot;)<br>
&gt;&gt;  File &quot;File.pyx&quot;, line 67, in mpi4py.MPI.File.Open (src/mpi4py.MPI.c:89639)<br>
&gt;&gt; mpi4py.MPI.Exception: MPI_ERR_OTHER: known error not in list<br>
&gt;&gt; --------------------------------------------------------------------------<br>
&gt;&gt; mpirun noticed that the job aborted, but has no info as to the process<br>
&gt;&gt; that caused that situation.<br>
&gt;&gt; --------------------------------------------------------------------------<br>
&gt;&gt;<br>
&gt;&gt; My mpirun version is (Open MPI) 1.6.2. I installed openmpi using the dorsal script (<a href="https://github.com/FEniCS/dorsal" target="_blank">https://github.com/FEniCS/dorsal</a>) for Redhat Enterprise 6 (OS I am using, release 6.5) . It configured the build as following :<br>

&gt;&gt;<br>
&gt;&gt; ./configure --enable-mpi-thread-multiple --enable-opal-multi-threads --with-threads=posix --disable-mpi-profile<br>
&gt;&gt;<br>
&gt;&gt; I need emphasize that I do not have root acces on the system I am running my application.<br>
&gt;&gt;<br>
&gt;&gt; Imran<br>
&gt;&gt;<br>
&gt;&gt;<br>
&gt;&gt; _______________________________________________<br>
&gt;&gt; users mailing list<br>
&gt;&gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
&gt;&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
&gt;<br>
&gt;<br>
&gt; --<br>
&gt; Jeff Squyres<br>
&gt; <a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a><br>
&gt; For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
&gt;<br>
&gt; _______________________________________________<br>
&gt; users mailing list<br>
&gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
<br>
<br>
<br>
------------------------------<br>
<br>
Message: 6<br>
Date: Tue, 6 May 2014 13:34:38 +0000<br>
From: &quot;Jeff Squyres (jsquyres)&quot; &lt;<a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] MPI File Open does not work<br>
Message-ID: &lt;<a href="mailto:2A933C0E-80F6-4DED-B44C-53B5F37EFC0C@cisco.com">2A933C0E-80F6-4DED-B44C-53B5F37EFC0C@cisco.com</a>&gt;<br>
Content-Type: text/plain; charset=&quot;us-ascii&quot;<br>
<br>
On May 6, 2014, at 9:32 AM, Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no">imranal@student.matnat.uio.no</a>&gt; wrote:<br>
<br>
&gt; I will attempt that than. I read at<br>
&gt;<br>
&gt; <a href="http://www.open-mpi.org/faq/?category=building#install-overwrite" target="_blank">http://www.open-mpi.org/faq/?category=building#install-overwrite</a><br>
&gt;<br>
&gt; that I should completely uninstall my previous version.<br>
<br>
Yes, that is best.  OR: you can install into a whole separate tree and ignore the first installation.<br>
<br>
&gt; Could you recommend to me how I can go about doing it (without root access).<br>
&gt; I am uncertain where I can use make uninstall.<br>
<br>
If you don&#39;t have write access into the installation tree (i.e., it was installed via root and you don&#39;t have root access), then your best bet is simply to install into a new tree.  E.g., if OMPI is installed into /opt/openmpi-1.6.2, try installing into /opt/openmpi-1.6.5, or even $HOME/installs/openmpi-1.6.5, or something like that.<br>

<br>
--<br>
Jeff Squyres<br>
<a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a><br>
For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
<br>
<br>
<br>
------------------------------<br>
<br>
Message: 7<br>
Date: Tue, 6 May 2014 15:40:34 +0200<br>
From: Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no">imranal@student.matnat.uio.no</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] MPI File Open does not work<br>
Message-ID: &lt;<a href="mailto:14F0596C-C5C5-4B1A-A4A8-8849D44AB76A@math.uio.no">14F0596C-C5C5-4B1A-A4A8-8849D44AB76A@math.uio.no</a>&gt;<br>
Content-Type: text/plain; charset=us-ascii<br>
<br>
<br>
6. mai 2014 kl. 15:34 skrev Jeff Squyres (jsquyres) &lt;<a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a>&gt;:<br>
<br>
&gt; On May 6, 2014, at 9:32 AM, Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no">imranal@student.matnat.uio.no</a>&gt; wrote:<br>
&gt;<br>
&gt;&gt; I will attempt that than. I read at<br>
&gt;&gt;<br>
&gt;&gt; <a href="http://www.open-mpi.org/faq/?category=building#install-overwrite" target="_blank">http://www.open-mpi.org/faq/?category=building#install-overwrite</a><br>
&gt;&gt;<br>
&gt;&gt; that I should completely uninstall my previous version.<br>
&gt;<br>
&gt; Yes, that is best.  OR: you can install into a whole separate tree and ignore the first installation.<br>
&gt;<br>
&gt;&gt; Could you recommend to me how I can go about doing it (without root access).<br>
&gt;&gt; I am uncertain where I can use make uninstall.<br>
&gt;<br>
&gt; If you don&#39;t have write access into the installation tree (i.e., it was installed via root and you don&#39;t have root access), then your best bet is simply to install into a new tree.  E.g., if OMPI is installed into /opt/openmpi-1.6.2, try installing into /opt/openmpi-1.6.5, or even $HOME/installs/openmpi-1.6.5, or something like that.<br>

<br>
My install was in my user directory (i.e $HOME). I managed to locate the source directory and successfully run make uninstall.<br>
<br>
Will let you know how things went after installation.<br>
<br>
Imran<br>
<br>
&gt;<br>
&gt; --<br>
&gt; Jeff Squyres<br>
&gt; <a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a><br>
&gt; For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
&gt;<br>
&gt; _______________________________________________<br>
&gt; users mailing list<br>
&gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
<br>
<br>
<br>
------------------------------<br>
<br>
Message: 8<br>
Date: Tue, 6 May 2014 14:42:52 +0000<br>
From: &quot;Jeff Squyres (jsquyres)&quot; &lt;<a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] MPI File Open does not work<br>
Message-ID: &lt;<a href="mailto:710E3328-EDAA-4A13-9F07-B45FE319113D@cisco.com">710E3328-EDAA-4A13-9F07-B45FE319113D@cisco.com</a>&gt;<br>
Content-Type: text/plain; charset=&quot;us-ascii&quot;<br>
<br>
On May 6, 2014, at 9:40 AM, Imran Ali &lt;<a href="mailto:imranal@student.matnat.uio.no">imranal@student.matnat.uio.no</a>&gt; wrote:<br>
<br>
&gt; My install was in my user directory (i.e $HOME). I managed to locate the source directory and successfully run make uninstall.<br>
<br>
<br>
FWIW, I usually install Open MPI into its own subdir.  E.g., $HOME/installs/openmpi-x.y.z.  Then if I don&#39;t want that install any more, I can just &quot;rm -rf $HOME/installs/openmpi-x.y.z&quot; -- no need to &quot;make uninstall&quot;.  Specifically: if there&#39;s nothing else installed in the same tree as Open MPI, you can just rm -rf its installation tree.<br>

<br>
--<br>
Jeff Squyres<br>
<a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a><br>
For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
<br>
<br>
<br>
------------------------------<br>
<br>
Message: 9<br>
Date: Tue, 6 May 2014 14:50:34 +0000<br>
From: &quot;Jeff Squyres (jsquyres)&quot; &lt;<a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a>&gt;<br>
To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>
Subject: Re: [OMPI users] users Digest, Vol 2879, Issue 1<br>
Message-ID: &lt;<a href="mailto:C60AA7E1-96A7-4CCD-9B5B-11A38FB87772@cisco.com">C60AA7E1-96A7-4CCD-9B5B-11A38FB87772@cisco.com</a>&gt;<br>
Content-Type: text/plain; charset=&quot;us-ascii&quot;<br>
<br>
Are you using TCP as the MPI transport?<br>
<br>
If so, another thing to try is to limit the IP interfaces that MPI uses for its traffic to see if there&#39;s some kind of problem with specific networks.<br>
<br>
For example:<br>
<br>
   mpirun --mca btl_tcp_if_include eth0 ...<br>
<br>
If that works, then try adding in any/all other IP interfaces that you have on your machines.<br>
<br>
A sorta-wild guess: you have some IP interfaces that aren&#39;t working, or at least, don&#39;t work in the way that OMPI wants them to work.  So the first barrier works because it flows across eth0 (or some other first network that, as far as OMPI is concerned, works just fine).  But then the next barrier round-robin advances to the next IP interface, and it doesn&#39;t work for some reason.<br>

<br>
We&#39;ve seen virtual machine bridge interfaces cause problems, for example.  E.g., if a machine has a Xen virtual machine interface (vibr0, IIRC?), then OMPI will try to use it to communicate with peer MPI processes because it has a &quot;compatible&quot; IP address, and OMPI think it should be connected/reachable to peers.  If this is the case, you might want to disable such interfaces and/or use btl_tcp_if_include or btl_tcp_if_exclude to select the interfaces that you want to use.<br>

<br>
Pro tip: if you use btl_tcp_if_exclude, remember to exclude the loopback interface, too.  OMPI defaults to a btl_tcp_if_include=&quot;&quot; (blank) and btl_tcp_if_exclude=&quot;lo0&quot;. So if you override btl_tcp_if_exclude, you need to be sure to *also* include lo0 in the new value.  For example:<br>

<br>
   mpirun --mca btl_tcp_if_exclude lo0,virb0 ...<br>
<br>
Also, if possible, try upgrading to Open MPI 1.8.1.<br>
<br>
<br>
<br>
On May 4, 2014, at 2:15 PM, Clay Kirkland &lt;<a href="mailto:clay.kirkland@versityinc.com">clay.kirkland@versityinc.com</a>&gt; wrote:<br>
<br>
&gt;  I am configuring with all defaults.   Just doing a ./configure and then<br>
&gt; make and make install.   I have used open mpi on several kinds of<br>
&gt; unix  systems this way and have had no trouble before.   I believe I<br>
&gt; last had success on a redhat version of linux.<br>
&gt;<br>
&gt;<br>
&gt; On Sat, May 3, 2014 at 11:00 AM, &lt;<a href="mailto:users-request@open-mpi.org">users-request@open-mpi.org</a>&gt; wrote:<br>
&gt; Send users mailing list submissions to<br>
&gt;         <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
&gt;<br>
&gt; To subscribe or unsubscribe via the World Wide Web, visit<br>
&gt;         <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
&gt; or, via email, send a message with subject or body &#39;help&#39; to<br>
&gt;         <a href="mailto:users-request@open-mpi.org">users-request@open-mpi.org</a><br>
&gt;<br>
&gt; You can reach the person managing the list at<br>
&gt;         <a href="mailto:users-owner@open-mpi.org">users-owner@open-mpi.org</a><br>
&gt;<br>
&gt; When replying, please edit your Subject line so it is more specific<br>
&gt; than &quot;Re: Contents of users digest...&quot;<br>
&gt;<br>
&gt;<br>
&gt; Today&#39;s Topics:<br>
&gt;<br>
&gt;    1. MPI_Barrier hangs on second attempt but only when multiple<br>
&gt;       hosts used. (Clay Kirkland)<br>
&gt;    2. Re: MPI_Barrier hangs on second attempt but only when<br>
&gt;       multiple hosts used. (Ralph Castain)<br>
&gt;<br>
&gt;<br>
&gt; ----------------------------------------------------------------------<br>
&gt;<br>
&gt; Message: 1<br>
&gt; Date: Fri, 2 May 2014 16:24:04 -0500<br>
&gt; From: Clay Kirkland &lt;<a href="mailto:clay.kirkland@versityinc.com">clay.kirkland@versityinc.com</a>&gt;<br>
&gt; To: <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
&gt; Subject: [OMPI users] MPI_Barrier hangs on second attempt but only<br>
&gt;         when    multiple hosts used.<br>
&gt; Message-ID:<br>
&gt;         &lt;CAJDnjA8Wi=FEjz6Vz+Bc34b+nFE=<a href="mailto:TF4B7g0BQgMbeKg7H-pV%2BA@mail.gmail.com">TF4B7g0BQgMbeKg7H-pV+A@mail.gmail.com</a>&gt;<br>
&gt; Content-Type: text/plain; charset=&quot;utf-8&quot;<br>
&gt;<br>
&gt; I have been using MPI for many many years so I have very well debugged mpi<br>
&gt; tests.   I am<br>
&gt; having trouble on either openmpi-1.4.5  or  openmpi-1.6.5 versions though<br>
&gt; with getting the<br>
&gt; MPI_Barrier calls to work.   It works fine when I run all processes on one<br>
&gt; machine but when<br>
&gt; I run with two or more hosts the second call to MPI_Barrier always hangs.<br>
&gt; Not the first one,<br>
&gt; but always the second one.   I looked at FAQ&#39;s and such but found nothing<br>
&gt; except for a comment<br>
&gt; that MPI_Barrier problems were often problems with fire walls.  Also<br>
&gt; mentioned as a problem<br>
&gt; was not having the same version of mpi on both machines.  I turned<br>
&gt; firewalls off and removed<br>
&gt; and reinstalled the same version on both hosts but I still see the same<br>
&gt; thing.   I then installed<br>
&gt; lam mpi on two of my machines and that works fine.   I can call the<br>
&gt; MPI_Barrier function when run on<br>
&gt; one of two machines by itself  many times with no hangs.  Only hangs if two<br>
&gt; or more hosts are involved.<br>
&gt; These runs are all being done on CentOS release 6.4.   Here is test program<br>
&gt; I used.<br>
&gt;<br>
&gt; main (argc, argv)<br>
&gt; int argc;<br>
&gt; char **argv;<br>
&gt; {<br>
&gt;     char message[20];<br>
&gt;     char hoster[256];<br>
&gt;     char nameis[256];<br>
&gt;     int fd, i, j, jnp, iret, myrank, np, ranker, recker;<br>
&gt;     MPI_Comm comm;<br>
&gt;     MPI_Status status;<br>
&gt;<br>
&gt;     MPI_Init( &amp;argc, &amp;argv );<br>
&gt;     MPI_Comm_rank( MPI_COMM_WORLD, &amp;myrank);<br>
&gt;     MPI_Comm_size( MPI_COMM_WORLD, &amp;np);<br>
&gt;<br>
&gt;         gethostname(hoster,256);<br>
&gt;<br>
&gt;         printf(&quot; In rank %d and host= %s  Do Barrier call<br>
&gt; 1.\n&quot;,myrank,hoster);<br>
&gt;     MPI_Barrier(MPI_COMM_WORLD);<br>
&gt;         printf(&quot; In rank %d and host= %s  Do Barrier call<br>
&gt; 2.\n&quot;,myrank,hoster);<br>
&gt;     MPI_Barrier(MPI_COMM_WORLD);<br>
&gt;         printf(&quot; In rank %d and host= %s  Do Barrier call<br>
&gt; 3.\n&quot;,myrank,hoster);<br>
&gt;     MPI_Barrier(MPI_COMM_WORLD);<br>
&gt;     MPI_Finalize();<br>
&gt;     exit(0);<br>
&gt; }<br>
&gt;<br>
&gt;   Here are three runs of test program.  First with two processes on one<br>
&gt; host, then with<br>
&gt; two processes on another host, and finally with one process on each of two<br>
&gt; hosts.  The<br>
&gt; first two runs are fine but the last run hangs on the second MPI_Barrier.<br>
&gt;<br>
&gt; [root@centos MPI]# /usr/local/bin/mpirun -np 2 --host centos a.out<br>
&gt;  In rank 0 and host= centos  Do Barrier call 1.<br>
&gt;  In rank 1 and host= centos  Do Barrier call 1.<br>
&gt;  In rank 1 and host= centos  Do Barrier call 2.<br>
&gt;  In rank 1 and host= centos  Do Barrier call 3.<br>
&gt;  In rank 0 and host= centos  Do Barrier call 2.<br>
&gt;  In rank 0 and host= centos  Do Barrier call 3.<br>
&gt; [root@centos MPI]# /usr/local/bin/mpirun -np 2 --host RAID a.out<br>
&gt; /root/.bashrc: line 14: unalias: ls: not found<br>
&gt;  In rank 0 and host= RAID  Do Barrier call 1.<br>
&gt;  In rank 0 and host= RAID  Do Barrier call 2.<br>
&gt;  In rank 0 and host= RAID  Do Barrier call 3.<br>
&gt;  In rank 1 and host= RAID  Do Barrier call 1.<br>
&gt;  In rank 1 and host= RAID  Do Barrier call 2.<br>
&gt;  In rank 1 and host= RAID  Do Barrier call 3.<br>
&gt; [root@centos MPI]# /usr/local/bin/mpirun -np 2 --host centos,RAID a.out<br>
&gt; /root/.bashrc: line 14: unalias: ls: not found<br>
&gt;  In rank 0 and host= centos  Do Barrier call 1.<br>
&gt;  In rank 0 and host= centos  Do Barrier call 2.<br>
&gt; In rank 1 and host= RAID  Do Barrier call 1.<br>
&gt;  In rank 1 and host= RAID  Do Barrier call 2.<br>
&gt;<br>
&gt;   Since it is such a simple test and problem and such a widely used MPI<br>
&gt; function, it must obviously<br>
&gt; be an installation or configuration problem.   A pstack for each of the<br>
&gt; hung MPI_Barrier processes<br>
&gt; on the two machines shows this:<br>
&gt;<br>
&gt; [root@centos ~]# pstack 31666<br>
&gt; #0  0x0000003baf0e8ee3 in __epoll_wait_nocancel () from /lib64/libc.so.6<br>
&gt; #1  0x00007f5de06125eb in epoll_dispatch () from /usr/local/lib/libmpi.so.1<br>
&gt; #2  0x00007f5de061475a in opal_event_base_loop () from<br>
&gt; /usr/local/lib/libmpi.so.1<br>
&gt; #3  0x00007f5de0639229 in opal_progress () from /usr/local/lib/libmpi.so.1<br>
&gt; #4  0x00007f5de0586f75 in ompi_request_default_wait_all () from<br>
&gt; /usr/local/lib/libmpi.so.1<br>
&gt; #5  0x00007f5ddc59565e in ompi_coll_tuned_sendrecv_actual () from<br>
&gt; /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; #6  0x00007f5ddc59d8ff in ompi_coll_tuned_barrier_intra_two_procs () from<br>
&gt; /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; #7  0x00007f5de05941c2 in PMPI_Barrier () from /usr/local/lib/libmpi.so.1<br>
&gt; #8  0x0000000000400a43 in main ()<br>
&gt;<br>
&gt; [root@RAID openmpi-1.6.5]# pstack 22167<br>
&gt; #0  0x00000030302e8ee3 in __epoll_wait_nocancel () from /lib64/libc.so.6<br>
&gt; #1  0x00007f7ee46885eb in epoll_dispatch () from /usr/local/lib/libmpi.so.1<br>
&gt; #2  0x00007f7ee468a75a in opal_event_base_loop () from<br>
&gt; /usr/local/lib/libmpi.so.1<br>
&gt; #3  0x00007f7ee46af229 in opal_progress () from /usr/local/lib/libmpi.so.1<br>
&gt; #4  0x00007f7ee45fcf75 in ompi_request_default_wait_all () from<br>
&gt; /usr/local/lib/libmpi.so.1<br>
&gt; #5  0x00007f7ee060b65e in ompi_coll_tuned_sendrecv_actual () from<br>
&gt; /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; #6  0x00007f7ee06138ff in ompi_coll_tuned_barrier_intra_two_procs () from<br>
&gt; /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; #7  0x00007f7ee460a1c2 in PMPI_Barrier () from /usr/local/lib/libmpi.so.1<br>
&gt; #8  0x0000000000400a43 in main ()<br>
&gt;<br>
&gt;  Which looks exactly the same on each machine.  Any thoughts or ideas would<br>
&gt; be greatly appreciated as<br>
&gt; I am stuck.<br>
&gt;<br>
&gt;  Clay Kirkland<br>
&gt; -------------- next part --------------<br>
&gt; HTML attachment scrubbed and removed<br>
&gt;<br>
&gt; ------------------------------<br>
&gt;<br>
&gt; Message: 2<br>
&gt; Date: Sat, 3 May 2014 06:39:20 -0700<br>
&gt; From: Ralph Castain &lt;<a href="mailto:rhc@open-mpi.org">rhc@open-mpi.org</a>&gt;<br>
&gt; To: Open MPI Users &lt;<a href="mailto:users@open-mpi.org">users@open-mpi.org</a>&gt;<br>
&gt; Subject: Re: [OMPI users] MPI_Barrier hangs on second attempt but only<br>
&gt;         when    multiple hosts used.<br>
&gt; Message-ID: &lt;<a href="mailto:3CF53D73-15D9-40BB-A2DE-50BA3561A0F4@open-mpi.org">3CF53D73-15D9-40BB-A2DE-50BA3561A0F4@open-mpi.org</a>&gt;<br>
&gt; Content-Type: text/plain; charset=&quot;us-ascii&quot;<br>
&gt;<br>
&gt; Hmmm...just testing on my little cluster here on two nodes, it works just fine with 1.8.2:<br>
&gt;<br>
&gt; [rhc@bend001 v1.8]$ mpirun -n 2 --map-by node ./a.out<br>
&gt;  In rank 0 and host= bend001  Do Barrier call 1.<br>
&gt;  In rank 0 and host= bend001  Do Barrier call 2.<br>
&gt;  In rank 0 and host= bend001  Do Barrier call 3.<br>
&gt;  In rank 1 and host= bend002  Do Barrier call 1.<br>
&gt;  In rank 1 and host= bend002  Do Barrier call 2.<br>
&gt;  In rank 1 and host= bend002  Do Barrier call 3.<br>
&gt; [rhc@bend001 v1.8]$<br>
&gt;<br>
&gt;<br>
&gt; How are you configuring OMPI?<br>
&gt;<br>
&gt;<br>
&gt; On May 2, 2014, at 2:24 PM, Clay Kirkland &lt;<a href="mailto:clay.kirkland@versityinc.com">clay.kirkland@versityinc.com</a>&gt; wrote:<br>
&gt;<br>
&gt; &gt; I have been using MPI for many many years so I have very well debugged mpi tests.   I am<br>
&gt; &gt; having trouble on either openmpi-1.4.5  or  openmpi-1.6.5 versions though with getting the<br>
&gt; &gt; MPI_Barrier calls to work.   It works fine when I run all processes on one machine but when<br>
&gt; &gt; I run with two or more hosts the second call to MPI_Barrier always hangs.   Not the first one,<br>
&gt; &gt; but always the second one.   I looked at FAQ&#39;s and such but found nothing except for a comment<br>
&gt; &gt; that MPI_Barrier problems were often problems with fire walls.  Also mentioned as a problem<br>
&gt; &gt; was not having the same version of mpi on both machines.  I turned firewalls off and removed<br>
&gt; &gt; and reinstalled the same version on both hosts but I still see the same thing.   I then installed<br>
&gt; &gt; lam mpi on two of my machines and that works fine.   I can call the MPI_Barrier function when run on<br>
&gt; &gt; one of two machines by itself  many times with no hangs.  Only hangs if two or more hosts are involved.<br>
&gt; &gt; These runs are all being done on CentOS release 6.4.   Here is test program I used.<br>
&gt; &gt;<br>
&gt; &gt; main (argc, argv)<br>
&gt; &gt; int argc;<br>
&gt; &gt; char **argv;<br>
&gt; &gt; {<br>
&gt; &gt;     char message[20];<br>
&gt; &gt;     char hoster[256];<br>
&gt; &gt;     char nameis[256];<br>
&gt; &gt;     int fd, i, j, jnp, iret, myrank, np, ranker, recker;<br>
&gt; &gt;     MPI_Comm comm;<br>
&gt; &gt;     MPI_Status status;<br>
&gt; &gt;<br>
&gt; &gt;     MPI_Init( &amp;argc, &amp;argv );<br>
&gt; &gt;     MPI_Comm_rank( MPI_COMM_WORLD, &amp;myrank);<br>
&gt; &gt;     MPI_Comm_size( MPI_COMM_WORLD, &amp;np);<br>
&gt; &gt;<br>
&gt; &gt;         gethostname(hoster,256);<br>
&gt; &gt;<br>
&gt; &gt;         printf(&quot; In rank %d and host= %s  Do Barrier call 1.\n&quot;,myrank,hoster);<br>
&gt; &gt;     MPI_Barrier(MPI_COMM_WORLD);<br>
&gt; &gt;         printf(&quot; In rank %d and host= %s  Do Barrier call 2.\n&quot;,myrank,hoster);<br>
&gt; &gt;     MPI_Barrier(MPI_COMM_WORLD);<br>
&gt; &gt;         printf(&quot; In rank %d and host= %s  Do Barrier call 3.\n&quot;,myrank,hoster);<br>
&gt; &gt;     MPI_Barrier(MPI_COMM_WORLD);<br>
&gt; &gt;     MPI_Finalize();<br>
&gt; &gt;     exit(0);<br>
&gt; &gt; }<br>
&gt; &gt;<br>
&gt; &gt;   Here are three runs of test program.  First with two processes on one host, then with<br>
&gt; &gt; two processes on another host, and finally with one process on each of two hosts.  The<br>
&gt; &gt; first two runs are fine but the last run hangs on the second MPI_Barrier.<br>
&gt; &gt;<br>
&gt; &gt; [root@centos MPI]# /usr/local/bin/mpirun -np 2 --host centos a.out<br>
&gt; &gt;  In rank 0 and host= centos  Do Barrier call 1.<br>
&gt; &gt;  In rank 1 and host= centos  Do Barrier call 1.<br>
&gt; &gt;  In rank 1 and host= centos  Do Barrier call 2.<br>
&gt; &gt;  In rank 1 and host= centos  Do Barrier call 3.<br>
&gt; &gt;  In rank 0 and host= centos  Do Barrier call 2.<br>
&gt; &gt;  In rank 0 and host= centos  Do Barrier call 3.<br>
&gt; &gt; [root@centos MPI]# /usr/local/bin/mpirun -np 2 --host RAID a.out<br>
&gt; &gt; /root/.bashrc: line 14: unalias: ls: not found<br>
&gt; &gt;  In rank 0 and host= RAID  Do Barrier call 1.<br>
&gt; &gt;  In rank 0 and host= RAID  Do Barrier call 2.<br>
&gt; &gt;  In rank 0 and host= RAID  Do Barrier call 3.<br>
&gt; &gt;  In rank 1 and host= RAID  Do Barrier call 1.<br>
&gt; &gt;  In rank 1 and host= RAID  Do Barrier call 2.<br>
&gt; &gt;  In rank 1 and host= RAID  Do Barrier call 3.<br>
&gt; &gt; [root@centos MPI]# /usr/local/bin/mpirun -np 2 --host centos,RAID a.out<br>
&gt; &gt; /root/.bashrc: line 14: unalias: ls: not found<br>
&gt; &gt;  In rank 0 and host= centos  Do Barrier call 1.<br>
&gt; &gt;  In rank 0 and host= centos  Do Barrier call 2.<br>
&gt; &gt; In rank 1 and host= RAID  Do Barrier call 1.<br>
&gt; &gt;  In rank 1 and host= RAID  Do Barrier call 2.<br>
&gt; &gt;<br>
&gt; &gt;   Since it is such a simple test and problem and such a widely used MPI function, it must obviously<br>
&gt; &gt; be an installation or configuration problem.   A pstack for each of the hung MPI_Barrier processes<br>
&gt; &gt; on the two machines shows this:<br>
&gt; &gt;<br>
&gt; &gt; [root@centos ~]# pstack 31666<br>
&gt; &gt; #0  0x0000003baf0e8ee3 in __epoll_wait_nocancel () from /lib64/libc.so.6<br>
&gt; &gt; #1  0x00007f5de06125eb in epoll_dispatch () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #2  0x00007f5de061475a in opal_event_base_loop () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #3  0x00007f5de0639229 in opal_progress () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #4  0x00007f5de0586f75 in ompi_request_default_wait_all () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #5  0x00007f5ddc59565e in ompi_coll_tuned_sendrecv_actual () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; &gt; #6  0x00007f5ddc59d8ff in ompi_coll_tuned_barrier_intra_two_procs () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; &gt; #7  0x00007f5de05941c2 in PMPI_Barrier () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #8  0x0000000000400a43 in main ()<br>
&gt; &gt;<br>
&gt; &gt; [root@RAID openmpi-1.6.5]# pstack 22167<br>
&gt; &gt; #0  0x00000030302e8ee3 in __epoll_wait_nocancel () from /lib64/libc.so.6<br>
&gt; &gt; #1  0x00007f7ee46885eb in epoll_dispatch () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #2  0x00007f7ee468a75a in opal_event_base_loop () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #3  0x00007f7ee46af229 in opal_progress () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #4  0x00007f7ee45fcf75 in ompi_request_default_wait_all () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #5  0x00007f7ee060b65e in ompi_coll_tuned_sendrecv_actual () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; &gt; #6  0x00007f7ee06138ff in ompi_coll_tuned_barrier_intra_two_procs () from /usr/local/lib/openmpi/mca_coll_tuned.so<br>
&gt; &gt; #7  0x00007f7ee460a1c2 in PMPI_Barrier () from /usr/local/lib/libmpi.so.1<br>
&gt; &gt; #8  0x0000000000400a43 in main ()<br>
&gt; &gt;<br>
&gt; &gt;  Which looks exactly the same on each machine.  Any thoughts or ideas would be greatly appreciated as<br>
&gt; &gt; I am stuck.<br>
&gt; &gt;<br>
&gt; &gt;  Clay Kirkland<br>
&gt; &gt;<br>
&gt; &gt;<br>
&gt; &gt;<br>
&gt; &gt;<br>
&gt; &gt; _______________________________________________<br>
&gt; &gt; users mailing list<br>
&gt; &gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
&gt; &gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
&gt;<br>
&gt; -------------- next part --------------<br>
&gt; HTML attachment scrubbed and removed<br>
&gt;<br>
&gt; ------------------------------<br>
&gt;<br>
&gt; Subject: Digest Footer<br>
&gt;<br>
&gt; _______________________________________________<br>
&gt; users mailing list<br>
&gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
&gt;<br>
&gt; ------------------------------<br>
&gt;<br>
&gt; End of users Digest, Vol 2879, Issue 1<br>
&gt; **************************************<br>
&gt;<br>
&gt; _______________________________________________<br>
&gt; users mailing list<br>
&gt; <a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
<br>
<br>
--<br>
Jeff Squyres<br>
<a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a><br>
For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
<br>
<br>
<br>
------------------------------<br>
<br>
Subject: Digest Footer<br>
<br>
_______________________________________________<br>
users mailing list<br>
<a href="mailto:users@open-mpi.org">users@open-mpi.org</a><br>
<a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/users</a><br>
<br>
------------------------------<br>
<br>
End of users Digest, Vol 2881, Issue 1<br>
**************************************<br>
</blockquote></div><br></div>

