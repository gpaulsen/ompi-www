I am new to openmpi. I am not sure whether my logic below will work or not. Can someone please confirm for me on that ? Basically, what this does is trying to check whether there are anything to send, if there are, send it right away and set sentinit to true. Then check whether there are anything to receive, if there are receive it. I am running this on a client-server model (2 nodes sending and receiving data between each other)<div>
<br></div><div>for (;;)  {</div><div>               if (sendinit &amp;&amp; MPI_Test(&amp;sendreq, &amp;sendcomplete, &amp;sendstatus)) {</div><div><div>                      if (sendcomplete) {</div><div>                         if (pollv[1].revents &amp; POLLIN) {</div>
<div>                             printf(&quot;Trying to send in rank %d\n&quot;, rank);</div><div>                             nx=vde_recv(conn,sendbuff,BUFSIZE-2,0);</div><div>                             vdestream_mpisend(vdestream,sendbuff, nx, GET_PAIR_RANK(rank), &amp;sendreq);</div>
<div>                         } else {</div><div>                             // no in-flight request.</div><div>                             sendinit = false;</div><div>                         }</div><div>                      }</div>
<div>                   } else {</div><div>                      // no in-flight request. try to start one</div><div>                      if (!sendinit &amp;&amp; pollv[1].revents &amp; POLLIN) {</div><div>                           nx=vde_recv(conn,sendbuff,BUFSIZE-2,0);</div>
<div>                           printf(&quot;Trying to send in rank %d\n&quot;, rank );</div><div>                           vdestream_mpisend(vdestream,sendbuff, nx, GET_PAIR_RANK(rank), &amp;sendreq);</div><div>                           sendinit = true;</div>
<div>                       }</div><div>                   }</div></div><div><br></div><div><br></div><div><div>                   if (recvinit &amp;&amp; MPI_Test(&amp;recvreq, &amp;recvcomplete, &amp;recvstatus)) {</div>
<div>                      if (recvcomplete) {</div><div>                          printf(&quot;Receive completed\n&quot;);</div><div>                          // get the actual number of byet received.</div><div>                          MPI_Get_count(&amp;recvstatus, MPI_CHAR, &amp;recvcount);</div>
<div>                          vdestream_recv(vdestream, recvbuff, recvcount);</div><div>                          // no more in-flight recv.</div><div>                          recvinit = false;</div><div>                      }</div>
<div>                   } else {</div><div>                      if (!recvinit) {</div><div>                         printf(&quot;Trying to receive in rank %d\n&quot;, rank);</div><div>                         // no in-flight recv. try to start one.</div>
<div>                         vdestream_mpirecv(vdestream, recvbuff, BUFSIZE-2, GET_PAIR_RANK(rank), &amp;recvreq);</div><div>                         recvinit = true;</div><div>                      }</div><div>                   }</div>
</div><div>}</div><div><br></div><div><br>-- <br>Kind Regards <br><br>Xin Tong <br>
</div>

