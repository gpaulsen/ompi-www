<div dir="ltr">I want to build OpenMPI 1.8.7 on a Cray XC30 (Edison at NERSC). I&#39;ve tried various configuration options, but I am always encountering either OpenMPI build errors, application build errors, or run-time errors.<div><br></div><div>I&#39;m currently looking at &lt;<a href="http://www.open-mpi.org/community/lists/users/2015/06/27230.php" target="_blank">http://www.open-mpi.org/community/lists/users/2015/06/27230.php</a>&gt;, which seems to describe my case. I&#39;m now configuring OpenMPI without any options, except setting compilers to clang/gfortran and pointing it to a self-built hwloc. For completeness, here are my configure options as recorded by config.status:</div><div><br></div><div>&#39;/project/projectdirs/m152/schnette/edison/software/src/openmpi-1.8.7/src/openmpi-1.8.7/configure&#39; Â &#39;--prefix=/project/projectdirs/m152/schnette/edison/software/openmpi-1.8.7&#39; &#39;--with-hwloc=/project/projectdirs/m152/schnette/edison/software/hwloc-1.11.0&#39; &#39;--disable-vt&#39; &#39;CC=/project/projectdirs/m152/schnette/edison/software/llvm-3.6.2/bin/wrap-clang&#39; &#39;CXX=/project/projectdirs/m152/schnette/edison/software/llvm-3.6.2/bin/wrap-clang++&#39; &#39;FC=/project/projectdirs/m152/schnette/edison/software/gcc-5.2.0/bin/wrap-gfortran&#39; &#39;CFLAGS=-I/opt/ofed/include -I/project/projectdirs/m152/schnette/edison/software/hwloc-1.11.0/include&#39; &#39;CXXFLAGS=-I/opt/ofed/include -I/project/projectdirs/m152/schnette/edison/software/hwloc-1.11.0/include&#39; &#39;LDFLAGS=-L/opt/ofed/lib64 -L/project/projectdirs/m152/schnette/edison/software/hwloc-1.11.0/lib -Wl,-rpath,/project/projectdirs/m152/schnette/edison/software/hwloc-1.11.0/lib&#39; &#39;LIBS=-lhwloc -lpthread -lpthread&#39; &#39;--with-wrapper-ldflags=-L/project/projectdirs/m152/schnette/edison/software/hwloc-1.11.0/lib -Wl,-rpath,/project/projectdirs/m152/schnette/edison/software/hwloc-1.11.0/lib&#39; &#39;--with-wrapper-libs=-lhwloc -lpthread&#39;<br></div><div><br></div><div>This builds and installs fine, and works when running on a single node. However, multi-node runs are stalling: The queue starts the job, but mpirun produces no output. The &quot;-v&quot; option to mpirun doesn&#39;t help.</div><div><br></div><div>When I use aprun instead of mpirun to start my application, then all processes think they are rank 0.</div><div><br></div><div>Do you have any pointers for how to debug this?</div><div><br></div><div>-erik</div><div><div><br></div>-- <br><div>Erik Schnetter &lt;<a href="mailto:schnetter@gmail.com" target="_blank">schnetter@gmail.com</a>&gt; <a href="http://www.perimeterinstitute.ca/personal/eschnetter/" target="_blank">http://www.perimeterinstitute.ca/personal/eschnetter/</a><br></div>
</div></div>

