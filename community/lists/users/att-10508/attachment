<table cellspacing="0" cellpadding="0" border="0" ><tr><td valign="top" style="font: inherit;">Dear all,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I am trying to checkpoint an mpi application at specific points in my program. So, i created a small function as follows:<br><br>void mychkpt()<br>{<br>system ("ompi-checkpoint -v `pidof mpirun`");<br>}<br><br>and I am calling it in my MPI application at specific points. e.g<br><br>##############<br>printf("I am processor no %d of a total of %d procs \n", rank, size);<br>system("sleep 6");<br>mychkpt();<br>printf("I am processor no %d of a total of %d procs \n", rank, size);<br>system("sleep 4");<br>mychkpt();<br>#############<br><br>If i do:<br>&nbsp;mpirun -am ft-enable-cr -np 1 mpisleepts0,<br><br>it works fine. but if i use more than 1 node there is a problem. e.g<br><br>mpirun -am ft-enable-cr -np 2 mpisleepts0<br><br>I get<br><br>################<br>I am processor
 no 0 of a total of 2 procs <br>I am processor no 1 of a total of 2 procs <br>[jean:13673] orte_checkpoint: Checkpointing...<br>[jean:13673] &nbsp;&nbsp;&nbsp; &nbsp;PID 13647<br>[jean:13673] &nbsp;&nbsp;&nbsp; &nbsp;Connected to Mpirun [[28355,0],0]<br>[jean:13673] orte_checkpoint: notify_hnp: Contact Head Node Process PID 13647<br>[jean:13673] orte_checkpoint: notify_hnp: Requested a checkpoint of jobid [INVALID]<br>[jean:13673] orte_checkpoint: hnp_receiver: Receive a command message.<br>[jean:13673] orte_checkpoint: hnp_receiver: Status Update.<br>[jean:13673]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Requested - Global Snapshot Reference: (null)<br>[jean:13673] orte_checkpoint: hnp_receiver: Receive a command message.<br>[jean:13673] orte_checkpoint: hnp_receiver: Status
 Update.<br>[jean:13673]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pending - Global Snapshot Reference: (null)<br>[jean:13673] orte_checkpoint: hnp_receiver: Receive a command message.<br>[jean:13673] orte_checkpoint: hnp_receiver: Status Update.<br>[jean:13673]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Running - Global Snapshot Reference: (null)<br>[jean:13672] orte_checkpoint: Checkpointing...<br>[jean:13672] &nbsp;&nbsp;&nbsp; &nbsp;PID 13647<br>[jean:13672] &nbsp;&nbsp;&nbsp; &nbsp;Connected to Mpirun [[28355,0],0]<br>[jean:13672] orte_checkpoint: notify_hnp: Contact Head Node Process PID 13647<br>[jean:13672] orte_checkpoint: notify_hnp: Requested a checkpoint of jobid [INVALID]<br>[jean:13673] orte_checkpoint: hnp_receiver: Receive a command message.<br>[jean:13673] orte_checkpoint: hnp_receiver: Status
 Update.<br>[jean:13673]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File Transfer - Global Snapshot Reference: (null)<br>[jean:13673] orte_checkpoint: hnp_receiver: Receive a command message.<br>[jean:13673] orte_checkpoint: hnp_receiver: Status Update.<br>[jean:13673]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Finished - Global Snapshot Reference: ompi_global_snapshot_13647.ckptSnapshot Ref.:&nbsp;&nbsp; 0 ompi_global_snapshot_13647.ckpt<br>^Xmpirun: killing job...<br>#################<br><br>It runs the function twice simultaneously which try to call the checkpointing process twice...thus causing problems.<br><br>How can i ensure that the checkpointing process is called only once when there are more than one process running?<br><br>Please given me some ideas on it. <br><br>Thank you<br><br>Jean <br></td></tr></table><br>


      
