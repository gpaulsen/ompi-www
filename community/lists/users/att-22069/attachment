<html><head><meta http-equiv="Content-Type" content="text/html charset=windows-1252"><base href="x-msg://272/"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">So, just to be sure - when you run 320 "cores", you are running across 20 nodes?<div><br></div><div>Just want to ensure we are using "core" the same way - some people confuse cores with hyperthreads.</div><div><br><div><div>On Jun 9, 2013, at 3:50 PM, "Blosch, Edwin L" &lt;<a href="mailto:edwin.l.blosch@lmco.com">edwin.l.blosch@lmco.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div lang="EN-US" link="blue" vlink="purple" style="font-family: Helvetica; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; "><div class="WordSection1" style="page: WordSection1; "><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); ">16.&nbsp; dual-socket Xeon, E5-2670.<o:p></o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); ">&nbsp;</span></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); ">I am trying a larger model to see if the performance drop-off happens at a different number of cores.&nbsp;<o:p></o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); ">Also I’m running some intermediate core-count sizes to refine the curve a bit.<o:p></o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); ">I also added mpi_show_mca_params all, and at the same time, btl_openib_use_eager_rdma 1, just to see if that does anything.<o:p></o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); ">&nbsp;</span></div><div><div style="border-style: solid none none; border-top-width: 1pt; border-top-color: rgb(181, 196, 223); padding: 3pt 0in 0in; "><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><b><span style="font-size: 10pt; font-family: Tahoma, sans-serif; ">From:</span></b><span style="font-size: 10pt; font-family: Tahoma, sans-serif; "><span class="Apple-converted-space">&nbsp;</span><a href="mailto:users-bounces@open-mpi.org">users-bounces@open-mpi.org</a> [mailto:users-<a href="mailto:bounces@open-mpi.org">bounces@open-mpi.org</a>]<span class="Apple-converted-space">&nbsp;</span><b>On Behalf Of<span class="Apple-converted-space">&nbsp;</span></b>Ralph Castain<br><b>Sent:</b><span class="Apple-converted-space">&nbsp;</span>Sunday, June 09, 2013 5:04 PM<br><b>To:</b><span class="Apple-converted-space">&nbsp;</span>Open MPI Users<br><b>Subject:</b><span class="Apple-converted-space">&nbsp;</span>EXTERNAL: Re: [OMPI users] Need advice on performance problem<o:p></o:p></span></div></div></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><o:p>&nbsp;</o:p></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; ">Looks to me like things are okay thru 160, and then things fall apart after that point. How many cores are on a node?<o:p></o:p></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><o:p>&nbsp;</o:p></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><o:p>&nbsp;</o:p></div><div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; ">On Jun 9, 2013, at 1:59 PM, "Blosch, Edwin L" &lt;<a href="mailto:edwin.l.blosch@lmco.com" style="color: purple; text-decoration: underline; ">edwin.l.blosch@lmco.com</a>&gt; wrote:<o:p></o:p></div></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><br><br><o:p></o:p></div><div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">I’m having some trouble getting good scaling with OpenMPI 1.6.4 and I don’t know where to start looking. This is an Infiniband FDR network with Sandy Bridge nodes.&nbsp; I am using affinity (--bind-to-core) but no other options. As the number of cores goes up, the message sizes are typically going down. There seem to be lots of options in the FAQ, and I would welcome any advice on where to start.&nbsp; All these timings are on a completely empty system except for me.</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">&nbsp;</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">Thanks</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">&nbsp;</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">&nbsp;</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">&nbsp;&nbsp;&nbsp; MPI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # cores&nbsp;&nbsp; Ave. Rate&nbsp;&nbsp; Std. Dev. %&nbsp; # timings&nbsp;&nbsp; Speedup&nbsp;&nbsp;&nbsp; Efficiency</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">================================================================================================</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">MVAPICH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; 16&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 8.6783&nbsp; |&nbsp;&nbsp; 0.995 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp; |&nbsp;&nbsp; 16.000&nbsp; |&nbsp; 1.0000</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">MVAPICH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; 48&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 8.7665&nbsp; |&nbsp;&nbsp; 1.937 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp; |&nbsp;&nbsp; 47.517&nbsp; |&nbsp; 0.9899</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">MVAPICH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; 80&nbsp;&nbsp; |&nbsp; &nbsp;&nbsp;8.8900&nbsp; |&nbsp;&nbsp; 2.291 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp; |&nbsp;&nbsp; 78.095&nbsp; |&nbsp; 0.9762</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">MVAPICH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 160&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 8.9897&nbsp; |&nbsp;&nbsp; 2.409 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp; |&nbsp; 154.457&nbsp; |&nbsp; 0.9654</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">MVAPICH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 320&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 8.9780&nbsp; |&nbsp;&nbsp; 2.801 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp; |&nbsp; 309.317&nbsp; |&nbsp; 0.9666</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">MVAPICH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 480 &nbsp;&nbsp;|&nbsp;&nbsp;&nbsp; 8.9704&nbsp; |&nbsp;&nbsp; 2.316 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp; |&nbsp; 464.366&nbsp; |&nbsp; 0.9674</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">MVAPICH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 640&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 9.0792&nbsp; |&nbsp;&nbsp; 1.138 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp; |&nbsp; 611.739&nbsp; |&nbsp; 0.9558</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">MVAPICH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 720&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 9.1328&nbsp; |&nbsp;&nbsp; 1.052 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp; |&nbsp; 684.162&nbsp; |&nbsp; 0.9502</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">MVAPICH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp;800&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 9.1945&nbsp; |&nbsp;&nbsp; 0.773 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp; |&nbsp; 755.079&nbsp; |&nbsp; 0.9438</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">OpenMPI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; 16&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 8.6743&nbsp; |&nbsp;&nbsp; 2.335 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp; |&nbsp;&nbsp; 16.000&nbsp; |&nbsp; 1.0000</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">OpenMPI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; 48&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 8.7826&nbsp; |&nbsp;&nbsp; 1.605 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp; |&nbsp;&nbsp; 47.408&nbsp; |&nbsp; 0.9877</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">OpenMPI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp; 80&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 8.8861&nbsp; |&nbsp;&nbsp; 0.120 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp; |&nbsp;&nbsp; 78.093&nbsp; |&nbsp; 0.9762</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">OpenMPI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 160&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 8.9774&nbsp; |&nbsp;&nbsp; 0.785 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp; |&nbsp; 154.598&nbsp; |&nbsp; 0.9662</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">OpenMPI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 320&nbsp;&nbsp; |&nbsp;&nbsp; 12.0585&nbsp; |&nbsp; 16.950 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp; |&nbsp; 230.191&nbsp; |&nbsp; 0.7193</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">OpenMPI&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp; 480&nbsp;&nbsp; |&nbsp;&nbsp; 14.8330&nbsp; |&nbsp;&nbsp; 1.300 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp; |&nbsp; 280.701&nbsp; |&nbsp; 0.5848</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">OpenMPI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 640&nbsp;&nbsp; |&nbsp;&nbsp; 17.1723&nbsp; |&nbsp;&nbsp; 2.577 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp; |&nbsp; 323.283&nbsp; |&nbsp; 0.5051</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">OpenMPI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 720&nbsp;&nbsp; |&nbsp;&nbsp; 18.2153&nbsp; |&nbsp;&nbsp; 2.798 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp; |&nbsp; 342.868&nbsp; |&nbsp; 0.4762</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: 'Courier New'; ">OpenMPI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 800&nbsp;&nbsp; |&nbsp;&nbsp; 19.3603&nbsp; |&nbsp;&nbsp; 2.254 % |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp; |&nbsp; 358.434&nbsp; |&nbsp; 0.4480</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; "><o:p></o:p></span></div></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 13.5pt; font-family: Helvetica, sans-serif; ">_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org" style="color: purple; text-decoration: underline; "><span style="color: purple; ">users@open-mpi.org</span></a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" style="color: purple; text-decoration: underline; "><span style="color: purple; ">http://www.open-mpi.org/mailman/listinfo.cgi/users</span></a><o:p></o:p></span></div></div></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><o:p>&nbsp;</o:p></div></div></div>_______________________________________________<br>users mailing list<br><a href="mailto:users@open-mpi.org" style="color: purple; text-decoration: underline; ">users@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/users" style="color: purple; text-decoration: underline; ">http://www.open-mpi.org/mailman/listinfo.cgi/users</a></div></blockquote></div><br></div></body></html>
