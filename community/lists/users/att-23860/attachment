<html>
<head>
<style><!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 12pt;
font-family:Calibri
}
--></style></head>
<body class='hmmessage'><div dir='ltr'>Thanks for your kindly input<br><br>More further questions<br><br>1.&nbsp; How to check  and change the ordering of network&nbsp; interfaces, such as tcp, ib, etc.,&nbsp; in the kernel?<br><br>2.&nbsp; One of my applications only can run with "--mca btl tcp,self",&nbsp; otherwise aborted without specific error messages, even if run on single node.&nbsp; &nbsp; How to figure out the possible reasons? <br><br>Appreciating your kindly input<br><br>Jianyu<br><br><br><div>&gt; From: rhc@open-mpi.org<br>&gt; Date: Sat, 15 Mar 2014 07:21:31 -0700<br>&gt; To: users@open-mpi.org<br>&gt; Subject: Re: [OMPI users] Question about '--mca btl tcp,self'<br>&gt; <br>&gt; <br>&gt; On Mar 14, 2014, at 10:18 PM, Jianyu Liu &lt;jerry_leo@msn.com&gt; wrote:<br>&gt; <br>&gt; &gt;&gt; On Mar 14, 2014, at 10:16:34 AM,Jeff Squyres &lt;jsquyres_at_[hidden]&gt; wrote: <br>&gt; &gt;&gt; <br>&gt; &gt;&gt;&gt; On Mar 14, 2014, at 10:11 AM, Ralph Castain &lt;rhc_at_[hidden]&gt; wrote: <br>&gt; &gt;&gt;&gt; <br>&gt; &gt;&gt;&gt;&gt; 1. If specified '--mca btl tcp,self', which interface application will run on, use GigE adaper OR use the OpenFabrics interface in IP over IB mode (just like a high performance GigE adapter) ? <br>&gt; &gt;&gt;&gt; <br>&gt; &gt;&gt;&gt; Both - ip over ib looks just like an Ethernet adaptor <br>&gt; &gt;&gt; <br>&gt; &gt;&gt; <br>&gt; &gt;&gt; To be clear: the TCP BTL will use all TCP interfaces (regardless of underlying physical transport). Your GigE adapter and your IP adapter both present IP interfaces to&gt;the OS, and both support TCP. So the TCP BTL will use them, because it just sees the TCP/IP interfaces. <br>&gt; &gt; <br>&gt; &gt; Thanks for your kindly input.<br>&gt; &gt; <br>&gt; &gt; Please see if I have understood correctly<br>&gt; &gt; <br>&gt; &gt; Assume there are two nework<br>&gt; &gt;   Gigabit Ethernet<br>&gt; &gt; <br>&gt; &gt;     eth0-renamed : 192.168.[1-22].[1-14] / 255.255.192.0<br>&gt; &gt; <br>&gt; &gt;   InfiniBand network<br>&gt; &gt; <br>&gt; &gt;     ib0 :  172.20.[1-22].[1-4] / 255.255.0.0<br>&gt; &gt; <br>&gt; &gt; <br>&gt; &gt; 1. If specified '--mca btl tcp,self<br>&gt; &gt; <br>&gt; &gt;     The control information ( such as setup and teardown ) are routed to and passed by Gigabit Ethernet in TCP/IP mode<br>&gt; <br>&gt; Not necessarily - the out-of-band (OOB) system will pickup one of the TCP interfaces, but which one depends on the ordering in the kernel.<br>&gt; <br>&gt; &gt;     The MPI messages are routed to and passed by InfiniBand network in IP over IB mode<br>&gt; <br>&gt; Not necessarily - could use either device<br>&gt; <br>&gt; &gt;     On the same machine, the TCP lookback device will be used for passing control and MPI messages <br>&gt; <br>&gt; I believe the TCP BTL would use the selected device for loopback, ignoring the loopback device<br>&gt; <br>&gt; &gt; <br>&gt; &gt; 2. If specified '--mca btl tcp,self --mca btl_tcp_if_include ib0'<br>&gt; &gt; <br>&gt; &gt;     Both of control information ( such as setup and teardown ) and MPI messages are routed to and passed by InfiniBand network in IP over IB mode<br>&gt; <br>&gt; No - control info is sent by the OOB, not the BTL. To get what you describe, you would have to add "-mca oob_tcp_if_include ib0"<br>&gt; <br>&gt; &gt;     On the same machine, The TCP lookback device will be used for passing control and MPI messages<br>&gt; <br>&gt; No - the TCP MPI messages would loopback via the ib0 device<br>&gt; <br>&gt; &gt; <br>&gt; &gt; <br>&gt; &gt; 3. If specified '--mca btl openib,self'<br>&gt; &gt; <br>&gt; &gt;     The control information ( such as setup and teardown ) are routed to and passed by InfiniBand network in IP over IB mode<br>&gt; <br>&gt; Not necessarily - same answer as #1<br>&gt; <br>&gt; &gt;     The MPI messages are routed to and passed by InfiniBand network in RDMA mode<br>&gt; <br>&gt; Well, it will use IB, but may not use RDMA. That is an internal decision tree made per-message based on a variety of factors<br>&gt; <br>&gt; &gt;     On the same machine, the TCP lookback device will be used for passing control and MPI messages<br>&gt; <br>&gt; No - you excluded TCP for MPI messages, and so it would have to loopback within the IB stack. Control messages would loopback via TCP<br>&gt; <br>&gt; &gt; <br>&gt; &gt; <br>&gt; &gt; 4. If without specifiying any 'mca btl' parameters<br>&gt; &gt; <br>&gt; &gt;     The control information ( such as setup and teardown ) are routed to and passed by Gigabit Ethernet in TCP/IP mode<br>&gt; <br>&gt; Not necessarily - same answer as #1<br>&gt; <br>&gt; &gt;     The MPI messages are routed and passed by InfiniBand network in RDMA mode<br>&gt; <br>&gt; Same as #3<br>&gt; <br>&gt; &gt;     On the same machine, the shared memory (sm) BTL will be used for control and MPI passing messages<br>&gt; <br>&gt; Not for control - just for MPI<br>&gt; <br>&gt; &gt; <br>&gt; &gt; <br>&gt; &gt; Appreciating your kindly input<br>&gt; &gt; <br>&gt; &gt; Jianyu 		 	   		  <br>&gt; &gt; _______________________________________________<br>&gt; &gt; users mailing list<br>&gt; &gt; users@open-mpi.org<br>&gt; &gt; http://www.open-mpi.org/mailman/listinfo.cgi/users<br>&gt; <br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt; users@open-mpi.org<br>&gt; http://www.open-mpi.org/mailman/listinfo.cgi/users<br></div> 		 	   		  </div></body>
</html>
