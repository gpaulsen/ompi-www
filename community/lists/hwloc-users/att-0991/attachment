<html>
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  </head>
  <body bgcolor="#FFFFFF" text="#000000">
    <div class="moz-cite-prefix">Can you run hwloc-gather-topology foo
      and send the resulting foo.tar.bz2 ?<br>
      If the tarball is too bug, feel free to send it to me in a private
      mail.<br>
      <br>
      Brice<br>
      <br>
      <br>
      <br>
      Le 25/03/2014 08:55, Biddiscombe, John A. a écrit :<br>
    </div>
    <blockquote
      cite="mid:50320452A334BD42A5EC72BAD2145099102D8CED@MBX110.d.ethz.ch"
      type="cite">
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <meta name="Generator" content="Microsoft Word 14 (filtered
        medium)">
      <!--[if !mso]><style>v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style><![endif]-->
      <style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	color:black;
	mso-fareast-language:EN-US;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p
	{mso-style-priority:99;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
pre
	{mso-style-priority:99;
	mso-style-link:"HTML Preformatted Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-priority:99;
	mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";
	color:black;
	mso-fareast-language:EN-US;}
span.EmailStyle17
	{mso-style-type:personal;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
span.EmailStyle18
	{mso-style-type:personal;
	font-family:"Calibri","sans-serif";
	color:#1F497D;}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-priority:99;
	mso-style-link:"HTML Preformatted";
	font-family:Consolas;
	color:black;
	mso-fareast-language:EN-US;}
span.EmailStyle22
	{mso-style-type:personal-reply;
	font-family:"Calibri","sans-serif";
	color:#1F497D;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-priority:99;
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";
	color:black;
	mso-fareast-language:EN-US;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-size:10.0pt;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext="edit" spidmax="1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext="edit">
<o:idmap v:ext="edit" data="1" />
</o:shapelayout></xml><![endif]-->
      <div class="WordSection1">
        <p class="MsoNormal"><span style="color:#1F497D">Brice,<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p> </o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">Correct : The
            IO nodes are running a  full linux install (RHE 6.4) on the
            same hardware as the CNK nodes.<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p> </o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">On vesta I do
            not have an account and I am not certain the IO nodes are
            available for direct login. I’m using the BGQ at CSCS which
            is an EPFL machine. The IO nodes are open for some special
            projects where we are trying to customise the IO.<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p> </o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D">JB<o:p></o:p></span></p>
        <p class="MsoNormal"><span style="color:#1F497D"><o:p> </o:p></span></p>
        <div style="border:none;border-left:solid blue 1.5pt;padding:0cm
          0cm 0cm 4.0pt">
          <div>
            <div style="border:none;border-top:solid #B5C4DF
              1.0pt;padding:3.0pt 0cm 0cm 0cm">
              <p class="MsoNormal"><b><span
style="font-size:10.0pt;font-family:&quot;Tahoma&quot;,&quot;sans-serif&quot;;color:windowtext;mso-fareast-language:EN-GB"
                    lang="EN-US">From:</span></b><span
style="font-size:10.0pt;font-family:&quot;Tahoma&quot;,&quot;sans-serif&quot;;color:windowtext;mso-fareast-language:EN-GB"
                  lang="EN-US"> Brice Goglin
                  [<a class="moz-txt-link-freetext" href="mailto:brice.goglin@inria.fr">mailto:brice.goglin@inria.fr</a>] <br>
                  <b>Sent:</b> 25 March 2014 08:43<br>
                  <b>To:</b> Hardware locality user list; Biddiscombe,
                  John A.<br>
                  <b>Subject:</b> Re: [hwloc-users] BGQ question.<o:p></o:p></span></p>
            </div>
          </div>
          <p class="MsoNormal"><o:p> </o:p></p>
          <p class="MsoNormal" style="margin-bottom:12.0pt"><span
              style="font-size:12.0pt;font-family:&quot;Times New
Roman&quot;,&quot;serif&quot;;color:windowtext;mso-fareast-language:EN-GB">Wait,
              I missed the "io node" part of your first mail. The bgq
              support is for compute nodes running cnk. Are io nodes
              running linux on same hardware as the compute nodes?<br>
              <br>
              I have an account on vesta. Where should I logon to have a
              look?<br>
              Brice<br>
              <br>
              <o:p></o:p></span></p>
          <div>
            <p class="MsoNormal"><span
                style="font-size:12.0pt;font-family:&quot;Times New
Roman&quot;,&quot;serif&quot;;color:windowtext;mso-fareast-language:EN-GB">On
                25 mars 2014 08:12:58 UTC+01:00, "Biddiscombe, John A."
                &lt;<a moz-do-not-send="true"
                  href="mailto:biddisco@cscs.ch">biddisco@cscs.ch</a>&gt;
                wrote:<o:p></o:p></span></p>
            <p class="MsoNormal"><span style="color:#1F497D">Brice,<o:p></o:p></span></p>
            <p><span style="color:#1F497D"> <o:p></o:p></span></p>
            <p class="MsoNormal"><span
                style="font-size:12.0pt;font-family:&quot;Times New
                Roman&quot;,&quot;serif&quot;;mso-fareast-language:EN-GB">lstopo
                --whole-system<o:p></o:p></span></p>
            <p> <o:p></o:p></p>
            <p class="MsoNormal"><span
                style="font-size:12.0pt;font-family:&quot;Times New
                Roman&quot;,&quot;serif&quot;;mso-fareast-language:EN-GB">gives
                the same output and setting env var BG_THREADMODEL=2
                does not appear to make any visible difference.
                <o:p></o:p></span></p>
            <p> <o:p></o:p></p>
            <p class="MsoNormal"><span
                style="font-size:12.0pt;font-family:&quot;Times New
                Roman&quot;,&quot;serif&quot;;mso-fareast-language:EN-GB">my
                configure command for compiling hwloc had no special
                options,<o:p></o:p></span></p>
            <p class="MsoNormal"><span
                style="font-size:12.0pt;font-family:&quot;Times New
                Roman&quot;,&quot;serif&quot;;mso-fareast-language:EN-GB">./configure
--prefix=/gpfs/bbp.cscs.ch/home/biddisco/apps/clang/hwloc-1.8.1<o:p></o:p></span></p>
            <p><span style="color:#1F497D"> <o:p></o:p></span></p>
            <p class="MsoNormal"><span style="color:#1F497D">should I
                rerun with something set?<o:p></o:p></span></p>
            <p><span style="color:#1F497D"> <o:p></o:p></span></p>
            <p class="MsoNormal"><span style="color:#1F497D">Thanks<o:p></o:p></span></p>
            <p><span style="color:#1F497D"> <o:p></o:p></span></p>
            <p class="MsoNormal"><span style="color:#1F497D">JB<o:p></o:p></span></p>
            <p><span style="color:#1F497D"> <o:p></o:p></span></p>
            <p><span style="color:#1F497D"> <o:p></o:p></span></p>
            <div style="border:none;border-left:solid blue
              1.5pt;padding:0cm 0cm 0cm 4.0pt">
              <div>
                <div style="border:none;border-top:solid #B5C4DF
                  1.0pt;padding:3.0pt 0cm 0cm 0cm">
                  <p class="MsoNormal"><b><span
style="font-size:10.0pt;font-family:&quot;Tahoma&quot;,&quot;sans-serif&quot;;color:windowtext;mso-fareast-language:EN-GB"
                        lang="EN-US">From:</span></b><span
style="font-size:10.0pt;font-family:&quot;Tahoma&quot;,&quot;sans-serif&quot;;color:windowtext;mso-fareast-language:EN-GB"
                      lang="EN-US"> hwloc-users [<a
                        moz-do-not-send="true"
                        href="mailto:hwloc-users-bounces@open-mpi.org">mailto:hwloc-users-bounces@open-mpi.org</a>]
                      <b>On Behalf Of </b>Brice Goglin<br>
                      <b>Sent:</b> 25 March 2014 08:04<br>
                      <b>To:</b> Hardware locality user list<br>
                      <b>Subject:</b> Re: [hwloc-users] BGQ question.<o:p></o:p></span></p>
                </div>
              </div>
              <p> <o:p></o:p></p>
              <div>
                <p class="MsoNormal">Le 25/03/2014 07:51, Biddiscombe,
                  John A. a écrit :<o:p></o:p></p>
              </div>
              <blockquote style="margin-top:5.0pt;margin-bottom:5.0pt">
                <p class="MsoNormal">I’m compiling hwloc using clang
                  (bgclang++11 from ANL) to run on IO nodes af a BGQ. It
                  seems to have compiled ok, and when I run lstopo, I
                  get an output like this (below), which looks
                  reasonable, but there are 15 sockets instead of 16.
                  I’m a little worried because the first time I
                  compiled, I had problems where apps would report an
                  error from HWLOC on start and tell me to set
                  HWLOC_FORCE_BGQ=1. when I did set this env var, it
                  would then report that “topology became empty” and the
                  app would segfault due to the unexpected return from
                  hwloc presumably.<o:p></o:p></p>
              </blockquote>
              <p class="MsoNormal" style="margin-bottom:12.0pt"><span
                  style="font-size:12.0pt;font-family:&quot;Times New
                  Roman&quot;,&quot;serif&quot;;mso-fareast-language:EN-GB"><br>
                  Can you give a bit more details on what you did there?
                  I'd like to check if that case should be better
                  supported or not.<br>
                  <br>
                  <o:p></o:p></span></p>
              <p class="MsoNormal">I wiped everything and recompiled
                (not sure what I did differently), and now it behaves
                more sensibly, but with 15 instead of 16 sockets.<o:p></o:p></p>
              <p class="MsoNormal"> <o:p></o:p></p>
              <p class="MsoNormal">Should IO be worried? <o:p></o:p></p>
              <p class="MsoNormal" style="margin-bottom:12.0pt"><span
                  style="font-size:12.0pt;font-family:&quot;Times New
                  Roman&quot;,&quot;serif&quot;;mso-fareast-language:EN-GB"><br>
                  The topology detection is hardwired so you shouldn't
                  worried on the hardware side.<br>
                  The problem could be related to how you reserved
                  resources before running lstopo.<br>
                  Does lstopo --whole-system see more sockets?<br>
                  Does BG_THREADMODEL=2 help?<br>
                  <br>
                  Brice<o:p></o:p></span></p>
            </div>
            <pre style="text-align:center"><hr align="center" size="2" width="100%"></pre>
            <pre>
hwloc-users mailing list
<a moz-do-not-send="true" href="mailto:hwloc-users@open-mpi.org">hwloc-users@open-mpi.org</a>
<a moz-do-not-send="true" href="http://www.open-mpi.org/mailman/listinfo.cgi/hwloc-users">http://www.open-mpi.org/mailman/listinfo.cgi/hwloc-users</a><o:p></o:p></pre>
          </div>
        </div>
      </div>
    </blockquote>
    <br>
  </body>
</html>

