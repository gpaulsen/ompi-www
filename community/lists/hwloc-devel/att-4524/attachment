<div dir="ltr"><div class="gmail_extra"><br><div class="gmail_quote">On Tue, Jul 28, 2015 at 2:15 PM, Samuel Thibault <span dir="ltr">&lt;<a href="mailto:samuel.thibault@inria.fr" target="_blank">samuel.thibault@inria.fr</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span class="">Paul Hargrove, le Tue 28 Jul 2015 13:28:00 -0700, a écrit :<br>
&gt; I am more concerned about dropping the input constraints in favor of &quot;+a&quot; and<br>
&gt; &quot;+c&quot;.<br>
&gt; For a *correct* compiler that should be equivalent, but the reason we are doing<br>
&gt; this is because some compilers are buggy.<br>
<br>
</span>I wouldn&#39;t say &quot;buggy&quot;. Usually the issue is that the register allocator<br>
is not smart enough to get its way through (which was the original issue<br>
of this thread).  I&#39;d be really surprised that there&#39;d be real bugs<br>
here, and to me &quot;+a&quot; seems actually safer than &quot;=a&quot; : &quot;0&quot;, if any.</blockquote></div><br>Well, for the compiler that accepted the &quot;=r&quot; form and then generated code that SEGV&#39;d I would say &quot;buggy&quot;.</div><div class="gmail_extra">Other than that one, I agree that a &quot;weak&quot; register allocator is not precisely a &quot;bug&quot;.</div><div class="gmail_extra"><br></div><div class="gmail_extra">Here is the good news:</div><div class="gmail_extra"><br></div><div class="gmail_extra">I have retested all 28 system/compiler combinations I had tested my original patches against.</div><div class="gmail_extra">This time I started with the 1.11.0 release tarball and applied Samuel&#39;s commit 46deaebf.</div><div class="gmail_extra"><br></div><div class="gmail_extra">All looked fine *except* the following with icc-15 with -m32 on a x86-64 Ubuntu 12.04.5 system:</div><div class="gmail_extra">   FAIL: 256ia64-64n2s2c.output</div><div class="gmail_extra">I don&#39;t see how that could possibly be related to the inline asm for cpuid, and have confirmed that the same failure occurs without the patch (but it is absent w/o -m32).</div><div class="gmail_extra"><br></div><div class="gmail_extra">I noticed an early-clobber applied to &quot;1&quot; and &quot;3&quot; in master.</div><div class="gmail_extra">I am retesting that now (still as applied to 1.11.0)</div><div class="gmail_extra"><br></div><div class="gmail_extra">-Paul<br clear="all"><div><br></div>-- <br><div class="gmail_signature"><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</div></div>

