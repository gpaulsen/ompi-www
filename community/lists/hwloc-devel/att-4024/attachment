<html><head></head><body>Push it to master, we&#39;ll what regression testing at <a href="https://ci.inria.fr/hwloc/job/master-1-check">https://ci.inria.fr/hwloc/job/master-1-check</a>/ thinks about it<br>
Brice<br>
<br><br><div class="gmail_quote"><br>
&quot;Jeff Squyres (jsquyres)&quot; &lt;jsquyres@cisco.com&gt; a écrit :<blockquote class="gmail_quote" style="margin: 0pt 0pt 0pt 0.8ex; border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;">
<pre class="k9mail">Brice / Samuel --<br /><br />In <a href="http://www.open-mpi.org/community/lists/devel/2014/01/13619.php">http://www.open-mpi.org/community/lists/devel/2014/01/13619.php</a>, Paul Hargrove found this compiler warning:<br /><br />-----<br />On OpenBSD the header malloc.h exists, but is NOT intended to be used:<br />-bash-4.2$ grep -B2 'is obsolete' make.log <br />CC       bind.lo<br />In file included from /home/phargrov/OMPI/openmpi-1.7-latest-openbsd5-amd64/openmpi-1.7.4rc2r30168/opal/mca/hwloc/hwloc172/hwloc/src/bind.c:17:<br />/usr/include/malloc.h:4:2: warning: #warning "&lt;malloc.h&gt; is obsolete, use &lt;stdlib.h&gt;"<br />-----<br /><br />What do you think of this patch (or something like it)?<br /><br />diff --git a/src/bind.c b/src/bind.c<br />index 046b7cf..37921bc 100644<br />--- a/src/bind.c<br />+++ b/src/bind.c<br />@@ -13,8 +13,9 @@<br />#ifdef HAVE_SYS_MMAN_H<br />#  include &lt;sys/mman.h&gt;<br />#endif<br />-#ifdef HAVE_MALLOC_H<br />-# 
include &lt;malloc.h&gt;<br />+/* &lt;malloc.h&gt; is only needed if we don't have posix_memalign() */<br />+#if defined(hwloc_getpagesize) &amp;&amp; !defined(HAVE_POSIX_MEMALIGN) &amp;&amp; defined(HAVE_MEMALIGN) &amp;&amp; defined(HAVE_MALLOC_H)<br />+#include &lt;malloc.h&gt;<br />#endif<br />#ifdef HAVE_UNISTD_H<br />#include &lt;unistd.h&gt;<br /><br /></pre></blockquote></div></body></html>
