<html><head></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><br><div><div>On Mar 25, 2011, at 10:48 AM, Hugo Meyer wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div class="gmail_quote"><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;"><div style="word-wrap:break-word"><div><div class="im"><div>From what you've described before, I suspect all you'll need to do is add some code in orte/mca/odls/base/odls_base_default_fns.c that (a) checks to see if a process in the launch message is being relocated (the construct_child_list code does that already), and then (b) sends the required info to all local child processes so they can take appropriate action.</div>
</div></div><div><br></div><div>Failure detection, re-launch, etc. have all been taken care of for you.</div></div></blockquote><div><br></div><div><br></div><div><span class="Apple-style-span" style="font-family: arial, sans-serif; "><span class="hps" title="Haz clic para obtener traducciones alternativas">I</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">looked at</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">the</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">code</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">that</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">you</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">mentioned</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">me and i realize that i have two possible options, that i'm going to share with you to know your opinion.</span></span></div>
<div><span class="Apple-style-span" style="font-family: arial, sans-serif; "><span class="hps" title="Haz clic para obtener traducciones alternativas"><br></span></span></div><div><font class="Apple-style-span" face="arial, sans-serif">First of all i will let you know my actual situation with the implementation. As i'm working in a Fault Tolerant system, but using uncoordinated checkpoint i'm taking checkpoints of all my process at different time and storing them on the machine where there are residing, but i also send this checkpoints to another node (lets call it protector), so if this node fails his process should be restarted in the protector that have his checkpoints.</font></div>
<div><font class="Apple-style-span" face="arial, sans-serif"><br></font></div><div><font class="Apple-style-span" face="arial, sans-serif">Right now i'm detecting the failure of a process and i know where this process should be restarted, and also i have the checkpoint in the protector. And i also have the child information of course.</font></div>
<div><font class="Apple-style-span" face="arial, sans-serif"><br></font></div><div><font class="Apple-style-span" face="arial, sans-serif">So, my options are:</font></div><div><font class="Apple-style-span" face="arial, sans-serif"><i><b>First Option</b></i></font></div>
<div><font class="Apple-style-span" face="arial, sans-serif"><b><i><br></i></b></font></div><div><font class="Apple-style-span" face="arial, sans-serif">I detect the failure, and then i use orte_errmgr_hnp_base_global_update_state() &nbsp;with some modifications and the hnp_relocate but changing the spawning to make a restart from a checkpoint, i suposse that using this, the migration of the process to another node will be updated and everyone will know it, because is the hnp who is going to do this (is this ok?).</font></div></div></blockquote><div><br></div>This is the option I would use. The other one is much, much more work. In this option, you only have to:</div><div><br></div><div>(a) modify the mapper so you can specify the location of the proc being restarted. The resilient mapper module will be handling the restart - if you look at orte/mca/rmaps/resilient/rmaps_resilient.c, you can see the code doing the "replacement" and modify accordingly.</div><div><br></div><div>(b) add any required info about your checkpoint to the launch message. This gets created in orte/mca/odls/base/odls_base_default_fns.c, the "get_add_procs_data" function (at the top of the file).</div><div><br></div><div>(c) modify the launch code to handle your checkpoint, if required - see the file in (b), the "construct_child" and "launch" functions.</div><div><br></div><div>HTH</div><div>Ralph</div><div><br></div><div><br><blockquote type="cite"><div class="gmail_quote">
<div><font class="Apple-style-span" face="arial, sans-serif"><br></font></div><div><font class="Apple-style-span" face="arial, sans-serif"><b><i>Second Option</i></b></font></div><div><font class="Apple-style-span" face="arial, sans-serif"><b><i><br>
</i></b></font></div><div><font class="Apple-style-span" face="arial, sans-serif">Modify one of the spawn variations</font><span class="Apple-style-span" style="font-family: arial, sans-serif; ">(probably the remote_spawn from rsh)</span><span class="Apple-style-span" style="font-family: arial, sans-serif; ">&nbsp;in the PLM framework and then use the orted_comm to command a remote_spawn in the protector, but i don't know here how to update the info so everyone knows about the change or how this is managed.</span></div>
<div><span class="Apple-style-span" style="font-family: arial, sans-serif; "><br></span></div><div><font class="Apple-style-span" face="arial, sans-serif"><span class="hps" title="Haz clic para obtener traducciones alternativas">I might be</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">very</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">wrong</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">in</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">what</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">I said,&nbsp;</span></font><span class="Apple-style-span" style="font-family: arial, sans-serif; "><span class="hps" title="Haz clic para obtener traducciones alternativas">my</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">apologies</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">if</span>&nbsp;<span class="hps" title="Haz clic para obtener traducciones alternativas">so.</span></span></div>
<div><span class="Apple-style-span" style="font-family: arial, sans-serif; "><span class="hps" title="Haz clic para obtener traducciones alternativas"><br></span></span></div><div><span class="Apple-style-span" style="font-family: arial, sans-serif; "><span class="hps" title="Haz clic para obtener traducciones alternativas">Thanks a lot for all the help.</span></span></div>
<div><span class="Apple-style-span" style="font-family: arial, sans-serif; "><span class="hps" title="Haz clic para obtener traducciones alternativas"><br></span></span></div><div><span class="Apple-style-span" style="font-family: arial, sans-serif; "><span class="hps" title="Haz clic para obtener traducciones alternativas">Best regards.</span></span></div>
<div><span class="Apple-style-span" style="font-family: arial, sans-serif; "><span class="hps" title="Haz clic para obtener traducciones alternativas"><br></span></span></div><div><span class="Apple-style-span" style="font-family: arial, sans-serif; "><span class="hps" title="Haz clic para obtener traducciones alternativas">Hugo Meyer</span></span></div>
</div><br>
_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/devel</blockquote></div><br></body></html>
