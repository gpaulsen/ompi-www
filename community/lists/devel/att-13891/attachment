<div dir="ltr">The following is an issue found when testing with xlf-14.1, which is already known to have problems with the F08 stuff.  So, I&#39;ve configured with &quot;FC=xlf90 --enable-mpi-fortran=usempi&quot;.<div><br>
</div><div>The problem is that mpifort is now a wrapper around xlf90 and thus is assuming F90 free-form input, independent of the file suffix.  This results in errors building fixed-form (f77) codes:</div><div><br></div><div>
<div><font face="courier new, monospace">$ mpifort hello_mpifh.f  </font></div><div><font face="courier new, monospace">&quot;hello_mpifh.f&quot;, line 1.1: 1515-019 (S) Syntax is incorrect.</font></div><div><font face="courier new, monospace">&quot;hello_mpifh.f&quot;, line 2.3: 1515-019 (S) Syntax is incorrect.</font></div>
<div><font face="courier new, monospace">&quot;hello_mpifh.f&quot;, line 3.27: 1515-019 (S) Syntax is incorrect.</font></div><div><font face="courier new, monospace">&quot;hello_mpifh.f&quot;, line 4.27: 1515-019 (S) Syntax is incorrect.</font></div>
<div><font face="courier new, monospace">&quot;hello_mpifh.f&quot;, line 5.3: 1515-019 (S) Syntax is incorrect.</font></div><div><font face="courier new, monospace">&quot;hello_mpifh.f&quot;, line 6.3: 1515-019 (S) Syntax is incorrect.</font></div>
<div><font face="courier new, monospace">&quot;hello_mpifh.f&quot;, line 7.1: 1515-019 (S) Syntax is incorrect.</font></div><div><font face="courier new, monospace">&quot;hello_mpifh.f&quot;, line 8.3: 1515-019 (S) Syntax is incorrect.</font></div>
<div><font face="courier new, monospace">&quot;hello_mpifh.f&quot;, line 9.1: 1515-019 (S) Syntax is incorrect.</font></div><div><font face="courier new, monospace">&quot;hello_mpifh.f&quot;, 1515-002 (S) END card is missing.  One is assumed.</font></div>
<div><font face="courier new, monospace">** _main   === End of Compilation 1 ===</font></div><div><font face="courier new, monospace">&quot;hello_mpifh.f&quot;, line 22.19: 1515-019 (S) Syntax is incorrect.</font></div><div>
<font face="courier new, monospace">** main   === End of Compilation 2 ===</font></div><div><font face="courier new, monospace">1501-511  Compilation failed for file hello_mpifh.f.</font></div></div><div><br></div><div>This can, fortunately, be worked around with &quot;-qfixed&quot;:</div>
<div><font face="courier new, monospace"><br></font></div><div><div><font face="courier new, monospace">$ mpifort -qfixed hello_mpifh.f</font></div><div><font face="courier new, monospace">** main   === End of Compilation 1 ===</font></div>
<div><font face="courier new, monospace">1501-510  Compilation successful for file hello_mpifh.f.</font></div></div><div><br></div><div>I *think* that I should have configured with FC=xlf (rather than xlf90) then it will determine language-level and format based on file suffix.  I can (without re-configuring) confirm that xlf honors the extension by setting OMPI_FC=xlf:</div>
<div><br></div><div><div><font face="courier new, monospace">{hargrove@vestalac1 examples}$ OMPI_FC=xlf mpifort  hello_mpifh.f</font></div><div><font face="courier new, monospace">** main   === End of Compilation 1 ===</font></div>
<div><font face="courier new, monospace">1501-510  Compilation successful for file hello_mpifh.f.</font></div><div><font face="courier new, monospace">{hargrove@vestalac1 examples}$ OMPI_FC=xlf mpifort  hello_usempi.f90 </font></div>
<div><font face="courier new, monospace">** main   === End of Compilation 1 ===</font></div><div><font face="courier new, monospace">1501-510  Compilation successful for file hello_usempi.f90.</font></div></div><div><br></div>
<div><br></div><div>The term &quot;fortran compiler&quot; in Open MPI&#39;s README is not (as far as I could see) clearly defined as &quot;a fortran compiler which honors file suffixes to determine language dialect&quot;</div>
<div><br></div><div>My FC=xlf90 setting is &quot;historical&quot; from the testing scripts I&#39;ve used since the 1.5 and 1.6 series.</div><div><br></div><div>ADDITIONALLY, the Open MPI manpages STILL say FC is to be a fortran90 compiler and F77 is to be an fortran77 compiler.  It looks like others might encounter the same problem I describe above just by reading the documentation too closely.</div>
<div><br></div><div>I will follow up with specifics on what appears to be out-of-date in the manpages.</div><div><br></div><div>-Paul</div><div><div><br></div>-- <br><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div>
<div>Future Technologies Group</div><div>Computer and Data Sciences Department     Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font>
</div></div>

