<div dir="ltr"><div>[note corrected &quot;rc2&quot; -&gt; &quot;rc1&quot; in the subject line]</div><div><br></div>I tried the same configure arguments with the 2.0.0rc1 and master tarballs.<div>The result is a failure at configure time similar to the problem I reported already with respect to xlc.</div><div><br></div><div>Specifically, the configure fails with</div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><div><font face="monospace, monospace">checking for working POSIX threads package... no</font></div></div><div><div><font face="monospace, monospace">configure: WARNING: &quot;*** POSIX threads are not&quot;</font></div></div><div><div><font face="monospace, monospace">configure: WARNING: &quot;*** available on your system &quot;</font></div></div><div><div><font face="monospace, monospace">configure: error: &quot;*** Can not continue&quot;</font></div></div></blockquote><div><br></div><div>Which is occurring because $FCFLAGS (&quot;-m32&quot; in this case) is missing from some or all of the Fortran + pthreads probes:</div><blockquote style="margin:0 0 0 40px;border:none;padding:0px"><div><div><font face="monospace, monospace">configure:64262: checking if Fortran compiler and POSIX threads work as is</font></div></div><div><div><font face="monospace, monospace">configure:64344: cc -m32 -g -I. -c conftest.c</font></div></div><div><div><font face="monospace, monospace">&quot;conftest.c&quot;, line 28: warning: improper pointer/integer combination: arg #1</font></div></div><div><div><font face="monospace, monospace">configure:64351: $? = 0</font></div></div><div><div><font face="monospace, monospace">configure:64361: f90  conftestf.f conftest.o -o conftest  -lrt -lm -lutil</font></div></div><div><div><font face="monospace, monospace">conftest.o: could not read symbols: <span style="background-color:rgb(255,255,0)">File in wrong format</span></font></div></div></blockquote><div><br></div><div>So, it appears that FCFLAGS is getting &quot;dropped&quot; in multiple locations in all three of 1.10.2rc1, 2.0.0rc1 and master.</div><div><br></div><div>-Paul</div><div class="gmail_extra"><br><div class="gmail_quote">On Sat, Dec 19, 2015 at 1:23 PM, Paul Hargrove <span dir="ltr">&lt;<a href="mailto:phhargrove@lbl.gov" target="_blank">phhargrove@lbl.gov</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr">While on Solaris the SS12.4 default compiler output is 32-bit, the same compiler on Linux defaults to 64-bit.<div>So, not surprisingly I see the &quot;complementary&quot; failure with this compiler on Linux when configured with FCFLAGS=-m32:</div><div><br></div><blockquote style="margin:0 0 0 40px;border:none;padding:0px"><div><div><font face="monospace, monospace">libtool: compile:  f90 -DHAVE_CONFIG_H -I. -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1/ompi/mpi/fortran/use-mpi-ignore-tkr -I../../../../opal/include -I../../../../orte/include -I../../../../ompi/include -I../../../../oshmem/include -I../../../../opal/mca/hwloc/hwloc191/hwloc/include/private/autogen -I../../../../opal/mca/hwloc/hwloc191/hwloc/include/hwloc/autogen -DOMPI_PROFILE_LAYER=0 -DOMPI_COMPILING_FORTRAN_WRAPPERS=1 -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1 -I../../../.. -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1/opal/include -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1/orte/include -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1/ompi/include -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1/oshmem/include -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1/opal/mca/hwloc/hwloc191/hwloc/include -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/BLD/opal/mca/hwloc/hwloc191/hwloc/include -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1/opal/mca/event/libevent2021/libevent -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1/opal/mca/event/libevent2021/libevent/include -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/BLD/opal/mca/event/libevent2021/libevent/include -I../../../../ompi/include -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1/ompi/include -I../../../.. -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1 -c /scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1/ompi/mpi/fortran/use-mpi-ignore-tkr/mpi-ignore-tkr.F90  -KPIC -o .libs/mpi-ignore-tkr.o</font></div></div><div><div><font face="monospace, monospace">/bin/sh ../../../../libtool  --tag=FC   --mode=link f90 -I../../../../ompi/include -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1/ompi/include -I../../../.. -I/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/openmpi-1.10.2rc1   -version-info 6:0:0   -o <a href="http://libmpi_usempi_ignore_tkr.la" target="_blank">libmpi_usempi_ignore_tkr.la</a> -rpath /scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/INST/lib mpi-ignore-tkr.lo   /scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/BLD/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a> -lrt -lm -lutil</font></div></div><div><div><font face="monospace, monospace">libtool: link: f90 -G  -KPIC  .libs/mpi-ignore-tkr.o   -Qoption ld -rpath -Qoption ld /scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/BLD/opal/.libs -Qoption ld -rpath -Qoption ld /scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/INST/lib /scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/BLD/opal/.libs/libopen-pal.so -lnuma -ldl -lrt -lm -lutil    -Qoption ld -soname -Qoption ld libmpi_usempi_ignore_tkr.so.6 -o .libs/libmpi_usempi_ignore_tkr.so.6.0.0</font></div></div><div><div><font face="monospace, monospace">/scratch/phargrov/OMPI/openmpi-1.10.2rc1-linux-x86_64-ss12u4-m32/BLD/opal/.libs/libopen-pal.so: could not read symbols: <span style="background-color:rgb(255,255,0)">File in wrong format</span></font></div></div><span class=""><div><div><font face="monospace, monospace">make[2]: *** [<a href="http://libmpi_usempi_ignore_tkr.la" target="_blank">libmpi_usempi_ignore_tkr.la</a>] Error 2</font></div></div></span></blockquote><span class="HOEnZb"><font color="#888888"><div><br></div><div>-Paul</div></font></span></div><div class="HOEnZb"><div class="h5"><div class="gmail_extra"><br><div class="gmail_quote">On Sat, Dec 19, 2015 at 1:17 PM, Paul Hargrove <span dir="ltr">&lt;<a href="mailto:phhargrove@lbl.gov" target="_blank">phhargrove@lbl.gov</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr">I am using the 12.4 release of the Solaris Studio compilers on a Solaris system that was fine with 1.10.1.<div>I am configuring with</div><div><br></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><font face="monospace, monospace">







configure --prefix=[...] --enable-debug CC=cc CXX=CC FC=f90 \</font></div><div><font face="monospace, monospace">    CFLAGS=-m64 --with-wrapper-cflags=-m64 \</font></div><div><font face="monospace, monospace">    CXXFLAGS=&#39;-m64 -library=stlport4&#39; --with-wrapper-cxxflags=&#39;-m64 -library=stlport4&#39; \</font></div><div><font face="monospace, monospace">    FCFLAGS=-m64 --with-wrapper-fcflags=-m64 \</font></div><div><font face="monospace, monospace">    --with-verbs --enable-mpi-java --with-jdk-dir=/usr/jdk/latest</font></div></blockquote><div><div><br></div><div>The build fails to link <a href="http://libmpi_usempi_ignore_tkr.la" target="_blank">libmpi_usempi_ignore_tkr.la</a>, apparently because &quot;-m64&quot; is missing from the link command (note that the default compiler output is &quot;-m32&quot;):</div><div><br></div></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><font face="monospace, monospace">libtool: compile:  f90 -DHAVE_CONFIG_H -I. -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1/ompi/mpi/fortran/use-mpi-ignore-tkr -I../../../../opal/include -I../../../../orte/include -I../../../../ompi/include -I../../../../oshmem/include -I../../../../opal/mca/hwloc/hwloc191/hwloc/include/private/autogen -I../../../../opal/mca/hwloc/hwloc191/hwloc/include/hwloc/autogen -DOMPI_PROFILE_LAYER=0 -DOMPI_COMPILING_FORTRAN_WRAPPERS=1 -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1 -I../../../.. -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1/opal/include -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1/orte/include -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1/ompi/include -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1/oshmem/include -D_REENTRANT -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1/opal/mca/hwloc/hwloc191/hwloc/include -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/BLD/opal/mca/hwloc/hwloc191/hwloc/include -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1/opal/mca/event/libevent2021/libevent -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1/opal/mca/event/libevent2021/libevent/include -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/BLD/opal/mca/event/libevent2021/libevent/include -I../../../../ompi/include -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1/ompi/include -I../../../.. -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1 -c /shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1/ompi/mpi/fortran/use-mpi-ignore-tkr/mpi-ignore-tkr.F90  -KPIC -o .libs/mpi-ignore-tkr.o</font></div><div><font face="monospace, monospace">/bin/sh ../../../../libtool  --tag=FC   --mode=link f90 -I../../../../ompi/include -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1/ompi/include -I../../../.. -I/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/openmpi-1.10.2rc1   -version-info 6:0:0   -o <a href="http://libmpi_usempi_ignore_tkr.la" target="_blank">libmpi_usempi_ignore_tkr.la</a> -rpath /shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/INST/lib mpi-ignore-tkr.lo   /shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/BLD/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a> -lm -lsocket -lnsl</font></div><div><font face="monospace, monospace">libtool: link: f90 -G -h libmpi_usempi_ignore_tkr.so.6 -o .libs/libmpi_usempi_ignore_tkr.so.6.0.0  .libs/mpi-ignore-tkr.o   -R/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/BLD/opal/.libs -R/shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/INST/lib /shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/BLD/opal/.libs/libopen-pal.so -lsendfile -lpicl -lkstat -llgrp -lpciaccess -lm -lsocket -lnsl</font></div><div><font face="monospace, monospace">ld: fatal: file /shared/OMPI/openmpi-1.10.2rc1-solaris11-x64-ib-ss12u4/BLD/opal/.libs/libopen-pal.so: <span style="background-color:rgb(255,255,0)">wrong ELF class: ELFCLASS64</span></font></div><div><font face="monospace, monospace">gmake[2]: *** [<a href="http://libmpi_usempi_ignore_tkr.la" target="_blank">libmpi_usempi_ignore_tkr.la</a>] Error 2</font></div></blockquote><span><font color="#888888"><div><div><br></div><div>-Paul</div><div><br></div>-- <br><div><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: <a href="tel:%2B1-510-495-2352" value="+15104952352" target="_blank">+1-510-495-2352</a></div><div>Lawrence Berkeley National Laboratory     Fax: <a href="tel:%2B1-510-486-6900" value="+15104866900" target="_blank">+1-510-486-6900</a></div></font></div></div></div>
</div></font></span></div>
</blockquote></div><br><br clear="all"><div><br></div>-- <br><div><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: <a href="tel:%2B1-510-495-2352" value="+15104952352" target="_blank">+1-510-495-2352</a></div><div>Lawrence Berkeley National Laboratory     Fax: <a href="tel:%2B1-510-486-6900" value="+15104866900" target="_blank">+1-510-486-6900</a></div></font></div></div></div>
</div>
</div></div></blockquote></div><br><br clear="all"><div><br></div>-- <br><div class="gmail_signature"><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</div></div>

