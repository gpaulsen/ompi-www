<html><head><meta http-equiv="Content-Type" content="text/html charset=windows-1252"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">Kewl - I'll add it in the next wave. Meantime, we can revert this one<div><br></div><div>Thanks!</div><div>Ralph</div><div><br><div style=""><div>On Feb 6, 2014, at 9:18 AM, Joshua Ladd &lt;<a href="mailto:joshual@mellanox.com">joshual@mellanox.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div lang="EN-US" link="blue" vlink="purple" style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div class="WordSection1" style="page: WordSection1;"><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif;"><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125);">It’s been CMRed, but scheduled for 1.7.5<o:p></o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif;"><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125);">&nbsp;</span></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif;"><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125);"><a href="https://svn.open-mpi.org/trac/ompi/ticket/4185" style="color: purple; text-decoration: underline;">https://svn.open-mpi.org/trac/ompi/ticket/4185</a><o:p></o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif;"><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125);">&nbsp;</span></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif;"><b><span style="font-size: 10pt; font-family: Tahoma, sans-serif;">From:</span></b><span style="font-size: 10pt; font-family: Tahoma, sans-serif;"><span class="Apple-converted-space">&nbsp;</span>devel [<a href="mailto:devel-bounces@open-mpi.org">mailto:devel-bounces@open-mpi.org</a>]<span class="Apple-converted-space">&nbsp;</span><b>On Behalf Of<span class="Apple-converted-space">&nbsp;</span></b>Mike Dubman<br><b>Sent:</b><span class="Apple-converted-space">&nbsp;</span>Thursday, February 06, 2014 12:17 PM<br><b>To:</b><span class="Apple-converted-space">&nbsp;</span>Open MPI Developers<br><b>Subject:</b><span class="Apple-converted-space">&nbsp;</span>Re: [OMPI devel] [OMPI svn] svn:open-mpi r30571 - trunk/ompi/runtime<o:p></o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif;"><o:p>&nbsp;</o:p></div><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif;">It seems that similar code in not in v1.7 tree.<o:p></o:p></div></div><div><p class="MsoNormal" style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif;"><o:p>&nbsp;</o:p></p><div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif;">On Thu, Feb 6, 2014 at 2:40 PM, George Bosilca &lt;<a href="mailto:bosilca@icl.utk.edu" target="_blank" style="color: purple; text-decoration: underline;">bosilca@icl.utk.edu</a>&gt; wrote:<o:p></o:p></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif;">This commit is unnecessary. The call to delete_proc is already there, few lines above your own patch. It was introduced on Jan 26 2014 with commit<span class="Apple-converted-space">&nbsp;</span><a href="https://svn.open-mpi.org/trac/ompi/changeset/30430" target="_blank" style="color: purple; text-decoration: underline;">https://svn.open-mpi.org/trac/ompi/changeset/30430</a>.<br><br>&nbsp; George.<br><br><br><br>On Feb 6, 2014, at 09:38 ,<span class="Apple-converted-space">&nbsp;</span><a href="mailto:svn-commit-mailer@open-mpi.org" style="color: purple; text-decoration: underline;">svn-commit-mailer@open-mpi.org</a><span class="Apple-converted-space">&nbsp;</span>wrote:<br><br>&gt; Author: miked (Mike Dubman)<br>&gt; Date: 2014-02-06 03:38:32 EST (Thu, 06 Feb 2014)<br>&gt; New Revision: 30571<br>&gt; URL:<span class="Apple-converted-space">&nbsp;</span><a href="https://svn.open-mpi.org/trac/ompi/changeset/30571" target="_blank" style="color: purple; text-decoration: underline;">https://svn.open-mpi.org/trac/ompi/changeset/30571</a><br>&gt;<br>&gt; Log:<br>&gt; OMPI: add call to del_procs<br>&gt;<br>&gt; fixed by AlexM, reviewed by miked<br>&gt; cmr=v1.7.5:reviewer=ompi-rm1.7<br>&gt;<br>&gt; Text files modified:<br>&gt; &nbsp; trunk/ompi/runtime/ompi_mpi_finalize.c | &nbsp; &nbsp;15 +++++++++++++++<br>&gt; &nbsp; 1 files changed, 15 insertions(+), 0 deletions(-)<br>&gt;<br>&gt; Modified: trunk/ompi/runtime/ompi_mpi_finalize.c<br>&gt; ==============================================================================<br>&gt; --- trunk/ompi/runtime/ompi_mpi_finalize.c &nbsp; &nbsp;Wed Feb &nbsp;5 17:49:26 2014 &nbsp; &nbsp; &nbsp; &nbsp;(r30570)<br>&gt; +++ trunk/ompi/runtime/ompi_mpi_finalize.c &nbsp; &nbsp;2014-02-06 03:38:32 EST (Thu, 06 Feb 2014) &nbsp; &nbsp; &nbsp;(r30571)<br>&gt; @@ -94,6 +94,9 @@<br>&gt; &nbsp; &nbsp; opal_list_item_t *item;<br>&gt; &nbsp; &nbsp; struct timeval ompistart, ompistop;<br>&gt; &nbsp; &nbsp; ompi_rte_collective_t *coll;<br>&gt; + &nbsp; &nbsp;ompi_proc_t** procs;<br>&gt; + &nbsp; &nbsp;size_t nprocs;<br>&gt; +<br>&gt;<br>&gt; &nbsp; &nbsp; /* Be a bit social if an erroneous program calls MPI_FINALIZE in<br>&gt; &nbsp; &nbsp; &nbsp; &nbsp;two different threads, otherwise we may deadlock in<br>&gt; @@ -150,6 +153,18 @@<br>&gt; &nbsp; &nbsp; &nbsp; &nbsp;MPI lifetime, to get better latency when not using TCP */<br>&gt; &nbsp; &nbsp; opal_progress_event_users_increment();<br>&gt;<br>&gt; +<br>&gt; + &nbsp; &nbsp;if (NULL == (procs = ompi_proc_world(&amp;nprocs))) {<br>&gt; + &nbsp; &nbsp; &nbsp; &nbsp;return OMPI_ERROR;<br>&gt; + &nbsp; &nbsp;}<br>&gt; +<br>&gt; + &nbsp; &nbsp;if (OMPI_SUCCESS != (ret = MCA_PML_CALL(del_procs(procs, nprocs)))) {<br>&gt; + &nbsp; &nbsp; &nbsp; &nbsp;free(procs);<br>&gt; + &nbsp; &nbsp; &nbsp; &nbsp;return ret;<br>&gt; + &nbsp; &nbsp;}<br>&gt; + &nbsp; &nbsp;free(procs);<br>&gt; +<br>&gt; +<br>&gt; &nbsp; &nbsp; /* check to see if we want timing information */<br>&gt; &nbsp; &nbsp; if (ompi_enable_timing != 0 &amp;&amp; 0 == OMPI_PROC_MY_NAME-&gt;vpid) {<br>&gt; &nbsp; &nbsp; &nbsp; &nbsp; gettimeofday(&amp;ompistart, NULL);<br>&gt; _______________________________________________<br>&gt; svn mailing list<br>&gt;<span class="Apple-converted-space">&nbsp;</span><a href="mailto:svn@open-mpi.org" style="color: purple; text-decoration: underline;">svn@open-mpi.org</a><br>&gt;<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/svn" target="_blank" style="color: purple; text-decoration: underline;">http://www.open-mpi.org/mailman/listinfo.cgi/svn</a><br><br>_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org" style="color: purple; text-decoration: underline;">devel@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" target="_blank" style="color: purple; text-decoration: underline;">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><o:p></o:p></div></div><div style="margin: 0in 0in 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif;"><o:p>&nbsp;</o:p></div></div></div>_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/devel</div></blockquote></div><br></div></body></html>
