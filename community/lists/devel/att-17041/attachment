<div dir="ltr">FYI:<div><br></div><div>On several systems where Jeff&#39;s tarball for pr410 ran fine yesterday, I am seeing errors in today&#39;s tarball related to either libverbs or mca_oob_ud.</div><div><br></div><div><br></div><div>Issue #1:</div><div>On Solaris verbs support is now rejected at configure time.</div><div>Configure output appears below as &quot;1)&quot;</div><div><br></div><div>Issue #2:</div><div>On Linux I get undefined symbols at either build time (from oob_ud_component.o when static linking orte-cean) or at runtime (dynamic linker again complaining about undefined symbol(s) in mca_oob_ud.so).  In both cases I would venture a guess that some linker option (-L or -l ?) is missing.</div><div>Outputs appear below as &quot;2a)&quot; and &quot;2b)&quot;.</div><div><br></div><div><div>I am currently assuming these failures with Jeff&#39;s tarball for PR410 reflect recent changes in &#39;master&#39; (e.g. I assume Jeff rebased his branch since the previous tarballs), but I don&#39;t have time to confirm that.  I believe that the failure in the static linking case eliminates Jeff&#39;s dlopen-related work from consideration as a root cause, but I could certainly be mistaken.</div></div><div><br></div><div>If these two issues are known, or have already been fixed in &#39;master&#39;, then just say so and I&#39;ll drop this.</div><div>Otherwise, let me know what additional files/output you want to see and who to send it to.</div><div><br></div><div>-Paul</div><div><br></div><div>1) Configure output from Solaris-11 on x86-64,using Gnu compilers:</div><div><br></div><div><div><font face="monospace, monospace" size="1">--- MCA component common:verbs (m4 configuration macro)</font></div><div><font face="monospace, monospace" size="1">checking for MCA component common:verbs compile mode... dso</font></div><div><font face="monospace, monospace" size="1">checking if want to add padding to the openib BTL control header... no</font></div><div><font face="monospace, monospace" size="1">checking for fcntl.h... (cached) yes</font></div><div><font face="monospace, monospace" size="1">checking sys/poll.h usability... yes</font></div><div><font face="monospace, monospace" size="1">checking sys/poll.h presence... yes</font></div><div><font face="monospace, monospace" size="1">checking for sys/poll.h... yes</font></div><div><font face="monospace, monospace" size="1">checking infiniband/verbs.h usability... yes</font></div><div><font face="monospace, monospace" size="1">checking infiniband/verbs.h presence... yes</font></div><div><font face="monospace, monospace" size="1">checking for infiniband/verbs.h... yes</font></div><div><font face="monospace, monospace" size="1">looking for library without search path</font></div><div><font face="monospace, monospace" size="1">checking for library containing ibv_open_device... -libverbs</font></div><div><font face="monospace, monospace" size="1" style="background-color:rgb(255,255,0)">checking number of arguments to ibv_create_cq... unknown</font></div><div><font face="monospace, monospace" size="1" style="background-color:rgb(255,255,0)">configure: WARNING: Can not determine number of args to ibv_create_cq.</font></div><div><font face="monospace, monospace" size="1" style="background-color:rgb(255,255,0)">configure: WARNING: Not building component.</font></div><div><font face="monospace, monospace" size="1">checking if ConnectX XRC support is enabled... no</font></div><div><font face="monospace, monospace" size="1">checking if ConnectIB XRC support is enabled... no</font></div><div><font face="monospace, monospace" size="1">checking if dynamic SL is enabled... no</font></div><div><font face="monospace, monospace" size="1">configure: WARNING: Verbs support requested (via --with-verbs) but not found.</font></div><div><font face="monospace, monospace" size="1">configure: WARNING: If you are using libibverbs v1.0 (i.e., OFED v1.0 or v1.1), you *MUST* have both the libsysfs headers and libraries installed.  Later versions of libibverbs do not require libsysfs.</font></div><div><font face="monospace, monospace" size="1">configure: error: Aborting.</font></div></div><div><div><br></div><div>2a) Failure at build time on Linux with &quot;--enable-static --disable-shared&quot; (truncated):</div><div><br></div><div><div><font face="monospace, monospace" size="1">/bin/sh ../../../libtool  --tag=CC   --mode=link gcc -std=gnu99  -g -finline-functions -fno-strict-aliasing -pthread   -o orte-clean orte-clean.o ../../../orte/<a href="http://libopen-rte.la">libopen-rte.la</a> ../../../opal/<a href="http://libopen-pal.la">libopen-pal.la</a> -lrt -lm -lutil </font></div><div><font face="monospace, monospace" size="1">  -lrt -lm -lutillibtool: link: gcc -std=gnu99 -g -finline-functions -fno-strict-aliasing -pthread -o orte-clean orte-clean.o  </font></div><div><font face="monospace, monospace" size="1">../../../orte/.libs/libopen-rte.a -L/usr/syscom/opt/torque/4.1.4/lib /usr/syscom/opt/torque/4.1.4/lib/libtorqu</font></div><div><font face="monospace, monospace" size="1">e.so -lxml2 -lz -lcrypto -lssl -lpthread /global/homes/h/hargrove/GSCRATCH/OMPI/openmpi-pr410-v2-linux-x86_64-static/BLD/opal/.libs/libopen-pal.a ../../../opal/.libs/libopen-pal.a -ldl -lrt -lm -lutil -pthread -Wl,-rpath</font></div><div><font face="monospace, monospace" size="1"> -Wl,/usr/syscom/opt/torque/4.1.4/lib -Wl,-rpath -Wl,/usr/syscom/opt/torque/4.1.4/lib</font></div><div><font face="monospace, monospace" size="1">../../../orte/.libs/libopen-rte.a(oob_ud_component.o): In function `mca_oob_ud_device_setup&#39;:/global/homes/h/hargrove/GSCRATCH/OMPI/openmpi-pr410-v2-linux-x86_64-static/openmpi-gitclone/orte/mca/oob/ud/o</font><span style="font-family:monospace,monospace;font-size:x-small">ob_ud_component.c:220: undefined reference to `ibv_open_device&#39;</span></div><div><font face="monospace, monospace" size="1">/global/homes/h/hargrove/GSCRATCH/OMPI/openmpi-pr410-v2-linux-x86_64-static/openmpi-gitclone/orte/mca/oob/ud/oob_ud_component.c:228: undefined reference to `ibv_query_device&#39;</font></div><div><font face="monospace, monospace" size="1">/global/homes/h/hargrove/GSCRATCH/OMPI/openmpi-pr410-v2-linux-x86_64-static/openmpi-gitclone/orte/mca/oob/ud/oob_ud_component.c:236: undefined reference to `ibv_create_comp_channel&#39;</font></div><div><font face="monospace, monospace" size="1">/global/homes/h/hargrove/GSCRATCH/OMPI/openmpi-pr410-v2-linux-x86_64-static/openmpi-gitclone/orte/mca/oob/ud/oob_ud_component.c:244: undefined reference to `ibv_alloc_pd&#39;</font></div><div><font face="monospace, monospace" size="1">../../../orte/.libs/libopen-rte.a(oob_ud_component.o): In function `mca_oob_ud_component_startup&#39;:</font></div><div><font face="monospace, monospace" size="1">/global/homes/h/hargrove/GSCRATCH/OMPI/openmpi-pr410-v2-linux-x86_64-static/openmpi-gitclone/orte/mca/oob/ud/oob_ud_component.c:291: undefined reference to `ibv_get_device_list&#39;</font></div></div><div>[and many more]</div><div><br></div><div><br></div><div>2b)  Failure at run time on Linux with only &quot;normal&quot; configure options:</div><div><br></div><div><font face="monospace, monospace" size="1">$ mpirun -mca btl sm,self -np 2 examples/ring_c&#39;<br></font></div><div><font face="monospace, monospace" size="1">/global/homes/h/hargrove/GSCRATCH/OMPI/openmpi-pr410-v2-linux-x86_64-icc-11.1/INST/bin/mpirun: symbol lookup error: /global/homes/h/hargrove/GSCRATCH/OMPI/openmpi-pr410-v2-linux-x86_64-icc-11.1/INST/lib/openmpi/mca_oob_ud.so: undefined symbol: ibv_get_device_list</font></div><div><br></div><div><br></div><div><br></div><div><br></div>-- <br><div class="gmail_signature"><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</div></div>

