<div dir="ltr">I am testing on a system with IBM&#39;s compilers which has worked for both LP64 ({C,CXX,F}FLAGS=-q64) and ILP32 ({C,CXX,FC}FLAGS=-q32) builds on all past releases.<div><br></div><div>With the 1.10.2rc2 tarball, however, I see the following in the configure output on the ILP32  configuration:</div><div><br></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><div><font face="monospace, monospace" size="1">checking if Fortran compiler and POSIX threads work with -lpthread... no</font></div></div><div><div><font face="monospace, monospace" size="1">configure: error: Can not find working threads configuration.  aborting</font></div></div><div><font face="monospace, monospace"><br></font></div></blockquote><div>Examining the config.log (below) shows this test has run the Fortran compiler *without* FCFLAGS (-q32).</div><div>The result is a failed attempt to link 32-bit and 64-bit object files together:</div><div><br></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><div><font face="monospace, monospace" size="1">configure:64264: checking if Fortran compiler and POSIX threads work with -lpthread</font></div></div><div><div><span style="background-color:rgb(255,255,0)"><font face="monospace, monospace" size="1">configure:64345: xlc -q32 -g -I. -c conftest.c</font></span></div></div><div><div><font face="monospace, monospace" size="1">&quot;conftest.c&quot;, line 27.18: 1506-280 (W) Function argument assignment between types &quot;unsigned long&quot; and &quot;unsigned long*&quot; is not allowed.</font></div></div><div><div><font face="monospace, monospace" size="1">configure:64352: $? = 0</font></div></div><div><div><span style="background-color:rgb(255,255,0)"><font face="monospace, monospace" size="1">configure:64362: xlf  conftestf.f conftest.o -o conftest  -lutil  -lpthread</font></span></div></div><div><div><font face="monospace, monospace" size="1">** fpthread   === End of Compilation 1 ===</font></div></div><div><div><font face="monospace, monospace" size="1">1501-510  Compilation successful for file conftestf.f.</font></div></div><div><div><span style="background-color:rgb(255,255,0)"><font face="monospace, monospace" size="1">/usr/bin/ld: powerpc:common architecture of input file `conftest.o&#39; is incompatible with powerpc:common64 output</font></span></div></div><div><div><font face="monospace, monospace" size="1">conftest.o: In function `pthreadtest_f&#39;:</font></div></div><div><div><font face="monospace, monospace" size="1">/gpfs/vesta-fs0/projects/PARTS/hargrove/OMPI/openmpi-1.10.2rc1-linux-ppc32-xlc-12.1/BLD/conftest.c:23: relocation truncated to fit: R_PPC_REL24 against `pthread_self&#39;</font></div></div><div><div><font face="monospace, monospace" size="1">/gpfs/vesta-fs0/projects/PARTS/hargrove/OMPI/openmpi-1.10.2rc1-linux-ppc32-xlc-12.1/BLD/conftest.c:24: relocation truncated to fit: R_PPC_REL24 against `pthread_attr_init&#39;</font></div></div><div><div><font face="monospace, monospace" size="1">/gpfs/vesta-fs0/projects/PARTS/hargrove/OMPI/openmpi-1.10.2rc1-linux-ppc32-xlc-12.1/BLD/conftest.c:25: relocation truncated to fit: R_PPC_REL24 against `__sigsetjmp&#39;</font></div></div><div><div><font face="monospace, monospace" size="1">/gpfs/vesta-fs0/projects/PARTS/hargrove/OMPI/openmpi-1.10.2rc1-linux-ppc32-xlc-12.1/BLD/conftest.c:25: relocation truncated to fit: R_PPC_REL24 against `__pthread_unwind_next&#39;</font></div></div><div><div><font face="monospace, monospace" size="1">/gpfs/vesta-fs0/projects/PARTS/hargrove/OMPI/openmpi-1.10.2rc1-linux-ppc32-xlc-12.1/BLD/conftest.c:25: relocation truncated to fit: R_PPC_REL24 against `__pthread_register_cancel&#39;</font></div></div><div><div><font face="monospace, monospace" size="1">/gpfs/vesta-fs0/projects/PARTS/hargrove/OMPI/openmpi-1.10.2rc1-linux-ppc32-xlc-12.1/BLD/conftest.c:26: relocation truncated to fit: R_PPC_REL24 against `pthread_create&#39;</font></div></div><div><div><font face="monospace, monospace" size="1">/gpfs/vesta-fs0/projects/PARTS/hargrove/OMPI/openmpi-1.10.2rc1-linux-ppc32-xlc-12.1/BLD/conftest.c:27: relocation truncated to fit: R_PPC_REL24 against `pthread_join&#39;</font></div></div><div><div><font face="monospace, monospace" size="1">/gpfs/vesta-fs0/projects/PARTS/hargrove/OMPI/openmpi-1.10.2rc1-linux-ppc32-xlc-12.1/BLD/conftest.c:28: relocation truncated to fit: R_PPC_REL24 against `__pthread_unregister_cancel&#39;</font></div></div><div><div><font face="monospace, monospace" size="1">configure:64369: $? = 1</font></div></div></blockquote><div><br></div><div><br></div><div>Note that tests of the Fortran compiler prior to the failure *are* passing &quot;-q32&quot;:</div><div><br></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><div><font face="monospace, monospace" size="1">configure:32543: checking if Fortran compiler works</font></div></div><div><div><font face="monospace, monospace" size="1">configure:32572: xlf -o conftest -q32 -g   conftest.f  &gt;&amp;5</font></div></div><div><div><font face="monospace, monospace" size="1">** main   === End of Compilation 1 ===</font></div></div><div><div><font face="monospace, monospace" size="1">1501-510  Compilation successful for file conftest.f.</font></div></div><div><div><font face="monospace, monospace" size="1">configure:32572: $? = 0</font></div></div></blockquote><div><br></div><div>So, I don&#39;t believe this is anything specific to XLF, but rather an issue that would appear on any system with a non-default ABI specified in {C,CXX,F}FLAGS.</div><div><br></div><div>I have *not* had the opportunity to test either master or the 2.0 RC on this platform.</div><div><br></div><div><div>-Paul</div><div><br></div><div><br></div>-- <br><div class="gmail_signature"><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</div></div>

