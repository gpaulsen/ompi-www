<html><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">My head hurts from working on this! &nbsp;I just realized &lt;omp.h&gt; is for OpenMP, not OpenMPI. &nbsp;So, of course the PGI &lt;omp.h&gt; is used. &nbsp;I still don't know why&nbsp;otfprofile&nbsp;is failing, but at least that explains why OpenMPI-1.5rc5 has no &lt;mpi.h&gt;.<br><div><br></div><div>Sorry for the noise.</div><div><br><div apple-content-edited="true"> <div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><div><div><div><div><div><div><div><div><div><div>Larry Baker</div><div>US Geological Survey</div><div>650-329-5608</div><div><a href="mailto:baker@usgs.gov">baker@usgs.gov</a></div></div></div></div></div></div></div></div></div></div></div> </div><div><br><div>Begin forwarded message:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><font face="Helvetica" size="3" color="#000000" style="font: 12.0px Helvetica; color: #000000"><b>From: </b></font><font face="Helvetica" size="3" style="font: 12.0px Helvetica">Larry Baker &lt;<a href="mailto:baker@usgs.gov">baker@usgs.gov</a>&gt;</font></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><font face="Helvetica" size="3" color="#000000" style="font: 12.0px Helvetica; color: #000000"><b>Date: </b></font><font face="Helvetica" size="3" style="font: 12.0px Helvetica">August 31, 2010 10:04:35 AM PDT</font></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><font face="Helvetica" size="3" color="#000000" style="font: 12.0px Helvetica; color: #000000"><b>To: </b></font><font face="Helvetica" size="3" style="font: 12.0px Helvetica">Open MPI Developers &lt;<a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a>&gt;</font></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><font face="Helvetica" size="3" color="#000000" style="font: 12.0px Helvetica; color: #000000"><b>Subject: </b></font><font face="Helvetica" size="3" style="font: 12.0px Helvetica"><b>Re: [OMPI devel] 1.5rc5 has been posted</b></font></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><font face="Helvetica" size="3" color="#000000" style="font: 12.0px Helvetica; color: #000000"><b>Reply-To: </b></font><font face="Helvetica" size="3" style="font: 12.0px Helvetica">Open MPI Developers &lt;<a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a>&gt;</font></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><br></div> </div><div>The make of OpenMPI 1.5rc5 fails for PGI 10.3 in otfprofile:<br><br><blockquote type="cite">Making all in otfprofile<br></blockquote><blockquote type="cite">make[9]: Entering directory `/usr/local/src/openmpi-1.5rc5/ompi/contrib/vt/vt/extlib/otf/tools/otfprofile'<br></blockquote><blockquote type="cite"> &nbsp;CXX &nbsp;&nbsp;&nbsp;otfprofile-otfprofile.o<br></blockquote><blockquote type="cite">"/opt/pgi/linux86-64/10.3/include/omp.h", line 41: error: expected an<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identifier<br></blockquote><blockquote type="cite"> &nbsp;extern int omp_get_thread_num(void);<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">"/opt/pgi/linux86-64/10.3/include/omp.h", line 43: error: expected an<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identifier<br></blockquote><blockquote type="cite"> &nbsp;extern int omp_get_num_threads(void);<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">2 errors detected in the compilation of "otfprofile.cpp".<br></blockquote><br>The errors are coming from an &lt;omp.h&gt; file that comes with the PGI compiler. &nbsp;I would think OpenMPI would use its own. &nbsp;The problem is, there isn't one (yet?):<br><br><blockquote type="cite">[root@hydra otfprofile]# find /usr/local/src/openmpi-1.5rc5 -name omp.h<br></blockquote><br>The C++ file that is using the PGI &lt;omp.h&gt; file is &nbsp;ompi/contrib/vt/vt/extlib/otf/tools/otfprofile/otfprofile.cpp:<br><br><blockquote type="cite">[root@hydra otfprofile]# cd ompi/contrib/vt/vt/extlib/otf/tools/otfprofile<br></blockquote><blockquote type="cite">[root@hydra otfprofile]# grep omp.h *.cpp<br></blockquote><blockquote type="cite">otfprofile.cpp:#<span class="Apple-tab-span" style="white-space:pre">	</span>include &lt;omp.h&gt;<br></blockquote><br>I ran the compile from make -n to verify that:<br><br><blockquote type="cite">[root@hydra otfprofile]# pgcpp -m64 -DHAVE_CONFIG_H -I. -I../.. -I../../otflib -I../../otflib &nbsp;-DINSIDE_OPENMPI &nbsp;-D_REENTRANT -mp -g -O3 -tp amd64 -DNO_PGI_OFFSET -c -o otfprofile-otfprofile.o `test -f 'otfprofile.cpp' || echo './'`otfprofile.cpp<br></blockquote><blockquote type="cite">"/opt/pgi/linux86-64/10.3/include/omp.h", line 41: error: expected an<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identifier<br></blockquote><blockquote type="cite"> &nbsp;extern int omp_get_thread_num(void);<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">"/opt/pgi/linux86-64/10.3/include/omp.h", line 43: error: expected an<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identifier<br></blockquote><blockquote type="cite"> &nbsp;extern int omp_get_num_threads(void);<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">2 errors detected in the compilation of "otfprofile.cpp".<br></blockquote><br>I don't know how to fix this. &nbsp;Where is otfprofile.cpp expecting to get &lt;omp.h&gt;? &nbsp;Why isn't it there? &nbsp;I'm beginning to think this contrib/vt stuff should not be enabled by default. &nbsp;I don't know that it is needed in general.<br><br>Larry Baker<br>US Geological Survey<br>650-329-5608<br><a href="mailto:baker@usgs.gov">baker@usgs.gov</a><br><br>On Aug 17, 2010, at 2:18 PM, Jeff Squyres wrote:<br><br><blockquote type="cite">We still have one known possible regression:<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;https://svn.open-mpi.org/trac/ompi/ticket/2530<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">But we posted rc5 anyway (there's a bunch of stuff that has been pending for a while that is now in). &nbsp;Please test!<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;http://www.open-mpi.org/software/ompi/v1.5/<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">-- <br></blockquote><blockquote type="cite">Jeff Squyres<br></blockquote><blockquote type="cite">jsquyres@cisco.com<br></blockquote><blockquote type="cite">For corporate legal information go to:<br></blockquote><blockquote type="cite">http://www.cisco.com/web/about/doing_business/legal/cri/<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">_______________________________________________<br></blockquote><blockquote type="cite">devel mailing list<br></blockquote><blockquote type="cite">devel@open-mpi.org<br></blockquote><blockquote type="cite">http://www.open-mpi.org/mailman/listinfo.cgi/devel<br></blockquote><br>_______________________________________________<br>devel mailing list<br>devel@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/devel<br></div></blockquote></div><br></div></body></html>
