<div dir="ltr">Ralph,<div><br></div><div>thanks for the info<br><div class="gmail_extra"><br><div class="gmail_quote"><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">
<div style="word-wrap:break-word"><div><div class=""><blockquote type="cite"><div dir="ltr"><div class="gmail_extra"><div class="gmail_quote"><div>can you detail your full mpirun command line, the number of servers you are using, the btl involved and the ompi release that can be used to reproduce the issue ?</div>
</div></div></div></blockquote><div><br></div></div>Running on only one server, using the current head of the svn repo. My cluster only has Ethernet, and I let it freely choose the BTLs (so I imagine the candidates are sm,self,tcp,vader). The cmd line is really trivial:</div>
<div><br></div></div></blockquote><div><br></div><div>is MPSS installed and loaded ?</div><div>if yes, scif is also a candidate</div><div> </div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">
<div style="word-wrap:break-word"><div></div><div>mpirun -n 1 ./loop_spawn</div><div><br></div><div>I modified loop_spawn to only run 100 iterations as I am not patient enough to wait for 1000, and the number of iters isn&#39;t a factor so long as it is greater than 1. When the parent calls finalize, I get one of the following emitted for every iteration that was done:</div>
<div><br></div><div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">dpm_base_disconnect_init: error -12 in isend to process 0</div><div><br></div></div><div></div></div></blockquote>
<div><br></div><div>so we do the same thing but have different behaviour ...</div><div><br></div><div>just to be sure :</div><div>are we talking about the loop_spawn test from the ibm test suite available at</div><div><a href="http://svn.open-mpi.org/svn/ompi-tests/trunk/ibm/dynamic/loop_spawn.c">http://svn.open-mpi.org/svn/ompi-tests/trunk/ibm/dynamic/loop_spawn.c</a></div>
<div>and</div><div><a href="http://svn.open-mpi.org/svn/ompi-tests/trunk/ibm/dynamic/loop_child.c">http://svn.open-mpi.org/svn/ompi-tests/trunk/ibm/dynamic/loop_child.c</a></div><div> </div><div>number of iterations is 2000 (and not 1000)</div>
<div>MPI_Comm_disconnect is invoked by both parent in loop_spawn.c :</div><div><pre style="color:rgb(0,0,0);word-wrap:break-word;white-space:pre-wrap">                MPI_Comm_free(&amp;comm_merged);
                MPI_Comm_disconnect(&amp;comm_spawned);</pre><pre style="color:rgb(0,0,0);word-wrap:break-word;white-space:pre-wrap"><br></pre></div><div>and children in loop_child.c :</div><div><pre style="color:rgb(0,0,0);word-wrap:break-word;white-space:pre-wrap">
        MPI_Comm_free(&amp;merged);
        MPI_Comm_disconnect(&amp;parent);</pre></div><div><br></div><div>is there any possibility you are running a different test called loop_spawn or an older version of the dynamic/loop_spawn test from the ibm test suite ?</div>
<div><br></div><div>Cheers,</div><div><br></div><div>Gilles</div></div></div></div></div>

