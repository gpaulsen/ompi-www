<div dir="ltr">With OpenBSD-5.9 on x86 (but *not* amd64) when I try to run an application built with Open MPI 2.0.0rc2, I get a SEGV before any output:<blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><div><font face="monospace, monospace">$ mpirun -mca btl sm,self -np 2 examples</font></div></div><div><div><font face="monospace, monospace">/ring_c&#39;</font></div></div><div><div><font face="monospace, monospace">--------------------------------------------------------------------------</font></div></div><div><div><font face="monospace, monospace">mpirun noticed that process rank 1 with PID 0 on node openbsd5-i386 exited on signal 11 (Segmentation fault).</font></div></div><div><div><font face="monospace, monospace">--------------------------------------------------------------------------</font></div></div></blockquote><div><div><br></div><div><br><div>The backtrace from gdb on the core file doesn&#39;t contain much info, but looks to me like some sort of dl-open related problem.</div></div></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><div><div><div><font face="monospace, monospace">(gdb) where</font></div></div></div></div><div><div><div><font face="monospace, monospace">#0  0x087f3b23 in _dl_find_symbol_obj (object=0x7d388800, name=0xf9ef8ac &quot;fileno&quot;, hash=Variable &quot;hash&quot; is not available.</font></div></div></div><div><div><div><font face="monospace, monospace">)</font></div></div></div><div><div><div><font face="monospace, monospace">    at /usr/src/libexec/<a href="http://ld.so/resolve.c:543">ld.so/resolve.c:543</a></font></div></div></div><div><div><div><font face="monospace, monospace">#1  0x087f3dbf in _dl_find_symbol (name=0xf9ef8ac &quot;fileno&quot;, this=0x7bec4f74, flags=Variable &quot;flags&quot; is not available.</font></div></div></div><div><div><div><font face="monospace, monospace">)</font></div></div></div><div><div><div><font face="monospace, monospace">    at /usr/src/libexec/<a href="http://ld.so/resolve.c:672">ld.so/resolve.c:672</a></font></div></div></div><div><div><div><font face="monospace, monospace">#2  0x087f65cf in _dl_bind (object=0x802a8200, index=4696) at /usr/src/libexec/<a href="http://ld.so/i386/rtld_machine.c:387">ld.so/i386/rtld_machine.c:387</a></font></div></div></div><div><div><div><font face="monospace, monospace">#3  0x087f25f7 in _dl_bind_start () at /usr/src/libexec/<a href="http://ld.so/i386/ldasm.S:153">ld.so/i386/ldasm.S:153</a></font></div></div></div><div><div><div><font face="monospace, monospace">#4  0x802a8200 in ?? ()</font></div></div></div><div><div><div><font face="monospace, monospace">#5  0x00001258 in ?? ()</font></div></div></div><div><div><div><font face="monospace, monospace">#6  0x00000033 in ?? ()</font></div></div></div><div><div><div><font face="monospace, monospace">#7  0x00000033 in ?? ()</font></div></div></div><div><div><div><font face="monospace, monospace">#8  0x00000000 in ?? ()</font></div></div></div></blockquote><div><div><br></div><div>When I retry I get a similar backtrace, but with different symbols (in place of &quot;fileno&quot;) on each try.</div><div>The symbol is always, in the several trials I have made, ones that should appear in libc.</div><div><br></div><div>On some trials I see additional output such as:</div></div><blockquote style="margin:0 0 0 40px;border:none;padding:0px"><div><div><div><font face="monospace, monospace">[openbsd5-i386:16620] *** Process received signal ***</font></div><div><font face="monospace, monospace">[openbsd5-i386:16620] Signal: Segmentation fault (11)</font></div></div></div><div><div><div><font face="monospace, monospace">[openbsd5-i386:16620] Signal code: Address not mapped (1)</font></div></div></div><div><div><div><font face="monospace, monospace">[openbsd5-i386:16620] Failing at address: 0x308023c</font></div></div></div><div><div><div><font face="monospace, monospace">Unable to print stack trace!</font></div></div></div><div><div><div><font face="monospace, monospace">[openbsd5-i386:16620] *** End of error message ***</font></div></div></div></blockquote><div><div>And in these cases gdb can&#39;t make sense of the core file either.</div><div><br></div><div>I can run a singleton w/o problems, fwiw:</div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><div><font face="monospace, monospace">{openbsd5-i386 examples}$ ./ring_c</font></div></div><div><div><font face="monospace, monospace">Process 0 sending 10 to 0, tag 201 (1 processes in ring)</font></div></div><div><div><font face="monospace, monospace">Process 0 sent to 0</font></div></div><div><div><font face="monospace, monospace">Process 0 decremented value: 9</font></div></div><div><div><font face="monospace, monospace">Process 0 decremented value: 8</font></div></div><div><div><font face="monospace, monospace">Process 0 decremented value: 7</font></div></div><div><div><font face="monospace, monospace">Process 0 decremented value: 6</font></div></div><div><div><font face="monospace, monospace">Process 0 decremented value: 5</font></div></div><div><div><font face="monospace, monospace">Process 0 decremented value: 4</font></div></div><div><div><font face="monospace, monospace">Process 0 decremented value: 3</font></div></div><div><div><font face="monospace, monospace">Process 0 decremented value: 2</font></div></div><div><div><font face="monospace, monospace">Process 0 decremented value: 1</font></div></div><div><div><font face="monospace, monospace">Process 0 decremented value: 0</font></div></div><div><div><font face="monospace, monospace">Process 0 exiting</font></div></div><div><div><font face="monospace, monospace">pthread_mutex_destroy on mutex with waiters!</font></div></div></blockquote><div><br></div><div>[Somebody might want to look into that pthread_mutex_destroy() warning, but I can&#39;t see it being relevant to the current problem.]</div><div><br></div><div>I am open to suggestions as to how to debug this issue.</div><div><br></div><div>-Paul<br clear="all"><div><br></div>-- <br><div class="gmail_signature"><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</div></div></div>

