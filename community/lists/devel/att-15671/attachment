<html><head><meta http-equiv="Content-Type" content="text/html charset=us-ascii"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">Not much - this is only used to decide if we need to keep both addresses. I may just remove it and keep all addresses, frankly, as the test doesn't seem to be working as it should<div><br><div><div>On Aug 20, 2014, at 10:31 AM, Dave Goodell (dgoodell) &lt;<a href="mailto:dgoodell@cisco.com">dgoodell@cisco.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div style="font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">On Aug 20, 2014, at 11:55 AM,<span class="Apple-converted-space">&nbsp;</span><a href="mailto:svn-commit-mailer@open-mpi.org">svn-commit-mailer@open-mpi.org</a><span class="Apple-converted-space">&nbsp;</span>wrote:<br><br><blockquote type="cite">Author: rhc (Ralph Castain)<br>Date: 2014-08-20 12:55:36 EDT (Wed, 20 Aug 2014)<br>New Revision: 32556<br>URL: <a href="https://svn.open-mpi.org/trac/ompi/changeset/32556">https://svn.open-mpi.org/trac/ompi/changeset/32556</a><br><br>Log:<br>Track down the last piece of the connection problem. It appears that<br>providing a netmask of 0 to opal_net_samenetwork results in everything<br>looking like it is on the same network. Hence, we were not retaining any<br>of the alternative addresses, so we had no other way to check them.<br><br>Refs #4870<br><br>Text files modified:<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;trunk/orte/mca/oob/tcp/oob_tcp.c &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &nbsp;&nbsp;&nbsp;&nbsp;8 +++++++- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;trunk/orte/mca/oob/tcp/oob_tcp_connection.c | &nbsp;&nbsp;&nbsp;&nbsp;1 + &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;2 files changed, 8 insertions(+), 1 deletions(-)<br><br>Modified: trunk/orte/mca/oob/tcp/oob_tcp.c<br>==============================================================================<br>--- trunk/orte/mca/oob/tcp/oob_tcp.c<span class="Apple-tab-span" style="white-space: pre;">	</span>Tue Aug 19 22:48:47 2014<span class="Apple-tab-span" style="white-space: pre;">	</span>(r32555)<br>+++ trunk/orte/mca/oob/tcp/oob_tcp.c<span class="Apple-tab-span" style="white-space: pre;">	</span>2014-08-20 12:55:36 EDT (Wed, 20 Aug 2014)<span class="Apple-tab-span" style="white-space: pre;">	</span>(r32556)<br>@@ -282,6 +282,8 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORTE_NAME_PRINT(ORTE_PROC_MY_NAME));<br><br>&nbsp;&nbsp;&nbsp;if (AF_INET != pop-&gt;af_family) {<br>+ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opal_output_verbose(20, orte_oob_base_framework.framework_output,<br>+<span class="Apple-tab-span" style="white-space: pre;">	</span><span class="Apple-converted-space">&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"%s NOT AF_INET", ORTE_NAME_PRINT(ORTE_PROC_MY_NAME));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto cleanup;<br>&nbsp;&nbsp;&nbsp;}<br><br>@@ -306,8 +308,12 @@<br><br>&nbsp;&nbsp;&nbsp;/* do we already have this address? */<br>&nbsp;&nbsp;&nbsp;OPAL_LIST_FOREACH(maddr, &amp;peer-&gt;addrs, mca_oob_tcp_addr_t) {<br>- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (opal_net_samenetwork(&amp;inaddr, (struct sockaddr*)&amp;maddr-&gt;addr, 0)) {<br>+ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* require only that the subnet be the same */<br>+ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (opal_net_samenetwork(&amp;inaddr, (struct sockaddr*)&amp;maddr-&gt;addr, 24)) {<br></blockquote><br>So... what if I have my hosts on a 10.123.0.0/16 network or some other network with a non-24-bit netmask?<br><br>-Dave<br><br>_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>Subscription:<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br>Link to this post:<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/community/lists/devel/2014/08/15670.php">http://www.open-mpi.org/community/lists/devel/2014/08/15670.php</a></div></blockquote></div><br></div></body></html>
