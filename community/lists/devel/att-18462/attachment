Paul,<div><br></div><div>generally speaking, when using mellanox stuff (mxm, hcoll, fca)</div><div>these libraries must be accessible, either via LD_LIBRARY_PATH or via ld.so.conf</div><div><br></div><div>I do not the config of these cluster, but you might have to use the mellanox libraries tha could be in a non standard location.</div><div><br></div><div>Cheers,</div><div><br></div><div>Gilles<br><br>On Wednesday, December 30, 2015, Paul Hargrove &lt;<a href="mailto:phhargrove@lbl.gov">phhargrove@lbl.gov</a>&gt; wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr"><div>I have tried 1.8.8, 10.0.2rc3 and master with the following configure options (and --prefix)<br><br>--enable-debug --with-verbs --enable-openib-connectx-xrc  --with-mxm=/opt/mellanox/mxm --with-fca=/opt/mellanox/fca --with-hcoll=/opt/mellanox/hcoll<br><br>In all three cases the configure output contains one of the following:</div><div><br></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><div><font face="monospace, monospace">--- MCA component coll:hcoll (m4 configuration macro)</font></div></div><div><div><font face="monospace, monospace">checking for MCA component coll:hcoll compile mode... dso</font></div></div><div><div><font face="monospace, monospace">checking --with-hcoll value... sanity check ok (/opt/mellanox/hcoll)</font></div></div><div><div><font face="monospace, monospace">checking hcoll_api.h usability... yes</font></div></div><div><div><font face="monospace, monospace">checking hcoll_api.h presence... yes</font></div></div><div><div><font face="monospace, monospace">checking for hcoll_api.h... yes</font></div></div><div><div><font face="monospace, monospace">checking for library containing hcoll_get_version... no</font></div></div><div><div><font face="monospace, monospace">configure: error: HCOLL support requested but not found.  Aborting</font></div></div></blockquote><div><div><br></div><div>OR</div><div><br></div></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><div><div><font face="monospace, monospace">--- MCA component coll:hcoll (m4 configuration macro)</font></div></div></div><div><div><div><font face="monospace, monospace">checking for MCA component coll:hcoll compile mode... dso</font></div></div></div><div><div><div><font face="monospace, monospace">checking hcoll/api/hcoll_api.h usability... yes</font></div></div></div><div><div><div><font face="monospace, monospace">checking hcoll/api/hcoll_api.h presence... yes</font></div></div></div><div><div><div><font face="monospace, monospace">checking for hcoll/api/hcoll_api.h... yes</font></div></div></div><div><div><div><font face="monospace, monospace">looking for library in lib</font></div></div></div><div><div><div><font face="monospace, monospace">checking for library containing hcoll_get_version... no</font></div></div></div><div><div><div><font face="monospace, monospace">looking for library in lib64</font></div></div></div><div><div><div><font face="monospace, monospace">checking for library containing hcoll_get_version... no</font></div></div></div><div><div><div><font face="monospace, monospace">configure: error: HCOLL support requested but not found.  Aborting</font></div></div></div></blockquote><div><div><br></div><div>Where the first output is seen with v1.8 and the second with v1.10 and master.</div><div><br></div><div>The contents of config.log (shown for master, below) indicates that the test for hcoll_get_version has failed *not* due to lack of that symbol, but rather due to some unsatisfied shared library dependency:</div><div><br></div></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px"><div><div><div><font face="monospace, monospace">configure:241636: gcc -std=gnu99 -o conftest -g -finline-functions -fno-strict-aliasing -pthread   -I/hpc/home/USERS/phhargrove/SCRATCH/OMPI/openmpi-master-linux-x86_64-mxm/openmpi-dev-3300-gb7b4231/opal/mca/hwloc/hwloc1111/hwloc/include -I/hpc/home/USERS/phhargrove/SCRATCH/OMPI/openmpi-master-linux-x86_64-mxm/BLD/opal/mca/hwloc/hwloc1111/hwloc/include -I/hpc/home/USERS/phhargrove/SCRATCH/OMPI/openmpi-master-linux-x86_64-mxm/openmpi-dev-3300-gb7b4231/opal/mca/event/libevent2022/libevent -I/hpc/home/USERS/phhargrove/SCRATCH/OMPI/openmpi-master-linux-x86_64-mxm/openmpi-dev-3300-gb7b4231/opal/mca/event/libevent2022/libevent/include -I/hpc/home/USERS/phhargrove/SCRATCH/OMPI/openmpi-master-linux-x86_64-mxm/BLD/opal/mca/event/libevent2022/libevent/include -I/opt/mellanox/hcoll/include    -L/opt/mellanox/hcoll/lib conftest.c -lhcoll   -lrt -lm -lutil   -lrt -lm -lutil   &gt;&amp;5</font></div></div></div><div><div><div><font face="monospace, monospace" style="background-color:rgb(255,255,0)">/usr/bin/ld: warning: libibnetdisc.so.5, needed by /opt/mellanox/hcoll/lib/libhcoll.so, not found (try using -rpath or -rpath-link)</font></div></div></div><div><div><div><font face="monospace, monospace">/opt/mellanox/hcoll/lib/libhcoll.so: undefined reference to `ibnd_iter_nodes_type@IBNETDISC_1.0&#39;</font></div></div></div><div><div><div><font face="monospace, monospace">/opt/mellanox/hcoll/lib/libhcoll.so: undefined reference to `ibnd_destroy_fabric@IBNETDISC_1.0&#39;</font></div></div></div><div><div><div><font face="monospace, monospace">/opt/mellanox/hcoll/lib/libhcoll.so: undefined reference to `ibnd_load_fabric@IBNETDISC_1.0&#39;</font></div></div></div><div><div><div><font face="monospace, monospace">/opt/mellanox/hcoll/lib/libhcoll.so: undefined reference to `ibnd_iter_nodes@IBNETDISC_1.0&#39;</font></div></div></div><div><div><div><font face="monospace, monospace">collect2: ld returned 1 exit status</font></div></div></div></blockquote><div><div><br></div><div>This is on the &quot;mir13&quot; head node of the Mellanox DMZ cluster.</div><div>So, Mellanox should be able to either tell me what I have done wrong, or else reproduce for themselves.</div><div><br></div><div>-Paul</div><div><br></div><div><br></div>-- <br><div><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="javascript:_e(%7B%7D,&#39;cvml&#39;,&#39;PHHargrove@lbl.gov&#39;);" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</div></div>
</blockquote></div>

