Thanks Ralph,<div><br></div><div>I will implement the second option.</div><div>conversion from sentinel to process name will require a few extra steps, but that should not be in the critical path.</div><div><br></div><div>Cheers,</div><div><br></div><div>Gilles<br><br>On Saturday, February 6, 2016, Ralph Castain &lt;<a href="mailto:rhc@open-mpi.org">rhc@open-mpi.org</a>&gt; wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div style="word-wrap:break-word">There are two potential places you could use:<div><br></div><div>* the vpid itself is 32-bits in size - we are quite some years away from needing all of them, so taking the upper-most bit for this purpose should be okay</div><div><br></div><div>* the lower 16-bits of the jobid is the local jobid - i.e., the number of times someone called “comm_spawn”. The code for recycling those has gone a tad stale, but it wouldn’t be hard to recover it. I doubt someone will call comm_spawn more than 2^15 times without at least one of those completing so we can reuse the jobid, and so it should be safe to take the upper bit of that field.</div><div><br></div><div>Frankly, I thought the second option was what Nathan had intended, so I’m surprised to see us masking at the 64-bit level. This touches the mpirun part of the jobid (the upper 16-bits), which is a hash based on the hostname and OS pid. Stripping a bit from that is risky and I definitely wouldn’t advise it.</div><div><br></div><div><br><div><blockquote type="cite"><div>On Feb 5, 2016, at 7:48 PM, Gilles Gouaillardet &lt;<a href="javascript:_e(%7B%7D,&#39;cvml&#39;,&#39;gilles.gouaillardet@gmail.com&#39;);" target="_blank">gilles.gouaillardet@gmail.com</a>&gt; wrote:</div><br><div><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">Thanks George,</span><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><br></div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px">I will definitely try that !</div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><br></div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px">back to the initial question, has someone any thoughts on which bit(s) we can lose when using cutoff ?</div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><br></div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px">Cheers,</div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><br></div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px">Gilles<br><br>On Saturday, February 6, 2016, George Bosilca &lt;<a href="javascript:_e(%7B%7D,&#39;cvml&#39;,&#39;bosilca@icl.utk.edu&#39;);" target="_blank">bosilca@icl.utk.edu</a>&gt; wrote:<br><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex"><p dir="ltr">In addition shouldn&#39;t we use uintptr_t instead of the intptr_t to cope with the MSB during the shifting operations?<span> </span></p><p dir="ltr">George<span> </span></p><div class="gmail_quote">On Feb 5, 2016 10:08 AM, &quot;Jeff Squyres (jsquyres)&quot; &lt;<a>jsquyres@cisco.com</a>&gt; wrote:<br type="attribution"><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">On Feb 5, 2016, at 9:26 AM, Gilles Gouaillardet &lt;<a>gilles.gouaillardet@gmail.com</a>&gt; wrote:<br>&gt;<br>&gt;  static inline opal_process_name_t ompi_proc_sentinel_to_name (intptr_t sentinel)<br>&gt; {<br>&gt;  sentinel &gt;&gt;= 1;<br>&gt;  sentinel &amp;= 0x7FFFFFFFFFFFFFFF;<br>&gt;  return *((opal_process_name_t *) &amp;sentinel);<br>&gt; }<br><br>I don&#39;t have much of an opinion on any of the other stuff here, but I note that this is unsafe.  I know we don&#39;t really care about non-64 bit these days, but we shouldn&#39;t be knowingly breaking it.  Instead of ANDing with a fixed constant, shouldn&#39;t it be something like:<br><br>intptr_t mask = ~1 &gt;&gt; 1;<br>sentinel &amp;= mask;<br><br>--<br>Jeff Squyres<br><a>jsquyres@cisco.com</a><br>For corporate legal information go to:<span> </span><a href="http://www.cisco.com/web/about/doing_business/legal/cri/" rel="noreferrer" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br><br>_______________________________________________<br>devel mailing list<br><a>devel@open-mpi.org</a><br>Subscription:<span> </span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" rel="noreferrer" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br>Link to this post:<span> </span><a href="http://www.open-mpi.org/community/lists/devel/2016/02/18557.php" rel="noreferrer" target="_blank">http://www.open-mpi.org/community/lists/devel/2016/02/18557.php</a><br></blockquote></div></blockquote></div><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">_______________________________________________</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">devel mailing list</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important"><a href="javascript:_e(%7B%7D,&#39;cvml&#39;,&#39;devel@open-mpi.org&#39;);" target="_blank">devel@open-mpi.org</a></span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a></span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important">Link to this post:<span> </span></span><a href="http://www.open-mpi.org/community/lists/devel/2016/02/18563.php" style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" target="_blank">http://www.open-mpi.org/community/lists/devel/2016/02/18563.php</a></div></blockquote></div><br></div></div></blockquote></div>

