<html><head><base href="x-msg://102/"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><div>With&nbsp;</div><div><br></div><div>* MLNX OFED stack tailored for GPUDirect</div><div>* RHEL + kernel patch&nbsp;</div><div>* MVAPICH2&nbsp;</div><div><br></div><div>it is possible to monitor GPUDirect v1 activities by means of observing changes to values in</div><div><br></div><div>* /sys/module/ib_core/parameters/gpu_direct_pages</div><div>* /sys/module/ib_core/parameters/gpu_direct_shares</div><div><br></div><div>By setting CUDA_NIC_INTEROP=1 there are no changes anymore.</div><div><br></div><div>Is there a different way now to monitor if GPUDirect actually works?</div><div><br></div><div>Sebastian.</div><br><div><div>On Jan 18, 2012, at 5:06 PM, Kenneth Lloyd wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div lang="EN-US" link="blue" vlink="purple"><div class="WordSection1" style="page: WordSection1; "><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); ">It is documented in<span class="Apple-converted-space">&nbsp;</span><a href="http://developer.download.nvidia.com/compute/cuda/4_0/docs/GPUDirect_Technology_Overview.pdf" style="color: blue; text-decoration: underline; ">http://developer.download.nvidia.com/compute/cuda/4_0/docs/GPUDirect_Technology_Overview.pdf</a><o:p></o:p></span></div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: Arial, sans-serif; color: black; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: windowtext; ">set CUDA_NIC_INTEROP=1</span><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: windowtext; "><o:p></o:p></span></div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); "><o:p>&nbsp;</o:p></span></div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); "><o:p>&nbsp;</o:p></span></div><div><div style="border-right-style: none; border-bottom-style: none; border-left-style: none; border-width: initial; border-color: initial; border-top-style: solid; border-top-color: rgb(181, 196, 223); border-top-width: 1pt; padding-top: 3pt; padding-right: 0in; padding-bottom: 0in; padding-left: 0in; "><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><b><span style="font-size: 10pt; font-family: Tahoma, sans-serif; ">From:</span></b><span style="font-size: 10pt; font-family: Tahoma, sans-serif; "><span class="Apple-converted-space">&nbsp;</span><a href="mailto:devel-bounces@open-mpi.org" style="color: blue; text-decoration: underline; ">devel-bounces@open-mpi.org</a><span class="Apple-converted-space">&nbsp;</span>[mailto:devel-bounces@open-mpi.org]<span class="Apple-converted-space">&nbsp;</span><b>On Behalf Of<span class="Apple-converted-space">&nbsp;</span></b>Sebastian Rinke<br><b>Sent:</b><span class="Apple-converted-space">&nbsp;</span>Wednesday, January 18, 2012 8:15 AM<br><b>To:</b><span class="Apple-converted-space">&nbsp;</span>Open MPI Developers<br><b>Subject:</b><span class="Apple-converted-space">&nbsp;</span>Re: [OMPI devel] GPUDirect v1 issues<o:p></o:p></span></div></div></div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><o:p>&nbsp;</o:p></div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; ">Setting the environment variable fixed the problem for Open MPI with CUDA 4.0. Thanks!<o:p></o:p></div></div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><o:p>&nbsp;</o:p></div></div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; ">However, I'm wondering why this is not documented in the NVIDIA GPUDirect package.<o:p></o:p></div></div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><o:p>&nbsp;</o:p></div></div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; ">Sebastian.<o:p></o:p></div></div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><o:p>&nbsp;</o:p></div><div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; ">On Jan 18, 2012, at 1:28 AM, Rolf vandeVaart wrote:<o:p></o:p></div></div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><br><br><o:p></o:p></div><div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); ">Yes, the step outlined in your second bullet is no longer necessary.&nbsp;</span><span style="color: black; "><o:p></o:p></span></div></div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); ">&nbsp;</span><span style="color: black; "><o:p></o:p></span></div></div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); ">Rolf</span><span style="color: black; "><o:p></o:p></span></div></div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); ">&nbsp;</span><span style="color: black; "><o:p></o:p></span></div></div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(31, 73, 125); ">&nbsp;</span><span style="color: black; "><o:p></o:p></span></div></div><div style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-width: initial; border-color: initial; border-left-style: solid; padding-top: 0in; padding-right: 0in; padding-bottom: 0in; padding-left: 4pt; border-width: initial; border-color: initial; "><div><div style="border-right-style: none; border-bottom-style: none; border-left-style: none; border-width: initial; border-color: initial; border-top-style: solid; padding-top: 3pt; padding-right: 0in; padding-bottom: 0in; padding-left: 0in; border-width: initial; border-color: initial; "><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><b><span style="font-size: 10pt; font-family: Tahoma, sans-serif; ">From:</span></b><span class="apple-converted-space"><span style="font-size: 10pt; font-family: Tahoma, sans-serif; ">&nbsp;</span></span><span style="font-size: 10pt; font-family: Tahoma, sans-serif; "><a href="mailto:devel-bounces@open-mpi.org" style="color: blue; text-decoration: underline; ">devel-bounces@open-mpi.org</a><span class="apple-converted-space">&nbsp;</span>[<a href="mailto:devel-bounces@open-mpi.org" style="color: blue; text-decoration: underline; ">mailto:devel-bounces@open-mpi.org</a>]<span class="apple-converted-space">&nbsp;</span><b>On Behalf Of<span class="apple-converted-space">&nbsp;</span></b>Sebastian Rinke<br><b>Sent:</b><span class="apple-converted-space">&nbsp;</span>Tuesday, January 17, 2012 5:22 PM<br><b>To:</b><span class="apple-converted-space">&nbsp;</span>Open MPI Developers<br><b>Subject:</b><span class="apple-converted-space">&nbsp;</span>Re: [OMPI devel] GPUDirect v1 issues</span><span style="color: black; "><o:p></o:p></span></div></div></div></div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="color: black; ">&nbsp;<o:p></o:p></span></div></div><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="color: black; ">Thank you very much. I will try setting the environment variable and if required also use the 4.1 RC2 version.<br><br>To clarify things a little bit for me, to set up my machine with GPUDirect v1 I did the following:<br><br>* Install RHEL 5.4<br>* Use the kernel with GPUDirect support<br>* Use the MLNX OFED stack with GPUDirect support<br>* Install the CUDA developer driver<br><br>Does using CUDA&nbsp; &gt;= 4.0&nbsp; make one of the above steps&nbsp; redundant?<br><br>I.e., RHEL or different kernel or MLNX OFED stack with GPUDirect support is&nbsp; not needed any more?<br><br>Sebastian.<br><br>Rolf vandeVaart wrote:<o:p></o:p></span></div></div><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">I ran your test case against Open MPI 1.4.2 and CUDA 4.1 RC2 and it worked fine.&nbsp; I do not have a machine right now where I can load CUDA 4.0 drivers.<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Any chance you can try CUDA 4.1 RC2?&nbsp; There were some improvements in the support (you do not need to set an environment variable for one)<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; "> <a href="http://developer.nvidia.com/cuda-toolkit-41" style="color: blue; text-decoration: underline; ">http://developer.nvidia.com/cuda-toolkit-41</a><o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">There is also a chance that setting the environment variable as outlined in this link may help you.<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; "><a href="http://forums.nvidia.com/index.php?showtopic=200629" style="color: blue; text-decoration: underline; ">http://forums.nvidia.com/index.php?showtopic=200629</a><o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">However, I cannot explain why MVAPICH would work and Open MPI would not.&nbsp; <o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Rolf<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp; <o:p></o:p></span></pre><blockquote style="margin-top: 5pt; margin-bottom: 5pt; "><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">-----Original Message-----<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">From: <a href="mailto:devel-bounces@open-mpi.org" style="color: blue; text-decoration: underline; ">devel-bounces@open-mpi.org</a> [<a href="mailto:devel-bounces@open-mpi.org" style="color: blue; text-decoration: underline; ">mailto:devel-bounces@open-mpi.org</a>]<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">On Behalf Of Sebastian Rinke<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Sent: Tuesday, January 17, 2012 12:08 PM<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">To: Open MPI Developers<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Subject: Re: [OMPI devel] GPUDirect v1 issues<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">I use CUDA 4.0 with MVAPICH2 1.5.1p1 and Open MPI 1.4.2.<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Attached you find a little test case which is based on the GPUDirect v1 test<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">case (mpi_pinned.c).<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">In that program the sender splits a message into chunks and sends them<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">separately to the receiver which posts the corresponding recvs. It is a kind of<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">pipelining.<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">In mpi_pinned.c:141 the offsets into the recv buffer are set.<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">For the correct offsets, i.e. increasing them, it blocks with Open MPI.<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Using line 142 instead (offset = 0) works.<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">The tarball attached contains a Makefile where you will have to adjust<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">* CUDA_INC_DIR<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">* CUDA_LIB_DIR<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Sebastian<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">On Jan 17, 2012, at 4:16 PM, Kenneth A. Lloyd wrote:<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; "> &nbsp;&nbsp;&nbsp;<o:p></o:p></span></pre><blockquote style="margin-top: 5pt; margin-bottom: 5pt; "><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Also, which version of MVAPICH2 did you use?<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">I've been pouring over Rolf's OpenMPI CUDA RDMA 3 (using CUDA 4.1 r2)<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">vis MVAPICH-GPU on a small 3 node cluster. These are wickedly interesting.<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Ken<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">-----Original Message-----<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">From: <a href="mailto:devel-bounces@open-mpi.org" style="color: blue; text-decoration: underline; ">devel-bounces@open-mpi.org</a> [<a href="mailto:devel-bounces@open" style="color: blue; text-decoration: underline; ">mailto:devel-bounces@open</a>-<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <o:p></o:p></span></pre></blockquote><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">mpi.org]<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;&nbsp;&nbsp; <o:p></o:p></span></pre><blockquote style="margin-top: 5pt; margin-bottom: 5pt; "><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">On Behalf Of Rolf vandeVaart<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Sent: Tuesday, January 17, 2012 7:54 AM<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">To: Open MPI Developers<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Subject: Re: [OMPI devel] GPUDirect v1 issues<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">I am not aware of any issues.&nbsp; Can you send me a test program and I<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">can try it out?<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Which version of CUDA are you using?<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Rolf<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <o:p></o:p></span></pre><blockquote style="margin-top: 5pt; margin-bottom: 5pt; "><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">-----Original Message-----<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">From: <a href="mailto:devel-bounces@open-mpi.org" style="color: blue; text-decoration: underline; ">devel-bounces@open-mpi.org</a> [<a href="mailto:devel-bounces@open" style="color: blue; text-decoration: underline; ">mailto:devel-bounces@open</a>-<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <o:p></o:p></span></pre></blockquote></blockquote><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">mpi.org]<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;&nbsp;&nbsp; <o:p></o:p></span></pre><blockquote style="margin-top: 5pt; margin-bottom: 5pt; "><blockquote style="margin-top: 5pt; margin-bottom: 5pt; "><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">On Behalf Of Sebastian Rinke<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Sent: Tuesday, January 17, 2012 8:50 AM<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">To: Open MPI Developers<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Subject: [OMPI devel] GPUDirect v1 issues<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Dear all,<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">I'm using GPUDirect v1 with Open MPI 1.4.3 and experience blocking<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">MPI_SEND/RECV to block forever.<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">For two subsequent MPI_RECV, it hangs if the recv buffer pointer of<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">the second recv points to somewhere, i.e. not at the beginning, in<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">the recv buffer (previously allocated with cudaMallocHost()).<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">I tried the same with MVAPICH2 and did not see the problem.<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Does anybody know about issues with GPUDirect v1 using Open MPI?<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Thanks for your help,<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">Sebastian<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">_______________________________________________<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">devel mailing list<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; "><a href="mailto:devel@open-mpi.org" style="color: blue; text-decoration: underline; ">devel@open-mpi.org</a><o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; "><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" style="color: blue; text-decoration: underline; ">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <o:p></o:p></span></pre></blockquote></blockquote></blockquote><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">-----------------------------------------------------------------------------------<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">This email message is for the sole use of the intended recipient(s) and may contain<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">confidential information.&nbsp; Any unauthorized review, use, disclosure or distribution<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">is prohibited.&nbsp; If you are not the intended recipient, please contact the sender by<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">reply email and destroy all copies of the original message.<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">-----------------------------------------------------------------------------------<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp;<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">_______________________________________________<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">devel mailing list<o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; "><a href="mailto:devel@open-mpi.org" style="color: blue; text-decoration: underline; ">devel@open-mpi.org</a><o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; "><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" style="color: blue; text-decoration: underline; ">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><o:p></o:p></span></pre><pre style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 10pt; font-family: 'Courier New'; "><span style="color: black; ">&nbsp; <o:p></o:p></span></pre><div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="color: black; ">&nbsp;<o:p></o:p></span></div></div></div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><span style="font-size: 13.5pt; font-family: Helvetica, sans-serif; ">_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org" style="color: blue; text-decoration: underline; ">devel@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" style="color: blue; text-decoration: underline; ">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><o:p></o:p></span></div></div></div><div style="margin-top: 0in; margin-right: 0in; margin-left: 0in; margin-bottom: 0.0001pt; font-size: 12pt; font-family: 'Times New Roman', serif; "><o:p>&nbsp;</o:p></div></div>_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org" style="color: blue; text-decoration: underline; ">devel@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" style="color: blue; text-decoration: underline; ">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a></div></blockquote></div><br></body></html>
