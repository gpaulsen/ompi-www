<div dir="ltr">Jeff,<br><div class="gmail_extra"><br></div><div class="gmail_extra"><div class="gmail_quote">On Wed, May 28, 2014 at 8:31 PM, Jeff Squyres (jsquyres) </div><div class="gmail_quote">&gt; To be totally clear: MPI says it is erroneous for only some (not all) processes in a communicator to call MPI_COMM_FREE.  So if that&#39;s the real problem, then the discussion about why the parent(s) is(are) trying to contact the children is moot -- the test is erroneous, and erroneous application behavior is undefined.<div>
<br></div><div>This is definetly what happens : only some tasks call MPI_Comm_free()</div><div>i will commit my changes and the initially reported issue is solved :-)</div><div><br></div><div><br></div><div><br></div><div>
about the &quot;bonus points&quot; :</div><div><br></div><div>v1.8 does not have this issue</div><div><br></div><div>i digged it and bottom line, the parent (who did not call MPI_Comm_free unlike the children) calls ompi_dpm_base_dyn_finalize, which tries to isend the already exited tasks.</div>
<div><br></div><span style="font-size:13px;font-family:arial,sans-serif"><div class="gmail_quote"><span style="font-size:13px;font-family:arial,sans-serif"><br></span></div>bottom line, in pml_ob1_sendreq.h line 450</span><br style="font-size:13px;font-family:arial,sans-serif">
<br>with v1,8<br style="font-size:13px;font-family:arial,sans-serif"><span style="font-size:13px;font-family:arial,sans-serif">mca_bml_base_btl_array_get_</span><span style="font-size:13px;font-family:arial,sans-serif">size(&amp;endpoint-&gt;btl_eager) = 0</span></div>
<div class="gmail_quote">nothing is sent but isend is reported successful</div><div class="gmail_quote"><br></div><div class="gmail_quote">with trunk<br><span style="font-size:13px;font-family:arial,sans-serif">mca_bml_base_btl_array_get_</span><span style="font-size:13px;font-family:arial,sans-serif">size(&amp;endpoint-&gt;btl_eager) = 1</span></div>
<div class="gmail_quote"><font face="arial, sans-serif">and then try to send the message =&gt;</font> BOUM</div><div class="gmail_quote"><br></div><div class="gmail_quote">i found various things that seem counter intuitive to me and will summarize all this tomorrow.</div>
<div class="gmail_quote"><br></div><div class="gmail_quote">Cheers,</div><div class="gmail_quote"><br></div><div class="gmail_quote">Gilles</div></div></div>

