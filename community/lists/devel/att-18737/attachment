<div dir="ltr">(Sorry, typo in previous email.  Please read that as)<div><br></div><div><div style="font-size:12.8px">I have another question: why is any given operation implemented twice for the same architecture? </div><div style="font-size:12.8px"><br></div><div style="font-size:12.8px">Ref:  opal/asm/base/AMD64.asm and opal/include/opal/sys/amd64/atomic.h,  say function opal_atomic_cmpset_32()</div></div><div style="font-size:12.8px"><br></div><div style="font-size:12.8px">Thanks!</div><div style="font-size:12.8px"><br></div><div style="font-size:12.8px"><br></div></div><div class="gmail_extra"><br><div class="gmail_quote">On Fri, Apr 1, 2016 at 2:26 PM, Sreenidhi Bharathkar Ramesh <span dir="ltr">&lt;<a href="mailto:sreenidhi-bharathkar.ramesh@broadcom.com" target="_blank">sreenidhi-bharathkar.ramesh@broadcom.com</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr">Hi Paul,<div><br></div><div>Thanks for the response, I understand.</div><div><br></div><div>I have another question: why is any given operation implemented twice for the same architecture? </div><div><br></div><div>Ref:  opal/asm/base/ARM.asm and opal/include/opal/sys/amd64/atomic.h</div><span class=""><div><br></div><div>Please let me know.</div><div><br></div><div>Thanks,</div><div>- Sreenidhi.</div><div><br></div><div><br></div></span></div><div class="gmail_extra"><br><div class="gmail_quote"><div><div class="h5">On Thu, Mar 31, 2016 at 2:28 AM, Paul Hargrove <span dir="ltr">&lt;<a href="mailto:phhargrove@lbl.gov" target="_blank">phhargrove@lbl.gov</a>&gt;</span> wrote:<br></div></div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div><div class="h5"><div dir="ltr">Sreenihdi,<div><br></div><div>Maintenance of the &quot;other&quot; files is, at least, required for older compilers (including several non-GNU ones) which have support for GCC inline ASM constructs but do not include the __sync functions.</div><div><br></div><div>Additionally, the __sync functions always include a full memory fence while there are places where Open MPI only needs Acquire or Release.  In that sense the use of the GCC builtin atomics is not always an &quot;optimization&quot;.</div><div><br></div><div>-Paul</div></div><div class="gmail_extra"><br><div class="gmail_quote"><span>On Wed, Mar 30, 2016 at 4:19 AM, Sreenidhi Bharathkar Ramesh <span dir="ltr">&lt;<a href="mailto:sreenidhi-bharathkar.ramesh@broadcom.com" target="_blank">sreenidhi-bharathkar.ramesh@broadcom.com</a>&gt;</span> wrote:<br></span><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span><div dir="ltr">Hello,<div><br></div><div>I did few more experiments.  Built-in atomics are disabled by default and can be enabled by &quot;--enable-builtin-atomics&quot;.  With this option, a different atomic file is include  (I mean, different from the other three mentioned in the earlier email).</div><div><br></div><div>opal/include/opal/sys/sync_builtin/atomic.h<br></div><div><br></div><div> By enabling &quot;--enable-builtin-atomics&quot;, the OpenMPI library will not only get the latest optimizations from GCC __sync functions, but also get all additional functions, such as &lt;<span style="font-size:medium;color:rgb(0,0,0);font-family:monospace">__sync_or_and_fetch</span>&gt;  &lt;<span style="font-size:medium;color:rgb(0,0,0);font-family:monospace">__sync_and_and_fetch</span>&gt; etc.  Also, this way, the arch/*.asm files need not be maintained.</div><div><br></div><div>Seems there is more of an advantage to have &quot;--enable-builtin-atomics&quot;.  Am I missing something ?  Please let me know your thoughts.</div><div><br></div><div>Thanks,</div><div>- Sreenidhi.</div></div><div><div><div class="gmail_extra"><br><div class="gmail_quote">On Wed, Mar 30, 2016 at 10:33 AM, Sreenidhi Bharathkar Ramesh <span dir="ltr">&lt;<a href="mailto:sreenidhi-bharathkar.ramesh@broadcom.com" target="_blank">sreenidhi-bharathkar.ramesh@broadcom.com</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr">Hello,<div><br></div><div>With respect to atomic operations in assembly, I can see three source files, for the same AMD64 architecture.</div><div><br></div><div>1. opal/asm/base/AMD64.asm</div><div>2. opal/include/opal/sys/amd64/atomic.h</div><div>3. opal/include/opal/sys/atomic_impl.h</div><div><br></div><div>What is the need for three files ?  How are they inter-related ?</div><div><br></div><div>Please let me know.</div><div><br></div><div>Thanks,</div><div>- Sreenidhi.</div></div>
</blockquote></div><br></div>
</div></div><br></span>_______________________________________________<br>
devel mailing list<br>
<a href="mailto:devel@open-mpi.org" target="_blank">devel@open-mpi.org</a><br>
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" rel="noreferrer" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br>
Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2016/03/18733.php" rel="noreferrer" target="_blank">http://www.open-mpi.org/community/lists/devel/2016/03/18733.php</a><span><font color="#888888"><br></font></span></blockquote></div><span><font color="#888888"><br><br clear="all"><div><br></div>-- <br><div><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</font></span></div>
<br>_______________________________________________<br>
devel mailing list<br>
<a href="mailto:devel@open-mpi.org" target="_blank">devel@open-mpi.org</a><br>
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" rel="noreferrer" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br></div></div>
Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2016/03/18734.php" rel="noreferrer" target="_blank">http://www.open-mpi.org/community/lists/devel/2016/03/18734.php</a><br></blockquote></div><br></div>
</blockquote></div><br></div>

