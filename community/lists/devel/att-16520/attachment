<div dir="ltr"><div>I think I&#39;ve reported this earlier in the 1.8 series.</div><div>If I compile on an SGI UV (e.g. blacklight at PSC) configure picks up the presence of xpmem headers and enables the vader BTL.</div><div>However, the port of vader to SGI&#39;s &quot;flavor&quot; of xpmem is incomplete and the following build failure results:</div><div><br></div><div><div><font face="monospace">make[2]: Entering directory `/brashear/hargrove/OMPI/openmpi-1.8.4rc2-linux-x86_64-uv/BLD/ompi/mca/btl/vader&#39;</font></div><div><font face="monospace">  CC       btl_vader_module.lo</font></div><div><font face="monospace">In file included from /usr/users/6/hargrove/SCRATCH/OMPI/openmpi-1.8.4rc2-linux-x86_64-uv/openmpi-1.8.4rc2/ompi/mca/btl/vader/btl_vader.h:60,</font></div><div><font face="monospace">                 from /usr/users/6/hargrove/SCRATCH/OMPI/openmpi-1.8.4rc2-linux-x86_64-uv/openmpi-1.8.4rc2/ompi/mca/btl/vader/btl_vader_module.c:29:</font></div><div><font face="monospace">/usr/users/6/hargrove/SCRATCH/OMPI/openmpi-1.8.4rc2-linux-x86_64-uv/openmpi-1.8.4rc2/ompi/mca/btl/vader/btl_vader_endpoint.h:76: error: expected specifier-qualifier-list before &#39;xpmem_apid_t&#39;</font></div><div><font face="monospace">/usr/users/6/hargrove/SCRATCH/OMPI/openmpi-1.8.4rc2-linux-x86_64-uv/openmpi-1.8.4rc2/ompi/mca/btl/vader/btl_vader_module.c: In function &#39;init_vader_endpoint&#39;:</font></div><div><font face="monospace">/usr/users/6/hargrove/SCRATCH/OMPI/openmpi-1.8.4rc2-linux-x86_64-uv/openmpi-1.8.4rc2/ompi/mca/btl/vader/btl_vader_module.c:197: error: &#39;struct &lt;anonymous&gt;&#39; has no member named &#39;apid&#39;</font></div><div><font face="monospace">/usr/users/6/hargrove/SCRATCH/OMPI/openmpi-1.8.4rc2-linux-x86_64-uv/openmpi-1.8.4rc2/ompi/mca/btl/vader/btl_vader_module.c: In function &#39;mca_btl_vader_endpoint_destructor&#39;:</font></div><div><font face="monospace">/usr/users/6/hargrove/SCRATCH/OMPI/openmpi-1.8.4rc2-linux-x86_64-uv/openmpi-1.8.4rc2/ompi/mca/btl/vader/btl_vader_module.c:682: error: &#39;struct &lt;anonymous&gt;&#39; has no member named &#39;apid&#39;</font></div><div><font face="monospace">/usr/users/6/hargrove/SCRATCH/OMPI/openmpi-1.8.4rc2-linux-x86_64-uv/openmpi-1.8.4rc2/ompi/mca/btl/vader/btl_vader_module.c:683: error: &#39;struct &lt;anonymous&gt;&#39; has no member named &#39;apid&#39;</font></div><div><font face="monospace">make[2]: *** [btl_vader_module.lo] Error 1</font></div><div><font face="monospace">make[2]: Leaving directory `/brashear/hargrove/OMPI/openmpi-1.8.4rc2-linux-x86_64-uv/BLD/ompi/mca/btl/vader&#39;</font></div><div><font face="monospace">make[1]: *** [all-recursive] Error 1</font></div><div><font face="monospace">make[1]: Leaving directory `/brashear/hargrove/OMPI/openmpi-1.8.4rc2-linux-x86_64-uv/BLD/ompi&#39;</font></div><div><font face="monospace">make: *** [all-recursive] Error 1</font></div></div><div><br></div><div>This can trivially be fixed in configure if one doesn&#39;t recognize the SGI variant of xpmem.</div><div>I think (untested) that the following is sufficient:</div><div><br></div><div><div><font face="monospace">--- ./ompi/mca/btl/vader/configure.m4~  2014-12-11 18:51:11.499654000 -0800</font></div><div><font face="monospace">+++ ./ompi/mca/btl/vader/configure.m4   2014-12-11 18:51:52.289654000 -0800</font></div><div><font face="monospace">@@ -23,7 +23,7 @@</font></div><div><font face="monospace">     AC_ARG_WITH([xpmem],</font></div><div><font face="monospace">                 [AC_HELP_STRING([--with-xpmem(=DIR)],</font></div><div><font face="monospace">                 [Build with XPMEM kernel module support, searching for headers in DIR])])</font></div><div><font face="monospace">-    OMPI_CHECK_WITHDIR([xpmem], [$with_xpmem], [include/xpmem.h include/sn/xpmem.h])</font></div><div><font face="monospace">+    OMPI_CHECK_WITHDIR([xpmem], [$with_xpmem], [include/xpmem.h])</font></div><div><font face="monospace"> </font></div><div><font face="monospace">     AC_ARG_WITH([xpmem-libdir],</font></div><div><font face="monospace">                 [AC_HELP_STRING([--with-xpmem-libdir=DIR],</font></div></div><div><font face="monospace"><br></font></div><div><br></div>-Paul<br clear="all"><div><br></div>-- <br><div class="gmail_signature"><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</div>

