<div dir="ltr">I have a systems running Solaris 11.1 on x86-64 hardware and 11.2 in an x86-64 VM.<div>To the extent I have tested the results are the same on both, despite gcc-4.5.2 vs 4.8.2<br><div><br></div><div>I have normally tested only the Sun/Oracle Studio compilers on these systems.</div><div>However, today I gave the vendor-provided gcc, g++ and gfortran in /usr/bin a try.</div><div>So I configured the OpenMPI 1.10.0rc3 tarball with NO arguments to configure.</div><div><br></div><div>When doing so I see tons of warnings like:</div><div><br></div><div><div><font face="monospace, monospace">../../../../openmpi-1.10.0rc3/opal/include/opal/sys/atomic.h:393:9: warning: `opal_atomic_add_32&#39; used but never defined</font></div><div><font face="monospace, monospace">../../../../openmpi-1.10.0rc3/opal/include/opal/sys/atomic.h:401:9: warning: `opal_atomic_sub_32&#39; used but never defined</font></div></div><div><br></div><div>and an eventual link failure to match:</div><div><br></div><div><div><font face="monospace, monospace">  CCLD     <a href="http://libopen-pal.la">libopen-pal.la</a></font></div><div><font face="monospace, monospace">Text relocation remains                         referenced</font></div><div><font face="monospace, monospace">    against symbol                  offset      in file</font></div><div><font face="monospace, monospace">opal_atomic_add_32                  0x1e4       runtime/.libs/opal_progress.o</font></div><div><font face="monospace, monospace">opal_atomic_sub_32                  0x234       runtime/.libs/opal_progress.o</font></div><div><font face="monospace, monospace">ld: fatal: relocations remain against allocatable but non-writable sections</font></div><div><font face="monospace, monospace">collect2: ld returned 1 exit status</font></div></div><div><br></div><div><br></div><div><br></div><div>Here is the possibly-relevant portion of the configure output:</div><div><br></div><div><div><font face="monospace, monospace">checking if gcc -std=gnu99 supports GCC inline assembly... yes</font></div><div><font face="monospace, monospace">checking if gcc -std=gnu99 supports DEC inline assembly... no</font></div><div><font face="monospace, monospace">checking if gcc -std=gnu99 supports XLC inline assembly... no</font></div><div><font face="monospace, monospace">checking for assembly format... default-.text-.globl-:--.L-@-1-0-1-1-0</font></div><div><font face="monospace, monospace">checking for assembly architecture... IA32</font></div><div><font face="monospace, monospace">checking for builtin atomics... BUILTIN_NO</font></div><div><font face="monospace, monospace">checking for perl... perl</font></div><div><font face="monospace, monospace">checking for pre-built assembly file... yes (atomic-ia32-linux-nongas.s)</font></div><div><font face="monospace, monospace">checking for atomic assembly filename... atomic-ia32-linux-nongas.s</font></div></div><div><br></div><div><br></div><div>The same problem is present in Open MPI 1.8.8, but 1.8.7 builds just fine.</div><div><br></div><div><div>Note that on Solaris the default ABI is ILP32 (e.g. default to -m32 rather than -m64).</div><div>There are no problems with LP64 builds (&quot;-m64&quot; in *FLAGS and the wrapper flags).</div></div><div>There are also no problems with either ILP32 or LP64 and the Studio compilers.</div><div>Only gcc with (default) 32-bit target experiences this failure.</div><div><br></div><div>-Paul<br clear="all"><div><br></div>-- <br><div class="gmail_signature"><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</div></div></div>

