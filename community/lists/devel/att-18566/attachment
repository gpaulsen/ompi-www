<html><head><meta http-equiv="Content-Type" content="text/html charset=utf-8"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class="">FWIW: there are macros in orte/util/name_fns.h that will extract the individual jobid fields, and there is another macro for reassembling the jobid from the two pieces. If you use those, we’ll avoid any issues with future modifications to the fields.<div class=""><br class=""></div><div class=""><br class=""><div><blockquote type="cite" class=""><div class="">On Feb 5, 2016, at 8:17 PM, Gilles Gouaillardet &lt;<a href="mailto:gilles.gouaillardet@gmail.com" class="">gilles.gouaillardet@gmail.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><div class="">Thanks Ralph,<div class=""><br class=""></div><div class="">I will implement the second option.</div><div class="">conversion from sentinel to process name will require a few extra steps, but that should not be in the critical path.</div><div class=""><br class=""></div><div class="">Cheers,</div><div class=""><br class=""></div><div class="">Gilles<br class=""><br class="">On Saturday, February 6, 2016, Ralph Castain &lt;<a href="mailto:rhc@open-mpi.org" class="">rhc@open-mpi.org</a>&gt; wrote:<br class=""><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div style="word-wrap:break-word" class="">There are two potential places you could use:<div class=""><br class=""></div><div class="">* the vpid itself is 32-bits in size - we are quite some years away from needing all of them, so taking the upper-most bit for this purpose should be okay</div><div class=""><br class=""></div><div class="">* the lower 16-bits of the jobid is the local jobid - i.e., the number of times someone called “comm_spawn”. The code for recycling those has gone a tad stale, but it wouldn’t be hard to recover it. I doubt someone will call comm_spawn more than 2^15 times without at least one of those completing so we can reuse the jobid, and so it should be safe to take the upper bit of that field.</div><div class=""><br class=""></div><div class="">Frankly, I thought the second option was what Nathan had intended, so I’m surprised to see us masking at the 64-bit level. This touches the mpirun part of the jobid (the upper 16-bits), which is a hash based on the hostname and OS pid. Stripping a bit from that is risky and I definitely wouldn’t advise it.</div><div class=""><br class=""></div><div class=""><br class=""><div class=""><blockquote type="cite" class=""><div class="">On Feb 5, 2016, at 7:48 PM, Gilles Gouaillardet &lt;<a href="javascript:_e(%7B%7D,'cvml','gilles.gouaillardet@gmail.com');" target="_blank" class="">gilles.gouaillardet@gmail.com</a>&gt; wrote:</div><br class=""><div class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">Thanks George,</span><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><br class=""></div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class="">I will definitely try that !</div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><br class=""></div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class="">back to the initial question, has someone any thoughts on which bit(s) we can lose when using cutoff ?</div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><br class=""></div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class="">Cheers,</div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><br class=""></div><div style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class="">Gilles<br class=""><br class="">On Saturday, February 6, 2016, George Bosilca &lt;<a href="javascript:_e(%7B%7D,'cvml','bosilca@icl.utk.edu');" target="_blank" class="">bosilca@icl.utk.edu</a>&gt; wrote:<br class=""><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex"><p dir="ltr" class="">In addition shouldn't we use uintptr_t instead of the intptr_t to cope with the MSB during the shifting operations?<span class="">&nbsp;</span></p><p dir="ltr" class="">George<span class="">&nbsp;</span></p><div class="gmail_quote">On Feb 5, 2016 10:08 AM, "Jeff Squyres (jsquyres)" &lt;<a class="">jsquyres@cisco.com</a>&gt; wrote:<br type="attribution" class=""><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">On Feb 5, 2016, at 9:26 AM, Gilles Gouaillardet &lt;<a class="">gilles.gouaillardet@gmail.com</a>&gt; wrote:<br class="">&gt;<br class="">&gt;&nbsp; static inline opal_process_name_t ompi_proc_sentinel_to_name (intptr_t sentinel)<br class="">&gt; {<br class="">&gt;&nbsp; sentinel &gt;&gt;= 1;<br class="">&gt;&nbsp; sentinel &amp;= 0x7FFFFFFFFFFFFFFF;<br class="">&gt;&nbsp; return *((opal_process_name_t *) &amp;sentinel);<br class="">&gt; }<br class=""><br class="">I don't have much of an opinion on any of the other stuff here, but I note that this is unsafe.&nbsp; I know we don't really care about non-64 bit these days, but we shouldn't be knowingly breaking it.&nbsp; Instead of ANDing with a fixed constant, shouldn't it be something like:<br class=""><br class="">intptr_t mask = ~1 &gt;&gt; 1;<br class="">sentinel &amp;= mask;<br class=""><br class="">--<br class="">Jeff Squyres<br class=""><a class="">jsquyres@cisco.com</a><br class="">For corporate legal information go to:<span class="">&nbsp;</span><a href="http://www.cisco.com/web/about/doing_business/legal/cri/" rel="noreferrer" target="_blank" class="">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br class=""><br class="">_______________________________________________<br class="">devel mailing list<br class=""><a class="">devel@open-mpi.org</a><br class="">Subscription:<span class="">&nbsp;</span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" rel="noreferrer" target="_blank" class="">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br class="">Link to this post:<span class="">&nbsp;</span><a href="http://www.open-mpi.org/community/lists/devel/2016/02/18557.php" rel="noreferrer" target="_blank" class="">http://www.open-mpi.org/community/lists/devel/2016/02/18557.php</a><br class=""></blockquote></div></blockquote></div><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">_______________________________________________</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">devel mailing list</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class=""><a href="javascript:_e(%7B%7D,'cvml','devel@open-mpi.org');" target="_blank" class="">devel@open-mpi.org</a></span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" target="_blank" class="">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a></span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">Link to this post:<span class="">&nbsp;</span></span><a href="http://www.open-mpi.org/community/lists/devel/2016/02/18563.php" style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" target="_blank" class="">http://www.open-mpi.org/community/lists/devel/2016/02/18563.php</a></div></blockquote></div><br class=""></div></div></blockquote></div>
_______________________________________________<br class="">devel mailing list<br class=""><a href="mailto:devel@open-mpi.org" class="">devel@open-mpi.org</a><br class="">Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/devel<br class="">Link to this post: http://www.open-mpi.org/community/lists/devel/2016/02/18565.php</div></blockquote></div><br class=""></div></body></html>
