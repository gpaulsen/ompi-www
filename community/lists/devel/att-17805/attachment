<html><head><meta http-equiv="Content-Type" content="text/html charset=utf-8"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class="">FYI - for those not on the PMIx mailing list, we would welcome your input<div class="">Ralph</div><div class=""><br class=""><div><br class=""><blockquote type="cite" class=""><div class="">Begin forwarded message:</div><br class="Apple-interchange-newline"><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px;" class=""><span style="font-family: -webkit-system-font, Helvetica Neue, Helvetica, sans-serif; color:rgba(0, 0, 0, 1.0);" class=""><b class="">From: </b></span><span style="font-family: -webkit-system-font, Helvetica Neue, Helvetica, sans-serif;" class="">Ralph Castain &lt;<a href="mailto:rhc@open-mpi.org" class="">rhc@open-mpi.org</a>&gt;<br class=""></span></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px;" class=""><span style="font-family: -webkit-system-font, Helvetica Neue, Helvetica, sans-serif; color:rgba(0, 0, 0, 1.0);" class=""><b class="">Subject: </b></span><span style="font-family: -webkit-system-font, Helvetica Neue, Helvetica, sans-serif;" class=""><b class="">PMIx 2.0 API thoughts</b><br class=""></span></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px;" class=""><span style="font-family: -webkit-system-font, Helvetica Neue, Helvetica, sans-serif; color:rgba(0, 0, 0, 1.0);" class=""><b class="">Date: </b></span><span style="font-family: -webkit-system-font, Helvetica Neue, Helvetica, sans-serif;" class="">August 22, 2015 at 8:45:50 AM PDT<br class=""></span></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px;" class=""><span style="font-family: -webkit-system-font, Helvetica Neue, Helvetica, sans-serif; color:rgba(0, 0, 0, 1.0);" class=""><b class="">To: </b></span><span style="font-family: -webkit-system-font, Helvetica Neue, Helvetica, sans-serif;" class=""><a href="mailto:pmix-devel@open-mpi.org" class="">pmix-devel@open-mpi.org</a><br class=""></span></div><br class=""><div class=""><meta http-equiv="Content-Type" content="text/html charset=utf-8" class=""><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=""><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">Hi folks</div><div style="margin: 0px; font-size: 15px; font-family: Times;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">At the last PMIx telecon, people asked about the current status of suggested PMIx 2.0 plans. I confess that we have been so absorbed by integrating PMIx 1.x into OMPI/ORCM and SLURM that we haven’t developed these plans as much as I had hoped. However, we have been collecting input from around the community and have assembled some initial thoughts.</div><div style="margin: 0px; font-size: 15px; font-family: Times;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">The 2.0 effort can be broken into two general tracks:</div><div style="margin: 0px; font-size: 15px; font-family: Times;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class=""><b class="">Performance Enhancements</b></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">* Reduced memory footprint. We currently store a lot of information in every process - in terms of per-proc footprint, it isn’t that huge, but when we get to large numbers of procs/node there is a significant amount of duplicated space. Courtesy of Elena (Mellanox), we already have a shared memory implementation poised in the 2.0 branch that will allow the local PMIx server to create one instance of the info, and then just point the local procs to it. This will undoubtedly benefit from some refinement as we begin to fully utilize it.</div><div style="margin: 0px; font-size: 15px; font-family: Times;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">* The data scoping feature included in the PMIx_Put function provides several levels of locality. This helps reduce the amount of data being distributed across nodes and being stored on each node. Current programming model libraries (other than OMPI) don’t exploit this feature, and we need to educate them on its use.</div><div style="margin: 0px; font-size: 15px; font-family: Times;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">* Distributed approach to database organization. If we consider the publish/lookup data as well as the typical modex data, what we really have is a traditional key-value datastore. Requirements for fault tolerance are beginning to be reflected into this datastore, which raises questions regarding where and how we store it. There has been a lot of research on the best ways of storing and retrieving such data - the current approach isn’t necessarily high on the list of “best” fault tolerant solutions. Therefore, we might want to spend some time looking at distributed datastore methods such as DHTs, included in PMIx as user-selectable options until we better understand their impact on performance. This will mean adding an appropriate infrastructure to PMIx to support such research.</div><div style="margin: 0px; font-size: 15px; font-family: Times;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">* Embedded collective algorithms for high-performance and scalable barrier/allgather operations. We do not envision PMIx having inter-nodal communication capabilities, but it is possible that we could provide APIs by which we could direct scalable collectives across the PMIx servers. These could range from traditional HPC algorithms to Adam Moody’s new “ring” model - we should let the user direct the choice and provide a default automated selection method.&nbsp;</div><div style="margin: 0px; font-size: 15px; font-family: Times;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">* Assuming we provide the above API, I guess that would open the question of providing a complete standalone server that uses the provided communication functions to execute inter-nodal operations. We would need to somehow wrap the other server APIs so the host RM could do things like “register_nspace”, but this might make adoption easier for those preferring something standalone.</div><div style="margin: 0px; font-size: 15px; font-family: Times;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">* Switching algorithms for full vs direct modex operations. PMIx provides the ability to either fully exchange all data during the “modex” operation, or to execute a zero-byte barrier (or even a “no-op”), with data retrieval done on an “as-requested” basis (what we call “direct modex”). Deciding which of these algorithms to use is currently left to the caller, which means it is hardwired into the programming model library. However, the “optimal” decision is probably a question of both scale and volume of data, which means that some selection logic might be appropriate. We could either embed the decision in PMIx, or at least provide an API to help users pick the best option based on provided info.</div><div style="margin: 0px; font-size: 15px; font-family: Times; min-height: 18px;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times; min-height: 18px;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times; min-height: 18px;" class=""><b class="">Functional Extensions</b></div><div style="margin: 0px; font-size: 15px; font-family: Times; min-height: 18px;" class="">These are focused on application-level APIs for interacting with the RM/system mgmt, based on input from various users as well as the recent CORAL RFP. Also, keep in mind that multi-tenant operations are likely to become more common as we see continued increases in the number of cores on nodes plus convergence of HPC with cloud environments. So the RM will likely become involved in managing an expanding range of resources (see <a href="http://www.open-mpi.org/papers/controls-2015/" class="">http://www.open-mpi.org/papers/controls-2015/</a> for at least one vision of how this might look), which means applications will need to interact with it even more.</div><div style="margin: 0px; font-size: 15px; font-family: Times; min-height: 18px;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times; min-height: 18px;" class="">* Application-directed workflow execution. I’ve been getting increased requests for the ability to support emerging programming models where the application “steers” execution (e.g., Hadoop, Spark, Legion, and Radical). In these models, the application starts as a single process, and then computes its resource needs (nodes, files, etc.), executes some operation that involves spawning new processes, evaluates the results, and iterates. We currently have the “spawn” API, but additional support will be required. I suspect Gary’s SC15 BoF will help to identify those needs.</div><div style="margin: 0px; font-size: 15px; font-family: Times; min-height: 18px;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">* Request changes in power policy and settings. This is still an emerging area of interest, and really only on the largest machines, but providing a method for doing this would be helpful.</div><div style="margin: 0px; font-size: 15px; font-family: Times; min-height: 18px;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">* Direct positioning of files for use by the application or another job step within the same allocated session. As on-node storage increases (e.g., with NVRAM), opportunities exist for pre-positioning files and retaining files and/or shared memory regions across job steps within the same allocated session. This needs to be supported as part of a workflow script as well as via a programmatic API (for dynamic directions by the application) - if we provide a standard library for this purpose, then even the cmd line becomes easy to support. This would also include specifying storage policies such as hot/warm/cold locations, and requests for burst buffer management.</div><div style="margin: 0px; font-size: 15px; font-family: Times; min-height: 18px;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">* Request notification of events at the application and/or system level, including warning of predicted failures for preemptive response, notification of process failures, and other events of interest to the application. I’ve received requests for a laundry list of events that various applications would like to be notified about, so I think generalizing the existing notification API makes the most sense. Currently, we only support registration of a single notifier callback. This probably needs to be extended to allow registration of an arbitrary number of callbacks, each for a given event (or combination of events), with multiple callbacks for the same event supported in some kind of defined progression (i.e., call this function first, then call this one next - maybe with a “stop the callback stack” return option).</div><div style="margin: 0px; font-size: 15px; font-family: Times; min-height: 18px;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">* Define notification response actions, including allocation of replacement resources and launch of replacement processes. All of the specific operations will probably be supported via other APIs, but we need a way to tell the host RM that the application is indeed taking responsive action, so please don’t do anything that would interfere with that action (e.g., terminate the job).</div><div style="margin: 0px; font-size: 15px; font-family: Times; min-height: 18px;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">* Request dynamic modification of allocations, including expansion and/or partial release of the existing allocation, and new allocations for subsequent spawn requests;</div><div style="margin: 0px; font-size: 15px; font-family: Times; min-height: 18px;" class=""><br class=""></div><div style="margin: 0px; font-size: 15px; font-family: Times;" class="">* Request fabric QoS and security constraints, plus information on network topology.</div><div class=""><br class=""></div><div class=""><br class=""></div><div class=""><font face="Times" class=""><span style="font-size: 15px;" class="">Obviously this is going to take some significant time to cover all these areas, and I honestly don’t expect to see ALL of them in the 2.x series. This is an open source community project, so the timing and ordering of the features will depend on the interests of the developers, influenced as always by feedback from users.</span></font></div><div class=""><font face="Times" class=""><span style="font-size: 15px;" class=""><br class=""></span></font></div><div class=""><font face="Times" class=""><span style="font-size: 15px;" class="">So please feel free to&nbsp;“volunteer” to contribute!</span></font></div><div class=""><font face="Times" class=""><span style="font-size: 15px;" class="">Ralph</span></font></div><div class=""><font face="Times" class=""><span style="font-size: 15px;" class=""><br class=""></span></font></div></div></div></blockquote></div><br class=""></div></body></html>
