<html><head><style type="text/css"><!-- DIV {margin:0px;} --></style></head><body><div style="font-family:times new roman, new york, times, serif;font-size:10pt">Hi, <br>Thanks a lot for the reply. You have understood my problem correctly but I am unable to comprehend your solution or suggestion where to look into . The btl_size is shown as 12 and size as 8. But my understanding of mca_btl_tcp_comonent_exchange function is a touch different or perhaps wrong, so please correct me if I am wrong.<br><br>Once we do the exchange i.e. mca_btl_tcp_component_exchange:(), the size is calculated as <br><br>size_t size = mca_btl_tcp_component.tcp_num_btls * sizeof(mca_btl_tcp_addr_t);<br><br>This is giving me correct size. I have only one tcp_num_btls, therefore size is given as 12. Now we allocate memory by <br><br>mca_btl_tcp_addr_t *addrs = (mca_btl_tcp_addr_t *)malloc(size)<br><br>As size is 12, hence it gives me the correct allocation. And lastly<br><br>rc
 =&nbsp; mca_pml_base_modex_send(&amp;mca_btl_tcp_component.super.btl_version, addrs, size);<br><br>This sends addrs with the size 12. Should not that work out of the box? Or are there more things attached which are not transparent?<br><br>Can you please give me some more explanation of this statement.... which I think holds the key to my solution, but I am not able to comprehend correctly.<br>"We copy the information to be sent into the addrs array and increase xfer_size afterwards (telling the function how many bytes to be transferred)."<br>Where exactly are we increasing the size? <br><br><div>&nbsp;</div>Best Regards,<br>Muhammad Atif<div style="font-family: times new roman,new york,times,serif; font-size: 10pt;"><br><br><div style="font-family: times new roman,new york,times,serif; font-size: 12pt;">----- Original Message ----<br>From: Adrian Knoth &lt;adi@drcomp.erfurt.thur.de&gt;<br>To: Open MPI Developers &lt;devel@open-mpi.org&gt;<br>Sent:
 Thursday, January 17, 2008 11:43:24 PM<br>Subject: Re: [OMPI devel] btl tcp port to xensocket<br><br>
On Tue, Jan 15, 2008 at 04:07:02PM -0800, Muhammad Atif wrote:<br><br>&gt; Just for reference, I am trying to port btl/tcp to xensockets. Now if<br>&gt; i want to do modex send/recv , to my understanding,
 mca_btl_tcp_addr_t<br>&gt; is used (ref code/function is mca_btl_tcp_component_exchange). For<br>&gt; xensockets, I need to send only one additional integer remote_domU_id<br>&gt; across to say all the peers (in refined code it would be specific to<br>&gt; each domain, but i just want to have clear understanding before i
 move<br>&gt; any further). Now I have changed the struct mca_btl_tcp_addr_t
 present<br>&gt; in btl_tcp_addr.h and have added int r_domu_id. This makes the size
 of<br>&gt; structure 12. Upon receive mca_btl_tcp_proc_create() gives an error<br>&gt; after mca_pml_base_modex_recv() and at this statement if(0 != (size %<br>&gt; sizeof(mca_btl_tcp_addr_t))) that size do not match. It is still<br>&gt; expecting size 8, where as i have made the size 12.&nbsp; I am unable to<br>&gt; pin point the exact location where the size 8 is still embedded. Any<br>&gt; ideas?<br><br>Just an idea: the mca_base_modex_recv error gives you this error:<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  BTL_ERROR(("mca_base_modex_recv: invalid size %d: btl-size:<br>&nbsp;&nbsp;&nbsp; &nbsp;  %d\n", size, sizeof(mca_btl_tcp_addr_t)));<br><br><br>So what is wrong? Is btl-size shown as 12 or as 8? It should be 12. And<br>is size just 8? So this means you forgot to include your new socket in<br>your modex_send_request.<br><br>See mca_btl_tcp_component_exchange: We copy the information to be sent<br>into the addrs array and increase xfer_size
 afterwards (telling the<br>function how many bytes to be transferred).<br><br>Perhaps you missed something there.<br><br><br>-- <br>Cluster and Metacomputing Working Group<br>Friedrich-Schiller-Universität Jena, Germany<br><br>private: <a href="http://adi.thur.de" target="_blank">http://adi.thur.de</a><br>_______________________________________________<br>devel mailing list<br><a ymailto="mailto:devel@open-mpi.org" href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br></div><br></div></div><br>



      <hr size=1>Never miss a thing.  <a href="http://us.rd.yahoo.com/evt=51438/*http://www.yahoo.com/r/hs"> Make Yahoo your homepage.</a>

</body></html>
