<html><head></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><div>Nathan,</div><div><br></div><div>I'm no Perl programmer AT ALL, so take this for what it it worth ($0).</div><div><br></div><div>This RE correctly parses a version no. either at the beginning of the string <i>or</i> preceded by a white-space character.</div><div><br></div><blockquote type="cite">$ echo "10.4.2" | perl -E 'while (&lt;STDIN&gt;) { if ( m/(^|\s)((\d+\.)+\d+)/ ) { $version = $2 ; print $version, "\n" ; last } }'</blockquote><div><blockquote type="cite"><div><font class="Apple-style-span" color="#000000">10.4.2</font></div></blockquote></div><div><div><br></div></div><div>I modified the RE from the last one I saw you post ($version =~ m/\s([\d\.]+\w?)/m;) to allow for multiple digit fields, to remove the "m" modifier ($ is gone now), and&nbsp;to only allow digits in the last field of the version number.</div><div><br></div><div>I don't know all the contortions of version strings you are trying to match, i.e., why you allowed any alphanumeric (including _) for the last field. &nbsp;This one will match all digits with an optional single letter suffix at the end (i.e., must be at a word boundary).</div><div><br></div><div><blockquote type="cite"><font class="Apple-style-span" color="#000000">$ echo "10.4.2A" | perl -E 'while (&lt;STDIN&gt;) { if ( m/(^|\s)((\d+\.)+\d+([a-zA-Z]\b)?)/ ) { $version = $2 ; print $version, "\n" ; last } }'</font></blockquote><blockquote type="cite"><div><font class="Apple-style-span" color="#000000">10.4.2A</font></div></blockquote><div><div><br></div></div><div>
Larry Baker<br>US Geological Survey<br>650-329-5608<br><a href="mailto:baker@usgs.gov">baker@usgs.gov</a><br><br><br>
</div>
<br><div><div>On 15 Nov 2012, at 8:42 AM, Hjelm, Nathan T wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div>Committed as r27615. Let me know if there are any more issues.<br><br>-Nathan<br><br>________________________________________<br>From: <a href="mailto:devel-bounces@open-mpi.org">devel-bounces@open-mpi.org</a> [devel-bounces@open-mpi.org] on behalf of Ralph Castain [rhc@open-mpi.org]<br>Sent: Thursday, November 15, 2012 8:53 AM<br>To: Open MPI Developers<br>Subject: Re: [OMPI devel] [OMPI svn] svn:open-mpi r27601 - trunk<br><br>Looks fine to me. I would only add one further refinement - I think we should check m4, but add a check in <a href="http://autogen.pl">autogen.pl</a> so that if we get nothing useful back from -v (or whatever), then output a warning that we couldn't validate the version and assume it is okay.<br><br>I believe the tool will return a non-zero status if the option isn't supported, so we should be able to do this - yes?<br><br><br>On Nov 15, 2012, at 7:48 AM, "Hjelm, Nathan T" &lt;<a href="mailto:hjelmn@lanl.gov">hjelmn@lanl.gov</a>&gt; wrote:<br><br><blockquote type="cite">Since the version of m4 that comes with Solaris likely works with all our .m4 files and there is no way to check the version (no --version, -v, -V, or anything from what I can tell) I guess we have no choice but to not check the m4 version.<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">flex on the other hand we can check. How about this for the new regex (for reference the old one is $version =~ m/\s([\d\w\.]+)$/m; -- matching a version at the end of the line):<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">$version =~ m/\s([\d\.]+\w?)/m;<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">It works with Apple's flex and still works with glibtoolize, autoconf, and automake.<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"> &nbsp;Searching for autoconf<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;Found autoconf version 2.69; checking version...<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 2 -- need 2<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 69 -- need 65<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;==&gt; ACCEPTED<br></blockquote><blockquote type="cite"> &nbsp;Searching for libtoolize<br></blockquote><blockquote type="cite"> libtoolize not found<br></blockquote><blockquote type="cite"> &nbsp;Searching for glibtoolize<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;Found glibtoolize version 2.4.2; checking version...<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 2 -- need 2<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 4 -- need 2<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;==&gt; ACCEPTED<br></blockquote><blockquote type="cite"> &nbsp;Searching for automake<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;Found automake version 1.12.2; checking version...<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 1 -- need 1<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 12 -- need 11<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;==&gt; ACCEPTED<br></blockquote><blockquote type="cite"> &nbsp;Searching for flex<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;Found flex version 2.5.35; checking version...<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 2 -- need 2<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 5 -- need 5<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 35 -- need 35<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;==&gt; ACCEPTED<br></blockquote><blockquote type="cite"> &nbsp;Searching for m4<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;Found m4 version 1.4.6; checking version...<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 1 -- need 1<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 4 -- need 4<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 6 -- need 16<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;==&gt; Too low! &nbsp;Skipping this version<br></blockquote><blockquote type="cite"> &nbsp;Searching for gm4<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;Found gm4 version 1.4.16; checking version...<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 1 -- need 1<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 4 -- need 4<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found version component 16 -- need 16<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;==&gt; ACCEPTED<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">-Nathan<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">________________________________________<br></blockquote><blockquote type="cite">From: <a href="mailto:devel-bounces@open-mpi.org">devel-bounces@open-mpi.org</a> [devel-bounces@open-mpi.org] on behalf of Paul Hargrove [phhargrove@lbl.gov]<br></blockquote><blockquote type="cite">Sent: Wednesday, November 14, 2012 7:37 PM<br></blockquote><blockquote type="cite">To: Larry Baker<br></blockquote><blockquote type="cite">Cc: Open MPI Developers<br></blockquote><blockquote type="cite">Subject: Re: [OMPI devel] [OMPI svn] svn:open-mpi r27601 - trunk<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">Larry,<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">I just wanted to speak up quickly to be sure nobody used your example to "fix" the Mac OS problem and thereby break Solaris instead. &nbsp;No personal attack/affront was intended.<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><a href="-Paulhttps://mymail.lanl.gov/owa/?ae=PreFormAction&amp;t=IPM.Note&amp;a=ReplyAll&amp;id=RgAAAAD3GfjXt9HDTI902%2b63W1IcBwCuRfL1X%2babT5m7NFXoIdcVAAAAxVZxAACuRfL1X%2babT5m7NFXoIdcVAAAa4RQFAAAJ#">-Paulhttps://mymail.lanl.gov/owa/?ae=PreFormAction&amp;t=IPM.Note&amp;a=ReplyAll&amp;id=RgAAAAD3GfjXt9HDTI902%2b63W1IcBwCuRfL1X%2babT5m7NFXoIdcVAAAAxVZxAACuRfL1X%2babT5m7NFXoIdcVAAAa4RQFAAAJ#</a><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">On Wed, Nov 14, 2012 at 7:10 PM, Larry Baker &lt;baker@usgs.gov&lt;<a href="mailto:baker@usgs.gov">mailto:baker@usgs.gov</a>&gt;&gt; wrote:<br></blockquote><blockquote type="cite">Paul,<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">1) I wasn't trying to solve the --version issue, only the parsing of the response.<br></blockquote><blockquote type="cite">2) I assumed from the initial e-mail that the broken parser was in a Perl script. &nbsp;I'm not a Perl person, so I wrote the example regular expression parser in sed.<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">These commands were done on my Mac OS X 10.6 system. &nbsp;I have no idea where the apps came from. &nbsp;I know the sed, at least, does not recognize regular expressions documented for GNU sed (such as \&lt; \&gt; for begin/end word). &nbsp;Maybe it is a BSD sed?<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">I was just trying to illustrate how to fix the broken parsing of Ralph's "flex --version". &nbsp;Assuming the RE parser I wrote is satisfactory, it would have to be adapted to fit in the framework, i.e., it has to be portable.<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">Larry Baker<br></blockquote><blockquote type="cite">US Geological Survey<br></blockquote><blockquote type="cite">650-329-5608&lt;tel:650-329-5608&gt;<br></blockquote><blockquote type="cite">baker@usgs.gov&lt;<a href="mailto:baker@usgs.gov">mailto:baker@usgs.gov</a>&gt;<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">On 14 Nov 2012, at 5:41 PM, Paul Hargrove wrote:<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">On Wed, Nov 14, 2012 at 6:26 PM, Larry Baker &lt;baker@usgs.gov&lt;<a href="mailto:baker@usgs.gov">mailto:baker@usgs.gov</a>&gt;&gt; wrote:<br></blockquote><blockquote type="cite">m4 --version | sed -n -E -e '1s/^.*[^A-Za-z0-9_-]?([0-9]+[.][0-9]+[.][0-9]+)[^A-Za-z0-9_-]?.*$/\1/p'<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">There are STILL problems with this approach as it is TWICE specific to GNU software:<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">1) M4 on OpenBSD (maybe others) doesn't support a "--version" flag:<br></blockquote><blockquote type="cite">$ m4 --version | sed -n -E -e '1s/^.*[^A-Za-z0-9_-]?([0-9]+[.][0-9]+[.][0-9]+)[^A-Za-z0-9_-]?.*$/\1/p'<br></blockquote><blockquote type="cite">m4: unknown option -- -<br></blockquote><blockquote type="cite">usage: m4 [-gPs] [-Dname[=value]] [-d flags] [-I dirname] [-o filename]<br></blockquote><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-t macro] [-Uname] [file ...]<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">2) sed on Solaris (maybe others) doesn't support a "-E" flag:<br></blockquote><blockquote type="cite">$ m4 --version | sed -n -E -e '1s/^.*[^A-Za-z0-9_-]?([0-9]+[.][0-9]+[.][0-9]+)[^A-Za-z0-9_-]?.*$/\1/p'<br></blockquote><blockquote type="cite">/bin/sed: illegal option -- E<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">-Paul<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">--<br></blockquote><blockquote type="cite">Paul H. Hargrove &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHHargrove@lbl.gov&lt;<a href="mailto:PHHargrove@lbl.gov">mailto:PHHargrove@lbl.gov</a>&gt;<br></blockquote><blockquote type="cite">Future Technologies Group<br></blockquote><blockquote type="cite">Computer and Data Sciences Department &nbsp;&nbsp;&nbsp;&nbsp;Tel: +1-510-495-2352&lt;tel:%2B1-510-495-2352&gt;<br></blockquote><blockquote type="cite">Lawrence Berkeley National Laboratory &nbsp;&nbsp;&nbsp;&nbsp;Fax: +1-510-486-6900&lt;tel:%2B1-510-486-6900&gt;<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">_______________________________________________<br></blockquote><blockquote type="cite">devel mailing list<br></blockquote><blockquote type="cite">devel@open-mpi.org&lt;<a href="mailto:devel@open-mpi.org">mailto:devel@open-mpi.org</a>&gt;<br></blockquote><blockquote type="cite"><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">--<br></blockquote><blockquote type="cite">Paul H. Hargrove &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHHargrove@lbl.gov&lt;<a href="mailto:PHHargrove@lbl.gov">mailto:PHHargrove@lbl.gov</a>&gt;<br></blockquote><blockquote type="cite">Future Technologies Group<br></blockquote><blockquote type="cite">Computer and Data Sciences Department &nbsp;&nbsp;&nbsp;&nbsp;Tel: +1-510-495-2352<br></blockquote><blockquote type="cite">Lawrence Berkeley National Laboratory &nbsp;&nbsp;&nbsp;&nbsp;Fax: +1-510-486-6900<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">_______________________________________________<br></blockquote><blockquote type="cite">devel mailing list<br></blockquote><blockquote type="cite"><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br></blockquote><blockquote type="cite"><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br></blockquote><br><br>_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/devel<br><br>_______________________________________________<br>devel mailing list<br>devel@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/devel<br></div></blockquote></div><br></div></body></html>
