<html><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><div>Jeff,</div><div><br></div><div><blockquote type="cite"><div>Hmm. &nbsp;This sounds right, but I'm a little curious as to why this never came up before.<br></div></blockquote><div><br></div>I reported this, as well as several others, in August 2010, "Fixes to OpenMPI-1.4.2 for PGI compilers". &nbsp;(Attached are my patches for OpenMPI 1.4.2.) &nbsp;At that time I was using the PGI 10.x compilers.<br><br></div><div><blockquote type="cite"><div>What was the specific problem that caused you to add this patch?<br></div></blockquote></div><div><div><br></div></div><div>These warning messages are from PGI C++ 11.4 for the assembly language macros in OpenMPI 1.4.3&nbsp;opal/include/opal/sys/amd64/atomic.h:</div><div><br></div><blockquote type="cite"><div><font class="Apple-style-span" color="#000000">libtool: compile: &nbsp;pgcpp -m64 -DHAVE_CONFIG_H -I. -I../../../opal/include -I../../../orte/include -I../../../ompi/include -I../../../opal/mca/paffinity/linux/plpa/src/libplpa -DOMPI_BUILDING_CXX_BINDINGS_LIBRARY=1 -DOMPI_SKIP_MPICXX=1 -I../../</font></div><div><font class="Apple-style-span" color="#000000">.. -D_REENTRANT -DNDEBUG -g -O3 -DNO_PGI_OFFSET -c mpicxx.cc &nbsp;-fpic -DPIC -o .libs/mpicxx.o</font></div><div><font class="Apple-style-span" color="#000000">"../../../opal/include/opal/sys/amd64/atomic.h", line 91: warning: "cc"</font></div><div><font class="Apple-style-span" color="#000000">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;clobber ignored</font></div><div><font class="Apple-style-span" color="#000000">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : "memory", "cc");</font></div><div><font class="Apple-style-span" color="#000000">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ^</font></div><div><font class="Apple-style-span" color="#000000"><br></font></div><div><font class="Apple-style-span" color="#000000">"../../../opal/include/opal/sys/amd64/atomic.h", line 83: warning: parameter</font></div><div><font class="Apple-style-span" color="#000000">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"oldval" was set but never used</font></div><div><font class="Apple-style-span" color="#000000">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;int32_t oldval, int32_t newval)</font></div><div><font class="Apple-style-span" color="#000000">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;^</font></div><div><font class="Apple-style-span" color="#000000"><br></font></div><div><font class="Apple-style-span" color="#000000">"../../../opal/include/opal/sys/amd64/atomic.h", line 112: warning: "cc"</font></div><div><font class="Apple-style-span" color="#000000">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;clobber ignored</font></div><div><font class="Apple-style-span" color="#000000">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : "memory", "cc"</font></div><div><font class="Apple-style-span" color="#000000">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ^</font></div><div><font class="Apple-style-span" color="#000000"><br></font></div><div><font class="Apple-style-span" color="#000000">"../../../opal/include/opal/sys/amd64/atomic.h", line 104: warning: parameter</font></div><div><font class="Apple-style-span" color="#000000">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"oldval" was set but never used</font></div><div><font class="Apple-style-span" color="#000000">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int64_t oldval, int64_t newval)</font></div><div><font class="Apple-style-span" color="#000000">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ^</font></div></blockquote><div><div><br></div></div><div>configure defines&nbsp;OMPI_CXX_GCC_INLINE_ASSEMBLY as 1 in&nbsp;opal/include/opal_config.h (unlike&nbsp;OMPI_C_GCC_INLINE_ASSEMBLY, which is defined as 0), which causes the assembly language macros to be used:</div><div><br></div><div><blockquote type="cite"><div><font class="Apple-style-span" color="#000000"># find . -name \*.h -exec grep \#define.\*OMPI_.\*_INLINE_ASSEMBLY {} ';' -print</font></div></blockquote><blockquote type="cite">&lt;snip&gt;<br></blockquote><blockquote type="cite"><div><font class="Apple-style-span" color="#000000">#define OMPI_CXX_DEC_INLINE_ASSEMBLY 0</font></div><div><font class="Apple-style-span" color="#000000">#define OMPI_CXX_GCC_INLINE_ASSEMBLY 1</font></div><div><font class="Apple-style-span" color="#000000">#define OMPI_CXX_XLC_INLINE_ASSEMBLY 0</font></div><div><font class="Apple-style-span" color="#000000">#define OMPI_C_DEC_INLINE_ASSEMBLY 0</font></div><div><font class="Apple-style-span" color="#000000">#define OMPI_C_GCC_INLINE_ASSEMBLY 0</font></div><div><font class="Apple-style-span" color="#000000">#define OMPI_C_XLC_INLINE_ASSEMBLY 0</font></div><div><font class="Apple-style-span" color="#000000">./opal/include/opal_config.h</font></div></blockquote></div><div><div><br></div></div><div apple-content-edited="true"> <div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><div><div><div><div><div><div><div><div><div><div>Larry Baker</div><div>US Geological Survey</div><div>650-329-5608</div><div><a href="mailto:baker@usgs.gov">baker@usgs.gov</a></div></div></div></div></div></div></div></div></div></div></div> </div><br><div><div>On 18 May 2011, at 6:17 AM, Jeff Squyres wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div>Hmm. &nbsp;This sounds right, but I'm a little curious as to why this never came up before. &nbsp;What was the specific problem that caused you to add this patch?<br><br><br>On May 17, 2011, at 9:41 PM, Larry Baker wrote:<br><br><blockquote type="cite">This bug applies to OpenMPI 1.4.x and 1.5.x.<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">Inline assembly does not work for PGI compilers. &nbsp;configure disables inline assembly for PGI C, but neglects to do the same for PGI C++. &nbsp;The code that disables inline assembly for PGI C needs to be copied to the section that handles inline assembly for C++.<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">Here's the diff -u from OpenMPI 1.4.3 (same code, same bug):<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><blockquote type="cite">[root@hydra openmpi-1.4.3]# diff -u configure{.original,}<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">--- configure.original<span class="Apple-tab-span" style="white-space:pre">	</span>2010-10-05 15:48:18.000000000 -0700<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">+++ configure<span class="Apple-tab-span" style="white-space:pre">	</span>2011-05-17 18:35:04.000000000 -0700<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">@@ -34690,6 +34690,11 @@<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;{ $as_echo "$as_me:$LINENO: checking if $CXX supports GCC inline assembly" &gt;&amp;5<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> $as_echo_n "checking if $CXX supports GCC inline assembly... " &gt;&amp;6; }<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">+ &nbsp;&nbsp;&nbsp;if test "$ompi_cv_cxx_compiler_vendor" = "portland group" ; then<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">+ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# PGI seems to have some issues with our inline assembly.<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">+ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Disable for now.<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">+ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asm_result="no (Portland Group)"<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">+ &nbsp;&nbsp;&nbsp;else<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;case $host in<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*-aix*)<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the AIX compilers and linkers really don't do gcc<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">@@ -34813,6 +34818,7 @@<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conftest$ac_exeext conftest.$ac_ext<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;fi<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">+ &nbsp;&nbsp;&nbsp;fi<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> &nbsp;&nbsp;&nbsp;&nbsp;{ $as_echo "$as_me:$LINENO: result: $asm_result" &gt;&amp;5<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> $as_echo "$asm_result" &gt;&amp;6; }<br></blockquote></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">Larry Baker<br></blockquote><blockquote type="cite">US Geological Survey<br></blockquote><blockquote type="cite">650-329-5608<br></blockquote><blockquote type="cite"><a href="mailto:baker@usgs.gov">baker@usgs.gov</a><br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">On 5 May 2011, at 7:15 AM, Jeff Squyres wrote:<br></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite"><blockquote type="cite">Fixed the ROMIO attribute problem properly this time -- it's in the usual place:<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"> &nbsp;&nbsp;<a href="http://www.open-mpi.org/software/ompi/v1.4/">http://www.open-mpi.org/software/ompi/v1.4/</a><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">-- <br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">Jeff Squyres<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">For corporate legal information go to:<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><a href="http://www.cisco.com/web/about/doing_business/legal/cri/">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">_______________________________________________<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite">devel mailing list<br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br></blockquote></blockquote><blockquote type="cite"><blockquote type="cite"><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br></blockquote></blockquote><blockquote type="cite"><br></blockquote><blockquote type="cite">_______________________________________________<br></blockquote><blockquote type="cite">devel mailing list<br></blockquote><blockquote type="cite"><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br></blockquote><blockquote type="cite"><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br></blockquote><br><br>-- <br>Jeff Squyres<br><a href="mailto:jsquyres@cisco.com">jsquyres@cisco.com</a><br>For corporate legal information go to:<br>http://www.cisco.com/web/about/doing_business/legal/cri/<br><br><br>_______________________________________________<br>devel mailing list<br>devel@open-mpi.org<br>http://www.open-mpi.org/mailman/listinfo.cgi/devel<br></div></blockquote></div></body></html>
