<html><head><meta http-equiv="Content-Type" content="text/html charset=utf-8"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class="">Out of curiosity: if both systems are Intel, they why are you enabling hetero? You donâ€™t need it in that scenario.<div class=""><br class=""></div><div class="">Admittedly, we do need to fix the bug - just trying to understand why you are configuring that way.</div><div class=""><br class=""></div><div class=""><br class=""><div><blockquote type="cite" class=""><div class="">On Feb 10, 2016, at 8:46 PM, Michael Rezny &lt;<a href="mailto:michael.rezny@monash.edu" class="">michael.rezny@monash.edu</a>&gt; wrote:</div><br class="Apple-interchange-newline"><div class=""><div dir="ltr" class=""><div class=""><div class=""><div class=""><div class=""><div class=""><div class="">Hi Gilles,<br class=""></div>I can confirm that with a fresh download and build from source for OpenMPI 1.10.2<br class=""></div><div class="">with --enable-heterogeneous<br class=""></div>the unpacked ints are the wrong endian.<br class=""><br class=""></div>However, without --enable-heterogeneous, the unpacked ints are correct.<br class=""><br class=""></div>So, this problem still exists in heterogeneous builds with OpenMPI version 1.10.2.<br class=""><br class=""></div>kindest regards<br class=""></div>Mike<br class=""></div><div class="gmail_extra"><br class=""><div class="gmail_quote">On 11 February 2016 at 14:48, Gilles Gouaillardet <span dir="ltr" class="">&lt;<a href="mailto:gilles.gouaillardet@gmail.com" target="_blank" class="">gilles.gouaillardet@gmail.com</a>&gt;</span> wrote:<br class=""><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">Michael,<div class=""><br class=""></div><div class="">does your two systems have the same endianness ?</div><div class=""><br class=""></div><div class="">do you know how openmpi was configure'd on both systems ?</div><div class="">(is --enable-heterogeneous enabled or disabled on both systems ?)</div><div class=""><br class=""></div><div class="">fwiw, openmpi 1.6.5 is old now and no more maintained.</div><div class="">I strongly encourage you to use openmpi 1.10.2</div><div class=""><br class=""></div><div class="">Cheers,</div><div class=""><br class=""></div><div class="">Gilles</div><div class=""><br class="">On Thursday, February 11, 2016, Michael Rezny &lt;<a href="mailto:michael.rezny@monash.edu" target="_blank" class="">michael.rezny@monash.edu</a>&gt; wrote:<br class=""><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr" class=""><div class=""><div class=""><div class=""><div class=""><div class=""><div class="">Hi,<br class=""></div>I am running Ubuntu 14.04 LTS with OpenMPI 1.6.5 and gcc 4.8.4<br class=""><br class=""></div>On a single rank program which just packs and unpacks two ints using MPI_Pack_external and MPI_Unpack_external<br class=""></div>the unpacked ints are in the wrong endian order.<br class=""><br class=""></div>However, on a HPC, (not Ubuntu), using OpenMPI 1.6.5 and gcc 4.8.4 the unpacked ints are correct.<br class=""><br class=""></div><div class="">Is it possible to get some assistance to track down what is going on?<br class=""></div><div class=""><br class=""></div>Here is the output from the program:<br class=""><br class="">&nbsp;<span style="font-family:monospace,monospace" class="">~/tests/mpi/Pack test1<br class="">send data 000004d2 0000162e <br class="">MPI_Pack_external: 0<br class="">buffer size: 8<br class="">MPI_unpack_external: 0<br class="">recv data d2040000 2e160000 </span><br class=""><br class=""></div>And here is the source code:<br class=""><br class=""><span style="font-family:monospace,monospace" class="">#include &lt;stdio.h&gt;<br class="">#include &lt;mpi.h&gt;<br class=""><br class="">int main(int argc, char *argv[]) {<br class="">&nbsp; int numRanks, myRank, error;<br class=""><br class="">&nbsp; int send_data[2] = {1234, 5678};<br class="">&nbsp; int recv_data[2];<br class=""><br class="">&nbsp; MPI_Aint buffer_size = 1000;<br class="">&nbsp; char buffer[buffer_size];<br class=""><br class="">&nbsp; MPI_Init(&amp;argc, &amp;argv);<br class="">&nbsp; MPI_Comm_size(MPI_COMM_WORLD, &amp;numRanks);<br class="">&nbsp; MPI_Comm_rank(MPI_COMM_WORLD, &amp;myRank);<br class=""><br class="">&nbsp; printf("send data %08x %08x \n", send_data[0], send_data[1]);<br class=""><br class="">&nbsp; MPI_Aint position = 0;<br class="">&nbsp; error = MPI_Pack_external("external32", (void*) send_data, 2, MPI_INT,<br class="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; buffer, buffer_size, &amp;position);<br class="">&nbsp; printf("MPI_Pack_external: %d\n", error);<br class=""><br class="">&nbsp; printf("buffer size: %d\n", (int) position);<br class=""><br class="">&nbsp; position = 0;<br class="">&nbsp; error = MPI_Unpack_external("external32", buffer, buffer_size, &amp;position,<br class="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; recv_data, 2, MPI_INT);<br class="">&nbsp; printf("MPI_unpack_external: %d\n", error);<br class=""><br class="">&nbsp; printf("recv data %08x %08x \n", recv_data[0], recv_data[1]);<br class=""><br class="">&nbsp; MPI_Finalize();<br class=""><br class="">&nbsp; return 0;<br class="">}<br class=""></span><br class=""><br class=""></div>
</blockquote></div>
<br class="">_______________________________________________<br class="">
devel mailing list<br class="">
<a href="mailto:devel@open-mpi.org" class="">devel@open-mpi.org</a><br class="">
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" rel="noreferrer" target="_blank" class="">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br class="">
Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2016/02/18573.php" rel="noreferrer" target="_blank" class="">http://www.open-mpi.org/community/lists/devel/2016/02/18573.php</a><br class=""></blockquote></div><br class=""></div>
_______________________________________________<br class="">devel mailing list<br class=""><a href="mailto:devel@open-mpi.org" class="">devel@open-mpi.org</a><br class="">Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/devel<br class="">Link to this post: http://www.open-mpi.org/community/lists/devel/2016/02/18575.php</div></blockquote></div><br class=""></div></body></html>
