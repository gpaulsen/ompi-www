<html><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">There was a glitch in the SVN server this evening; you can tell that this r number is far lower than it should be.<div><br></div><div>IU is fixing it right now. &nbsp;This commit will occur again with a new, higher SVN r number shortly...</div><div><br><div><br><div>Begin forwarded message:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><font face="Helvetica" size="5" color="#000000" style="font: 18.0px Helvetica; color: #000000"><b>From: </b></font><font face="Helvetica" size="5" style="font: 18.0px Helvetica">&lt;<a href="mailto:jsquyres@osl.iu.edu">jsquyres@osl.iu.edu</a>></font></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><font face="Helvetica" size="5" color="#000000" style="font: 18.0px Helvetica; color: #000000"><b>Date: </b></font><font face="Helvetica" size="5" style="font: 18.0px Helvetica">March 19, 2009 8:41:21 PM EDT</font></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><font face="Helvetica" size="5" color="#000000" style="font: 18.0px Helvetica; color: #000000"><b>To: </b></font><font face="Helvetica" size="5" style="font: 18.0px Helvetica">&lt;<a href="mailto:svn-full@open-mpi.org">svn-full@open-mpi.org</a>></font></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><font face="Helvetica" size="5" color="#000000" style="font: 18.0px Helvetica; color: #000000"><b>Subject: </b></font><font face="Helvetica" size="5" style="font: 18.0px Helvetica"><b>[OMPI svn-full] svn:open-mpi r20759</b></font></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><font face="Helvetica" size="5" color="#000000" style="font: 18.0px Helvetica; color: #000000"><b>Reply-To: </b></font><font face="Helvetica" size="5" style="font: 18.0px Helvetica">&lt;<a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a>></font></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; min-height: 14px; "><br></div> </div> <div> <!-- Converted from text/plain format --><p><font size="2">Author: jsquyres<br> Date: 2009-03-19 20:41:21 EDT (Thu, 19 Mar 2009)<br> New Revision: 20759<br> URL: <a href="https://svn.open-mpi.org/trac/ompi/changeset/20759">https://svn.open-mpi.org/trac/ompi/changeset/20759</a><br> <br> Log:<br> Per a comment on the users list, don't try to install our own signal<br> handlers if there are already non-default handlers installed.&nbsp; Print a<br> warning if that situation arises.<br> <br> '''NOTE:''' This is a definite target for OPAL_SOS conversion -- as it<br> is right now, this message will be displayed for ''every'' MPI<br> process.&nbsp; We want this to be OPAL_SOS'ed when that becomes available<br> so that the error message can be aggregated nicely.<br> <br> Added:<br> &nbsp;&nbsp; trunk/opal/util/help-opal-util.txt<br> Text files modified:<br> &nbsp;&nbsp; trunk/opal/util/Makefile.am&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; 4 +++-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp; trunk/opal/util/stacktrace.c |&nbsp;&nbsp;&nbsp; 22 ++++++++++++++++++++--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp; 2 files changed, 23 insertions(+), 3 deletions(-)<br> <br> Modified: trunk/opal/util/Makefile.am<br> ==============================================================================<br> --- trunk/opal/util/Makefile.am (original)<br> +++ trunk/opal/util/Makefile.am 2009-03-19 20:41:21 EDT (Thu, 19 Mar 2009)<br> @@ -9,7 +9,7 @@<br> &nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; University of Stuttgart.&nbsp; All rights reserved.<br> &nbsp;# Copyright (c) 2004-2005 The Regents of the University of California.<br> &nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; All rights reserved.<br> -# Copyright (c) 2007&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Cisco Systems, Inc.&nbsp; All rights reserved.<br> +# Copyright (c) 2007-2009 Cisco Systems, Inc.&nbsp; All rights reserved.<br> &nbsp;# $COPYRIGHT$<br> &nbsp;#<br> &nbsp;# Additional copyrights may follow<br> @@ -19,6 +19,8 @@<br> <br> &nbsp;SUBDIRS = keyval<br> <br> +dist_pkgdata_DATA = help-opal-util.txt<br> +<br> &nbsp;AM_LFLAGS = -Popal_show_help_yy<br> &nbsp;LEX_OUTPUT_ROOT = lex.opal_show_help_yy<br> <br> <br> Added: trunk/opal/util/help-opal-util.txt<br> ==============================================================================<br> --- (empty file)<br> +++ trunk/opal/util/help-opal-util.txt&nbsp; 2009-03-19 20:41:21 EDT (Thu, 19 Mar 2009)<br> @@ -0,0 +1,25 @@<br> +# -*- text -*-<br> +#<br> +# Copyright (c) 2009 Cisco Systems, Inc.&nbsp; All rights reserved.<br> +# $COPYRIGHT$<br> +#<br> +# Additional copyrights may follow<br> +#<br> +# $HEADER$<br> +#<br> +# This is the US/English general help file for Open MPI.<br> +#<br> +[stacktrace signal override]<br> +Open MPI was insertting a signal handler for signal %d but noticed<br> +that there is already a non-default handler installer.&nbsp; Open MPI's<br> +handler was therefore not installed; your job will continue.&nbsp; This<br> +warning message will only be displayed once, even if Open MPI<br> +encounters this situation again.<br> +<br> +To avoid displaying this warning message, you can either not install<br> +the error handler for signal %d or you can have Open MPI not try to<br> +install its own signal handler for this signal by setting the<br> +"opal_signals" MCA parameter.<br> +<br> +&nbsp; Signal: %d<br> +&nbsp; Current opal_signals value: %s<br> <br> Modified: trunk/opal/util/stacktrace.c<br> ==============================================================================<br> --- trunk/opal/util/stacktrace.c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (original)<br> +++ trunk/opal/util/stacktrace.c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2009-03-19 20:41:21 EDT (Thu, 19 Mar 2009)<br> @@ -38,6 +38,7 @@<br> &nbsp;#include "opal/mca/backtrace/backtrace.h"<br> &nbsp;#include "opal/constants.h"<br> &nbsp;#include "opal/util/output.h"<br> +#include "opal/util/show_help.h"<br> <br> &nbsp;#ifndef _NSIG<br> &nbsp;#define _NSIG 32<br> @@ -410,11 +411,12 @@<br> &nbsp;int opal_util_register_stackhandlers (void)<br> &nbsp;{<br> &nbsp;#if OMPI_WANT_PRETTY_PRINT_STACKTRACE &amp;&amp; ! defined(__WINDOWS__)<br> -&nbsp;&nbsp;&nbsp; struct sigaction act;<br> +&nbsp;&nbsp;&nbsp; struct sigaction act, old;<br> &nbsp;&nbsp;&nbsp;&nbsp; char * string_value;<br> &nbsp;&nbsp;&nbsp;&nbsp; char * tmp;<br> &nbsp;&nbsp;&nbsp;&nbsp; char * next;<br> &nbsp;&nbsp;&nbsp;&nbsp; int param, i;<br> +&nbsp;&nbsp;&nbsp; bool showed_help = false;<br> <br> &nbsp;&nbsp;&nbsp;&nbsp; gethostname(stacktrace_hostname, sizeof(stacktrace_hostname));<br> &nbsp;&nbsp;&nbsp;&nbsp; stacktrace_hostname[sizeof(stacktrace_hostname) - 1] = '\0';<br> @@ -459,10 +461,26 @@<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return OPAL_ERR_BAD_PARAM;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> <br> -&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret = sigaction (sig, &amp;act, NULL);<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret = sigaction (sig, &amp;act, &amp;old);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ret != 0) {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return OPAL_ERR_IN_ERRNO;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (SIG_IGN != old.sa_handler &amp;&amp; SIG_DFL != old.sa_handler) {<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!showed_help) {<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* JMS This is icky; there is no error message<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregation here so this message may be repeated for<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; every single MPI process...&nbsp; This should be replaced<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; with OPAL_SOS when that is done so that it can be<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; properly aggregated. */<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; opal_show_help("help-opal-util.txt",<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "stacktrace signal override",<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; true, sig, sig, sig, string_value);<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; showed_help = true;<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (0 != sigaction(sig, &amp;old, NULL)) {<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return OPAL_ERR_IN_ERRNO;<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp; free(string_value);<br> &nbsp;#endif /* OMPI_WANT_PRETTY_PRINT_STACKTRACE &amp;&amp; ! defined(__WINDOWS__) */<br> _______________________________________________<br> svn-full mailing list<br> <a href="mailto:svn-full@open-mpi.org">svn-full@open-mpi.org</a><br> <a href="http://www.open-mpi.org/mailman/listinfo.cgi/svn-full">http://www.open-mpi.org/mailman/listinfo.cgi/svn-full</a><br> </font> </p> </div> </blockquote></div><br><div> <span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0; "><br class="Apple-interchange-newline">--&nbsp;<br>Jeff Squyres<br>Cisco Systems<br></span> </div><br></div></body></html>
