<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="Generator" CONTENT="MS Exchange Server version 6.0.6603.0">
<TITLE>RE: [O-MPI devel] Fwd: Regarding MVAPI Component in Open MPI</TITLE>
</HEAD>
<BODY>
<!-- Converted from text/rtf format -->
<BR>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">Hi,</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">I have got the latest code drop and this time I didn't give -r</FONT></SPAN><SPAN LANG="en-us"> <FONT SIZE=2 FACE="Courier New">option</FONT></SPAN><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New"> to svn co.</FONT></SPAN><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New"> The last line that it showed me is given below.</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><B><FONT SIZE=2 FACE="Courier New">Checked out revision 6760.</FONT></B></SPAN><SPAN LANG="en-us"><B></B></SPAN></P>
<BR>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">I am trying to install/configure/build OpenMPI on RHEL3 update 4 machine.</FONT></SPAN><SPAN LANG="en-us"> <FONT SIZE=2 FACE="Courier New">For this release, we don't have</FONT></SPAN><SPAN LANG="en-us"> <FONT SIZE=2 FACE="Courier New">l</FONT></SPAN><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">mpga and</FONT></SPAN><SPAN LANG="en-us"> <FONT SIZE=2 FACE="Courier New">l</FONT></SPAN><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">mtl_common libraries. We are not using separate VAPI libraries. We only use lvapi and lmosal.</FONT></SPAN><SPAN LANG="en-us"> <FONT SIZE=2 FACE="Courier New">We do have lmpga and lmtl_common libs but with the older release.</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">In the file README of latest check out, I could see the following lin</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">- Support for Quadrics and Infiniband (both mVAPI and OpenIB) is</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&nbsp; missing (see the current code base).</FONT></SPAN><SPAN LANG="en-us"></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">What does it mean? Does OpenMPI has support for Infiniband (mVAPI)? I am not getting why btl mVAPI</FONT></SPAN><SPAN LANG="en-us"> <FONT SIZE=2 FACE="Courier New">compone</FONT></SPAN><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">nt is not being built</FONT></SPAN><SPAN LANG="en-us"> <FONT SIZE=2 FACE="Courier New">(in my previous mail with ompi_info output). Could you please let me know whether OpenMPI has got support for Infiniband (mVAPI)? If yes, what</FONT></SPAN><SPAN LANG="en-us"> <FONT SIZE=2 FACE="Courier New">sort of</FONT></SPAN><SPAN LANG="en-us"> <FONT SIZE=2 FACE="Courier New">configuration options that I need to give?</FONT></SPAN><SPAN LANG="en-us"> <FONT SIZE=2 FACE="Courier New">Or Do I have to modify anything in the respective directories? Please let me know.</FONT></SPAN><SPAN LANG="en-us"></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">Thanks</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">-Sridhar</FONT></SPAN><SPAN LANG="en-us"></SPAN></P>
<BR>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">-----Original Message-----<BR>
From: devel-bounces@open-mpi.org [<A HREF="mailto:devel-bounces@open-mpi.org">mailto:devel-bounces@open-mpi.org</A>] On Behalf Of Jeff Squyres<BR>
Sent: Friday, August 05, 2005 6:15 PM<BR>
To: Open MPI Developers<BR>
Subject: Re: [O-MPI devel] Fwd: Regarding MVAPI Component in Open MPI</FONT></SPAN><SPAN LANG="en-us"></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">On Aug 5, 2005, at 8:02 AM, Sridhar Chirravuri ((schirrav)) wrote:</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; Here is the output of ompi_info</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; &nbsp;</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; [root@micrompi-1 ompi]# ompi_info</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Open MPI: 1.0a1r6612M</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; &nbsp;&nbsp; Open MPI SVN revision: r6612M</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; [snipped]&nbsp;</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; The OpenMPI version that I am using r6612 (I could see from the output </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; ompi_info command). There is NO btl frame where as mpool was built.</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; &nbsp;</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; In the configure options,&nbsp;giving &nbsp;--with-btl-mvapi=/opt/topspin would </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; sufficient as it has got include and lib64 directories. Therefore it </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; will pick up the necessary things. Also, I have set the following </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; flags</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">Good.</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; export CFLAGS=&quot;-I/optl/topspin/include -I/opt/topspin/include/vapi&quot;</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; export LDFLAGS=&quot;-lmosal -lvapi -L/opt/topspin/lib64&quot;</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; export btl_mvapi_LDFLAGS=$LDFLAGS</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; export btl_mvapi_LIBS=$LDFLAGS</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">You shouldn't need these -- our configure script should figure all that </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">out with just the --with-btl-mvapi switch.&nbsp; Let us know if it doesn't </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">(an explicit goal of our configure script is to handle all this kind of </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">complexity and do all the Right Things with a single --with switch).</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; I will configure and build the latest code. To get the latest code,&nbsp;I </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; have run the following command. Please let me know if I am not </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; correct.</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; &nbsp;</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; svn co -r6613 <A HREF="http://svn.open-mpi.org/svn/ompi/trunk">http://svn.open-mpi.org/svn/ompi/trunk</A> ompi</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">No -- do not specify the -r switch.&nbsp; That asks for a specific </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">repository r number, and 6613 only 1 commit beyond your last version.&nbsp; </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">The current r number at the HEAD is 6746, for example -- 6613 was </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">committed around 9am on July 27th.&nbsp; Specifically, the r number </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">represents a unique state of the *entire* repository.&nbsp; So every commit </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">increments the r number (more Subversion documentation is available </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">here: <A HREF="http://svnbook.red-bean.com/">http://svnbook.red-bean.com/</A>).</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">I believe that in 6612 and 6613, we still had many of the 3rd </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">generation BTL stuff .ompi_ignore'd out, so they would not have built </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">(many were removed at 6616, but even more were removed as late as </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">6658).</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">Note that the &quot;M&quot; in your version number means that you have locally </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">modified the tree -- so you started with r6612, but then made local </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">modifications (the configure script queries Subversion to see what </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">version your tree it; Subversion detects these kinds of things).</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">If you &quot;svn co <A HREF="http://svn.open-mpi.org/svn/ompi/trunk">http://svn.open-mpi.org/svn/ompi/trunk</A> ompi&quot; (i.e., do </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">not specify -r), it'll just get the latest number.</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">Alternatively, if you have a checkout already, you can just run &quot;svn </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">up&quot; within that tree and it will update to the latest (quite analogous </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">to &quot;cvs up&quot;).</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; Configured as..</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; &nbsp;</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; ./configure --prefix=/openmpi --with-btl-mvapi=/opt/topspin/</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">When you get a subversion checkout, you need to first run autogen.sh.&nbsp; </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">See the HACKING document for details on this (you don't need to run </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">autogen.sh in tarballs) and the README document for common building / </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">running.&nbsp; Both of these are in the top-level directory of the SVN </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">checkout (update to the latest to get the most up-to-date README </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">information).</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; When I gave make all, it is configuring again and again, I mean it is </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; going in a loop. In my machine, I do not need libmpga and </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; libmtl_common, hence I removed -lmpga and -lmtl_common entries from </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; config/ompi_check_mvapi.m4 file and then ran autogen.sh.</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">If you modify a .m4 file, you need to run autogen.sh again.</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">autogen.sh is simply a wrapper around all the right GNU Auto tool </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">commands (autoconf, autoheader, libtool, automake, etc.) to setup all </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">the build scripts properly.&nbsp; However, automake also inserts </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">dependencies in makefiles such that if any of the dependent m4 files </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">change (for example), it should re-run the necessary commands.&nbsp; In </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">theory, that is supposed to work, but we've never really exercised that </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">-- we just re-run autogen.sh.</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">But could you clarify -- why do you not need libmpga or libmtl_common?&nbsp; </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">Are these libraries from a different mVAPI implementation?&nbsp; I would </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">like to have our configure script do the Right Things regardless of </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">which mVAPI implementation is being used -- if we need to add a little </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">more logic to make this correct, then so be it.</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; I don't have any clue why the configuration is going in loop even </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; while building. I could see that config.status --recheck is being </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; issued from Makefile and I feel this might the reason for configure to </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">&gt; run in loop.</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">Running autogen.sh should do the Right Things for you.</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">-- </FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">{+} Jeff Squyres</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">{+} The Open MPI Project</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">{+} <A HREF="http://www.open-mpi.org/">http://www.open-mpi.org/</A></FONT></SPAN></P>
<BR>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">_______________________________________________</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">devel mailing list</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New">devel@open-mpi.org</FONT></SPAN></P>

<P ALIGN=LEFT><SPAN LANG="en-us"><FONT SIZE=2 FACE="Courier New"><A HREF="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</A></FONT></SPAN><SPAN LANG="en-us"></SPAN></P>

</BODY>
</HTML>
