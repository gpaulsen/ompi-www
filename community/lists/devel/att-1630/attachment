I&#39;ll cleanup the code and add the granular selction part. It should be ready by monday.<br>--Nysal<br><br><div><span class="gmail_quote">On 6/6/07, <b class="gmail_sendername">Jeff Squyres</b> &lt;<a href="mailto:jsquyres@cisco.com">
jsquyres@cisco.com</a>&gt; wrote:</span><blockquote class="gmail_quote" style="border-left: 1px solid rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">Ok -- so did you want to go ahead and make these changes, or did you
<br>want me to do it?<br><br>Either way, I&#39;d be in favor of all this stuff coming to the trunk in<br>the Very Near Future.&nbsp;&nbsp;:-)<br><br><br><br>On Jun 6, 2007, at 7:02 AM, Nysal Jan wrote:<br><br>&gt; Hi Jeff,<br>&gt;<br>
&gt; 1. The logic for if_exclude was not correct.&nbsp;&nbsp;I committed a fix for<br>&gt; it.&nbsp;&nbsp;<a href="https://svn.open-mpi.org/trac/ompi/changeset/14748">https://svn.open-mpi.org/trac/ompi/changeset/14748</a><br>&gt;<br>&gt; Thanks
<br>&gt;<br>&gt; 2. I&#39;m a bit confused on a) how the new MCA params mca_num_hcas and<br>&gt; map_num_procs_per_hca are supposed to be used and b) what their<br>&gt; default values shoulant code)d be.<br>&gt;<br>&gt; Probably these params(and relevant code) should be removed now,
<br>&gt; since there is a plan for generic Socket/Core to HCA mapping<br>&gt; scheme. mca_num_hcas is the maximum number of HCAs a task can use.<br>&gt; Eg. If mpa_num_procs_per_hca is 3 and max_num_hcas is 2. On any<br>&gt; node, task 1/2/3 are mapped to hca1 &amp; hca2, task 4/5/6 are mapped
<br>&gt; to hca3 &amp; hca4 ....<br>&gt; Default values were set as 1(thats what we needed at that point in<br>&gt; time).It needs to be modified so that ompi&#39;s default behaviour<br>&gt; remains unchanged (ie. use all hcas)
<br>&gt;<br>&gt; 2a. I don&#39;t quite understand the logic of is_hca_allowed(); I could<br>&gt; not get it to work properly.&nbsp;&nbsp;Specifically, I have 2 machines each<br>&gt; with 2 HCAs (mthca0 has 1 port, mthca1 has 2 ports).&nbsp;&nbsp;If I ran 2
<br>&gt; procs (regardless of byslot or bynode), is_hca_allowed() would always<br>&gt; return false for the 2nd proc.&nbsp;&nbsp;So I put a temporary override in<br>&gt; is_hca_allowed() to simply always return true.&nbsp;&nbsp;Can you explain how
<br>&gt; the logic is supposed to work in that function?<br>&gt;<br>&gt; Explained above<br>&gt;<br>&gt; 2b. The default values of max_num_hcas and map_num_procs_per_hca are<br>&gt; both 1.&nbsp;&nbsp;Based on my (potentially flawed) understanding of how these
<br>&gt; MCA params are meant to be used, this is different than the current<br>&gt; default behavior.&nbsp;&nbsp;The current default is that all procs use all<br>&gt; ACTIVE ports on all HCAs.&nbsp;&nbsp;I *think* your new default param values
<br>&gt; will set each proc to use the ACTIVE ports on exactly one HCA,<br>&gt; regardless how many there are in the host.&nbsp;&nbsp;Did you mean to do that?<br>&gt; Also: both values must currently be &gt;=1; should we allow -1 for both
<br>&gt; of these values, meaning that they can be &quot;infinite&quot; ( i.e., based on<br>&gt; the number of HCAs in the host)?<br>&gt;<br>&gt; Yes,&nbsp;&nbsp;the defaults need to be changed. I&#39;ll also make the selection<br>
&gt; logic more granular (eg. -mca mca_btl_openib_if_include<br>&gt; mthca0:1,mthca1:1)<br>&gt;<br>&gt; --Nysal<br>&gt; _______________________________________________<br>&gt; devel mailing list<br>&gt; <a href="mailto:devel@open-mpi.org">
devel@open-mpi.org</a><br>&gt; <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br><br><br>--<br>Jeff Squyres<br>Cisco Systems<br><br>_______________________________________________
<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br></blockquote></div>
<br>

