<div dir="ltr">Ralph,<div><br></div><div>Yes, I suspect that would resolve the problem.  However, based on my conclusions presented in an email sent a few minutes ago (and expanded upon below), I think you should either *revert* or *remove* all of those *_LDFLAGS settings.</div><div><br></div><div>These variables were *empty* prior to our work that lead to RC6, since WRAPPER_EXTRA_LDFLAGS was undefined.</div><div>Looking at config/opal_setup_wrappers.m4 I find that WRAPPER_EXTRA_LDFLAGS is subject to AC_DEFINE_UNQUOTED(), but never AC_SUBST().</div><div>So the presence of this variable in any Makefile.am may be &quot;dead code&quot; - that is probably still worth some investigation.</div><div><br></div><div>Perhaps more importantly, as noted in my other recent email, if I had followed the MX installation instructions to the letter then the libdir would be in my LD_LIBRARY_PATH or system default library search path and *none* of these MX-related issues would have arisen at all (mea culpa).  So, you and I have been chasing a bug (or series of them) that could be attributed to &quot;pilot error&quot;.</div><div><br></div><div>So, if one removes or reverts (to rc5) these [testname]_LDFLAGS setting then there are no known bugs associated with them.</div><div>The only failures would be attributable to my MIS-INSTALLATION of MX.</div><div><br></div><div>-Paul</div><div><br></div></div><div class="gmail_extra"><br><div class="gmail_quote">On Mon, Aug 24, 2015 at 11:18 AM, Ralph Castain <span dir="ltr">&lt;<a href="mailto:rhc@open-mpi.org" target="_blank">rhc@open-mpi.org</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div style="word-wrap:break-word">So you think this will resolve the problem:<div><br></div><div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><b>diff --git a/ompi/debuggers/Makefile.am b/ompi/debuggers/Makefile.am</b></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><b>index 93a3046..069c3e6 100644</b></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><b>--- a/ompi/debuggers/Makefile.am</b></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><b>+++ b/ompi/debuggers/Makefile.am</b></div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(37,178,191);background-color:rgb(254,244,156)">@@ -44,14 +44,14 @@<span style="color:#000000"> headers = \</span></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> # Simple checks to ensure that the DSOs are functional</div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> dlopen_test_SOURCES = dlopen_test.c</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-dlopen_test_LDFLAGS = $(OMPI_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+dlopen_test_LDFLAGS = $(OMPI_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> dlopen_test_LDADD = \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/ompi/<a href="http://libmpi.la" target="_blank">libmpi.la</a> \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> dlopen_test_DEPENDENCIES = $(ompi_predefined_LDADD)</div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> predefined_gap_test_SOURCES = predefined_gap_test.c</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-predefined_gap_test_LDFLAGS = $(OMPI_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+predefined_gap_test_LDFLAGS = $(OMPI_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> predefined_gap_test_LDADD = $(top_builddir)/ompi/<a href="http://libmpi.la" target="_blank">libmpi.la</a></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> predefined_gap_test_DEPENDENCIES = $(ompi_predefined_LDADD)</div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><b>diff --git a/test/datatype/Makefile.am b/test/datatype/Makefile.am</b></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><b>index 7683c34..7c14ec7 100644</b></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><b>--- a/test/datatype/Makefile.am</b></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><b>+++ b/test/datatype/Makefile.am</b></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><span style="color:#25b2bf">@@ -21,46 +21,46 @@</span> TESTS = opal_datatype_test $(MPI_TESTS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> check_PROGRAMS = $(TESTS) $(MPI_CHECKS)</div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> ddt_test_SOURCES = ddt_test.c ddt_lib.c ddt_lib.h</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-ddt_test_LDFLAGS = $(OMPI_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+ddt_test_LDFLAGS = $(OMPI_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> ddt_test_LDADD = \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/ompi/<a href="http://libmpi.la" target="_blank">libmpi.la</a> \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a></div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> ddt_raw_SOURCES = ddt_raw.c ddt_lib.c ddt_lib.h</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-ddt_raw_LDFLAGS = $(OMPI_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+ddt_raw_LDFLAGS = $(OMPI_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> ddt_raw_LDADD = \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/ompi/<a href="http://libmpi.la" target="_blank">libmpi.la</a> \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a></div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> ddt_pack_SOURCES = ddt_pack.c</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-ddt_pack_LDFLAGS = $(OMPI_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+ddt_pack_LDFLAGS = $(OMPI_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> ddt_pack_LDADD = \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/ompi/<a href="http://libmpi.la" target="_blank">libmpi.la</a> \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a></div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> checksum_SOURCES = checksum.c</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-checksum_LDFLAGS = $(OMPI_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+checksum_LDFLAGS = $(OMPI_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> checksum_LDADD = \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/ompi/<a href="http://libmpi.la" target="_blank">libmpi.la</a> \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a></div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> position_SOURCES = position.c</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-position_LDFLAGS = $(OMPI_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+position_LDFLAGS = $(OMPI_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> position_LDADD = \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/ompi/<a href="http://libmpi.la" target="_blank">libmpi.la</a> \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a></div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> position_noncontig_SOURCES = position_noncontig.c</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-position_noncontig_LDFLAGS = $(OMPI_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+position_noncontig_LDFLAGS = $(OMPI_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> position_noncontig_LDADD = \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/ompi/<a href="http://libmpi.la" target="_blank">libmpi.la</a> \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a></div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> to_self_SOURCES = to_self.c</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-to_self_LDFLAGS = $(OMPI_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+to_self_LDFLAGS = $(OMPI_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> to_self_LDADD = $(top_builddir)/ompi/<a href="http://libmpi.la" target="_blank">libmpi.la</a></div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> opal_datatype_test_SOURCES = opal_datatype_test.c opal_ddt_lib.c opal_ddt_lib.h</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-opal_datatype_test_LDFLAGS = $(OMPI_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+opal_datatype_test_LDFLAGS = $(OMPI_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> opal_datatype_test_LDADD = $(top_builddir)/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a></div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><b>diff --git a/test/event/Makefile.am b/test/event/Makefile.am</b></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><b>index 168d6bf..a133f2f 100644</b></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><b>--- a/test/event/Makefile.am</b></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><b>+++ b/test/event/Makefile.am</b></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"><span style="color:#25b2bf">@@ -27,19 +27,19 @@</span> check_PROGRAMS = \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> TESTS = $(check_PROGRAMS)</div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> signal_test_SOURCES = signal-test.c</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-signal_test_LDFLAGS = $(OPAL_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+signal_test_LDFLAGS = $(OPAL_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> signal_test_LDADD = \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> signal_test_DEPENDENCIES = $(signal_test_LDADD)</div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> time_test_SOURCES = time-test.c</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-time_test_LDFLAGS = $(OPAL_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+time_test_LDFLAGS = $(OPAL_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> time_test_LDADD = \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> time_test_DEPENDENCIES = $(time_test_LDADD)</div><p style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156);min-height:13px"> <br></p><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> event_test_SOURCES = event-test.c</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(188,50,28);background-color:rgb(254,244,156)">-event_test_LDFLAGS = $(OPAL_WRAPPER_EXTRA_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;color:rgb(39,180,28);background-color:rgb(254,244,156)">+event_test_LDFLAGS = $(OPAL_PKG_CONFIG_LDFLAGS)</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> event_test_LDADD = \</div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)">         $(top_builddir)/opal/<a href="http://libopen-pal.la" target="_blank">libopen-pal.la</a></div><div style="margin:0px;font-size:11px;font-family:Menlo;background-color:rgb(254,244,156)"> event_test_DEPENDENCIES = $(event_test_LDADD)</div><div><br></div><div><br></div><div><blockquote type="cite"><div><div class="h5"><div>On Aug 24, 2015, at 11:04 AM, Paul Hargrove &lt;<a href="mailto:phhargrove@lbl.gov" target="_blank">phhargrove@lbl.gov</a>&gt; wrote:</div><br></div></div><div><div><div class="h5"><div dir="ltr"><div><br></div><div>This is from testing the Studio compilers on a Solaris-11.1/amd64 platform, in a configuration that passed my testing of rc5.</div><div>I have configured with</div><blockquote style="margin:0 0 0 40px;border:none;padding:0px"><div><font size="1" face="monospace, monospace">--prefix=[...] --enable-debug CC=cc CXX=CC FC=f90 --with-verbs \</font></div><div><font size="1" face="monospace, monospace">CXXFLAGS=&#39;-library=stlport4&#39; --with-wrapper-cxxflags=&#39;-library=stlport4&#39;</font></div></blockquote><div><br></div><div>Note that there is nothing but TCP and Verbs on this platform.</div><div>This is not yet another problem with mx or ofi.</div><div><br></div><div>My &quot;make check&quot; step fails as shown below, apparently choking on the $(OMPI_WRAPPER_EXTRA_LDFLAGS) that Ralph had to add to resolve the problems I saw in rc5:<br></div><div><br></div><div><div><font face="monospace, monospace">gmake[3]: Entering directory `/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/BLD/ompi/debuggers&#39;</font></div><div><font face="monospace, monospace">source=&#39;/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6/ompi/debuggers/predefined_gap_test.c&#39; object=&#39;predefined_gap_test.o&#39; libtool=no \</font></div><div><font face="monospace, monospace">        DEPDIR=.deps depmode=none /bin/sh /shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6/config/depcomp \</font></div><div><font face="monospace, monospace">        cc -DHAVE_CONFIG_H -I. -I/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6/ompi/debuggers -I../../opal/include -I../../orte/include -I../../ompi/include -I../../oshmem/include -I../../opal/mca/hwloc/hwloc191/hwloc/include/private/autogen -I../../opal/mca/hwloc/hwloc191/hwloc/include/hwloc/autogen   -I/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6 -I../.. -I/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6/opal/include -I/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6/orte/include -I/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6/ompi/include -I/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6/oshmem/include  -D_REENTRANT  -I/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6/opal/mca/hwloc/hwloc191/hwloc/include -I/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/BLD/opal/mca/hwloc/hwloc191/hwloc/include -I/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6/opal/mca/event/libevent2021/libevent -I/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6/opal/mca/event/libevent2021/libevent/include -I/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/BLD/opal/mca/event/libevent2021/libevent/include  -D_REENTRANT -g -c -o predefined_gap_test.o /shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6/ompi/debuggers/predefined_gap_test.c</font></div><div><font face="monospace, monospace">&quot;/shared/OMPI/openmpi-1.10.0rc6-solaris11-x86-ib-ss12u3/openmpi-1.10.0rc6/opal/include/opal/sys/ia32/atomic.h&quot;, line 173: warning: parameter in inline asm statement unused: %3</font></div><div><font face="monospace, monospace">/bin/sh ../../libtool  --tag=CC   --mode=link cc  -D_REENTRANT -g <span style="background-color:rgb(255,255,0)">-R@{libdir}</span>   -o predefined_gap_test predefined_gap_test.o ../../ompi/<a href="http://libmpi.la/" target="_blank">libmpi.la</a> -lm -lsocket -lnsl  </font></div><div><font face="monospace, monospace">libtool: link: only absolute run-paths are allowed</font></div><div><br></div><div>I am going to venture a guess that libtool is complaining about &quot;-R@{libdir}&quot;.</div><div>Looking at config/opal_setup_wrappers.m4 I find:</div></div><blockquote style="margin:0 0 0 40px;border:none;padding:0px"><div><div><div><font face="monospace, monospace" size="1"># Called to find all -L arguments in the LDFLAGS and add in RPATH args</font></div></div></div><div><div><div><font face="monospace, monospace" size="1"># for each of them.  Then also add in an RPATH for @{libdir} (which</font></div></div></div><div><div><div><font face="monospace, monospace" size="1"># will be replaced by the wrapper compile to the installdir libdir at</font></div></div></div><div><div><div><font face="monospace, monospace" size="1"># runtime), and the RUNPATH args, if we have them.</font></div></div></div></blockquote><div><div><br></div><div>So, since it sounds like the wrapper compiler (not autoconf, automake or libtool) is expected to perform the expansion, it sounds to me like the $(*_WRAPPER_EXTRA_LDFLAGS) are *not* suitable for linking the tests.</div><div>This means that Ralph and I wasted our Sunday iterating to the wrong fix for the mx+static problem I encountered in rc5.</div><div><br></div><div>The good news (I hope) is the following comment in the same .m4 file:</div><div><div><font face="monospace, monospace" size="1">    # Note that we have to setup &lt;package&gt;_PKG_CONFIG_LDFLAGS for the</font></div><div><font face="monospace, monospace" size="1">    # pkg-config files to parallel the</font></div><div><font face="monospace, monospace" size="1">    # &lt;package&gt;_WRAPPER_EXTRA_LDFLAGS.  This is because pkg-config</font></div><div><font face="monospace, monospace" size="1">    # will not understand the @{libdir} notation in</font></div><div><font face="monospace, monospace" size="1">    # *_WRAPPER_EXTRA_LDFLAGS; we have to translate it to ${libdir}.</font></div></div><div><br></div><div>So, Ralph, I suspect that use of {OMPI,OPAL}_PKG_CONFIG_LDFLAGS is the proper replacement for WRAPPER_LD_FLAGS.</div><div>I tried manually making this change in the three affected generated Makefiles and was able to pass my testing on this platform.</div><div><br></div><div>-Paul</div><div><br></div>-- <br><div><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: <a href="tel:%2B1-510-495-2352" value="+15104952352" target="_blank">+1-510-495-2352</a></div><div>Lawrence Berkeley National Laboratory     Fax: <a href="tel:%2B1-510-486-6900" value="+15104866900" target="_blank">+1-510-486-6900</a></div></font></div></div></div>
</div></div></div></div>
_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org" target="_blank">devel@open-mpi.org</a><br>Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br>Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2015/08/17824.php" target="_blank">http://www.open-mpi.org/community/lists/devel/2015/08/17824.php</a></div></blockquote></div><br></div></div><br>_______________________________________________<br>
devel mailing list<br>
<a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" rel="noreferrer" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br>
Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2015/08/17826.php" rel="noreferrer" target="_blank">http://www.open-mpi.org/community/lists/devel/2015/08/17826.php</a><br></blockquote></div><br><br clear="all"><div><br></div>-- <br><div class="gmail_signature"><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</div>

