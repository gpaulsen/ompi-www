<html><head><meta http-equiv="Content-Type" content="text/html charset=utf-8"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class="">Hey Mark<div class=""><br class=""></div><div class="">Can you do me a favor? I’m totally buried, but I have been able to replicate this on my machine, so it is a definite race condition.</div><div class=""><br class=""></div><div class="">What would really help me is if you could do the following:</div><div class=""><br class=""></div><div class="">* start the orte-dvm with the “—mca state_base_verbose 10” option, and capture stdout/stderr in a file</div><div class=""><br class=""></div><div class="">* run your test program - I don’t think you need all 40 submits, so you might try a smaller number just to make life easier</div><div class=""><br class=""></div><div class="">* reorganize the output, organizing the resulting state machine debug output according to the job. You’ll see output like this:</div><div class=""><br class=""></div><div class=""><div style="margin: 0px; font-size: 11px; line-height: normal; font-family: Menlo; background-color: rgb(254, 244, 156);" class="">[bend001:22303] [[55873,0],0] state:base:check_job_completed job [55873,2] is terminated (1 vs 1 [NORMALLY TERMINATED])</div><div class=""><br class=""></div><div class=""><div style="margin: 0px; font-size: 11px; line-height: normal; font-family: Menlo; background-color: rgb(254, 244, 156);" class="">[bend001:22303] [[55873,0],0] ACTIVATE JOB [55873,32] STATE NOTIFY COMPLETED AT state_dvm.c:415</div></div><div class=""><br class=""></div><div class="">etc. If you could collect all the state output for each job, it would really help me to identify the last state each job reached. I could then see what state the jobs that aren’t being properly marked as terminated finished in.</div><div class=""><br class=""></div><div class="">I hate to ask it of you - I just don’t have time to do all that sorting right now. If you’d prefer to decline, feel free to do so and I’ll attack this when I next have a chance.</div><div class=""><br class=""></div><div class="">Ralph</div><div class=""><br class=""></div><div class=""><br class=""></div><div><blockquote type="cite" class=""><div class="">On Oct 15, 2015, at 3:50 PM, Mark Santcroos &lt;<a href="mailto:mark.santcroos@rutgers.edu" class="">mark.santcroos@rutgers.edu</a>&gt; wrote:</div><br class="Apple-interchange-newline"><div class=""><div class=""><br class=""><blockquote type="cite" class="">On 16 Oct 2015, at 0:44 , Ralph Castain &lt;<a href="mailto:rhc@open-mpi.org" class="">rhc@open-mpi.org</a>&gt; wrote:<br class=""><br class="">Hmmm....ok. I'll have to look at it this weekend when I return from travel. Can you please send me your test program so I can try to locally reproduce it?<br class=""></blockquote><br class="">Ok, thanks Ralph.<br class=""><br class=""><br class="">Start the DVM with: orte-dvm --report-uri dvm_uri --debug-devel<br class=""><br class="">And then run the following script. The "serial /bin/date" and the "parallel sleep 1" are fine. The "parallel /bin/date" shows the hanging.<br class=""><br class=""><br class="">#!/bin/sh<br class=""><br class="">for i in $(seq 42):<br class="">do<br class=""> &nbsp;&nbsp;&nbsp;# GOOD<br class=""> &nbsp;&nbsp;&nbsp;#orte-submit --hnp file:dvm_uri -np 1 /bin/date<br class=""> &nbsp;&nbsp;&nbsp;#orte-submit --hnp file:dvm_uri -np 1 /bin/sleep 1 &amp;<br class=""><br class=""> &nbsp;&nbsp;&nbsp;# BAD<br class=""> &nbsp;&nbsp;&nbsp;orte-submit --hnp file:dvm_uri -np 1 /bin/date &amp;<br class="">done<br class="">wait<br class="">_______________________________________________<br class="">devel mailing list<br class=""><a href="mailto:devel@open-mpi.org" class="">devel@open-mpi.org</a><br class="">Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/devel<br class="">Link to this post: http://www.open-mpi.org/community/lists/devel/2015/10/18188.php<br class=""></div></div></blockquote></div><br class=""></div></body></html>
