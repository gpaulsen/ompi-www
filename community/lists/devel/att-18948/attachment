<div dir="ltr">(Just to followup for the list)<div>I merged in the master PR, and created a PR for v2.0.0:<div>  <a href="https://github.com/open-mpi/ompi-release/pull/1149">https://github.com/open-mpi/ompi-release/pull/1149</a></div><div><br></div></div><div>Thanks Paul and Brice!</div><div><br></div></div><div class="gmail_extra"><br><div class="gmail_quote">On Sun, May 8, 2016 at 3:21 PM, Brice Goglin <span dir="ltr">&lt;<a href="mailto:Brice.Goglin@inria.fr" target="_blank">Brice.Goglin@inria.fr</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
  
    
  
  <div text="#000000" bgcolor="#FFFFFF">
    Thanks, applied to hwloc. And PR for OMPI master at
    <a href="https://github.com/open-mpi/ompi/pull/1657" target="_blank">https://github.com/open-mpi/ompi/pull/1657</a><span class="HOEnZb"><font color="#888888"><br>
    Brice</font></span><span class=""><br>
    <br>
    <br>
    <br>
    <div>Le 06/05/2016 00:29, Paul Hargrove a
      écrit :<br>
    </div>
    </span><div><div class="h5"><blockquote type="cite">
      <div dir="ltr">
        <div>I have some good news:  I have a fix!!</div>
        <div><br>
        </div>
        FWIW: I too can build w/ xlc 12.1 (also BG/Q).
        <div>It is just the 13.1.0 on Power7 that crashes building
          hwloc.</div>
        <div>Meanwhile, 13.1.2 on Power8 little-endian does not crash
          (but is a different front-end than big-endian if I understand
          correctly).</div>
        <div><br>
        </div>
        <div>I started &quot;bisecting&quot; the file topology-xml-nolibxml.c and
          found that xlc is crashing on &quot;__hwloc_attribute_may_alias&quot;.</div>
        <div>Simply disabling use of that attribute resolves the
          problem.</div>
        <div><br>
        </div>
        <div><span>So, here is the fix, which simply changes
            the check for this attribute to match the way in which hwloc
            uses it.</span></div>
        <div><span>It disqualifies the buggy compiler
            version(s) based on behavior, rather than us trying to list
            affected versions.</span></div>
        <div><span><br>
          </span></div>
        <div><span>
            <div><font face="monospace, monospace">---
                config/hwloc_check_attributes.m4~   2016-05-05
                17:18:10.380479303 -0500</font></div>
            <div><font face="monospace, monospace">+++
                config/hwloc_check_attributes.m4    2016-05-05
                17:21:30.399799031 -0500</font></div>
            <div><font face="monospace, monospace">@@ -322,9 +322,10 @@</font></div>
            <div><font face="monospace, monospace">     # Attribute
                may_alias: No suitable cross-check available, that works
                for non-supporting compilers</font></div>
            <div><font face="monospace, monospace">     # Ignored by
                intel-9.1.045 -- turn off with -wd1292</font></div>
            <div><font face="monospace, monospace">     # Ignored by
                PGI-6.2.5; ignore not detected due to missing
                cross-check</font></div>
            <div><font face="monospace, monospace">+    # The test case
                is chosen to match hwloc&#39;s usage, and reproduces an
                xlc-13.1.0 bug.</font></div>
            <div><font face="monospace, monospace">     #</font></div>
            <div><font face="monospace, monospace">   
                 _HWLOC_CHECK_SPECIFIC_ATTRIBUTE([may_alias],</font></div>
            <div><font face="monospace, monospace">-        [int *
                p_value __attribute__ ((__may_alias__));],</font></div>
            <div><font face="monospace, monospace">+        [struct {
                int i; } __attribute__ ((__may_alias__)) * p_value;],</font></div>
            <div><font face="monospace, monospace">         [],</font></div>
            <div><font face="monospace, monospace">         [])</font></div>
            <div><br>
            </div>
          </span></div>
        <div><span><br>
          </span></div>
        <div>-Paul [proving that I am good for more than just *breaking*
          other people&#39;s software - I can fix things too]</div>
        <div class="gmail_extra"><br>
          <div class="gmail_quote">On Thu, May 5, 2016 at 2:28 PM, Jeff
            Squyres (jsquyres) <span dir="ltr">&lt;<a href="mailto:jsquyres@cisco.com" target="_blank"></a><a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a>&gt;</span> wrote:<br>
            <blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span>On May 5, 2016, at 5:27 PM, Josh Hursey &lt;<a href="mailto:jjhursey@open-mpi.org" target="_blank"></a><a href="mailto:jjhursey@open-mpi.org" target="_blank">jjhursey@open-mpi.org</a>&gt;
                wrote:<br>
                &gt;<br>
                &gt; Since this also happens with hwloc 1.11.3
                standalone maybe hwloc folks can take point on further
                investigation?<br>
                <br>
              </span>I think Brice would love your assistance in
              figuring this out, since I&#39;m guessing he doesn&#39;t have
              access to these platforms, either.  :-)<br>
              <br>
              --<br>
              Jeff Squyres<br>
              <a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a><br>
              For corporate legal information go to: <a href="http://www.cisco.com/web/about/doing_business/legal/cri/" rel="noreferrer" target="_blank"></a><a href="http://www.cisco.com/web/about/doing_business/legal/cri/" target="_blank">http://www.cisco.com/web/about/doing_business/legal/cri/</a><br>
              <span><br>
                _______________________________________________<br>
                devel mailing list<br>
                <a href="mailto:devel@open-mpi.org" target="_blank">devel@open-mpi.org</a><br>
                Subscription: <a href="https://www.open-mpi.org/mailman/listinfo.cgi/devel" rel="noreferrer" target="_blank">https://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br>
              </span>Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2016/05/18917.php" rel="noreferrer" target="_blank">http://www.open-mpi.org/community/lists/devel/2016/05/18917.php</a><br>
            </blockquote>
          </div>
          <br>
          <br clear="all">
          <div><br>
          </div>
          -- <br>
          <div>
            <div dir="ltr">
              <div><font face="courier new, monospace">
                  <div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank"></a><a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div>
                  <div>Computer Languages &amp; Systems Software (CLaSS)
                    Group</div>
                  <div>Computer Science Department               Tel:
                    <a href="tel:%2B1-510-495-2352" value="+15104952352" target="_blank">+1-510-495-2352</a></div>
                  <div>Lawrence Berkeley National Laboratory     Fax:
                    <a href="tel:%2B1-510-486-6900" value="+15104866900" target="_blank">+1-510-486-6900</a></div>
                </font></div>
            </div>
          </div>
        </div>
      </div>
    </blockquote>
    <br>
  </div></div></div>

<br>_______________________________________________<br>
devel mailing list<br>
<a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>
Subscription: <a href="https://www.open-mpi.org/mailman/listinfo.cgi/devel" rel="noreferrer" target="_blank">https://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br>
Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2016/05/18940.php" rel="noreferrer" target="_blank">http://www.open-mpi.org/community/lists/devel/2016/05/18940.php</a><br></blockquote></div><br></div>

