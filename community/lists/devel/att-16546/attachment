<html><head><meta http-equiv="Content-Type" content="text/html charset=utf-8"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class="">Hey folks<div class=""><br class=""></div><div class="">I’ve been looking into this warning:</div><div class=""><br class=""></div><div class=""><div style="margin: 0px; font-size: 11px; font-family: Menlo; background-color: rgb(254, 244, 156);" class=""><b class="">btl_openib_component.c:</b> In function '<b class="">init_one_device</b>':</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; background-color: rgb(254, 244, 156);" class=""><b class="">btl_openib_component.c:2019:54:</b> <span style="font-variant-ligatures: no-common-ligatures; color: #ce33cc" class=""><b class="">warning: </b></span>comparison between '<b class="">enum &lt;anonymous&gt;</b>' and '<b class="">mca_base_var_source_t</b>' [-Wenum-compare]</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; background-color: rgb(254, 244, 156);" class="">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (BTL_OPENIB_RQ_SOURCE_DEVICE_INI ==</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(39, 180, 28); background-color: rgb(254, 244, 156);" class=""><b class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ^</b></div></div><div class=""><b class=""><br class=""></b></div><div class=""><b class=""><br class=""></b></div><div class="">This warning is really valid - the equality can *never* be true. Essentially, someone defined two enum types, and is now trying to check if one is equal to the other. This is the code block under concern:</div><div class=""><br class=""></div><div class=""><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (BTL_OPENIB_RQ_SOURCE_DEVICE_INI ==</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mca_btl_openib_component.receive_queues_source) {</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; opal_show_help("help-mpi-btl-openib.txt",</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"locally conflicting receive_queues", true,</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;opal_install_dirs.opaldatadir,</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;opal_process_info.nodename,</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ibv_get_device_name(receive_queues_device-&gt;ib_dev),</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;receive_queues_device-&gt;ib_dev_attr.vendor_id,</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;receive_queues_device-&gt;ib_dev_attr.vendor_part_id,</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mca_btl_openib_component.receive_queues,</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ibv_get_device_name(device-&gt;ib_dev),</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;device-&gt;ib_dev_attr.vendor_id,</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;device-&gt;ib_dev_attr.vendor_part_id,</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mca_btl_openib_component.default_recv_qps);</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret = OPAL_ERR_RESOURCE_BUSY;</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; goto error;</div><div class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div></div><div class=""><br class=""></div><div class="">BTL_OPENIB_RQ_SOURCE_DEVICE_INI is defined as an enum in the openib code. The receive_queues_source field is an MCA base enum that indicates the source of the param. In this case, it is indicating that the source was a file, but says nothing about which file.</div><div class=""><br class=""></div><div class="">I don’t want to step on toes to fix this, but the code clearly is wrong. Can someone please fix it? It’s in the master as well as in the 1.8 branch</div><div class=""><br class=""></div><div class="">Thanks</div><div class="">Ralph</div><div class=""><br class=""></div></body></html>
