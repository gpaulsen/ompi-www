<html><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">The problem I have on our own package is definitely a current problem that requires the ld&nbsp;-search_paths_first option on Mac OS X. &nbsp;From man ld on Mac OS X Snow Leopard:<div><br></div><div><blockquote type="cite"><span class="Apple-style-span" style="font-family: monospace; ">&nbsp; &nbsp; -search_paths_first<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By default the -lx and -weak-lx options first search for a<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file of the form `libx.dylib' in each directory in the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;library search path, then a file of the form `libx.a' is<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searched for in the library search paths. &nbsp;This option<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;changes it so that in each path `libx.dylib' is searched for<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then `libx.a' before the next path in the library search path<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is searched.<br></span></blockquote><div><br></div><div>Without -Wl,-search_paths_first:</div><div><br></div><div><blockquote type="cite"><span class="Apple-style-span" style="font-family: monospace; ">/usr/bin/gcc -m32 -g -O -Wuninitialized -D_MACOSX -D_INTEL -D_GFORTRAN -D_USE_PTHREADS -D_USE_SCHED -I/Users/baker/Desktop/Earthworm/merged/include -I./ &nbsp;-o /Users/baker/Desktop/Earthworm/merged/bin/reftek2ew main.o hbeat.o init.o notify.o params.o scn.o send.o terminate.o samprate.o /Users/baker/Desktop/Earthworm/merged/lib/transport.o /Users/baker/Desktop/Earthworm/merged/lib/getutil.o /Users/baker/Desktop/Earthworm/merged/lib/kom.o /Users/baker/Desktop/Earthworm/merged/lib/logit.o /Users/baker/Desktop/Earthworm/merged/lib/sema_ew.o /Users/baker/Desktop/Earthworm/merged/lib/sleep_ew.o /Users/baker/Desktop/Earthworm/merged/lib/time_ew.o /Users/baker/Desktop/Earthworm/merged/lib/threads_ew.o -L./lib -lrtp -lreftek -lutil -lm -lpthread<br>Undefined symbols:<br>&nbsp;"_util_sswap", referenced from:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_reftek_dt in libreftek.a(dt.o)<br></span></blockquote></div><blockquote type="cite"><div>&lt;snip&gt;</div></blockquote><div><br></div><div>With&nbsp;-Wl,-search_paths_first:</div><div><br></div><div><blockquote type="cite"><span class="Apple-style-span" style="font-family: monospace; ">/usr/bin/gcc -m32 -g -O -Wuninitialized -D_MACOSX -D_INTEL -D_GFORTRAN -D_USE_PTHREADS -D_USE_SCHED -I/Users/baker/Desktop/Earthworm/merged/include -I./ -Wl,-search_paths_first -o /Users/baker/Desktop/Earthworm/merged/bin/reftek2ew main.o hbeat.o init.o notify.o params.o scn.o send.o terminate.o samprate.o /Users/baker/Desktop/Earthworm/merged/lib/transport.o /Users/baker/Desktop/Earthworm/merged/lib/getutil.o /Users/baker/Desktop/Earthworm/merged/lib/kom.o /Users/baker/Desktop/Earthworm/merged/lib/logit.o /Users/baker/Desktop/Earthworm/merged/lib/sema_ew.o /Users/baker/Desktop/Earthworm/merged/lib/sleep_ew.o /Users/baker/Desktop/Earthworm/merged/lib/time_ew.o /Users/baker/Desktop/Earthworm/merged/lib/threads_ew.o -L./lib -lrtp -lreftek -lutil -lm -lpthread<br></span></blockquote><div><br></div>While this may not be what Matthew is encountering, it is&nbsp;definitely something to keep in your bag or tricks.</div><div><br><div apple-content-edited="true"> <div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><div><div><div><div><div><div><div><div><div><div>Larry Baker</div><div>US Geological Survey</div><div>650-329-5608</div><div><a href="mailto:baker@usgs.gov">baker@usgs.gov</a></div></div></div></div></div></div></div></div></div></div></div> </div><br><div><div>On 15 Aug 2011, at 5:43 PM, Ralph Castain wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">FWIW: I build OMPI on Mac OS-X (Snow Leopard) every day, without adding any extra flags, without problem. The citation below relates to something from a long time ago, I believe - haven't seen that problem in quite some time.<div><br></div><div>I do not, however, use PGI. We regularly have problems with PGI on a variety of systems, and I suspect you are hitting one here - but can't confirm it as we don't have PGI licenses to use for testing.<div><br></div><div>The Xgrid support is broken, but has nothing to do with the problem you describe. Just means you can't launch via Xgrid.<br><div><br></div><div><br><div><div>On Aug 15, 2011, at 2:53 PM, Larry Baker wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><div>Matthew,</div><div><br></div><div>I have the same type of error on a completely different software package on Mac OS X. &nbsp;The error occurs because of the way that Mac OS X searches for -lutil. &nbsp;If the libutil.a ORTE needs is theirs, i.e., not the system libutil.dylib, then you have exactly the same problem I did.</div><div><br></div><div>Here are my notes for the fix using gcc. &nbsp;You will have to find out the equivalent method to pass the&nbsp;-search_paths_first&nbsp;linker option using pgcc.</div><div><br></div><div></div><blockquote type="cite"><div># Mac OS X searches for shared libraries before static libraries. &nbsp;Thus, -L&lt;ours&gt; -lutil finds the system libutil.dylib</div><div># before our libutil.a, which causes undefined references in the link step because it is using the wrong library. &nbsp;The</div><div># ld -search_paths_first option forces ld to search each directory first for a matching library, instead of all directories</div><div># first for a shared library.</div><div># Note: this is the form to pass -search_paths_first to ld when $(CC) is the linker command in makefile.ux</div><div>export LDFLAGS=-Wl,-search_paths_first</div></blockquote><div><br></div><div apple-content-edited="true"> <div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><div><div><div><div><div><div><div><div><div><div>Larry Baker</div><div>US Geological Survey</div><div>650-329-5608</div><div><a href="mailto:baker@usgs.gov">baker@usgs.gov</a></div></div></div></div></div></div></div></div></div></div></div> </div><br><div><div>On 15 Aug 2011, at 1:01 PM, Matthew Russell wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div class="gmail_quote"><br><br>I hope this problem merits being posted here.<div><br></div><div>On OS X (Snow Leopard, and Lion), I cannot seem to build Open MPI.</div><div><br></div><div>After a lot of building, I get the error:</div> <div><br></div><div> <div>/bin/sh ../../../libtool --tag=CC &nbsp; --mode=link /opt/pgi/osx86-64/10.9/bin/pgcc &nbsp;-DNDEBUG -O2 -Msignextend -V &nbsp; -export-dynamic &nbsp; -o orte-clean orte-clean.o ../../../orte/libopen-rte.la-lutil &nbsp;</div> <div>libtool: link: /opt/pgi/osx86-64/10.9/bin/pgcc -DNDEBUG -O2 -Msignextend -V -o orte-clean orte-clean.o &nbsp;../../../orte/.libs/libopen-rte.a /Users/matt/software/openmpi/openmpi-1.4.3/opal/.libs/libopen-pal.a -lutil</div> <div>Undefined symbols for architecture x86_64:</div><div>&nbsp; "_orte_odls", referenced from:</div><div>&nbsp; &nbsp; &nbsp; _orte_errmgr_base_error_abort in libopen-rte.a(errmgr_base_fns.o)</div><div>ld: symbol(s) not found for architecture x86_64</div> </div><div><br></div><div>This is with the PGI 10.9 compiler, OpenMPI 1.4.3, platform is 86x64</div><div><br></div><div>The README does not list PGI as a compiler that OpenMPI was tested with, and there are notes about it's support for XGrid being broken (I'm not sure if this is related.)</div> <div><br></div><div>I seem to get the error regardless of which configure flags I'm using, just for completeness though, here are the flags I am using:</div><div>./configure --prefix=/usr/local/openmpi_pg --enable-mpi-f77 --enable-mpi-f90 --with-memory-manager=none</div> <div><br></div><div>Has anyone else got or fixed this error?</div><div><br></div><div>I looked at other postings in this list, such as&nbsp;<a href="http://www.open-mpi.org/community/lists/devel/2007/05/1590.php" target="_blank">http://www.open-mpi.org/community/lists/devel/2007/05/1590.php</a> , but they didn't help much.</div> </div><br> _______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a></blockquote></div><br></div>_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a></blockquote></div><br></div></div></div></div>_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/devel</blockquote></div><br></div></div></body></html>
