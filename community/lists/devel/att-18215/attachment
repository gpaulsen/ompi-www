<div dir="ltr"><div class="gmail_extra"><br><div class="gmail_quote">On Tue, Oct 20, 2015 at 1:47 PM, Jeff Squyres (jsquyres) <span dir="ltr">&lt;<a href="mailto:jsquyres@cisco.com" target="_blank">jsquyres@cisco.com</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span class="">On Oct 20, 2015, at 4:35 PM, Paul Hargrove &lt;<a href="mailto:phhargrove@lbl.gov">phhargrove@lbl.gov</a>&gt; wrote:<br>
&gt;<br>
&gt; As an example, I might have two ethernet cards, one of which is a Cisco VNIC.<br>
&gt; I would want be able to control which BTL or MTL is used on those NICs independently, including the option to disable use of one or the other.<br>
&gt; I do not want to learn distinct include/exclude MCA params for every BTL and MTL to accomplish that.<br>
<br>
</span>Hmm.<br>
<br>
I think heterogeneous multirail is still pretty uncommon.  It might still be ok to force users (or better yet, their admins -- via the global mca-params.conf file) to use level 3 to precisely specify which network / OMPI API to use (e.g., BTL, MTL, ...etc.).<br>
<span class=""><br></span></blockquote><div><br></div><div>I think a reasonable fraction of IB-connected clusters also have an Ethernet network plus have IPoIB enabled (thus two IP networks).</div><div>So, I don&#39;t agree that heterogenous multirail is &quot;pretty uncommon&quot;.</div><div>Regardless, lets ignore heterogenous multirail for a moment and consider a related problem in a homogenous case.</div><div><br></div><div>I have multiple ports of the same type, lets say a dual-port Mellanox HCA, and just want to disable one of them (reserving it for Luster perhaps).</div><div>If OMPI is hiding from me the details of the API selection, how do I enable/disable specific ports?</div><div>Right now I believe that I need two distinct MCA params to instruct ibv and mxm both to exclude a given IB port.</div><div>I assume I will need two more params to tell ofi and ucx not to use the port either, right?</div><div>Now lets assume I&#39;ve got the portals4 reference implementation (over verbs) installed too.</div><div>Now that makes no less than 5 MCA params I might need to pass to tell 5 different components to keep their hands off the reserved port.</div><div><br></div><div>If I didn&#39;t know the HCA model/vendor, I might need a sixth and seventh MCA param to tell psm and psm2 not to use the port.</div><div>However, if the port name is something like &quot;mlx4_0.0&quot; or &quot;ipath0.0&quot; then we can at least know if mxm or psm* are even possible.</div><div><br></div><div>I don&#39;t suggest that OMPI should magically discover &quot;aliases&quot; for a port but if I have IPoIB the problem grows:</div><div>I need yet more MCA params to tell tcp, ofi (and maybe ucx?) not to use the corresponding ibN interface.</div><div>And don&#39;t forget about oob_tcp_if_exclude.</div><div><br></div><div>To ensure that Jeff doesn&#39;t dodge the issue, lets assume this desire to disable one port is a *transient* need/desire by an end-user.</div><div>In other words, I don&#39;t accept &quot;admin should place all 11 MCA params in the global config file&quot; as a valid solution.</div><div><br></div><div>-Paul</div><div><br></div></div>-- <br><div class="gmail_signature"><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</div></div>

