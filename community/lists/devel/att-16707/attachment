<html><head><meta http-equiv="Content-Type" content="text/html charset=windows-1252"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class="">Works for me…thanks!<div class=""><br class=""><div><blockquote type="cite" class=""><div class="">On Dec 20, 2014, at 9:37 AM, Jeff Squyres (jsquyres) &lt;<a href="mailto:jsquyres@cisco.com" class="">jsquyres@cisco.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><div class=""><div style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; direction: ltr; font-family: Tahoma; font-size: 10pt;" class="">Fixed.<br class=""><div class=""><br class=""><div style="font-family: Tahoma; font-size: 13px;" class=""><font face="'Courier New'" class="">--&nbsp;</font><div class=""><p class="p1"><font face="'Courier New'" class="">Jeff Squyres</font></p><p class="p1"><font face="'Courier New'" class=""><a href="mailto:jsquyres@cisco.com" class="">jsquyres@cisco.com</a></font></p><p class="p1"><font face="'Courier New'" class="">For corporate legal information go to:<span class="Apple-converted-space">&nbsp;</span><a href="http://www.cisco.com/web/about/doing_business/legal/cri/" class="">http://www.cisco.com/web/about/doing_business/legal/cri/</a></font></p></div></div></div><div style="font-family: 'Times New Roman'; font-size: 16px;" class=""><hr tabindex="-1" class=""><div id="divRpF583028" style="direction: ltr;" class=""><font face="Tahoma" size="2" class=""><b class="">From:</b><span class="Apple-converted-space">&nbsp;</span>devel [<a href="mailto:devel-bounces@open-mpi.org" class="">devel-bounces@open-mpi.org</a>] on behalf of George Bosilca [<a href="mailto:bosilca@icl.utk.edu" class="">bosilca@icl.utk.edu</a>]<br class=""><b class="">Sent:</b><span class="Apple-converted-space">&nbsp;</span>Saturday, December 20, 2014 12:56 AM<br class=""><b class="">To:</b><span class="Apple-converted-space">&nbsp;</span>Open MPI Developers<br class=""><b class="">Subject:</b><span class="Apple-converted-space">&nbsp;</span>Re: [OMPI devel] libfabric, config.h and hwloc<br class=""></font><br class=""></div><div class=""></div><div class=""><div dir="ltr" class=""><p class=""><span class="">The trunk is broken:</span></p><p class=""><span class="">libfabric/libfabric/include/fi.h:50:25: error: stdatomic.h: No such file or directory</span></p><p class="">George.</p><p class=""><br class=""></p></div><div class="gmail_extra"><br class=""><div class="gmail_quote">On Fri, Dec 19, 2014 at 2:03 AM, Gilles Gouaillardet<span class="Apple-converted-space">&nbsp;</span><span dir="ltr" class="">&lt;<a href="mailto:gilles.gouaillardet@iferc.org" target="_blank" class="">gilles.gouaillardet@iferc.org</a>&gt;</span><span class="Apple-converted-space">&nbsp;</span>wrote:<br class=""><blockquote class="gmail_quote" style="margin: 0px 0px 0px 0.8ex; border-left-width: 1px; border-left-color: rgb(204, 204, 204); border-left-style: solid; padding-left: 1ex;">Jeff,<br class=""><br class="">the include path is $top_srcdir/opal/mca/event/libevent2021/libevent<br class="">and the libevent config.h is in<br class="">$top_builddir/opal/mca/event/libevent2021/libevent<br class=""><br class="">so if you do not use VPATH, $top_srcdir = $top_builddir and make success,<br class="">but since i use VPATH, $top_srcdir != $top_builddir and there is no<br class="">config.h in my include path,<br class="">and hence make fails.<br class=""><br class="">Cheers,<br class=""><br class="">Gilles<br class=""><div class=""><div class="h5"><br class=""><br class=""><br class="">&nbsp;On 2014/12/19 4:12, Jeff Squyres (jsquyres) wrote:<br class="">&gt; On Dec 18, 2014, at 3:13 AM, Gilles Gouaillardet &lt;<a href="mailto:gilles.gouaillardet@iferc.org" target="_blank" class="">gilles.gouaillardet@iferc.org</a>&gt; wrote:<br class="">&gt;<br class="">&gt;&gt; currently, ompi master cannot be built if configured with<br class="">&gt;&gt; --without-hwloc *and without* --without-libfabric.<br class="">&gt;&gt;<br class="">&gt;&gt; the root cause is HAVE_CONFIG_H is defined but no config.h file is found.<br class="">&gt;&gt;<br class="">&gt;&gt; i digged a bit and found that config.h is taken from a hwloc directory<br class="">&gt;&gt; (if the --without-hwloc option is not used),<br class="">&gt;&gt; so even if this "works" that is unlikely the expected behavior.<br class="">&gt; Mmm.&nbsp; I see what you're saying -- the libfabric code expects there to be a config.h file; it'll basically take any config.h that's in the include path.<br class="">&gt;<br class="">&gt; I actually find several config.h's in the tree:<br class="">&gt;<br class="">&gt; -----<br class="">&gt; $ find . -name config.h<br class="">&gt; ./opal/libltdl/config.h<br class="">&gt; ./opal/mca/hwloc/hwloc191/hwloc/include/hwloc/autogen/config.h<br class="">&gt; ./opal/mca/hwloc/hwloc191/hwloc/include/private/autogen/config.h<br class="">&gt; ./opal/mca/event/libevent2021/libevent/config.h<br class="">&gt; ./ompi/contrib/vt/vt/extlib/otf/config.h<br class="">&gt; ./ompi/contrib/vt/vt/config.h<br class="">&gt; -----<br class="">&gt;<br class="">&gt; However, even if I exclude libltdl, vt, and hwloc (so that there's only a single config.h left in the tree -- for libevent), everything still works:<br class="">&gt;<br class="">&gt; ----<br class="">&gt; $ ./configure --prefix=$bogus --disable-dlopen --disable-vt --without-hwloc<br class="">&gt; ...etc...<br class="">&gt; $ make<br class="">&gt; [...succeeds...]<br class="">&gt; $ find . -name config.h<br class="">&gt; ./opal/mca/event/libevent2021/libevent/config.h<br class="">&gt; -----<br class="">&gt;<br class="">&gt; So I agree with you that it only works by chance (sorta -- libevent's config.h will still have all the Right Stuff in it), I can't find a case that fails.<br class="">&gt;<br class="">&gt; Can you detail what your specific case is that is failing?<br class="">&gt;<br class="">&gt; (SIDENOTE: I might not be able to find the failure because of what I mention below...)<br class="">&gt;<br class="">&gt;&gt; the attached patch fixes some missing #ifdef<br class="">&gt; Good catch.&nbsp; I fixed those a different way (just deleted the #includes -- they weren't necessary); I committed the fix both in OMPI and upstream in libfabric.<br class="">&gt;<br class="">&gt;&gt; my last (cosmetic) comment is about<br class="">&gt;&gt; $srcdir/opal/mca/common/libfabric/Makefile.in (and several other<br class="">&gt;&gt; Makefile.in) :<br class="">&gt;&gt; [snipped]<br class="">&gt; Good catch.&nbsp; Fixed in<span class="Apple-converted-space">&nbsp;</span><a href="https://github.com/open-mpi/ompi/commit/be6d46490f7b80d4f5ea90c859ccbebe96bdaaba" target="_blank" class="">https://github.com/open-mpi/ompi/commit/be6d46490f7b80d4f5ea90c859ccbebe96bdaaba</a>.&nbsp; And then later fixed *that* a followup commit.&nbsp; :-(<br class="">&gt;<br class=""><br class=""></div></div><span class="">_______________________________________________<br class="">devel mailing list<br class=""><a href="mailto:devel@open-mpi.org" target="_blank" class="">devel@open-mpi.org</a><br class="">Subscription:<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" target="_blank" class="">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br class=""></span>Link to this post:<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/community/lists/devel/2014/12/16684.php" target="_blank" class="">http://www.open-mpi.org/community/lists/devel/2014/12/16684.php</a><br class=""></blockquote></div><br class=""></div></div></div></div><span style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none; display: inline !important;" class="">_______________________________________________</span><br style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class=""><span style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none; display: inline !important;" class="">devel mailing list</span><br style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class=""><a href="mailto:devel@open-mpi.org" style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class="">devel@open-mpi.org</a><br style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class=""><span style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none; display: inline !important;" class="">Subscription:<span class="Apple-converted-space">&nbsp;</span></span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class="">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class=""><span style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none; display: inline !important;" class="">Link to this post:<span class="Apple-converted-space">&nbsp;</span></span><a href="http://www.open-mpi.org/community/lists/devel/2014/12/16706.php" style="font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" class="">http://www.open-mpi.org/community/lists/devel/2014/12/16706.php</a></div></blockquote></div><br class=""></div></body></html>
