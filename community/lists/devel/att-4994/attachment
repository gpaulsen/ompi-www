<html><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">Hmmm...only problem with that idea is that the entity being communicated to (e.g., SLURM, Moab) have no concept of MPI nor any way to communicate via that system. They do, however, have APIs that notifier can call, and know how to speak TCP via their own agreed-upon protocols. And many large systems turn off the TCP btl (all of ours, for example) because it isn't needed and opens additional unnecessary ports.<div><br></div><div>So calling APIs and/or sending messages across the OOB are pretty straight forward. Teaching Moab to understand btl/datatype engine messages (flowing across who knows what transport) is an unlikely thing to happen.</div><div><br></div><div>Besides, one of the primary reasons for needing to call notifier is a failure in the btl - so relying on the btl to send the message is self-defeating.</div><div><br></div><div><br><div><div>On Dec 4, 2008, at 10:37 AM, Richard Graham wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div> <font face="Calibri, Verdana, Helvetica, Arial"><span style="font-size:11pt">Here is where I think we should reconsider accessing the notifier component in the btl. &nbsp;It creates dependencies in the btl that are not needed. &nbsp;The idea of a notifier component is a good one, but I would defer using it to upper layers, rather than embedding it in the guts of the communication system. &nbsp;I would be in favor of an approach that sends the information up the call stack. &nbsp;The btl’s should not depend on other communication primitives, as they are the communication primitive.<br> <br> Rich<br> <br> <br> On 12/4/08 9:04 AM, "Ralph Castain" &lt;<a href="rhc@lanl.gov">rhc@lanl.gov</a>> wrote:<br> <br> </span></font><blockquote type="cite"><font face="Calibri, Verdana, Helvetica, Arial"><span style="font-size:11pt">Yes, FTB utilizes the notifier framework. In addition, we have three <br> other components getting ready to be added to that framework that will <br> provide interfaces to Moab, SLURM, and a DOE monitoring program. The <br> first two will require messaging capabilities to tell the schedulers <br> about problem nodes/routes. The latter will also use a messaging <br> protocol, but is mostly aimed at alerting operators to a problem and <br> creating a historical archive.<br> <br> &nbsp;&nbsp;That said, we can expect the use of orte_notifier to spread across <br> the BTL's pretty aggressively in the next few months, and for the <br> notifier API to change/expand as we address these needs.<br> <br> On Dec 4, 2008, at 6:13 AM, Jeff Squyres wrote:<br> <br> > I think you got it right. &nbsp;And I think we're pretty good in terms of <br> > BTL usage of ORTE and OPAL (to include the new "notifier" service <br> > that Ralph put in recently -- what the FTB will likely eventually <br> > use, I think...?); those interfaces and abstraction barriers are <br> > technologically enforced. &nbsp;If you break the abstractions, the linker <br> > will swiftly and unmercifully punish you. &nbsp;(this was exactly [one <br> > of] the rationale that we used for splitting the code base into <br> > OPAL, ORTE, and OMPI several years ago)<br> ><br> > Greg has already noted on the wiki a few constants used in the BTL's <br> > that have an OMPI_ prefix that aren't really OMPI values (e.g., <br> > OMPI_ENABLE_HETEROGENEOUS_SUPPORT). &nbsp;These come from configure <br> > (i.e., opal/include/opal_config.h) and were not renamed back when we <br> > split the code base into OPAL, ORTE, and OMPI. &nbsp;I don't think we had <br> > a strong reason for not renaming them -- most could probably be <br> > renamed to OPAL_* -- we just didn't do it then. &nbsp;Perhaps they can be <br> > changed during the BTL extraction process (I noted this on the wiki).<br> ><br> ><br> ><br> > On Dec 3, 2008, at 9:43 PM, Richard Graham wrote:<br> ><br> >> BTW,<br> >> &nbsp;I was guessing FTB is Fault Tolerant Backbone, but if not, can <br> >> someone tell me what it is ? &nbsp;If it is not the later, what I just <br> >> wrote about it makes no sense.<br> >><br> >> Rich<br> >><br> >><br> >> On 12/3/08 9:34 PM, "Richard Graham" &lt;<a href="rlgraham@ornl.gov">rlgraham@ornl.gov</a>> wrote:<br> >><br> >>> The goal is to use the btl’s outside of the context of MPI, which <br> >>> was what was in mind from the day the ompi work started over five <br> >>> years ago, but with no other use at the time, things grew up <br> >>> intermingled – no surprise at all. &nbsp;What we are attempting to do <br> >>> is to untangle the existing dependencies, and make a much cleaner <br> >>> distinction between how/what data is passed between layers.<br> >>><br> >>> I expect this will involve some sort of well defined interface <br> >>> between the btl’s and orte, and I don’t know if this will also <br> >>> require something like this between the btl’s and the pml – I <br> >>> think that interface is rigidly enforced, but am not sure.<br> >>><br> >>> I expect that explicit calls to FTB in the btl layer would have to <br> >>> be componentized, especially in the context of what is developing <br> >>> in the FT working group of the MPI Forum. &nbsp;Not that FTB is bad in <br> >>> any way, just that it is one of many monitors.<br> >>><br> >>> We will need to talk about this on a case by case basis, and <br> >>> decide how to proceed. &nbsp;If anyone wants to help, please do.<br> >>><br> >>> Rich<br> >>><br> >>><br> >>> On 12/3/08 3:02 PM, "Ralph Castain" &lt;<a href="rhc@lanl.gov">rhc@lanl.gov</a>> wrote:<br> >>><br> >>>> I managed to execute the modex-less changes pretty much without<br> >>>> introducing additional ORTE dependencies into the BTL's, though <br> >>>> there<br> >>>> may be some additions as we look a the other BTLs that I didn't<br> >>>> address. So hopefully that won't contribute too much to the issue <br> >>>> here.<br> >>>><br> >>>> At the moment, I don't think it matters where notifier sits - it <br> >>>> might<br> >>>> be able to move to OPAL. Only catch will be if some notifier <br> >>>> component<br> >>>> requires communications. I'm thinking of FTB, for example, and <br> >>>> our own<br> >>>> local monitoring program that may require TCP messaging. We don't<br> >>>> currently have anything in OPAL that would support an OPAL level<br> >>>> messaging system, though perhaps that could be resolved.<br> >>>><br> >>>> We also have dependencies where the BTL's will call orte_ess to <br> >>>> find<br> >>>> out what node another proc is on, the node local rank of that proc,<br> >>>> etc. Those dependencies are likely to grow after the Dec meeting <br> >>>> (see<br> >>>> wiki for that agenda item), and definitely cannot be moved to OPAL.<br> >>>><br> >>>> However, note that Rich stated the BTL's were -not- moving to OPAL.<br> >>>> This begs the question: where -are- they going? Into their own <br> >>>> layer?<br> >>>> Will that layer be somewhere in-between OMPI and ORTE (in which <br> >>>> case,<br> >>>> the ORTE dependencies are moot)?<br> >>>><br> >>>> I note that the wiki page doesn't address any of these questions,<br> >>>> which is understandable if things are just getting underway. But it<br> >>>> does sound like this is going to take some thought to ensure we <br> >>>> don't<br> >>>> paint ourselves into a corner.<br> >>>><br> >>>> Ralph<br> >>>><br> >>>><br> >>>> On Dec 3, 2008, at 12:10 PM, Jeff Squyres wrote:<br> >>>><br> >>>> > FWIW, I see lots of notifier calls being added to the BTLs (and<br> >>>> > elsewhere throughout the OMPI code base) over time...<br> >>>> ><br> >>>> > On Dec 3, 2008, at 2:07 PM, Tim Mattox wrote:<br> >>>> ><br> >>>> >> The BTLs might have added calls to the notifier framework in <br> >>>> their<br> >>>> >> error paths.<br> >>>> >> The notifier framework is currently in the ORTE layer... not <br> >>>> sure<br> >>>> >> if we could<br> >>>> >> move it down to OPAL. &nbsp;Ralph, any thoughts on that?<br> >>>> >><br> >>>> >> On Wed, Dec 3, 2008 at 11:56 AM, Richard Graham &lt;<a href="rlgraham@ornl.gov">rlgraham@ornl.gov</a><br> >>>> ><br> >>>> >> wrote:<br> >>>> >>> George told me about what he is doing, so no changes would be<br> >>>> >>> committed<br> >>>> >>> until George has his changes in.<br> >>>> >>><br> >>>> >>> Are there other changes to the btl's that we should be aware <br> >>>> of ?<br> >>>> >>><br> >>>> >>> Rich<br> >>>> >>><br> >>>> >>><br> >>>> >>> On 12/3/08 11:47 AM, "George Bosilca" &lt;<a href="bosilca@eecs.utk.edu">bosilca@eecs.utk.edu</a>> <br> >>>> wrote:<br> >>>> >>><br> >>>> >>>> Terry,<br> >>>> >>>><br> >>>> >>>> I'm involved [at some degree] in both efforts and I can <br> >>>> confirm<br> >>>> >>>> these<br> >>>> >>>> two efforts will not affect each other in any bad way.<br> >>>> >>>><br> >>>> >>>> &nbsp;george.<br> >>>> >>>><br> >>>> >>>> On Dec 3, 2008, at 11:42 , Terry Dontje wrote:<br> >>>> >>>><br> >>>> >>>>> I don't have any *strong* objections. However, I know that <br> >>>> Eugene<br> >>>> >>>>> and George B have been working on some Fastpath code changes<br> >>>> >>>>> that we<br> >>>> >>>>> should make sure neither project obliterates the other.<br> >>>> >>>>><br> >>>> >>>>> --td<br> >>>> >>>>><br> >>>> >>>>> Richard Graham wrote:<br> >>>> >>>>>> Now that 1.3 will be released, we would like to go ahead <br> >>>> with the<br> >>>> >>>>>> plan to move the btl’s out of the MPI layer. Greg Koenig <br> >>>> who is<br> >>>> >>>>>> doing most of the work has started a wiki page with <br> >>>> details on<br> >>>> >>>>>> the<br> >>>> >>>>>> plans. Right now details are sketchy, as Greg is digging <br> >>>> through<br> >>>> >>>>>> the code, and has only hand written notes on data <br> >>>> structures that<br> >>>> >>>>>> need to be moved, include files that are not needed, etc. <br> >>>> The<br> >>>> >>>>>> page<br> >>>> >>>>>> is at:<br> >>>> >>>>>> _<a href="https://svn.open-mpi.org/trac/ompi/wiki/BTLExtraction_">https://svn.open-mpi.org/trac/ompi/wiki/BTLExtraction_</a><br> >>>> >>>>>><br> >>>> >>>>>> The first three steps basically only involve code motion, <br> >>>> moving<br> >>>> >>>>>> items such as ompi_list, and renaming them, moving where <br> >>>> the code<br> >>>> >>>>>> is actually located in the repository, and the like. For <br> >>>> these we<br> >>>> >>>>>> do not plan to put out a formal RFC, but comments are very<br> >>>> >>>>>> welcome,<br> >>>> >>>>>> and any hands that are willing to help with this are even <br> >>>> more<br> >>>> >>>>>> welcome.<br> >>>> >>>>>><br> >>>> >>>>>> The last phase where the btl’s are made dependent on OPAL, <br> >>>> and<br> >>>> >>>>>> supporting libraries such as mpools I expect will be <br> >>>> disruptive,<br> >>>> >>>>>> and will definitely require an RFC, and will also be a <br> >>>> longer<br> >>>> >>>>>> process.<br> >>>> >>>>>><br> >>>> >>>>>> Please send comments,<br> >>>> >>>>>> Rich<br> >>>> >>>>>> <br> >>>> ------------------------------------------------------------------------<br> >>>> >>>>>><br> >>>> >>>>>> _______________________________________________<br> >>>> >>>>>> devel mailing list<br> >>>> >>>>>> <a href="devel@open-mpi.org">devel@open-mpi.org</a><br> >>>> >>>>>> <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br> >>>> >>>>>><br> >>>> >>>>><br> >>>> >>>>> _______________________________________________<br> >>>> >>>>> devel mailing list<br> >>>> >>>>> <a href="devel@open-mpi.org">devel@open-mpi.org</a><br> >>>> >>>>> <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br> >>>> >>>><br> >>>> >>>><br> >>>> >>>> _______________________________________________<br> >>>> >>>> devel mailing list<br> >>>> >>>> <a href="devel@open-mpi.org">devel@open-mpi.org</a><br> >>>> >>>> <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br> >>>> >>><br> >>>> >>><br> >>>> >>> _______________________________________________<br> >>>> >>> devel mailing list<br> >>>> >>> <a href="devel@open-mpi.org">devel@open-mpi.org</a><br> >>>> >>> <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br> >>>> >>><br> >>>> >><br> >>>> >><br> >>>> >><br> >>>> >> --<br> >>>> >> Tim Mattox, Ph.D. - <a href="http://homepage.mac.com/tmattox/">http://homepage.mac.com/tmattox/</a><br> >>>> >> <a href="tmattox@gmail.com">tmattox@gmail.com</a> || <a href="timattox@open-mpi.org">timattox@open-mpi.org</a><br> >>>> >> &nbsp;&nbsp;I'm a bright... <a href="http://www.the-brights.net/">http://www.the-brights.net/</a><br> >>>> >><br> >>>> >> _______________________________________________<br> >>>> >> devel mailing list<br> >>>> >> <a href="devel@open-mpi.org">devel@open-mpi.org</a><br> >>>> >> <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br> >>>> ><br> >>>> ><br> >>>> > --<br> >>>> > Jeff Squyres<br> >>>> > Cisco Systems<br> >>>> ><br> >>>> ><br> >>>> > _______________________________________________<br> >>>> > devel mailing list<br> >>>> > <a href="devel@open-mpi.org">devel@open-mpi.org</a><br> >>>> > <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br> >>>><br> >>>><br> >>>> _______________________________________________<br> >>>> devel mailing list<br> >>>> <a href="devel@open-mpi.org">devel@open-mpi.org</a><br> >>>> <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br> >>>><br> >>><br> >>> _______________________________________________<br> >>> devel mailing list<br> >>> <a href="devel@open-mpi.org">devel@open-mpi.org</a><br> >>> <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br> >> _______________________________________________<br> >> devel mailing list<br> >> <a href="devel@open-mpi.org">devel@open-mpi.org</a><br> >> <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br> ><br> ><br> > --<br> > Jeff Squyres<br> > Cisco Systems<br> ><br> ><br> > _______________________________________________<br> > devel mailing list<br> > <a href="devel@open-mpi.org">devel@open-mpi.org</a><br> > <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br> <br> <br> _______________________________________________<br> devel mailing list<br> <a href="devel@open-mpi.org">devel@open-mpi.org</a><br> <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br> <br> </span></font></blockquote> </div>  _______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/devel</blockquote></div><br></div></body></html>
