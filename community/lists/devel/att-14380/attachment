<html><head><meta http-equiv="Content-Type" content="text/html charset=iso-8859-1"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">Talked to Nathan and he concurs with your proposed fix, so I'll add it only to v1.7 (leaving trunk alone)<div><br></div><div>Thanks Paul!</div><div><br><div><div>On Mar 19, 2014, at 9:40 PM, Paul Hargrove &lt;<a href="mailto:phhargrove@lbl.gov">phhargrove@lbl.gov</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div dir="ltr">Sorry to be the bearer of bad news...<div><br></div><div>I configured on an SGI Altix UV with only "--enable-debug --enable-static --prefix=..."</div><div><br></div><div>The configure script found the sn/xpmem.h header and threfore enabled btl:vader:</div>
<div><br></div><div><div><font face="courier new, monospace">--- MCA component btl:vader (m4 configuration macro)</font></div><div><font face="courier new, monospace">checking for MCA component btl:vader compile mode... static</font></div>
<div><font face="courier new, monospace">checking --with-xpmem value... simple ok (unspecified)</font></div><div><font face="courier new, monospace">checking --with-xpmem-libdir value... simple ok (unspecified)</font></div>
<div><font face="courier new, monospace">checking xpmem.h usability... no</font></div><div><font face="courier new, monospace">checking xpmem.h presence... no</font></div><div><font face="courier new, monospace">checking for xpmem.h... no</font></div>
<div><font face="courier new, monospace">checking sn/xpmem.h usability... yes</font></div><div><font face="courier new, monospace">checking sn/xpmem.h presence... yes</font></div><div><font face="courier new, monospace">checking for sn/xpmem.h... yes</font></div>
<div><font face="courier new, monospace">looking for library without search path</font></div><div><font face="courier new, monospace">checking for xpmem_make in -lxpmem... yes</font></div><div><font face="courier new, monospace">checking if MCA component btl:vader can compile... yes</font></div>
</div><div><br></div><div>However, not only was btl:vader failing at runtime on the Altix when I last checked, but the version of the code in 1.7.5rc5 won't build:</div><div><br></div><div><div><font face="courier new, monospace">Making all in mca/btl/vader</font></div>
<div><font face="courier new, monospace">make[2]: Entering directory `/brashear/hargrove/OMPI/openmpi-1.7.5rc5-linux-x86_64-uv/BLD/ompi/mca/btl/vader'</font></div><div><font face="courier new, monospace">&nbsp; CC &nbsp; &nbsp; &nbsp; btl_vader_module.lo</font></div>
<div><font face="courier new, monospace">In file included from /usr/users/6/hargrove/SCRATCH/OMPI/openmpi-1.7.5rc5-linux-x86_64-uv/openmpi-1.7.5rc5/ompi/mca/btl/vader/btl_vader.h:76,</font></div><div><font face="courier new, monospace">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;from /usr/users/6/hargrove/SCRATCH/OMPI/openmpi-1.7.5rc5-linux-x86_64-uv/openmpi-1.7.5rc5/ompi/mca/btl/vader/btl_vader_module.c:26:</font></div>
<div><font face="courier new, monospace">/usr/users/6/hargrove/SCRATCH/OMPI/openmpi-1.7.5rc5-linux-x86_64-uv/openmpi-1.7.5rc5/ompi/mca/btl/vader/btl_vader_endpoint.h:28:19: error: xpmem.h: No such file or directory</font></div>
</div><div><br></div><div>I think the safest/fastest fix is the following 1-line change to prevent locating sn/xpmem.h, which is Altix-specific:</div><div><br></div><div><div><font face="courier new, monospace">--- ompi/mca/btl/vader/configure.m4 &nbsp; &nbsp; (revision 31166)</font></div>
<div><font face="courier new, monospace">+++ ompi/mca/btl/vader/configure.m4 &nbsp; &nbsp; (working copy)</font></div><div><font face="courier new, monospace">@@ -23,7 +23,7 @@</font></div><div><font face="courier new, monospace">&nbsp; &nbsp; &nbsp;AC_ARG_WITH([xpmem],</font></div>
<div><font face="courier new, monospace">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[AC_HELP_STRING([--with-xpmem(=DIR)],</font></div><div><font face="courier new, monospace">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[Build with XPMEM kernel module support, searching for headers in DIR])])</font></div>
<div><font face="courier new, monospace">- &nbsp; &nbsp;OMPI_CHECK_WITHDIR([xpmem], [$with_xpmem], [include/xpmem.h include/sn/xpmem.h])</font></div><div><font face="courier new, monospace">+ &nbsp; &nbsp;OMPI_CHECK_WITHDIR([xpmem], [$with_xpmem], [include/xpmem.h])</font></div>
<div><font face="courier new, monospace">&nbsp;</font></div><div><font face="courier new, monospace">&nbsp; &nbsp; &nbsp;AC_ARG_WITH([xpmem-libdir],</font></div><div><font face="courier new, monospace">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[AC_HELP_STRING([--with-xpmem-libdir=DIR],</font></div>
</div><div><br></div><div>This patch is intended for 1.7 only - lets leave the trunk as-is.</div><div><br></div><div>-Paul</div><div><div><br></div>-- <br><font face="courier new, monospace"><div>Paul H. Hargrove &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div>
<div>Future Technologies Group</div><div>Computer and Data Sciences Department &nbsp; &nbsp; Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory &nbsp; &nbsp; Fax: +1-510-486-6900</div></font>
</div></div>
_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/devel<br>Link to this post: http://www.open-mpi.org/community/lists/devel/2014/03/14376.php</blockquote></div><br></div></body></html>
