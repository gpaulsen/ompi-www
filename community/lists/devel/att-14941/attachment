<div dir="ltr"><div><div>Rolf,<br><br></div>i faced a bit different problem, but that is 100% reproductible :<br></div><div>- i launch mpirun (no batch manager) from a node with one IB port<br></div><div>- i use -host node01,node02 where node01 and node02 both have two IB port on the<br>
</div><div>  same subnet<br><br></div><div>by default, this will hang.<br></div><div>if this is a &quot;feature&quot; (e.g. openmpi does not support this kind of configuration) i am fine with it.<br><br></div><div>when i run mpirun --mca btl_openib_if_exclude mlx4_1, then if the application is a success, then it works just fine.<br>
<br></div><div>if the application calls MPI_Abort() /* and even if all tasks call MPI_Abort() */ then it will hang 100% of the time.<br></div><div>i do not see that as a feature but as a bug.<br><br>in an other thread, Jeff mentionned that the usnic btl is doing stuff even if there is no usnic hardware (this will be fixed shortly).<br>
Do you still see intermittent hang without listing usnic as a btl ?<br><br>Cheers,<br><br>Gilles<br><br></div><div class="gmail_extra"><br><br><div class="gmail_quote">On Fri, May 30, 2014 at 12:11 AM, Rolf vandeVaart <span dir="ltr">&lt;<a href="mailto:rvandevaart@nvidia.com" target="_blank">rvandevaart@nvidia.com</a>&gt;</span> wrote:<br>
<blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div link="blue" vlink="purple" lang="EN-US"><div><p class="MsoNormal">Ralph:<u></u><u></u></p><p class="MsoNormal">I am seeing cases where mpirun seems to hang when one of the applications exits with non-zero.  For example, the intel test MPI_Cart_get_c will exit that way if there are not enough processes to run the test.  In most cases, mpirun seems to return fine with the error code, but sometimes it just hangs.   I first started noticing this in my mtt runs.  It seems (but not conclusive) that I see this when both the usnic and openib are built, even though I am only using the openib (as I have no usnic hardware). <u></u><u></u></p>
<p class="MsoNormal"><u></u> <u></u></p><p class="MsoNormal">Anyone else seeing something like this?  Note that I see this on both 1.8 and trunk, but I show trunk here. <u></u><u></u></p></div></div></blockquote></div></div>
</div>

