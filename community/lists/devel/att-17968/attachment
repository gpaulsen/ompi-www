<html><head><meta http-equiv="Content-Type" content="text/html charset=utf-8"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class="">I think we already do, but I can check<div class=""><br class=""><div style=""><blockquote type="cite" class=""><div class="">On Sep 4, 2015, at 6:06 AM, Gilles Gouaillardet &lt;<a href="mailto:gilles.gouaillardet@gmail.com" class="">gilles.gouaillardet@gmail.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><div class="">iirc, hwloc can read input from an xml file.<div class="">if not already the case, should we provide a simple mechanism to tell hwloc not to detect the topology from the os but from a config file.</div><div class="">for example, if working on a new os and/or hardware, then manually generate the hwloc xml file on each node and do something like</div><div class="">mpirun --mca hwloc_file /etc/hwloc.xml ...</div><div class=""><br class=""></div><div class="">makes sense ?</div><div class=""><br class=""><div class=""><div class="">On Friday, September 4, 2015, Ralph Castain &lt;<a href="mailto:rhc@open-mpi.org" class="">rhc@open-mpi.org</a>&gt; wrote:<br class=""><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div style="word-wrap:break-word" class="">It sounds, then, like removing —without-hwloc will do no harm. At worst, hwloc might report inaccurate info, but that won’t stop us from running with appropriate cmd line options (e.g., to set the #slots and bind-to none).<div class=""><br class=""></div><div class="">Unless there are any further concerns, I’ll prep the PR</div><div class=""><br class=""></div><div class=""><br class=""><div class=""><blockquote type="cite" class=""><div class="">On Sep 4, 2015, at 1:08 AM, Kawashima, Takahiro &lt;<a href="javascript:_e(%7B%7D,'cvml','t-kawashima@jp.fujitsu.com');" target="_blank" class="">t-kawashima@jp.fujitsu.com</a>&gt; wrote:</div><br class=""><div class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">Brice,</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">I'm a developer of Fujitsu MPI for K computer and Fujitsu</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">PRIMEHPC FX10/FX100 (SPARC-based CPU).</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">Though I'm not familiar with the hwloc code and didn't know</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">the issue reported by Gilles, I also would be able to help</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">you to fix the issue.</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">Takahiro Kawashima,</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">MPI development team,</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">Fujitsu</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><blockquote type="cite" style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class="">Thanks Brice,<br class=""><br class="">bottom line, even if hwloc is not fully ported, it should build and ompi<span class="">&nbsp;</span><br class="">should get something usable.<br class="">in this case, i have no objection removing the --without-hwloc configure<span class="">&nbsp;</span><br class="">option.<br class=""><br class="">you can contact me off-list regarding the FX10 specific issue<br class=""><br class="">Cheers,<br class=""><br class="">Gilles<br class=""><br class="">On 9/4/2015 2:31 PM, Brice Goglin wrote:<br class=""><blockquote type="cite" class="">Le 04/09/2015 00:36, Gilles Gouaillardet a écrit :<br class=""><blockquote type="cite" class="">Ralph,<br class=""><br class="">just to be clear, your proposal is to abort if openmpi is configured<span class="">&nbsp;</span><br class="">with --without-hwloc, right ?<br class="">( the --with-hwloc option is not removed because we want to keep the<span class="">&nbsp;</span><br class="">option of using an external hwloc library )<br class=""><br class="">if I understand correctly, Paul's point is that if openmpi is ported<span class="">&nbsp;</span><br class="">to a new architecture for which hwloc has not been ported yet<span class="">&nbsp;</span><br class="">(embedded hwloc or external hwloc), then the very first step is to<span class="">&nbsp;</span><br class="">port hwloc before ompi can be built.<br class=""><br class="">did I get it right Paul ?<br class=""><br class="">Brice, what would happen in such a case ?<br class="">embedded hwloc cannot be built ?<br class="">hwloc returns little or no information ?<br class=""></blockquote><br class="">If it's a new operating system and it supports at least things like<span class="">&nbsp;</span><br class="">sysconf, you will get a Machine object with one PUs per logical processor.<br class=""><br class="">If it's a new platform running Linux, they are supposed to tell Linux<span class="">&nbsp;</span><br class="">at least package/core/thread information. That's what we have for ARM<span class="">&nbsp;</span><br class="">for instance.<br class=""><br class="">Missing topology detection can be worked around easily (with XML and<span class="">&nbsp;</span><br class="">synthetic description, what we did for BlueGene/Q before adding manual<span class="">&nbsp;</span><br class="">support for that specific processor). Binding support can't.<br class="">And once you get binding, you get x86-topology even if the operating<span class="">&nbsp;</span><br class="">system isn't supported (using cpuid).<br class=""><br class=""><blockquote type="cite" class="">for example, on Fujitsu FX10 node (single socket, 16 cores), hwloc<span class="">&nbsp;</span><br class="">reports 16 sockets with one core each and no cache. though this is<span class="">&nbsp;</span><br class="">not correct, that can be seen as equivalent to the real config by<span class="">&nbsp;</span><br class="">ompi, so this is not really an issue for ompi.<br class=""></blockquote><br class="">Can you help fixing this?<br class=""><br class="">The issue is indeed with supercomputers with uncommon architectures<span class="">&nbsp;</span><br class="">like this one.<br class=""></blockquote></blockquote><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">_______________________________________________</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">devel mailing list</span><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><a href="javascript:_e(%7B%7D,'cvml','devel@open-mpi.org');" style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" target="_blank" class="">devel@open-mpi.org</a><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">Subscription:<span class="">&nbsp;</span></span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" target="_blank" class="">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" class=""><span style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;float:none;display:inline!important" class="">Link to this post:<span class="">&nbsp;</span></span><a href="http://www.open-mpi.org/community/lists/devel/2015/09/17961.php" style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px" target="_blank" class="">http://www.open-mpi.org/community/lists/devel/2015/09/17961.php</a></div></blockquote></div><br class=""></div></div></blockquote></div></div></div>
_______________________________________________<br class="">devel mailing list<br class=""><a href="mailto:devel@open-mpi.org" class="">devel@open-mpi.org</a><br class="">Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/devel<br class="">Link to this post: http://www.open-mpi.org/community/lists/devel/2015/09/17966.php</div></blockquote></div><br class=""></div></body></html>
