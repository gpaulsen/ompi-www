<div dir="ltr">Both i386 and amd64 systems running NetBSD-7 fail with:<div><font face="monospace, monospace"><br></font></div><div><div><font face="monospace, monospace">libtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2/opal/mca/memory/patcher -I../../../../opal/include -I../../../../ompi/include -I../../../../oshmem/include -I../../../../opal/mca/hwloc/hwloc1112/hwloc/include/private/autogen -I../../../../opal/mca/hwloc/hwloc1112/hwloc/include/hwloc/autogen -I../../../../ompi/mpiext/cuda/c -I/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2 -I../../../.. -I/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2/opal/include -I/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2/orte/include -I../../../../orte/include -I/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2/ompi/include -I/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2/oshmem/include -I/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2/opal/mca/hwloc/hwloc1112/hwloc/include -I/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/BLD/opal/mca/hwloc/hwloc1112/hwloc/include -I/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2/opal/mca/event/libevent2022/libevent -I/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2/opal/mca/event/libevent2022/libevent/include -I/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/BLD/opal/mca/event/libevent2022/libevent/include -g -finline-functions -fno-strict-aliasing -pthread -MT memory_patcher_component.lo -MD -MP -MF .deps/memory_patcher_component.Tpo -c /home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2/opal/mca/memory/patcher/memory_patcher_component.c  -fPIC -DPIC -o .libs/memory_patcher_component.o</font></div><div><font face="monospace, monospace">/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2/opal/mca/memory/patcher/memory_patcher_component.c: In function &#39;intercept_mremap&#39;:</font></div><div><font face="monospace, monospace">/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2/opal/mca/memory/patcher/memory_patcher_component.c:178:19: error: &#39;MREMAP_FIXED&#39; undeclared (first use in this function)</font></div><div><font face="monospace, monospace">     if (!(flags &amp; MREMAP_FIXED)) {</font></div><div><font face="monospace, monospace">                   ^</font></div><div><font face="monospace, monospace">/home/phargrov/OMPI/openmpi-2.0.0rc2-netbsd7-amd64/openmpi-2.0.0rc2/opal/mca/memory/patcher/memory_patcher_component.c:178:19: note: each undeclared identifier is reported only once for each function it appears in</font></div><div><font face="monospace, monospace">*** Error code 1</font></div><div><br></div><div><br></div><div>NetBSD does have a mremap() function, but with different arguments than the one under Linux (and using MAP_FIXED rather than MREMAP_FIXED).</div><div>That is why the &quot;#if defined (SYS_mremap)&quot; is evaluating TRUE.</div><div>So, I think one wants &quot;#if defined (SYS_mremap) &amp;&amp; defined (__linux__)&quot; on lines 163 and 409 of memory_patcher_component.c.</div><div><br></div><div><div>It would be possible (advisable?) to construct a NetBSD-specific intercept for mremap(), but the curent Linux-specific one won&#39;t compile.</div><div>See: <a href="http://netbsd.gw.com/cgi-bin/man-cgi?mremap++NetBSD-current">http://netbsd.gw.com/cgi-bin/man-cgi?mremap++NetBSD-current</a></div></div><div><br></div><div>-Paul</div><div><br></div>-- <br><div class="gmail_signature"><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</div></div>

