<html><head><meta http-equiv="Content-Type" content="text/html charset=us-ascii"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">Clarification: MPI_Address was deprecated for MPI_Get_address (which properly has the const in it). The MPI_Info_set problem is a bug and I'll commit a fix for that one now.<div><br></div><div>What you might want to do is update your Score-P code to the current standard, since you are striving for MPI-3 compliance anyway.</div><div><br><div><div>On Mar 11, 2014, at 4:15 PM, Ralph Castain &lt;<a href="mailto:rhc@open-mpi.org">rhc@open-mpi.org</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><meta http-equiv="Content-Type" content="text/html charset=us-ascii"><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">Hmmm....well, we appear to have a problem. According to our Forum reps, those functions were deprecated by the Forum and hence the standard was actually NOT updated with "const" declarations. For some odd reason, MPICH went ahead and updated them anyway - leaving MPICH out of compliance with the standard.<div><br></div><div>So we aren't entirely sure what we should do here. We're going to discuss it tomorrow, but our initial decision was to follow the standard and just note that MPICH is out of compliance.</div><div><br></div><div><br><div><div>On Mar 11, 2014, at 3:55 PM, Orion Poplawski &lt;<a href="mailto:orion@cora.nwra.com">orion@cora.nwra.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div style="font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">On 03/11/2014 11:30 AM, Jeff Squyres (jsquyres) wrote:<br><blockquote type="cite">The safest thing for scoreP (and *any* MPI application/middleware) is to not wholly rely on the MPI_VERSION macros.<br><br><blockquote type="cite">From a theoretical sense, the MPI_VERSION macro should be sufficient.<br></blockquote><br>But in reality, the upgrade of an MPI implementation to support all of MPI-3 is a gradual thing and takes time. &nbsp;Hence, OMPI 1.7.4 supports *part* of MPI-3, but not all of it. &nbsp;There's simply no way to indicate this "partial MPI-3 support" with the simplistic MPI_VERSION macro -- that macro is pretty much an all-or-nothing value. Which simply doesn't reflect reality. Sorry. &nbsp;:-\<br><br>If it helps, you might try an OMPI 1.7.5rc (I'm due to make rc2 later this afternoon). &nbsp;1.7.5 should be full MPI-3 compliant -- if there are any const's missing, those are bugs.<br><br></blockquote><br>Thanks for the help. &nbsp;However, with 1.7.5rc2 I'm still seeing:<br><br>../../build-mpi/../src/adapters/mpi/SCOREP_Mpi_Misc.c:64:1: error: conflicting types for 'MPI_Address'<br>MPI_Address( SCOREP_MPI_CONST_DECL void* location, MPI_Aint* address )<br>^<br>In file included from ../../build-mpi/../src/adapters/mpi/SCOREP_Mpi.h:32:0,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from ../../build-mpi/../src/adapters/mpi/SCOREP_Mpi_Misc.c:45:<br>/usr/include/openmpi-x86_64/mpi.h:1176:44: note: previous declaration of 'MPI_Address' was here<br>OMPI_DECLSPEC &nbsp;int MPI_Address(void *location, MPI_Aint *address)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^<br>../../build-mpi/../src/adapters/mpi/SCOREP_Mpi_Misc.c:651:1: error: conflicting types for 'MPI_Info_set'<br>MPI_Info_set( MPI_Info info, SCOREP_MPI_CONST_DECL char* key, SCOREP_MPI_CONST_DECL char* value )<br>^<br>In file included from ../../build-mpi/../src/adapters/mpi/SCOREP_Mpi.h:32:0,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from ../../build-mpi/../src/adapters/mpi/SCOREP_Mpi_Misc.c:45:<br>/usr/include/openmpi-x86_64/mpi.h:1512:44: note: previous declaration of 'MPI_Info_set' was here<br>OMPI_DECLSPEC &nbsp;int MPI_Info_set(MPI_Info info, char *key, char *value);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^<br>The MPI-3 spec seems to side with Score-P here for MPI_Info_set. &nbsp;I couldn't find a definition for MPI_Address in the MPI-3 spec. &nbsp;Mpich appears to delare it const void *location.<br><br><br><blockquote type="cite">That being said, to fully support OMPI 1.7.4, more fine-grained configure checks for const will likely be required.<br></blockquote><br>At this point I'm hoping to just skip 1.7.4 and move to 1.7.5.<br><br><blockquote type="cite">(keep in mind that this same thing is going to happen for MPI 3.1, MPI 4.0, ...etc.)<br></blockquote><br>Yup.<br><br>- Orion<br><br><blockquote type="cite"><br><br><br><br>On Mar 11, 2014, at 1:14 PM, Orion Poplawski &lt;<a href="mailto:orion@cora.nwra.com">orion@cora.nwra.com</a>&gt; wrote:<br><br><blockquote type="cite">FYI -<br><br>&nbsp;Looks like the mix of MPI 3 compliant and older declarations is causing a bit of an issue for Score-P support. &nbsp;The current Score-P code bases adding the const qualifiers on MPI_VERSION &gt;= 3. &nbsp;But openmpi 1.7.4 is still MPI_VERSION 2 (SUB 2). &nbsp;If I change scorep to add the const qualifiers for openmpi 1.7.4, then it has trouble with some different routines that are missing the const qualifiers, for example MPI_Address and MPI_Info_set. &nbsp;It's tough to support a mix like this.<br><br>- Orion<br><br>-------- Original Message --------<br>Subject: Re: [Score-P support] Compile errors of Fedora rawhide<br>Date: Tue, 11 Mar 2014 14:16:46 +0100<br>From: Daniel Lorenz &lt;<a href="mailto:d.lorenz@grs-sim.de">d.lorenz@grs-sim.de</a>&gt;<br>To: Orion Poplawski &lt;<a href="mailto:orion@cora.nwra.com">orion@cora.nwra.com</a>&gt;<br>CC: Score-P Support &lt;<a href="mailto:support@score-p.org">support@score-p.org</a>&gt;<br><br>Hi,<br><br>I can reproduce the results with openmpi 1.7.4. It seems that openmpi 1.7.4 added const qualifiers to some MPI function parameters which cause this error. For MPI 3 many function arguments get such a const qualifier, and openmpi 1.7.4 added some MPI 3 features. However, not all function signatures in openmpi 1.7.4 are changed to the MPI 3 standard. Thus, there is a mixture of MPI 2 compliant functions and MPI 3 compliant functions. &nbsp;To support such mixtures we need to add a couple of additional checks. If you want to use the current Score-P with openmpi 1.7.4, the easiest workaround you could try is to build Score-P with the mpi.h header from openmpi 1.7.3. However there is no guarantee that it works. Another option is to adapt the Score-P MPI function wrapper signatures to the openmpi 1.7.4.<br><br>Regards,<br>Daniel<br><br>On 11 Mar 2014, at 03:35, Orion Poplawski &lt;<a href="mailto:orion@cora.nwra.com">orion@cora.nwra.com</a>&gt; wrote:<br><br><blockquote type="cite">scorep 1.2.3 is compiling fine on Fedora 20, but failing on Fedora<br>Rawhide during the openmpi build. &nbsp;Full build log is here:<br><a href="http://kojipkgs.fedoraproject.org//work/tasks/191/6620191/build.log">http://kojipkgs.fedoraproject.org//work/tasks/191/6620191/build.log</a><br><br>errors are like:<br><br>../../build-mpi/../src/adapters/mpi/SCOREP_Mpi_Cg.c:334:1: error:<br>conflicting types for 'MPI_Group_excl'<br>MPI_Group_excl( MPI_Group group, int n, SCOREP_MPI_CONST_DECL int*<br>ranks, MPI_Group* newgroup )<br>^<br>In file included from ../../build-mpi/../src/adapters/mpi/SCOREP_Mpi.h:32:0,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from<br>../../build-mpi/../src/adapters/mpi/SCOREP_Mpi_Cg.c:44:<br>/usr/include/openmpi-i386/mpi.h:1451:20: note: previous declaration of<br>'MPI_Group_excl' was here<br>OMPI_DECLSPEC &nbsp;int MPI_Group_excl(MPI_Group group, int n, const int<br>ranks[],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^<br>../../build-mpi/../src/adapters/mpi/SCOREP_Mpi_Cg.c:371:1: error:<br>conflicting types for 'MPI_Group_incl'<br>MPI_Group_incl( MPI_Group group, int n, SCOREP_MPI_CONST_DECL int*<br>ranks, MPI_Group* newgroup )<br>^<br>In file included from ../../build-mpi/../src/adapters/mpi/SCOREP_Mpi.h:32:0,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from<br>../../build-mpi/../src/adapters/mpi/SCOREP_Mpi_Cg.c:44:<br>/usr/include/openmpi-i386/mpi.h:1455:20: note: previous declaration of<br>'MPI_Group_incl' was here<br>OMPI_DECLSPEC &nbsp;int MPI_Group_incl(MPI_Group group, int n, const int<br>ranks[],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^<br><br>one difference is openmpi 1.7.4 instead of 1.7.3. &nbsp;Let me know what else<br>I can provide.<br><br>- Orion<br><br>--<br>Orion Poplawski<br>Technical Manager &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;303-415-9701 x222<br>NWRA/CoRA Division &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FAX: 303-415-9702<br>3380 Mitchell Lane &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="mailto:orion@cora.nwra.com">orion@cora.nwra.com</a><br>Boulder, CO 80301 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cora.nwra.com">http://www.cora.nwra.com</a><br>_______________________________________________<br>Support mailing list for Score-P<br><a href="mailto:support@score-p.org">support@score-p.org</a><br>https://mailman.zih.tu-dresden.de/groups/listinfo/scorep-support<br></blockquote><br><br><br>_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br>Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2014/03/14320.php">http://www.open-mpi.org/community/lists/devel/2014/03/14320.php</a><br></blockquote><br><br></blockquote><br><br>--<span class="Apple-converted-space">&nbsp;</span><br>Orion Poplawski<br>Technical Manager &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;303-415-9701 x222<br>NWRA, Boulder/CoRA Office &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FAX: 303-415-9702<br>3380 Mitchell Lane &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="mailto:orion@nwra.com">orion@nwra.com</a><br>Boulder, CO 80301 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.nwra.com/">http://www.nwra.com</a><br>_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>Subscription:<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br>Link to this post:<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/community/lists/devel/2014/03/14329.php">http://www.open-mpi.org/community/lists/devel/2014/03/14329.php</a></div></blockquote></div><br></div></div></blockquote></div><br></div></body></html>
