<div dir="ltr">I am seeing the following on OpenBSD/amd64 with &quot;make V=1&quot;:<div><br></div><div><div>Making all in tools/wrappers</div><div>/bin/sh ../../../libtool  --tag=CC    --mode=link gcc -std=gnu99  -g -finline-functions -fno-strict-aliasing -pthread   -export-dynamic   -o opal_wrapper opal_wrapper.o ../../../opal/<a href="http://libopen-pal.la">libopen-pal.la</a> -lutil -lm </div>
<div>libtool: link: gcc -std=gnu99 -g -finline-functions -fno-strict-aliasing -pthread -o .libs/opal_wrapper opal_wrapper.o -Wl,-E  -L../../../opal/.libs -lopen-pal -lpthread -lutil -lm -pthread -Wl,-rpath,/home/phargrov/OMPI/openmpi-1.8.2rc3-openbsd5-amd64/INST/lib</div>
<div>../../../opal/.libs/libopen-pal.so.8.0: warning: vsprintf() is often misused, please use vsnprintf()</div><div>../../../opal/.libs/libopen-pal.so.8.0: warning: strcpy() is almost always misused, please use strlcpy()</div>
<div>../../../opal/.libs/libopen-pal.so.8.0: warning: random() isn&#39;t random; consider using arc4random()</div><div>../../../opal/.libs/libopen-pal.so.8.0: warning: strcat() is almost always misused, please use strlcat()</div>
<div>../../../opal/.libs/libopen-pal.so.8.0: warning: sprintf() is often misused, please use snprintf()</div><div>../../../opal/.libs/libopen-pal.so.8.0: undefined reference to `arc4random_addrandom&#39;</div><div>collect2: ld returned 1 exit status</div>
<div>*** Error 1 in opal/tools/wrappers (Makefile:1623 &#39;opal_wrapper&#39;)</div><div>*** Error 1 in opal (Makefile:2145 &#39;all-recursive&#39;)</div><div>*** Error 1 in /home/phargrov/OMPI/openmpi-1.8.2rc3-openbsd5-amd64/BLD (Makefile:1689 &#39;all-recursive&#39;)</div>
<div><br></div><div>Ignoring OpenBSD&#39;s typical warnings about functions their developers don&#39;t like there is an undefined reference to arc4random_addrandom.  The only explicit reference appears to be in libevent:</div>
<div><br></div><div><div>$ grep -rlw arc4random_addrandom .</div><div>./opal/mca/event/libevent2021/libevent/evutil_rand.c</div><div>./opal/mca/event/libevent2021/libevent/arc4random.c</div></div><div><br></div><div>It appears that OpenBSD has arc4random, but no arc4random_addrandom():</div>
<div><div>/usr/include/stdlib.h:u_int32_t arc4random(void);</div><div>/usr/include/stdlib.h:u_int32_t arc4random_uniform(u_int32_t);</div><div>/usr/include/stdlib.h:void arc4random_buf(void *, size_t)</div></div><div><br>
</div><div>I tried to work-around this by adding  &quot;ac_cv_func_arc4random=no&quot; to the configure command line, but that creates secondary problems because the #if logic in libevent doesn&#39;t allow for the case that arc4random() does not exist but arc4random_buf() does:</div>
<div><br></div><div><div>In file included from /home/phargrov/OMPI/openmpi-1.8.2rc3-openbsd5-amd64/openmpi-1.8.2rc3/opal/mca/event/libev</div><div>ent2021/libevent/evutil_rand.c:119:</div><div>/home/phargrov/OMPI/openmpi-1.8.2rc3-openbsd5-amd64/openmpi-1.8.2rc3/opal/mca/event/libevent2021/libevent/./arc</div>
<div>4random.c:482: error: static declaration of &#39;arc4random_buf&#39; follows non-static declaration</div><div>/usr/include/stdlib.h:308: error: previous declaration of &#39;arc4random_buf&#39; was here</div></div><div>
<br></div><div>Use of --with-libevent=... was no use because the pre-built libevent package for OpenBSD lacks thread support.</div><div><br></div><div>So, I am left without any recipe to build 1.8.2rc3 on OpenBSD.</div><div>
HOWEVER, is appears that 1.8, 1.8.1 and trunk all have the same problem.</div><div>Of course, I am the only one who tests Open MPI on OpenBSD, and I don&#39;t actually USE it.</div><div>So, this is not any sort of a priority as far as I am concerned.</div>
<div><br></div><div>-Paul</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br clear="all"><div><br></div>-- <br><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div>
<div>Future Technologies Group</div><div>Computer and Data Sciences Department     Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font>
</div></div></div>

