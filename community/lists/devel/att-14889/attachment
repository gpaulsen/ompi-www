<html><head><meta http-equiv="Content-Type" content="text/html charset=us-ascii"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div style="margin: 0px; font-size: 11px; font-family: Menlo; background-color: rgb(254, 244, 156);">gcc (GCC) 4.4.7 20120313 (Red Hat 4.4.7-4)</div><div><div style="margin: 0px; font-size: 11px; font-family: Menlo; background-color: rgb(254, 244, 156);">&nbsp;./configure --prefix=/home/common/openmpi/build/svn-trunk --enable-mpi-java --enable-orterun-prefix-by-default</div></div><div style="margin: 0px; font-size: 11px; font-family: Menlo; background-color: rgb(254, 244, 156);"><br></div><div style="margin: 0px; font-size: 11px; font-family: Menlo; background-color: rgb(254, 244, 156);">More inline below</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; background-color: rgb(254, 244, 156);"><br></div><div><div>On May 27, 2014, at 9:29 PM, Gilles Gouaillardet &lt;<a href="mailto:gilles.gouaillardet@gmail.com">gilles.gouaillardet@gmail.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div dir="ltr"><div><div><div><div><div><div><div><div><div><div>Ralph,<br><br></div>can you please describe your environment (at least compiler (and version) + configure command line)<br></div>i checked osc_rdma_data_move.c only :<br>
<br></div>size_t incoming_length; is used to improve readability.<br></div>it is used only in an assert clause and in OPAL_OUTPUT_VERBOSE<br><br></div>one way to silence the warning is not to use this variable (and compromise readability).<br>
<br></div><div>an other way would be to<br></div><div>#if OPAL_ENABLE_DEBUG<br></div><div>size_t incoming_length = request-&gt;req_status._ucount);<br>#endif<br><br></div>imho, a more elegant way would be to use a macro like<br>
</div>OPAL_IF_DEBUG(size_t incoming_length = request-&gt;req_status._ucount);)<br><br></div>/* i am not aware of such a macro, please point me if it already exists */<br><br></div><div>any thoughts ?<br></div></div></div></blockquote><div><br></div>I'm unaware of such a macro, but could see the value in creating one - though I must admit, this problem hasn't come up very often. Your choice - either way (surround it with #if or create a macro) is fine with me.</div><div><br><blockquote type="cite"><div dir="ltr"><div><div><br><br></div>about the other warnings, xxx may be used uninitialized in this function, i was unable to reproduce it and i have to double check again.<br>
so far, it seems this is a false positive/compiler bug that could be triggered by inlining<br></div><div>/* i could not find any path in which the variable is used unitialized */<br></div></div></blockquote><div><br></div>I just glanced at the first one (line 221 of osc_rdma_data_move.c), and I can see what the compiler is complaining about - have gotten this in other places as well. The problem is that you pass the address of ptr into a function without first initializing the value of ptr itself. There is no guarantee (so far as the compiler can see) that this function will in fact set the value of ptr - you are relying solely on the fact that (a) you checked that function at one point in time and saw that it always gets set to something if ret == OMPI_SUCCESS, and (b) nobody changed that function since you checked.</div><div><br></div><div>Newer compilers seem to be getting more defensive about such things and starting to "bark" when they see it. I think you are correct that inlining also impacts that situation, though I've also been seeing it when the functions aren't inlined.</div><div><br></div><div>Not sure what to suggest here - hate to add initialization steps in that sequence....</div><div><br><blockquote type="cite"><div dir="ltr"><div><br></div>Cheers,<br><br>Gilles<br>
</div><div class="gmail_extra"><br><br><div class="gmail_quote">On Mon, May 26, 2014 at 12:25 PM, Ralph Castain <span dir="ltr">&lt;<a href="mailto:rhc@open-mpi.org" target="_blank">rhc@open-mpi.org</a>&gt;</span> wrote:<br>
<blockquote class="gmail_quote" style="margin: 0px 0px 0px 0.8ex; border-left-width: 1px; border-left-color: rgb(204, 204, 204); border-left-style: solid; padding-left: 1ex; position: static; z-index: auto;"><div style="word-wrap:break-word"><div style="margin:0px;font-size:11px;font-family:Menlo">Building optimized on an IB-based machine:</div>
<div style="margin:0px;font-size:11px;font-family:Menlo"><br></div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_data_move.c: In function 'ompi_osc_rdma_callback':</div><div style="margin:0px;font-size:11px;font-family:Menlo">
osc_rdma_data_move.c:1633: warning: unused variable 'incoming_length'</div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_data_move.c: In function 'ompi_osc_rdma_control_send':</div><div style="margin:0px;font-size:11px;font-family:Menlo">
osc_rdma_data_move.c:221: warning: 'ptr' may be used uninitialized in this function</div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_data_move.c:220: warning: 'frag' may be used uninitialized in this function</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_data_move.c: In function 'ompi_osc_gacc_long_start':</div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_data_move.c:961: warning: 'acc_data' may be used uninitialized in this function</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_data_move.c: In function 'ompi_osc_rdma_gacc_start':</div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_data_move.c:912: warning: 'acc_data' may be used uninitialized in this function</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c: In function 'ompi_osc_rdma_rget_accumulate_internal':</div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c:943: warning: 'ptr' may be used uninitialized in this function</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c:940: warning: 'frag' may be used uninitialized in this function</div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_data_move.c: In function 'ompi_osc_rdma_acc_long_start':</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_data_move.c:827: warning: 'acc_data' may be used uninitialized in this function</div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c: In function 'ompi_osc_rdma_rget':</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c:736: warning: 'ptr' may be used uninitialized in this function</div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c:733: warning: 'frag' may be used uninitialized in this function</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c: In function 'ompi_osc_rdma_accumulate_w_req':</div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c:420: warning: 'ptr' may be used uninitialized in this function</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c:417: warning: 'frag' may be used uninitialized in this function</div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c: In function 'ompi_osc_rdma_put_w_req':</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c:251: warning: 'ptr' may be used uninitialized in this function</div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c:244: warning: 'frag' may be used uninitialized in this function</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c: In function 'ompi_osc_rdma_get':</div><div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c:736: warning: 'ptr' may be used uninitialized in this function</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">osc_rdma_comm.c:733: warning: 'frag' may be used uninitialized in this function</div><div style="margin:0px;font-size:11px;font-family:Menlo"><br></div><div style="margin:0px;font-size:11px;font-family:Menlo">
<br></div><div style="margin:0px;font-size:11px;font-family:Menlo"><br></div><div style="margin:0px;font-size:11px;font-family:Menlo"><br></div><div style="margin:0px;font-size:11px;font-family:Menlo">vt_plugin_cntr.c: In function 'vt_plugin_cntr_write_post_mortem':</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">vt_plugin_cntr.c:1139: warning: 'min_counter' may be used uninitialized in this function</div><div style="margin:0px;font-size:11px;font-family:Menlo">vt_plugin_cntr.c: In function 'vt_plugin_cntr_write_post_mortem':</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">vt_plugin_cntr.c:1139: warning: 'min_counter' may be used uninitialized in this function</div><div style="margin:0px;font-size:11px;font-family:Menlo">vt_plugin_cntr.c: In function 'vt_plugin_cntr_write_post_mortem':</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">vt_plugin_cntr.c:1139: warning: 'min_counter' may be used uninitialized in this function</div><div style="margin:0px;font-size:11px;font-family:Menlo">vt_plugin_cntr.c: In function 'vt_plugin_cntr_write_post_mortem':</div>
<div style="margin:0px;font-size:11px;font-family:Menlo">vt_plugin_cntr.c:1139: warning: 'min_counter' may be used uninitialized in this function</div><div><br></div></div><br>_______________________________________________<br>

devel mailing list<br>
<a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br>
Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2014/05/14840.php" target="_blank">http://www.open-mpi.org/community/lists/devel/2014/05/14840.php</a><br></blockquote></div><br></div>
_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/devel<br>Link to this post: http://www.open-mpi.org/community/lists/devel/2014/05/14880.php</blockquote></div><br></body></html>
