<div dir="ltr"><div>I have the Sun/Oracle Studio compilers installed on Linux/x86-64 systems.</div><div>I test versions 12.2 and 12.4 with &quot;-m32&quot;.</div><div>I both of those builds &quot;make check&quot; is failing with a SEGV from dlopen_test.</div><div>This is an improvement over the previous rc3, which did not build at all.</div><div><br></div><div>From the core file on the Studio 12.4 system (the other is the same)</div><div><br></div><div><div>Program terminated with signal 11, Segmentation fault.</div><div>#0  0xf6373da7 in flush_and_invalidate_cache (a=4127109984)</div><div>    at /scratch/phargrov/OMPI/openmpi-2.0.0rc4-linux-x86_64-ss12u4-m32/openmpi-2.0.0rc4/opal/mca/patcher/base/patcher_base_patch.c:96</div><div>96              have_clflush = !!(cpuid2 &amp; (1 &lt;&lt; 19));</div><div><br></div><div>(gdb) where<br></div></div><div><div>#0  0xf6373da7 in flush_and_invalidate_cache (a=4127109984)</div><div>    at /scratch/phargrov/OMPI/openmpi-2.0.0rc4-linux-x86_64-ss12u4-m32/openmpi-2.0.0rc4/opal/mca/patcher/base/patcher_base_patch.c:96</div><div>#1  0xf6373ed4 in apply_patch (patch_data=0x971b4e0 &quot;\351\033\277\066&quot;, address=4127109984, data_size=5)</div><div>    at /scratch/phargrov/OMPI/openmpi-2.0.0rc4-linux-x86_64-ss12u4-m32/openmpi-2.0.0rc4/opal/mca/patcher/base/patcher_base_patch.c:138</div><div>#2  0xf6373fb8 in mca_base_patcher_patch_apply_binary (patch=0x971b4a8)</div><div>    at /scratch/phargrov/OMPI/openmpi-2.0.0rc4-linux-x86_64-ss12u4-m32/openmpi-2.0.0rc4/opal/mca/patcher/base/patcher_base_patch.c:152</div><div>#3  0xf6117e4c in mca_patcher_overwrite_apply_patch (patch=0x971b4a8)</div><div>    at /scratch/phargrov/OMPI/openmpi-2.0.0rc4-linux-x86_64-ss12u4-m32/openmpi-2.0.0rc4/opal/mca/patcher/overwrite/patcher_overwrite_module.c:151</div><div>#4  0xf6117ee9 in mca_patcher_overwrite_patch_address (sys_addr=4127109984, hook_addr=4130697856)</div><div>    at /scratch/phargrov/OMPI/openmpi-2.0.0rc4-linux-x86_64-ss12u4-m32/openmpi-2.0.0rc4/opal/mca/patcher/overwrite/patcher_overwrite_module.c:255</div><div>#5  0xf6118000 in mca_patcher_overwrite_patch_symbol (func_symbol_name=0xf63e9f2c &quot;munmap&quot;, </div><div>    func_new_addr=4130697856, func_old_addr=0xf6404aa0)</div><div>    at /scratch/phargrov/OMPI/openmpi-2.0.0rc4-linux-x86_64-ss12u4-m32/openmpi-2.0.0rc4/opal/mca/patcher/overwrite/patcher_overwrite_module.c:301</div><div>#6  0xf635771d in patcher_open ()</div><div>    at /scratch/phargrov/OMPI/openmpi-2.0.0rc4-linux-x86_64-ss12u4-m32/openmpi-2.0.0rc4/opal/mca/memory/patcher/memory_patcher_component.c:442</div><div>#7  0xf622ecfb in open_components (framework=0xf63fda40)</div><div>    at /scratch/phargrov/OMPI/openmpi-2.0.0rc4-linux-x86_64-ss12u4-m32/openmpi-2.0.0rc4/opal/mca/base/mca_base_components_open.c:117</div></div><div>[...truncated...]</div><div><br></div><div><br></div><div>Note that gcc, clang and open64 all work fine on this system when configured with -m32.</div><div>I ran the Studio 12.5 beta (not in my original suite of tests) and do *NOT* see the failure.</div><div>So, I think a compiler bug is a definite possibility here.</div><div>However, given the issues seen with xlc, I think is might also be possible that the patcher code could contain &quot;marginal C&quot; with undefined behavior.</div><div><br></div><div>Note that w/o -m32 all the versions of the Studio Compilers are working fine.</div><div>So the impact of this issue is pretty small.</div><div><br></div><div>-Paul</div><br clear="all"><div><br></div>-- <br><div class="gmail_signature" data-smartmail="gmail_signature"><div dir="ltr"><div><font face="courier new, monospace"><div>Paul H. Hargrove                          <a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div><div>Computer Languages &amp; Systems Software (CLaSS) Group</div><div>Computer Science Department               Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory     Fax: +1-510-486-6900</div></font></div></div></div>
</div>

