<html><head><meta http-equiv="Content-Type" content="text/html charset=iso-8859-1"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">This was apparently somewhat recent - here is the OpenBSD ticket regarding it:<div><br></div><div><a href="http://sourceforge.net/p/levent/bugs/320/">http://sourceforge.net/p/levent/bugs/320/</a></div><div><br></div><div>If someone feels it important that we continue supporting OpenBSD, one might explore the solution recommended in that ticket. It's also possible that the libevent guys are working on solving it too (or may have already done so in a later version than we include)</div><div><br></div><div><br><div><div>On Aug 1, 2014, at 4:07 PM, Paul Hargrove &lt;<a href="mailto:phhargrove@lbl.gov">phhargrove@lbl.gov</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div dir="ltr">I am seeing the following on OpenBSD/amd64 with "make V=1":<div><br></div><div><div>Making all in tools/wrappers</div><div>/bin/sh ../../../libtool &nbsp;--tag=CC &nbsp; &nbsp;--mode=link gcc -std=gnu99 &nbsp;-g -finline-functions -fno-strict-aliasing -pthread &nbsp; -export-dynamic &nbsp; -o opal_wrapper opal_wrapper.o ../../../opal/<a href="http://libopen-pal.la/">libopen-pal.la</a> -lutil -lm&nbsp;</div>
<div>libtool: link: gcc -std=gnu99 -g -finline-functions -fno-strict-aliasing -pthread -o .libs/opal_wrapper opal_wrapper.o -Wl,-E &nbsp;-L../../../opal/.libs -lopen-pal -lpthread -lutil -lm -pthread -Wl,-rpath,/home/phargrov/OMPI/openmpi-1.8.2rc3-openbsd5-amd64/INST/lib</div>
<div>../../../opal/.libs/libopen-pal.so.8.0: warning: vsprintf() is often misused, please use vsnprintf()</div><div>../../../opal/.libs/libopen-pal.so.8.0: warning: strcpy() is almost always misused, please use strlcpy()</div>
<div>../../../opal/.libs/libopen-pal.so.8.0: warning: random() isn't random; consider using arc4random()</div><div>../../../opal/.libs/libopen-pal.so.8.0: warning: strcat() is almost always misused, please use strlcat()</div>
<div>../../../opal/.libs/libopen-pal.so.8.0: warning: sprintf() is often misused, please use snprintf()</div><div>../../../opal/.libs/libopen-pal.so.8.0: undefined reference to `arc4random_addrandom'</div><div>collect2: ld returned 1 exit status</div>
<div>*** Error 1 in opal/tools/wrappers (Makefile:1623 'opal_wrapper')</div><div>*** Error 1 in opal (Makefile:2145 'all-recursive')</div><div>*** Error 1 in /home/phargrov/OMPI/openmpi-1.8.2rc3-openbsd5-amd64/BLD (Makefile:1689 'all-recursive')</div>
<div><br></div><div>Ignoring OpenBSD's typical warnings about functions their developers don't like there is an undefined reference to arc4random_addrandom. &nbsp;The only explicit reference appears to be in libevent:</div>
<div><br></div><div><div>$ grep -rlw arc4random_addrandom .</div><div>./opal/mca/event/libevent2021/libevent/evutil_rand.c</div><div>./opal/mca/event/libevent2021/libevent/arc4random.c</div></div><div><br></div><div>It appears that OpenBSD has arc4random, but no arc4random_addrandom():</div>
<div><div>/usr/include/stdlib.h:u_int32_t arc4random(void);</div><div>/usr/include/stdlib.h:u_int32_t arc4random_uniform(u_int32_t);</div><div>/usr/include/stdlib.h:void arc4random_buf(void *, size_t)</div></div><div><br>
</div><div>I tried to work-around this by adding &nbsp;"ac_cv_func_arc4random=no" to the configure command line, but that creates secondary problems because the #if logic in libevent doesn't allow for the case that arc4random() does not exist but arc4random_buf() does:</div>
<div><br></div><div><div>In file included from /home/phargrov/OMPI/openmpi-1.8.2rc3-openbsd5-amd64/openmpi-1.8.2rc3/opal/mca/event/libev</div><div>ent2021/libevent/evutil_rand.c:119:</div><div>/home/phargrov/OMPI/openmpi-1.8.2rc3-openbsd5-amd64/openmpi-1.8.2rc3/opal/mca/event/libevent2021/libevent/./arc</div>
<div>4random.c:482: error: static declaration of 'arc4random_buf' follows non-static declaration</div><div>/usr/include/stdlib.h:308: error: previous declaration of 'arc4random_buf' was here</div></div><div>
<br></div><div>Use of --with-libevent=... was no use because the pre-built libevent package for OpenBSD lacks thread support.</div><div><br></div><div>So, I am left without any recipe to build 1.8.2rc3 on OpenBSD.</div><div>
HOWEVER, is appears that 1.8, 1.8.1 and trunk all have the same problem.</div><div>Of course, I am the only one who tests Open MPI on OpenBSD, and I don't actually USE it.</div><div>So, this is not any sort of a priority as far as I am concerned.</div>
<div><br></div><div>-Paul</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br clear="all"><div><br></div>-- <br><font face="courier new, monospace"><div>Paul H. Hargrove &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="mailto:PHHargrove@lbl.gov" target="_blank">PHHargrove@lbl.gov</a></div>
<div>Future Technologies Group</div><div>Computer and Data Sciences Department &nbsp; &nbsp; Tel: +1-510-495-2352</div><div>Lawrence Berkeley National Laboratory &nbsp; &nbsp; Fax: +1-510-486-6900</div></font>
</div></div></div>
_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/devel<br>Link to this post: http://www.open-mpi.org/community/lists/devel/2014/08/15466.php</blockquote></div><br></div></body></html>
